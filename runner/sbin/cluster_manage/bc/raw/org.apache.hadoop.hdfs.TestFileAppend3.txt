[msx] before_class
2020-04-02 05:08:03,736 [main] INFO  hdfs.AppendTestUtil (AppendTestUtil.java:<clinit>(53)) - seed=8928088006529632134
2020-04-02 05:08:03,742 [main] INFO  hdfs.AppendTestUtil (TestFileAppend3.java:setUp(77)) - setUp()
2020-04-02 05:08:04,061 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:<init>(492)) - starting cluster: numNameNodes=1, numDataNodes=5
Formatting using clusterid: testClusterID
2020-04-02 05:08:04,869 [main] INFO  namenode.FSEditLog (FSEditLog.java:newInstance(227)) - Edit logging is async:true
2020-04-02 05:08:04,883 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(749)) - KeyProvider: null
2020-04-02 05:08:04,884 [main] INFO  namenode.FSNamesystem (FSNamesystemLock.java:<init>(121)) - fsLock is fair: true
2020-04-02 05:08:04,886 [main] INFO  namenode.FSNamesystem (FSNamesystemLock.java:<init>(139)) - Detailed lock hold time metrics enabled: false
2020-04-02 05:08:04,894 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(774)) - fsOwner             = root (auth:SIMPLE)
2020-04-02 05:08:04,895 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(775)) - supergroup          = supergroup
2020-04-02 05:08:04,895 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(776)) - isPermissionEnabled = true
2020-04-02 05:08:04,896 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(787)) - HA Enabled: false
2020-04-02 05:08:04,953 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(394)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-04-02 05:08:04,964 [main] INFO  Configuration.deprecation (Configuration.java:logDeprecation(1394)) - hadoop.configured.node.mapping is deprecated. Instead, use net.topology.configured.node.mapping
2020-04-02 05:08:04,965 [main] INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(301)) - dfs.block.invalidate.limit: configured=1000, counted=60, effected=1000
2020-04-02 05:08:04,965 [main] INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(309)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2020-04-02 05:08:04,971 [main] INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(79)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2020-04-02 05:08:04,972 [main] INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(85)) - The block deletion will start around 2020 Apr 02 05:08:04
2020-04-02 05:08:04,975 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map BlocksMap
2020-04-02 05:08:04,975 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-04-02 05:08:04,977 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 2.0% max memory 1.9 GB = 39.3 MB
2020-04-02 05:08:04,978 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^22 = 4194304 entries
2020-04-02 05:08:04,996 [main] INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(579)) - dfs.block.access.token.enable = false
2020-04-02 05:08:05,004 [main] INFO  Configuration.deprecation (Configuration.java:logDeprecation(1394)) - No unit for dfs.namenode.safemode.extension(0) assuming MILLISECONDS
2020-04-02 05:08:05,005 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(161)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2020-04-02 05:08:05,005 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(162)) - dfs.namenode.safemode.min.datanodes = 0
2020-04-02 05:08:05,005 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(164)) - dfs.namenode.safemode.extension = 0
2020-04-02 05:08:05,006 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(565)) - defaultReplication         = 3
2020-04-02 05:08:05,006 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(566)) - maxReplication             = 512
2020-04-02 05:08:05,006 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(567)) - minReplication             = 1
2020-04-02 05:08:05,006 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(568)) - maxReplicationStreams      = 2
2020-04-02 05:08:05,006 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(569)) - redundancyRecheckInterval  = 3000ms
2020-04-02 05:08:05,006 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(570)) - encryptDataTransfer        = false
2020-04-02 05:08:05,007 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(571)) - maxNumBlocksToLog          = 1000
2020-04-02 05:08:05,042 [main] INFO  namenode.FSDirectory (SerialNumberManager.java:initialize(77)) - GLOBAL serial map: bits=24 maxEntries=16777215
2020-04-02 05:08:05,064 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map INodeMap
2020-04-02 05:08:05,065 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-04-02 05:08:05,065 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 1.0% max memory 1.9 GB = 19.6 MB
2020-04-02 05:08:05,066 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^21 = 2097152 entries
2020-04-02 05:08:05,072 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(285)) - ACLs enabled? false
2020-04-02 05:08:05,073 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(289)) - POSIX ACL inheritance enabled? true
2020-04-02 05:08:05,073 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(293)) - XAttrs enabled? true
2020-04-02 05:08:05,074 [main] INFO  namenode.NameNode (FSDirectory.java:<init>(357)) - Caching file names occurring more than 10 times
2020-04-02 05:08:05,081 [main] INFO  snapshot.SnapshotManager (SnapshotManager.java:<init>(124)) - Loaded config captureOpenFiles: false, skipCaptureAccessTimeOnlyChange: false, snapshotDiffAllowSnapRootDescendant: true, maxSnapshotLimit: 65536
2020-04-02 05:08:05,084 [main] INFO  snapshot.SnapshotManager (DirectoryDiffListFactory.java:init(43)) - SkipList is disabled
2020-04-02 05:08:05,090 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map cachedBlocks
2020-04-02 05:08:05,090 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-04-02 05:08:05,091 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 0.25% max memory 1.9 GB = 4.9 MB
2020-04-02 05:08:05,091 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^19 = 524288 entries
2020-04-02 05:08:05,102 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(76)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2020-04-02 05:08:05,102 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(78)) - NNTop conf: dfs.namenode.top.num.users = 10
2020-04-02 05:08:05,103 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(80)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2020-04-02 05:08:05,107 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(990)) - Retry cache on namenode is enabled
2020-04-02 05:08:05,107 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(998)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2020-04-02 05:08:05,110 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map NameNodeRetryCache
2020-04-02 05:08:05,110 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-04-02 05:08:05,111 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 0.029999999329447746% max memory 1.9 GB = 603.0 KB
2020-04-02 05:08:05,111 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^16 = 65536 entries
2020-04-02 05:08:05,153 [main] INFO  namenode.FSImage (FSImage.java:format(170)) - Allocated new BlockPoolId: BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:05,166 [main] INFO  common.Storage (NNStorage.java:format(583)) - Storage directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1 has been successfully formatted.
2020-04-02 05:08:05,169 [main] INFO  common.Storage (NNStorage.java:format(583)) - Storage directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2 has been successfully formatted.
2020-04-02 05:08:05,181 [FSImageSaver for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1 of type IMAGE_AND_EDITS] INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:save(449)) - Saving image file /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/fsimage.ckpt_0000000000000000000 using no compression
2020-04-02 05:08:05,181 [FSImageSaver for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2 of type IMAGE_AND_EDITS] INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:save(449)) - Saving image file /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/current/fsimage.ckpt_0000000000000000000 using no compression
2020-04-02 05:08:05,303 [FSImageSaver for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2 of type IMAGE_AND_EDITS] INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:save(453)) - Image file /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/current/fsimage.ckpt_0000000000000000000 of size 391 bytes saved in 0 seconds .
2020-04-02 05:08:05,303 [FSImageSaver for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1 of type IMAGE_AND_EDITS] INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:save(453)) - Image file /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/fsimage.ckpt_0000000000000000000 of size 391 bytes saved in 0 seconds .
2020-04-02 05:08:05,333 [main] INFO  namenode.NNStorageRetentionManager (NNStorageRetentionManager.java:getImageTxIdToRetain(203)) - Going to retain 1 images with txid >= 0
2020-04-02 05:08:05,337 [main] INFO  namenode.NameNode (NameNode.java:createNameNode(1613)) - createNameNode []
2020-04-02 05:08:05,491 [main] INFO  beanutils.FluentPropertyBeanIntrospector (FluentPropertyBeanIntrospector.java:introspect(147)) - Error when creating PropertyDescriptor for public final void org.apache.commons.configuration2.AbstractConfiguration.setProperty(java.lang.String,java.lang.Object)! Ignoring this property.
2020-04-02 05:08:05,544 [main] INFO  impl.MetricsConfig (MetricsConfig.java:loadFirst(121)) - loaded properties from hadoop-metrics2.properties
2020-04-02 05:08:05,978 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:startTimer(374)) - Scheduled Metric snapshot period at 0 second(s).
2020-04-02 05:08:05,978 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:start(191)) - NameNode metrics system started
2020-04-02 05:08:05,983 [main] INFO  conf.Configured (ReconfAgent.java:performReconf(74)) - [msx-restart] NameNode init, vvmode is none, do nothing
2020-04-02 05:08:06,032 [main] INFO  namenode.NameNodeUtils (NameNodeUtils.java:getClientNamenodeAddress(79)) - fs.defaultFS is hdfs://127.0.0.1:0
2020-04-02 05:08:06,081 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@4c1909a3] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2020-04-02 05:08:06,104 [main] INFO  hdfs.DFSUtil (DFSUtil.java:httpServerTemplateForNNAndJN(1605)) - Starting Web-server for hdfs at: http://localhost:0
2020-04-02 05:08:06,108 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1052)) - Web server is in development mode. Resources will be read from the source tree.
2020-04-02 05:08:06,123 [main] INFO  util.log (Log.java:initialized(192)) - Logging initialized @3536ms
2020-04-02 05:08:06,254 [main] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2020-04-02 05:08:06,258 [main] INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(81)) - Http request log for http.requests.namenode is not defined
2020-04-02 05:08:06,259 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1052)) - Web server is in development mode. Resources will be read from the source tree.
2020-04-02 05:08:06,267 [main] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(970)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2020-04-02 05:08:06,269 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(943)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context hdfs
2020-04-02 05:08:06,270 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(953)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2020-04-02 05:08:06,270 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(953)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2020-04-02 05:08:06,302 [main] INFO  http.HttpServer2 (NameNodeHttpServer.java:initWebHdfs(100)) - Added filter 'org.apache.hadoop.hdfs.web.AuthFilter' (class=org.apache.hadoop.hdfs.web.AuthFilter)
2020-04-02 05:08:06,302 [main] INFO  http.HttpServer2 (HttpServer2.java:addJerseyResourcePackage(789)) - addJerseyResourcePackage: packageName=org.apache.hadoop.hdfs.server.namenode.web.resources;org.apache.hadoop.hdfs.web.resources, pathSpec=/webhdfs/v1/*
2020-04-02 05:08:06,312 [main] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1186)) - Jetty bound to port 44092
2020-04-02 05:08:06,314 [main] INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2020-04-02 05:08:06,360 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@9816741{/logs,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,AVAILABLE}
2020-04-02 05:08:06,361 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@13d73f29{/static,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,AVAILABLE}
2020-04-02 05:08:06,427 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@766653e6{/,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/hdfs/,AVAILABLE}{/hdfs}
2020-04-02 05:08:06,437 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@5a37d3ed{HTTP/1.1,[http/1.1]}{localhost:44092}
2020-04-02 05:08:06,440 [main] INFO  server.Server (Server.java:doStart(419)) - Started @3854ms
2020-04-02 05:08:06,453 [main] INFO  namenode.FSEditLog (FSEditLog.java:newInstance(227)) - Edit logging is async:true
2020-04-02 05:08:06,454 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(749)) - KeyProvider: null
2020-04-02 05:08:06,454 [main] INFO  namenode.FSNamesystem (FSNamesystemLock.java:<init>(121)) - fsLock is fair: true
2020-04-02 05:08:06,454 [main] INFO  namenode.FSNamesystem (FSNamesystemLock.java:<init>(139)) - Detailed lock hold time metrics enabled: false
2020-04-02 05:08:06,455 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(774)) - fsOwner             = root (auth:SIMPLE)
2020-04-02 05:08:06,455 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(775)) - supergroup          = supergroup
2020-04-02 05:08:06,455 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(776)) - isPermissionEnabled = true
2020-04-02 05:08:06,455 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:<init>(787)) - HA Enabled: false
2020-04-02 05:08:06,458 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(394)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-04-02 05:08:06,459 [main] INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(301)) - dfs.block.invalidate.limit: configured=1000, counted=60, effected=1000
2020-04-02 05:08:06,459 [main] INFO  blockmanagement.DatanodeManager (DatanodeManager.java:<init>(309)) - dfs.namenode.datanode.registration.ip-hostname-check=true
2020-04-02 05:08:06,460 [main] INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(79)) - dfs.namenode.startup.delay.block.deletion.sec is set to 000:00:00:00.000
2020-04-02 05:08:06,460 [main] INFO  blockmanagement.BlockManager (InvalidateBlocks.java:printBlockDeletionTime(85)) - The block deletion will start around 2020 Apr 02 05:08:06
2020-04-02 05:08:06,460 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map BlocksMap
2020-04-02 05:08:06,460 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-04-02 05:08:06,461 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 2.0% max memory 1.8 GB = 36.4 MB
2020-04-02 05:08:06,461 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^22 = 4194304 entries
2020-04-02 05:08:06,482 [main] INFO  blockmanagement.BlockManager (BlockManager.java:createBlockTokenSecretManager(579)) - dfs.block.access.token.enable = false
2020-04-02 05:08:06,483 [main] INFO  Configuration.deprecation (Configuration.java:logDeprecation(1394)) - No unit for dfs.namenode.safemode.extension(0) assuming MILLISECONDS
2020-04-02 05:08:06,484 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(161)) - dfs.namenode.safemode.threshold-pct = 0.9990000128746033
2020-04-02 05:08:06,484 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(162)) - dfs.namenode.safemode.min.datanodes = 0
2020-04-02 05:08:06,484 [main] INFO  blockmanagement.BlockManagerSafeMode (BlockManagerSafeMode.java:<init>(164)) - dfs.namenode.safemode.extension = 0
2020-04-02 05:08:06,484 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(565)) - defaultReplication         = 3
2020-04-02 05:08:06,485 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(566)) - maxReplication             = 512
2020-04-02 05:08:06,485 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(567)) - minReplication             = 1
2020-04-02 05:08:06,485 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(568)) - maxReplicationStreams      = 2
2020-04-02 05:08:06,485 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(569)) - redundancyRecheckInterval  = 3000ms
2020-04-02 05:08:06,485 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(570)) - encryptDataTransfer        = false
2020-04-02 05:08:06,486 [main] INFO  blockmanagement.BlockManager (BlockManager.java:<init>(571)) - maxNumBlocksToLog          = 1000
2020-04-02 05:08:06,486 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map INodeMap
2020-04-02 05:08:06,486 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-04-02 05:08:06,487 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 1.0% max memory 1.8 GB = 18.2 MB
2020-04-02 05:08:06,487 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^21 = 2097152 entries
2020-04-02 05:08:06,493 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(285)) - ACLs enabled? false
2020-04-02 05:08:06,493 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(289)) - POSIX ACL inheritance enabled? true
2020-04-02 05:08:06,493 [main] INFO  namenode.FSDirectory (FSDirectory.java:<init>(293)) - XAttrs enabled? true
2020-04-02 05:08:06,493 [main] INFO  namenode.NameNode (FSDirectory.java:<init>(357)) - Caching file names occurring more than 10 times
2020-04-02 05:08:06,494 [main] INFO  snapshot.SnapshotManager (SnapshotManager.java:<init>(124)) - Loaded config captureOpenFiles: false, skipCaptureAccessTimeOnlyChange: false, snapshotDiffAllowSnapRootDescendant: true, maxSnapshotLimit: 65536
2020-04-02 05:08:06,494 [main] INFO  snapshot.SnapshotManager (DirectoryDiffListFactory.java:init(43)) - SkipList is disabled
2020-04-02 05:08:06,494 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map cachedBlocks
2020-04-02 05:08:06,494 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-04-02 05:08:06,494 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 0.25% max memory 1.8 GB = 4.6 MB
2020-04-02 05:08:06,494 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^19 = 524288 entries
2020-04-02 05:08:06,495 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(76)) - NNTop conf: dfs.namenode.top.window.num.buckets = 10
2020-04-02 05:08:06,496 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(78)) - NNTop conf: dfs.namenode.top.num.users = 10
2020-04-02 05:08:06,496 [main] INFO  metrics.TopMetrics (TopMetrics.java:logConf(80)) - NNTop conf: dfs.namenode.top.windows.minutes = 1,5,25
2020-04-02 05:08:06,496 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(990)) - Retry cache on namenode is enabled
2020-04-02 05:08:06,496 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:initRetryCache(998)) - Retry cache will use 0.03 of total heap and retry cache entry expiry time is 600000 millis
2020-04-02 05:08:06,496 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(395)) - Computing capacity for map NameNodeRetryCache
2020-04-02 05:08:06,496 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(396)) - VM type       = 64-bit
2020-04-02 05:08:06,496 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(397)) - 0.029999999329447746% max memory 1.8 GB = 559.3 KB
2020-04-02 05:08:06,497 [main] INFO  util.GSet (LightWeightGSet.java:computeCapacity(402)) - capacity      = 2^16 = 65536 entries
2020-04-02 05:08:06,506 [main] INFO  common.Storage (Storage.java:tryLock(905)) - Lock on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/in_use.lock acquired by nodename 13851@5b1ca12d458b
2020-04-02 05:08:06,510 [main] INFO  common.Storage (Storage.java:tryLock(905)) - Lock on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/in_use.lock acquired by nodename 13851@5b1ca12d458b
2020-04-02 05:08:06,514 [main] INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(396)) - Recovering unfinalized segments in /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current
2020-04-02 05:08:06,514 [main] INFO  namenode.FileJournalManager (FileJournalManager.java:recoverUnfinalizedSegments(396)) - Recovering unfinalized segments in /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/current
2020-04-02 05:08:06,515 [main] INFO  namenode.FSImage (FSImage.java:loadFSImage(718)) - No edit log streams selected.
2020-04-02 05:08:06,516 [main] INFO  namenode.FSImage (FSImage.java:loadFSImageFile(782)) - Planning to load image: FSImageFile(file=/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/fsimage_0000000000000000000, cpktTxId=0000000000000000000)
2020-04-02 05:08:06,578 [main] INFO  namenode.FSImageFormatPBINode (FSImageFormatPBINode.java:loadINodeSection(233)) - Loading 1 INodes.
2020-04-02 05:08:06,588 [main] INFO  namenode.FSImageFormatProtobuf (FSImageFormatProtobuf.java:load(183)) - Loaded FSImage in 0 seconds.
2020-04-02 05:08:06,588 [main] INFO  namenode.FSImage (FSImage.java:loadFSImage(951)) - Loaded image for txid 0 from /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/fsimage_0000000000000000000
2020-04-02 05:08:06,594 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:loadFSImage(1102)) - Need to save fs image? false (staleImage=false, haEnabled=false, isRollingUpgrade=false)
2020-04-02 05:08:06,595 [main] INFO  namenode.FSEditLog (FSEditLog.java:startLogSegment(1361)) - Starting log segment at 1
2020-04-02 05:08:06,644 [main] INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2020-04-02 05:08:06,644 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:loadFromDisk(721)) - Finished loading FSImage in 145 msecs
2020-04-02 05:08:06,832 [main] INFO  namenode.NameNode (NameNodeRpcServer.java:<init>(446)) - RPC server is binding to localhost:0
2020-04-02 05:08:06,845 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue queueCapacity: 1000 scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler
2020-04-02 05:08:06,865 [Socket Reader #1 for port 35215] INFO  ipc.Server (Server.java:run(1070)) - Starting Socket Reader #1 for port 35215
2020-04-02 05:08:07,168 [main] INFO  namenode.NameNode (NameNode.java:initialize(710)) - Clients are to use localhost:35215 to access this namenode/service.
2020-04-02 05:08:07,173 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5000)) - Registered FSNamesystemState, ReplicatedBlocksState and ECBlockGroupsState MBeans.
2020-04-02 05:08:07,193 [main] INFO  namenode.LeaseManager (LeaseManager.java:getNumUnderConstructionBlocks(171)) - Number of blocks under construction: 0
2020-04-02 05:08:07,213 [main] INFO  blockmanagement.BlockManager (BlockManager.java:initializeReplQueues(4792)) - initializing replication queues
2020-04-02 05:08:07,213 [main] INFO  hdfs.StateChange (BlockManagerSafeMode.java:leaveSafeMode(396)) - STATE* Leaving safe mode after 0 secs
2020-04-02 05:08:07,216 [main] INFO  hdfs.StateChange (BlockManagerSafeMode.java:leaveSafeMode(402)) - STATE* Network topology has 0 racks and 0 datanodes
2020-04-02 05:08:07,217 [main] INFO  hdfs.StateChange (BlockManagerSafeMode.java:leaveSafeMode(404)) - STATE* UnderReplicatedBlocks has 0 blocks
2020-04-02 05:08:07,219 [Reconstruction Queue Initializer] INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(3475)) - Total number of blocks            = 0
2020-04-02 05:08:07,219 [Reconstruction Queue Initializer] INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(3476)) - Number of invalid blocks          = 0
2020-04-02 05:08:07,219 [Reconstruction Queue Initializer] INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(3477)) - Number of under-replicated blocks = 0
2020-04-02 05:08:07,220 [Reconstruction Queue Initializer] INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(3478)) - Number of  over-replicated blocks = 0
2020-04-02 05:08:07,220 [Reconstruction Queue Initializer] INFO  blockmanagement.BlockManager (BlockManager.java:processMisReplicatesAsync(3480)) - Number of blocks being written    = 0
2020-04-02 05:08:07,220 [Reconstruction Queue Initializer] INFO  hdfs.StateChange (BlockManager.java:processMisReplicatesAsync(3483)) - STATE* Replication Queue initialization scan for invalid, over- and under-replicated blocks completed in 6 msec
2020-04-02 05:08:07,263 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1310)) - IPC Server Responder: starting
2020-04-02 05:08:07,281 [IPC Server listener on 35215] INFO  ipc.Server (Server.java:run(1149)) - IPC Server listener on 35215: starting
2020-04-02 05:08:07,285 [main] INFO  namenode.NameNode (NameNode.java:startCommonServices(816)) - NameNode RPC up at: localhost/127.0.0.1:35215
2020-04-02 05:08:07,290 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:startActiveServices(1214)) - Starting services required for active state
2020-04-02 05:08:07,290 [main] INFO  namenode.FSDirectory (FSDirectory.java:updateCountForQuota(769)) - Initializing quota with 4 thread(s)
2020-04-02 05:08:07,294 [main] INFO  namenode.FSDirectory (FSDirectory.java:updateCountForQuota(778)) - Quota initialization completed in 4 milliseconds
name space=1
storage space=0
storage types=RAM_DISK=0, SSD=0, DISK=0, ARCHIVE=0, PROVIDED=0
2020-04-02 05:08:07,298 [CacheReplicationMonitor(84970957)] INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(160)) - Starting CacheReplicationMonitor with interval 30000 milliseconds
2020-04-02 05:08:07,299 [main] INFO  namenode.NameNode (NameNode.java:<init>(963)) - [msx-restart] NameNode 35215 start, check after start, dfs.namenode.fs-limits.max-directory-items = 1048576
2020-04-02 05:08:07,306 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1632)) - Starting DataNode 0 with dfs.datanode.data.dir: [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1,[DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
2020-04-02 05:08:07,397 [main] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
2020-04-02 05:08:07,419 [main] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
2020-04-02 05:08:07,454 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - DataNode metrics system started (again)
2020-04-02 05:08:07,455 [main] INFO  conf.Configured (ReconfAgent.java:performReconf(74)) - [msx-restart] DataNode init, vvmode is none, do nothing
2020-04-02 05:08:07,481 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(394)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-04-02 05:08:07,484 [main] INFO  datanode.BlockScanner (BlockScanner.java:<init>(184)) - Initialized block scanner with targetBytesPerSec 1048576
2020-04-02 05:08:07,487 [main] INFO  datanode.DataNode (DataNode.java:<init>(510)) - Configured hostname is 127.0.0.1
2020-04-02 05:08:07,488 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(394)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-04-02 05:08:07,493 [main] INFO  datanode.DataNode (DataNode.java:startDataNode(1410)) - Starting DataNode with maxLockedMemory = 0
2020-04-02 05:08:07,501 [main] INFO  datanode.DataNode (DataNode.java:initDataXceiver(1158)) - Opened streaming server at /127.0.0.1:45580
2020-04-02 05:08:07,503 [main] INFO  datanode.DataNode (DataXceiverServer.java:<init>(78)) - Balancing bandwidth is 10485760 bytes/s
2020-04-02 05:08:07,503 [main] INFO  datanode.DataNode (DataXceiverServer.java:<init>(79)) - Number threads for balancing is 50
2020-04-02 05:08:07,531 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1052)) - Web server is in development mode. Resources will be read from the source tree.
2020-04-02 05:08:07,533 [main] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2020-04-02 05:08:07,535 [main] INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(81)) - Http request log for http.requests.datanode is not defined
2020-04-02 05:08:07,535 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1052)) - Web server is in development mode. Resources will be read from the source tree.
2020-04-02 05:08:07,537 [main] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(970)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2020-04-02 05:08:07,538 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(943)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2020-04-02 05:08:07,538 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(953)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2020-04-02 05:08:07,538 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(953)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2020-04-02 05:08:07,542 [main] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1186)) - Jetty bound to port 35894
2020-04-02 05:08:07,543 [main] INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2020-04-02 05:08:07,552 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1021f6c9{/logs,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,AVAILABLE}
2020-04-02 05:08:07,553 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@488eb7f2{/static,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,AVAILABLE}
2020-04-02 05:08:07,606 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@7b8233cd{/,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/datanode/,AVAILABLE}{/datanode}
2020-04-02 05:08:07,607 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@4b20ca2b{HTTP/1.1,[http/1.1]}{localhost:35894}
2020-04-02 05:08:07,607 [main] INFO  server.Server (Server.java:doStart(419)) - Started @5021ms
2020-04-02 05:08:08,082 [main] INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(255)) - Listening HTTP traffic on /127.0.0.1:45148
2020-04-02 05:08:08,089 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@716a7124] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2020-04-02 05:08:08,089 [main] INFO  datanode.DataNode (DataNode.java:startDataNode(1438)) - dnUserName = root
2020-04-02 05:08:08,091 [main] INFO  datanode.DataNode (DataNode.java:startDataNode(1439)) - supergroup = supergroup
2020-04-02 05:08:08,136 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue queueCapacity: 1000 scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler
2020-04-02 05:08:08,137 [Socket Reader #1 for port 43422] INFO  ipc.Server (Server.java:run(1070)) - Starting Socket Reader #1 for port 43422
2020-04-02 05:08:08,144 [main] INFO  datanode.DataNode (DataNode.java:initIpcServer(1044)) - Opened IPC server at /127.0.0.1:43422
2020-04-02 05:08:08,164 [main] INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(149)) - Refresh request received for nameservices: null
2020-04-02 05:08:08,169 [main] INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(210)) - Starting BPOfferServices for nameservices: <default>
2020-04-02 05:08:08,574 [Thread-59] INFO  datanode.DataNode (BPServiceActor.java:run(810)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:35215 starting to offer service
2020-04-02 05:08:08,582 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1310)) - IPC Server Responder: starting
2020-04-02 05:08:08,582 [IPC Server listener on 43422] INFO  ipc.Server (Server.java:run(1149)) - IPC Server listener on 43422: starting
2020-04-02 05:08:08,584 [main] INFO  datanode.DataNode (DataNode.java:runDatanodeDaemon(2674)) - [msx-restart] DataNode 43422 start, check after start, dfs.namenode.fs-limits.max-directory-items = 1048576
2020-04-02 05:08:08,586 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1632)) - Starting DataNode 1 with dfs.datanode.data.dir: [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3,[DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4
2020-04-02 05:08:08,588 [main] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3
2020-04-02 05:08:08,589 [main] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4
2020-04-02 05:08:08,616 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - DataNode metrics system started (again)
2020-04-02 05:08:08,617 [main] INFO  conf.Configured (ReconfAgent.java:performReconf(74)) - [msx-restart] DataNode init, vvmode is none, do nothing
2020-04-02 05:08:08,618 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(394)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-04-02 05:08:08,642 [main] INFO  datanode.BlockScanner (BlockScanner.java:<init>(184)) - Initialized block scanner with targetBytesPerSec 1048576
2020-04-02 05:08:08,644 [main] INFO  datanode.DataNode (DataNode.java:<init>(510)) - Configured hostname is 127.0.0.1
2020-04-02 05:08:08,645 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(394)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-04-02 05:08:08,647 [main] INFO  datanode.DataNode (DataNode.java:startDataNode(1410)) - Starting DataNode with maxLockedMemory = 0
2020-04-02 05:08:08,651 [main] INFO  datanode.DataNode (DataNode.java:initDataXceiver(1158)) - Opened streaming server at /127.0.0.1:43230
2020-04-02 05:08:08,652 [main] INFO  datanode.DataNode (DataXceiverServer.java:<init>(78)) - Balancing bandwidth is 10485760 bytes/s
2020-04-02 05:08:08,652 [main] INFO  datanode.DataNode (DataXceiverServer.java:<init>(79)) - Number threads for balancing is 50
2020-04-02 05:08:08,663 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1052)) - Web server is in development mode. Resources will be read from the source tree.
2020-04-02 05:08:08,666 [main] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2020-04-02 05:08:08,670 [main] INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(81)) - Http request log for http.requests.datanode is not defined
2020-04-02 05:08:08,670 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1052)) - Web server is in development mode. Resources will be read from the source tree.
2020-04-02 05:08:08,675 [main] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(970)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2020-04-02 05:08:08,681 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(943)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2020-04-02 05:08:08,681 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(953)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2020-04-02 05:08:08,681 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(953)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2020-04-02 05:08:08,683 [main] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1186)) - Jetty bound to port 46079
2020-04-02 05:08:08,683 [main] INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2020-04-02 05:08:08,720 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@9635fa{/logs,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,AVAILABLE}
2020-04-02 05:08:08,722 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@63c5efee{/static,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,AVAILABLE}
2020-04-02 05:08:08,766 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@6d1d4d7{/,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/datanode/,AVAILABLE}{/datanode}
2020-04-02 05:08:08,770 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@89ff02e{HTTP/1.1,[http/1.1]}{localhost:46079}
2020-04-02 05:08:08,771 [main] INFO  server.Server (Server.java:doStart(419)) - Started @6185ms
2020-04-02 05:08:08,862 [main] INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(255)) - Listening HTTP traffic on /127.0.0.1:35250
2020-04-02 05:08:08,863 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@62679465] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2020-04-02 05:08:08,863 [main] INFO  datanode.DataNode (DataNode.java:startDataNode(1438)) - dnUserName = root
2020-04-02 05:08:08,864 [main] INFO  datanode.DataNode (DataNode.java:startDataNode(1439)) - supergroup = supergroup
2020-04-02 05:08:08,865 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue queueCapacity: 1000 scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler
2020-04-02 05:08:08,879 [Socket Reader #1 for port 42719] INFO  ipc.Server (Server.java:run(1070)) - Starting Socket Reader #1 for port 42719
2020-04-02 05:08:08,902 [main] INFO  datanode.DataNode (DataNode.java:initIpcServer(1044)) - Opened IPC server at /127.0.0.1:42719
2020-04-02 05:08:08,916 [main] INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(149)) - Refresh request received for nameservices: null
2020-04-02 05:08:08,919 [main] INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(210)) - Starting BPOfferServices for nameservices: <default>
2020-04-02 05:08:08,920 [Thread-84] INFO  datanode.DataNode (BPServiceActor.java:run(810)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:35215 starting to offer service
2020-04-02 05:08:08,935 [main] INFO  datanode.DataNode (DataNode.java:runDatanodeDaemon(2674)) - [msx-restart] DataNode 42719 start, check after start, dfs.namenode.fs-limits.max-directory-items = 1048576
2020-04-02 05:08:08,936 [IPC Server listener on 42719] INFO  ipc.Server (Server.java:run(1149)) - IPC Server listener on 42719: starting
2020-04-02 05:08:08,940 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1632)) - Starting DataNode 2 with dfs.datanode.data.dir: [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5,[DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
2020-04-02 05:08:08,941 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1310)) - IPC Server Responder: starting
2020-04-02 05:08:08,943 [main] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5
2020-04-02 05:08:08,950 [main] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
2020-04-02 05:08:08,962 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - DataNode metrics system started (again)
2020-04-02 05:08:08,962 [main] INFO  conf.Configured (ReconfAgent.java:performReconf(74)) - [msx-restart] DataNode init, vvmode is none, do nothing
2020-04-02 05:08:08,963 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(394)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-04-02 05:08:08,963 [main] INFO  datanode.BlockScanner (BlockScanner.java:<init>(184)) - Initialized block scanner with targetBytesPerSec 1048576
2020-04-02 05:08:08,964 [main] INFO  datanode.DataNode (DataNode.java:<init>(510)) - Configured hostname is 127.0.0.1
2020-04-02 05:08:08,964 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(394)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-04-02 05:08:08,965 [main] INFO  datanode.DataNode (DataNode.java:startDataNode(1410)) - Starting DataNode with maxLockedMemory = 0
2020-04-02 05:08:08,966 [main] INFO  datanode.DataNode (DataNode.java:initDataXceiver(1158)) - Opened streaming server at /127.0.0.1:44971
2020-04-02 05:08:08,966 [main] INFO  datanode.DataNode (DataXceiverServer.java:<init>(78)) - Balancing bandwidth is 10485760 bytes/s
2020-04-02 05:08:08,966 [main] INFO  datanode.DataNode (DataXceiverServer.java:<init>(79)) - Number threads for balancing is 50
2020-04-02 05:08:08,968 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1052)) - Web server is in development mode. Resources will be read from the source tree.
2020-04-02 05:08:08,969 [main] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2020-04-02 05:08:08,971 [main] INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(81)) - Http request log for http.requests.datanode is not defined
2020-04-02 05:08:08,971 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1052)) - Web server is in development mode. Resources will be read from the source tree.
2020-04-02 05:08:08,973 [main] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(970)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2020-04-02 05:08:08,974 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(943)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2020-04-02 05:08:08,975 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(953)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2020-04-02 05:08:08,975 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(953)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2020-04-02 05:08:08,977 [main] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1186)) - Jetty bound to port 44364
2020-04-02 05:08:08,978 [main] INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2020-04-02 05:08:08,979 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@6b5966e1{/logs,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,AVAILABLE}
2020-04-02 05:08:08,982 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@1568159{/static,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,AVAILABLE}
2020-04-02 05:08:08,995 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@31024624{/,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/datanode/,AVAILABLE}{/datanode}
2020-04-02 05:08:08,996 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@25bcd0c7{HTTP/1.1,[http/1.1]}{localhost:44364}
2020-04-02 05:08:08,996 [main] INFO  server.Server (Server.java:doStart(419)) - Started @6410ms
2020-04-02 05:08:09,026 [main] INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(255)) - Listening HTTP traffic on /127.0.0.1:43364
2020-04-02 05:08:09,027 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@63cd604c] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2020-04-02 05:08:09,027 [main] INFO  datanode.DataNode (DataNode.java:startDataNode(1438)) - dnUserName = root
2020-04-02 05:08:09,027 [main] INFO  datanode.DataNode (DataNode.java:startDataNode(1439)) - supergroup = supergroup
2020-04-02 05:08:09,028 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue queueCapacity: 1000 scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler
2020-04-02 05:08:09,028 [Socket Reader #1 for port 32993] INFO  ipc.Server (Server.java:run(1070)) - Starting Socket Reader #1 for port 32993
2020-04-02 05:08:09,032 [main] INFO  datanode.DataNode (DataNode.java:initIpcServer(1044)) - Opened IPC server at /127.0.0.1:32993
2020-04-02 05:08:09,040 [main] INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(149)) - Refresh request received for nameservices: null
2020-04-02 05:08:09,040 [main] INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(210)) - Starting BPOfferServices for nameservices: <default>
2020-04-02 05:08:09,041 [Thread-107] INFO  datanode.DataNode (BPServiceActor.java:run(810)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:35215 starting to offer service
2020-04-02 05:08:09,046 [IPC Server listener on 32993] INFO  ipc.Server (Server.java:run(1149)) - IPC Server listener on 32993: starting
2020-04-02 05:08:09,046 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1310)) - IPC Server Responder: starting
2020-04-02 05:08:09,051 [main] INFO  datanode.DataNode (DataNode.java:runDatanodeDaemon(2674)) - [msx-restart] DataNode 32993 start, check after start, dfs.namenode.fs-limits.max-directory-items = 1048576
2020-04-02 05:08:09,076 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1632)) - Starting DataNode 3 with dfs.datanode.data.dir: [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7,[DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
2020-04-02 05:08:09,088 [main] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
2020-04-02 05:08:09,094 [main] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
2020-04-02 05:08:09,099 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - DataNode metrics system started (again)
2020-04-02 05:08:09,099 [main] INFO  conf.Configured (ReconfAgent.java:performReconf(74)) - [msx-restart] DataNode init, vvmode is none, do nothing
2020-04-02 05:08:09,100 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(394)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-04-02 05:08:09,100 [main] INFO  datanode.BlockScanner (BlockScanner.java:<init>(184)) - Initialized block scanner with targetBytesPerSec 1048576
2020-04-02 05:08:09,100 [main] INFO  datanode.DataNode (DataNode.java:<init>(510)) - Configured hostname is 127.0.0.1
2020-04-02 05:08:09,101 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(394)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-04-02 05:08:09,101 [main] INFO  datanode.DataNode (DataNode.java:startDataNode(1410)) - Starting DataNode with maxLockedMemory = 0
2020-04-02 05:08:09,102 [main] INFO  datanode.DataNode (DataNode.java:initDataXceiver(1158)) - Opened streaming server at /127.0.0.1:43434
2020-04-02 05:08:09,102 [main] INFO  datanode.DataNode (DataXceiverServer.java:<init>(78)) - Balancing bandwidth is 10485760 bytes/s
2020-04-02 05:08:09,102 [main] INFO  datanode.DataNode (DataXceiverServer.java:<init>(79)) - Number threads for balancing is 50
2020-04-02 05:08:09,104 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1052)) - Web server is in development mode. Resources will be read from the source tree.
2020-04-02 05:08:09,106 [main] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2020-04-02 05:08:09,107 [main] INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(81)) - Http request log for http.requests.datanode is not defined
2020-04-02 05:08:09,107 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1052)) - Web server is in development mode. Resources will be read from the source tree.
2020-04-02 05:08:09,122 [main] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(970)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2020-04-02 05:08:09,123 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(943)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2020-04-02 05:08:09,124 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(953)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2020-04-02 05:08:09,124 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(953)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2020-04-02 05:08:09,125 [main] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1186)) - Jetty bound to port 44452
2020-04-02 05:08:09,125 [main] INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2020-04-02 05:08:09,126 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@285d851a{/logs,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,AVAILABLE}
2020-04-02 05:08:09,127 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@664a9613{/static,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,AVAILABLE}
2020-04-02 05:08:09,131 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@1fc0053e{/,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/datanode/,AVAILABLE}{/datanode}
2020-04-02 05:08:09,132 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@290b1b2e{HTTP/1.1,[http/1.1]}{localhost:44452}
2020-04-02 05:08:09,133 [main] INFO  server.Server (Server.java:doStart(419)) - Started @6547ms
2020-04-02 05:08:09,209 [main] INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(255)) - Listening HTTP traffic on /127.0.0.1:42817
2020-04-02 05:08:09,209 [main] INFO  datanode.DataNode (DataNode.java:startDataNode(1438)) - dnUserName = root
2020-04-02 05:08:09,209 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@33617539] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2020-04-02 05:08:09,209 [main] INFO  datanode.DataNode (DataNode.java:startDataNode(1439)) - supergroup = supergroup
2020-04-02 05:08:09,210 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue queueCapacity: 1000 scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler
2020-04-02 05:08:09,211 [Socket Reader #1 for port 46021] INFO  ipc.Server (Server.java:run(1070)) - Starting Socket Reader #1 for port 46021
2020-04-02 05:08:09,214 [main] INFO  datanode.DataNode (DataNode.java:initIpcServer(1044)) - Opened IPC server at /127.0.0.1:46021
2020-04-02 05:08:09,218 [main] INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(149)) - Refresh request received for nameservices: null
2020-04-02 05:08:09,219 [main] INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(210)) - Starting BPOfferServices for nameservices: <default>
2020-04-02 05:08:09,220 [Thread-130] INFO  datanode.DataNode (BPServiceActor.java:run(810)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:35215 starting to offer service
2020-04-02 05:08:09,222 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1310)) - IPC Server Responder: starting
2020-04-02 05:08:09,222 [IPC Server listener on 46021] INFO  ipc.Server (Server.java:run(1149)) - IPC Server listener on 46021: starting
2020-04-02 05:08:09,227 [main] INFO  datanode.DataNode (DataNode.java:runDatanodeDaemon(2674)) - [msx-restart] DataNode 46021 start, check after start, dfs.namenode.fs-limits.max-directory-items = 1048576
2020-04-02 05:08:09,229 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:startDataNodes(1632)) - Starting DataNode 4 with dfs.datanode.data.dir: [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9,[DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
2020-04-02 05:08:09,230 [main] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
2020-04-02 05:08:09,232 [main] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
2020-04-02 05:08:09,234 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:init(158)) - DataNode metrics system started (again)
2020-04-02 05:08:09,234 [main] INFO  conf.Configured (ReconfAgent.java:performReconf(74)) - [msx-restart] DataNode init, vvmode is none, do nothing
2020-04-02 05:08:09,234 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(394)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-04-02 05:08:09,234 [main] INFO  datanode.BlockScanner (BlockScanner.java:<init>(184)) - Initialized block scanner with targetBytesPerSec 1048576
2020-04-02 05:08:09,235 [main] INFO  datanode.DataNode (DataNode.java:<init>(510)) - Configured hostname is 127.0.0.1
2020-04-02 05:08:09,235 [main] INFO  common.Util (Util.java:isDiskStatsEnabled(394)) - dfs.datanode.fileio.profiling.sampling.percentage set to 0. Disabling file IO profiling
2020-04-02 05:08:09,235 [main] INFO  datanode.DataNode (DataNode.java:startDataNode(1410)) - Starting DataNode with maxLockedMemory = 0
2020-04-02 05:08:09,236 [main] INFO  datanode.DataNode (DataNode.java:initDataXceiver(1158)) - Opened streaming server at /127.0.0.1:45739
2020-04-02 05:08:09,236 [main] INFO  datanode.DataNode (DataXceiverServer.java:<init>(78)) - Balancing bandwidth is 10485760 bytes/s
2020-04-02 05:08:09,237 [main] INFO  datanode.DataNode (DataXceiverServer.java:<init>(79)) - Number threads for balancing is 50
2020-04-02 05:08:09,239 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1052)) - Web server is in development mode. Resources will be read from the source tree.
2020-04-02 05:08:09,241 [main] INFO  server.AuthenticationFilter (AuthenticationFilter.java:constructSecretProvider(240)) - Unable to initialize FileSignerSecretProvider, falling back to use random secrets.
2020-04-02 05:08:09,242 [main] INFO  http.HttpRequestLog (HttpRequestLog.java:getRequestLog(81)) - Http request log for http.requests.datanode is not defined
2020-04-02 05:08:09,242 [main] INFO  http.HttpServer2 (HttpServer2.java:getWebAppsPath(1052)) - Web server is in development mode. Resources will be read from the source tree.
2020-04-02 05:08:09,244 [main] INFO  http.HttpServer2 (HttpServer2.java:addGlobalFilter(970)) - Added global filter 'safety' (class=org.apache.hadoop.http.HttpServer2$QuotingInputFilter)
2020-04-02 05:08:09,245 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(943)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context datanode
2020-04-02 05:08:09,245 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(953)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context logs
2020-04-02 05:08:09,245 [main] INFO  http.HttpServer2 (HttpServer2.java:addFilter(953)) - Added filter static_user_filter (class=org.apache.hadoop.http.lib.StaticUserWebFilter$StaticUserFilter) to context static
2020-04-02 05:08:09,246 [main] INFO  http.HttpServer2 (HttpServer2.java:bindListener(1186)) - Jetty bound to port 40322
2020-04-02 05:08:09,246 [main] INFO  server.Server (Server.java:doStart(351)) - jetty-9.3.24.v20180605, build timestamp: 2018-06-05T17:11:56Z, git hash: 84205aa28f11a4f31f2a3b86d1bba2cc8ab69827
2020-04-02 05:08:09,248 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@644c78d4{/logs,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,AVAILABLE}
2020-04-02 05:08:09,253 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.s.ServletContextHandler@611f8234{/static,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,AVAILABLE}
2020-04-02 05:08:09,271 [main] INFO  handler.ContextHandler (ContextHandler.java:doStart(781)) - Started o.e.j.w.WebAppContext@4cc76301{/,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/datanode/,AVAILABLE}{/datanode}
2020-04-02 05:08:09,275 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStart(278)) - Started ServerConnector@2f08c4b{HTTP/1.1,[http/1.1]}{localhost:40322}
2020-04-02 05:08:09,275 [main] INFO  server.Server (Server.java:doStart(419)) - Started @6689ms
2020-04-02 05:08:09,307 [main] INFO  web.DatanodeHttpServer (DatanodeHttpServer.java:start(255)) - Listening HTTP traffic on /127.0.0.1:46206
2020-04-02 05:08:09,308 [org.apache.hadoop.util.JvmPauseMonitor$Monitor@7de0c6ae] INFO  util.JvmPauseMonitor (JvmPauseMonitor.java:run(188)) - Starting JVM pause monitor
2020-04-02 05:08:09,309 [main] INFO  datanode.DataNode (DataNode.java:startDataNode(1438)) - dnUserName = root
2020-04-02 05:08:09,312 [main] INFO  datanode.DataNode (DataNode.java:startDataNode(1439)) - supergroup = supergroup
2020-04-02 05:08:09,312 [main] INFO  ipc.CallQueueManager (CallQueueManager.java:<init>(84)) - Using callQueue: class java.util.concurrent.LinkedBlockingQueue queueCapacity: 1000 scheduler: class org.apache.hadoop.ipc.DefaultRpcScheduler
2020-04-02 05:08:09,313 [Socket Reader #1 for port 37669] INFO  ipc.Server (Server.java:run(1070)) - Starting Socket Reader #1 for port 37669
2020-04-02 05:08:09,323 [Thread-107] INFO  datanode.DataNode (BPOfferService.java:verifyAndSetNamespaceInfo(378)) - Acknowledging ACTIVE Namenode during handshakeBlock pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:35215
2020-04-02 05:08:09,327 [Thread-84] INFO  datanode.DataNode (BPOfferService.java:verifyAndSetNamespaceInfo(378)) - Acknowledging ACTIVE Namenode during handshakeBlock pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:35215
2020-04-02 05:08:09,327 [Thread-59] INFO  datanode.DataNode (BPOfferService.java:verifyAndSetNamespaceInfo(378)) - Acknowledging ACTIVE Namenode during handshakeBlock pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:35215
2020-04-02 05:08:09,329 [main] INFO  datanode.DataNode (DataNode.java:initIpcServer(1044)) - Opened IPC server at /127.0.0.1:37669
2020-04-02 05:08:09,329 [Thread-107] INFO  common.Storage (DataStorage.java:getParallelVolumeLoadThreadsNum(354)) - Using 2 threads to upgrade data directories (dfs.datanode.parallel.volumes.load.threads.num=2, dataDirs=2)
2020-04-02 05:08:09,329 [Thread-59] INFO  common.Storage (DataStorage.java:getParallelVolumeLoadThreadsNum(354)) - Using 2 threads to upgrade data directories (dfs.datanode.parallel.volumes.load.threads.num=2, dataDirs=2)
2020-04-02 05:08:09,330 [Thread-84] INFO  common.Storage (DataStorage.java:getParallelVolumeLoadThreadsNum(354)) - Using 2 threads to upgrade data directories (dfs.datanode.parallel.volumes.load.threads.num=2, dataDirs=2)
2020-04-02 05:08:09,331 [Thread-59] INFO  common.Storage (Storage.java:tryLock(905)) - Lock on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/in_use.lock acquired by nodename 13851@5b1ca12d458b
2020-04-02 05:08:09,331 [Thread-59] INFO  common.Storage (DataStorage.java:loadStorageDirectory(282)) - Storage directory with location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1 is not formatted for namespace 1820228250. Formatting...
2020-04-02 05:08:09,332 [Thread-84] INFO  common.Storage (Storage.java:tryLock(905)) - Lock on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/in_use.lock acquired by nodename 13851@5b1ca12d458b
2020-04-02 05:08:09,332 [Thread-84] INFO  common.Storage (DataStorage.java:loadStorageDirectory(282)) - Storage directory with location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3 is not formatted for namespace 1820228250. Formatting...
2020-04-02 05:08:09,333 [main] INFO  datanode.DataNode (BlockPoolManager.java:refreshNamenodes(149)) - Refresh request received for nameservices: null
2020-04-02 05:08:09,333 [Thread-84] INFO  common.Storage (DataStorage.java:createStorageID(160)) - Generated new storageID DS-9e64160f-8239-40bc-b495-871e2ebb5a3a for directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3 
2020-04-02 05:08:09,333 [Thread-59] INFO  common.Storage (DataStorage.java:createStorageID(160)) - Generated new storageID DS-2d1f4083-d7c8-4136-8351-6f589a4451bd for directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1 
2020-04-02 05:08:09,333 [main] INFO  datanode.DataNode (BlockPoolManager.java:doRefreshNamenodes(210)) - Starting BPOfferServices for nameservices: <default>
2020-04-02 05:08:09,334 [Thread-153] INFO  datanode.DataNode (BPServiceActor.java:run(810)) - Block pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:35215 starting to offer service
2020-04-02 05:08:09,336 [Thread-107] INFO  common.Storage (Storage.java:tryLock(905)) - Lock on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/in_use.lock acquired by nodename 13851@5b1ca12d458b
2020-04-02 05:08:09,336 [Thread-107] INFO  common.Storage (DataStorage.java:loadStorageDirectory(282)) - Storage directory with location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5 is not formatted for namespace 1820228250. Formatting...
2020-04-02 05:08:09,337 [Thread-107] INFO  common.Storage (DataStorage.java:createStorageID(160)) - Generated new storageID DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3 for directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5 
2020-04-02 05:08:09,340 [Thread-107] INFO  common.Storage (Storage.java:tryLock(905)) - Lock on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/in_use.lock acquired by nodename 13851@5b1ca12d458b
2020-04-02 05:08:09,340 [Thread-107] INFO  common.Storage (DataStorage.java:loadStorageDirectory(282)) - Storage directory with location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6 is not formatted for namespace 1820228250. Formatting...
2020-04-02 05:08:09,340 [Thread-107] INFO  common.Storage (DataStorage.java:createStorageID(160)) - Generated new storageID DS-9396c1fd-c034-40b5-99a4-7728fe5d066f for directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6 
2020-04-02 05:08:09,351 [Thread-130] INFO  datanode.DataNode (BPOfferService.java:verifyAndSetNamespaceInfo(378)) - Acknowledging ACTIVE Namenode during handshakeBlock pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:35215
2020-04-02 05:08:09,352 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1310)) - IPC Server Responder: starting
2020-04-02 05:08:09,352 [IPC Server listener on 37669] INFO  ipc.Server (Server.java:run(1149)) - IPC Server listener on 37669: starting
2020-04-02 05:08:09,353 [main] INFO  datanode.DataNode (DataNode.java:runDatanodeDaemon(2674)) - [msx-restart] DataNode 37669 start, check after start, dfs.namenode.fs-limits.max-directory-items = 1048576
2020-04-02 05:08:09,362 [Thread-153] INFO  datanode.DataNode (BPOfferService.java:verifyAndSetNamespaceInfo(378)) - Acknowledging ACTIVE Namenode during handshakeBlock pool <registering> (Datanode Uuid unassigned) service to localhost/127.0.0.1:35215
2020-04-02 05:08:09,379 [Thread-59] INFO  common.Storage (Storage.java:tryLock(905)) - Lock on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/in_use.lock acquired by nodename 13851@5b1ca12d458b
2020-04-02 05:08:09,380 [Thread-59] INFO  common.Storage (DataStorage.java:loadStorageDirectory(282)) - Storage directory with location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2 is not formatted for namespace 1820228250. Formatting...
2020-04-02 05:08:09,380 [Thread-59] INFO  common.Storage (DataStorage.java:createStorageID(160)) - Generated new storageID DS-089629a9-5898-4562-bd81-79a4f45c96c1 for directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2 
2020-04-02 05:08:09,380 [Thread-84] INFO  common.Storage (Storage.java:tryLock(905)) - Lock on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/in_use.lock acquired by nodename 13851@5b1ca12d458b
2020-04-02 05:08:09,381 [Thread-84] INFO  common.Storage (DataStorage.java:loadStorageDirectory(282)) - Storage directory with location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4 is not formatted for namespace 1820228250. Formatting...
2020-04-02 05:08:09,381 [Thread-84] INFO  common.Storage (DataStorage.java:createStorageID(160)) - Generated new storageID DS-5ce71111-7ef9-40e4-bd53-df33411df409 for directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4 
2020-04-02 05:08:09,391 [Thread-153] INFO  common.Storage (DataStorage.java:getParallelVolumeLoadThreadsNum(354)) - Using 2 threads to upgrade data directories (dfs.datanode.parallel.volumes.load.threads.num=2, dataDirs=2)
2020-04-02 05:08:09,391 [Thread-130] INFO  common.Storage (DataStorage.java:getParallelVolumeLoadThreadsNum(354)) - Using 2 threads to upgrade data directories (dfs.datanode.parallel.volumes.load.threads.num=2, dataDirs=2)
2020-04-02 05:08:09,393 [Thread-153] INFO  common.Storage (Storage.java:tryLock(905)) - Lock on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/in_use.lock acquired by nodename 13851@5b1ca12d458b
2020-04-02 05:08:09,393 [Thread-130] INFO  common.Storage (Storage.java:tryLock(905)) - Lock on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/in_use.lock acquired by nodename 13851@5b1ca12d458b
2020-04-02 05:08:09,393 [Thread-153] INFO  common.Storage (DataStorage.java:loadStorageDirectory(282)) - Storage directory with location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9 is not formatted for namespace 1820228250. Formatting...
2020-04-02 05:08:09,393 [Thread-130] INFO  common.Storage (DataStorage.java:loadStorageDirectory(282)) - Storage directory with location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7 is not formatted for namespace 1820228250. Formatting...
2020-04-02 05:08:09,393 [Thread-153] INFO  common.Storage (DataStorage.java:createStorageID(160)) - Generated new storageID DS-6946cabd-2f8d-451f-81bc-4884ebba8665 for directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9 
2020-04-02 05:08:09,393 [Thread-130] INFO  common.Storage (DataStorage.java:createStorageID(160)) - Generated new storageID DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e for directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7 
2020-04-02 05:08:09,397 [Thread-153] INFO  common.Storage (Storage.java:tryLock(905)) - Lock on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/in_use.lock acquired by nodename 13851@5b1ca12d458b
2020-04-02 05:08:09,397 [Thread-130] INFO  common.Storage (Storage.java:tryLock(905)) - Lock on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/in_use.lock acquired by nodename 13851@5b1ca12d458b
2020-04-02 05:08:09,397 [Thread-130] INFO  common.Storage (DataStorage.java:loadStorageDirectory(282)) - Storage directory with location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8 is not formatted for namespace 1820228250. Formatting...
2020-04-02 05:08:09,398 [Thread-130] INFO  common.Storage (DataStorage.java:createStorageID(160)) - Generated new storageID DS-29df15fa-b2ca-4eca-89df-87135d5e3b76 for directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8 
2020-04-02 05:08:09,399 [Thread-153] INFO  common.Storage (DataStorage.java:loadStorageDirectory(282)) - Storage directory with location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10 is not formatted for namespace 1820228250. Formatting...
2020-04-02 05:08:09,400 [Thread-153] INFO  common.Storage (DataStorage.java:createStorageID(160)) - Generated new storageID DS-d49b8d06-4514-41da-af7b-faacf4f00b86 for directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10 
2020-04-02 05:08:09,410 [Thread-107] INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(251)) - Analyzing storage directories for bpid BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,410 [Thread-107] INFO  common.Storage (Storage.java:lock(864)) - Locking is disabled for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,420 [Thread-84] INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(251)) - Analyzing storage directories for bpid BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,421 [Thread-84] INFO  common.Storage (Storage.java:lock(864)) - Locking is disabled for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,421 [Thread-84] INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(168)) - Block pool storage directory for location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3 and block pool id BP-1786648874-172.17.0.4-1585804085136 is not formatted. Formatting ...
2020-04-02 05:08:09,421 [Thread-84] INFO  common.Storage (BlockPoolSliceStorage.java:format(280)) - Formatting block pool BP-1786648874-172.17.0.4-1585804085136 directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current
2020-04-02 05:08:09,422 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(251)) - Analyzing storage directories for bpid BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,422 [Thread-59] INFO  common.Storage (Storage.java:lock(864)) - Locking is disabled for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,422 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(168)) - Block pool storage directory for location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1 and block pool id BP-1786648874-172.17.0.4-1585804085136 is not formatted. Formatting ...
2020-04-02 05:08:09,422 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:format(280)) - Formatting block pool BP-1786648874-172.17.0.4-1585804085136 directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current
2020-04-02 05:08:09,423 [Thread-130] INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(251)) - Analyzing storage directories for bpid BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,423 [Thread-130] INFO  common.Storage (Storage.java:lock(864)) - Locking is disabled for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,423 [Thread-130] INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(168)) - Block pool storage directory for location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7 and block pool id BP-1786648874-172.17.0.4-1585804085136 is not formatted. Formatting ...
2020-04-02 05:08:09,423 [Thread-130] INFO  common.Storage (BlockPoolSliceStorage.java:format(280)) - Formatting block pool BP-1786648874-172.17.0.4-1585804085136 directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current
2020-04-02 05:08:09,428 [Thread-153] INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(251)) - Analyzing storage directories for bpid BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,428 [Thread-153] INFO  common.Storage (Storage.java:lock(864)) - Locking is disabled for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,429 [Thread-153] INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(168)) - Block pool storage directory for location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9 and block pool id BP-1786648874-172.17.0.4-1585804085136 is not formatted. Formatting ...
2020-04-02 05:08:09,429 [Thread-153] INFO  common.Storage (BlockPoolSliceStorage.java:format(280)) - Formatting block pool BP-1786648874-172.17.0.4-1585804085136 directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current
2020-04-02 05:08:09,433 [Thread-130] INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(251)) - Analyzing storage directories for bpid BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,433 [Thread-130] INFO  common.Storage (Storage.java:lock(864)) - Locking is disabled for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,433 [Thread-130] INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(168)) - Block pool storage directory for location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8 and block pool id BP-1786648874-172.17.0.4-1585804085136 is not formatted. Formatting ...
2020-04-02 05:08:09,433 [Thread-130] INFO  common.Storage (BlockPoolSliceStorage.java:format(280)) - Formatting block pool BP-1786648874-172.17.0.4-1585804085136 directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current
2020-04-02 05:08:09,435 [Thread-130] INFO  datanode.DataNode (DataNode.java:initStorage(1732)) - Setting up storage: nsid=1820228250;bpid=BP-1786648874-172.17.0.4-1585804085136;lv=-57;nsInfo=lv=-64;cid=testClusterID;nsid=1820228250;c=1585804085136;bpid=BP-1786648874-172.17.0.4-1585804085136;dnuuid=null
2020-04-02 05:08:09,437 [Thread-130] INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1556)) - Generated and persisted new Datanode UUID 5207c5c0-37c7-443f-94c4-771a605480e4
2020-04-02 05:08:09,441 [Thread-84] INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(251)) - Analyzing storage directories for bpid BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,444 [Thread-84] INFO  common.Storage (Storage.java:lock(864)) - Locking is disabled for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/current/BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,444 [Thread-84] INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(168)) - Block pool storage directory for location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4 and block pool id BP-1786648874-172.17.0.4-1585804085136 is not formatted. Formatting ...
2020-04-02 05:08:09,444 [Thread-84] INFO  common.Storage (BlockPoolSliceStorage.java:format(280)) - Formatting block pool BP-1786648874-172.17.0.4-1585804085136 directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/current/BP-1786648874-172.17.0.4-1585804085136/current
2020-04-02 05:08:09,445 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(251)) - Analyzing storage directories for bpid BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,445 [Thread-59] INFO  common.Storage (Storage.java:lock(864)) - Locking is disabled for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,447 [Thread-84] INFO  datanode.DataNode (DataNode.java:initStorage(1732)) - Setting up storage: nsid=1820228250;bpid=BP-1786648874-172.17.0.4-1585804085136;lv=-57;nsInfo=lv=-64;cid=testClusterID;nsid=1820228250;c=1585804085136;bpid=BP-1786648874-172.17.0.4-1585804085136;dnuuid=null
2020-04-02 05:08:09,447 [Thread-107] INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(168)) - Block pool storage directory for location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5 and block pool id BP-1786648874-172.17.0.4-1585804085136 is not formatted. Formatting ...
2020-04-02 05:08:09,451 [Thread-107] INFO  common.Storage (BlockPoolSliceStorage.java:format(280)) - Formatting block pool BP-1786648874-172.17.0.4-1585804085136 directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current
2020-04-02 05:08:09,452 [Thread-153] INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(251)) - Analyzing storage directories for bpid BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,453 [Thread-153] INFO  common.Storage (Storage.java:lock(864)) - Locking is disabled for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,453 [Thread-153] INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(168)) - Block pool storage directory for location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10 and block pool id BP-1786648874-172.17.0.4-1585804085136 is not formatted. Formatting ...
2020-04-02 05:08:09,453 [Thread-153] INFO  common.Storage (BlockPoolSliceStorage.java:format(280)) - Formatting block pool BP-1786648874-172.17.0.4-1585804085136 directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current
2020-04-02 05:08:09,450 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(168)) - Block pool storage directory for location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2 and block pool id BP-1786648874-172.17.0.4-1585804085136 is not formatted. Formatting ...
2020-04-02 05:08:09,454 [Thread-59] INFO  common.Storage (BlockPoolSliceStorage.java:format(280)) - Formatting block pool BP-1786648874-172.17.0.4-1585804085136 directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current
2020-04-02 05:08:09,454 [Thread-84] INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1556)) - Generated and persisted new Datanode UUID 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4
2020-04-02 05:08:09,484 [Thread-59] INFO  datanode.DataNode (DataNode.java:initStorage(1732)) - Setting up storage: nsid=1820228250;bpid=BP-1786648874-172.17.0.4-1585804085136;lv=-57;nsInfo=lv=-64;cid=testClusterID;nsid=1820228250;c=1585804085136;bpid=BP-1786648874-172.17.0.4-1585804085136;dnuuid=null
2020-04-02 05:08:09,485 [Thread-59] INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1556)) - Generated and persisted new Datanode UUID fa2f4855-186d-4810-9249-db4686eb92b3
2020-04-02 05:08:09,481 [Thread-153] INFO  datanode.DataNode (DataNode.java:initStorage(1732)) - Setting up storage: nsid=1820228250;bpid=BP-1786648874-172.17.0.4-1585804085136;lv=-57;nsInfo=lv=-64;cid=testClusterID;nsid=1820228250;c=1585804085136;bpid=BP-1786648874-172.17.0.4-1585804085136;dnuuid=null
2020-04-02 05:08:09,495 [Thread-153] INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1556)) - Generated and persisted new Datanode UUID 85182ebc-cd1c-4941-89fb-8d9b64eeaece
2020-04-02 05:08:09,496 [Thread-107] INFO  common.Storage (BlockPoolSliceStorage.java:recoverTransitionRead(251)) - Analyzing storage directories for bpid BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,496 [Thread-107] INFO  common.Storage (Storage.java:lock(864)) - Locking is disabled for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,497 [Thread-107] INFO  common.Storage (BlockPoolSliceStorage.java:loadStorageDirectory(168)) - Block pool storage directory for location [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6 and block pool id BP-1786648874-172.17.0.4-1585804085136 is not formatted. Formatting ...
2020-04-02 05:08:09,497 [Thread-107] INFO  common.Storage (BlockPoolSliceStorage.java:format(280)) - Formatting block pool BP-1786648874-172.17.0.4-1585804085136 directory /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current
2020-04-02 05:08:09,507 [Thread-107] INFO  datanode.DataNode (DataNode.java:initStorage(1732)) - Setting up storage: nsid=1820228250;bpid=BP-1786648874-172.17.0.4-1585804085136;lv=-57;nsInfo=lv=-64;cid=testClusterID;nsid=1820228250;c=1585804085136;bpid=BP-1786648874-172.17.0.4-1585804085136;dnuuid=null
2020-04-02 05:08:09,529 [Thread-107] INFO  datanode.DataNode (DataNode.java:checkDatanodeUuid(1556)) - Generated and persisted new Datanode UUID 519e1267-21af-4106-9b82-32175ae0f5c5
2020-04-02 05:08:09,650 [Thread-153] INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(306)) - Added new volume: DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:09,650 [Thread-153] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(450)) - Added volume - [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9, StorageType: DISK
2020-04-02 05:08:09,664 [Thread-153] INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(306)) - Added new volume: DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:09,664 [Thread-153] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(450)) - Added volume - [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10, StorageType: DISK
2020-04-02 05:08:09,668 [Thread-130] INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(306)) - Added new volume: DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:09,668 [Thread-84] INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(306)) - Added new volume: DS-9e64160f-8239-40bc-b495-871e2ebb5a3a
2020-04-02 05:08:09,668 [Thread-130] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(450)) - Added volume - [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7, StorageType: DISK
2020-04-02 05:08:09,668 [Thread-59] INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(306)) - Added new volume: DS-2d1f4083-d7c8-4136-8351-6f589a4451bd
2020-04-02 05:08:09,673 [Thread-59] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(450)) - Added volume - [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1, StorageType: DISK
2020-04-02 05:08:09,653 [Thread-107] INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(306)) - Added new volume: DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3
2020-04-02 05:08:09,689 [Thread-59] INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(306)) - Added new volume: DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:09,706 [Thread-59] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(450)) - Added volume - [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2, StorageType: DISK
2020-04-02 05:08:09,687 [Thread-130] INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(306)) - Added new volume: DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:09,683 [Thread-84] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(450)) - Added volume - [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3, StorageType: DISK
2020-04-02 05:08:09,690 [Thread-107] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(450)) - Added volume - [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5, StorageType: DISK
2020-04-02 05:08:09,722 [Thread-130] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(450)) - Added volume - [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8, StorageType: DISK
2020-04-02 05:08:09,722 [Thread-59] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2280)) - Registered FSDatasetState MBean
2020-04-02 05:08:09,722 [Thread-130] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2280)) - Registered FSDatasetState MBean
2020-04-02 05:08:09,723 [Thread-153] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2280)) - Registered FSDatasetState MBean
2020-04-02 05:08:09,725 [Thread-84] INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(306)) - Added new volume: DS-5ce71111-7ef9-40e4-bd53-df33411df409
2020-04-02 05:08:09,725 [Thread-84] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(450)) - Added volume - [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4, StorageType: DISK
2020-04-02 05:08:09,725 [Thread-84] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2280)) - Registered FSDatasetState MBean
2020-04-02 05:08:09,734 [Thread-153] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
2020-04-02 05:08:09,736 [Thread-130] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
2020-04-02 05:08:09,737 [Thread-59] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
2020-04-02 05:08:09,739 [Thread-84] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3
2020-04-02 05:08:09,740 [Thread-107] INFO  impl.FsDatasetImpl (FsVolumeList.java:addVolume(306)) - Added new volume: DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:09,740 [Thread-107] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addVolume(450)) - Added volume - [DISK]file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6, StorageType: DISK
2020-04-02 05:08:09,740 [Thread-107] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:registerMBean(2280)) - Registered FSDatasetState MBean
2020-04-02 05:08:09,741 [Thread-107] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5
2020-04-02 05:08:09,790 [Thread-59] INFO  checker.DatasetVolumeChecker (DatasetVolumeChecker.java:checkAllVolumes(221)) - Scheduled health check for volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
2020-04-02 05:08:09,792 [Thread-59] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
2020-04-02 05:08:09,797 [Thread-153] INFO  checker.DatasetVolumeChecker (DatasetVolumeChecker.java:checkAllVolumes(221)) - Scheduled health check for volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
2020-04-02 05:08:09,797 [Thread-153] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
2020-04-02 05:08:09,794 [Thread-84] INFO  checker.DatasetVolumeChecker (DatasetVolumeChecker.java:checkAllVolumes(221)) - Scheduled health check for volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3
2020-04-02 05:08:09,802 [Thread-84] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4
2020-04-02 05:08:09,802 [Thread-84] INFO  checker.DatasetVolumeChecker (DatasetVolumeChecker.java:checkAllVolumes(221)) - Scheduled health check for volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4
2020-04-02 05:08:09,792 [Thread-107] INFO  checker.DatasetVolumeChecker (DatasetVolumeChecker.java:checkAllVolumes(221)) - Scheduled health check for volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5
2020-04-02 05:08:09,806 [Thread-107] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
2020-04-02 05:08:09,806 [Thread-153] INFO  checker.DatasetVolumeChecker (DatasetVolumeChecker.java:checkAllVolumes(221)) - Scheduled health check for volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
2020-04-02 05:08:09,806 [Thread-153] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2791)) - Adding block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,792 [Thread-130] INFO  checker.DatasetVolumeChecker (DatasetVolumeChecker.java:checkAllVolumes(221)) - Scheduled health check for volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
2020-04-02 05:08:09,806 [Thread-107] INFO  checker.DatasetVolumeChecker (DatasetVolumeChecker.java:checkAllVolumes(221)) - Scheduled health check for volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
2020-04-02 05:08:09,806 [Thread-59] INFO  checker.DatasetVolumeChecker (DatasetVolumeChecker.java:checkAllVolumes(221)) - Scheduled health check for volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
2020-04-02 05:08:09,807 [Thread-59] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2791)) - Adding block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,807 [Thread-130] INFO  checker.ThrottledAsyncChecker (ThrottledAsyncChecker.java:schedule(137)) - Scheduling a check for /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
2020-04-02 05:08:09,808 [Thread-174] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(409)) - Scanning block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9...
2020-04-02 05:08:09,821 [Thread-176] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(409)) - Scanning block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10...
2020-04-02 05:08:09,824 [Thread-130] INFO  checker.DatasetVolumeChecker (DatasetVolumeChecker.java:checkAllVolumes(221)) - Scheduled health check for volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
2020-04-02 05:08:09,825 [Thread-177] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(409)) - Scanning block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2...
2020-04-02 05:08:09,828 [Thread-107] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2791)) - Adding block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,827 [Thread-175] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(409)) - Scanning block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1...
2020-04-02 05:08:09,831 [Thread-130] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2791)) - Adding block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,826 [Thread-84] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:addBlockPool(2791)) - Adding block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:09,836 [Thread-179] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(409)) - Scanning block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6...
2020-04-02 05:08:09,836 [Thread-178] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(409)) - Scanning block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5...
2020-04-02 05:08:09,837 [Thread-182] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(409)) - Scanning block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3...
2020-04-02 05:08:09,840 [Thread-181] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(409)) - Scanning block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8...
2020-04-02 05:08:09,836 [Thread-180] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(409)) - Scanning block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7...
2020-04-02 05:08:09,874 [Thread-184] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(409)) - Scanning block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4...
2020-04-02 05:08:09,967 [Thread-181] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(414)) - Time taken to scan block pool BP-1786648874-172.17.0.4-1585804085136 on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8: 127ms
2020-04-02 05:08:09,967 [Thread-174] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(414)) - Time taken to scan block pool BP-1786648874-172.17.0.4-1585804085136 on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9: 159ms
2020-04-02 05:08:09,970 [Thread-177] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(414)) - Time taken to scan block pool BP-1786648874-172.17.0.4-1585804085136 on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2: 140ms
2020-04-02 05:08:09,971 [Thread-175] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(414)) - Time taken to scan block pool BP-1786648874-172.17.0.4-1585804085136 on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1: 141ms
2020-04-02 05:08:09,991 [Thread-182] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(414)) - Time taken to scan block pool BP-1786648874-172.17.0.4-1585804085136 on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3: 152ms
2020-04-02 05:08:09,996 [Thread-59] INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(440)) - Total time to scan all replicas for block pool BP-1786648874-172.17.0.4-1585804085136: 189ms
2020-04-02 05:08:10,021 [Thread-176] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(414)) - Time taken to scan block pool BP-1786648874-172.17.0.4-1585804085136 on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10: 200ms
2020-04-02 05:08:10,021 [Thread-153] INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(440)) - Total time to scan all replicas for block pool BP-1786648874-172.17.0.4-1585804085136: 215ms
2020-04-02 05:08:10,038 [Thread-194] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(198)) - Adding replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1...
2020-04-02 05:08:10,043 [Thread-197] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(198)) - Adding replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10...
2020-04-02 05:08:10,043 [Thread-197] INFO  impl.BlockPoolSlice (BlockPoolSlice.java:readReplicasFromCache(871)) - Replica Cache file: /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/replicas doesn't exist 
2020-04-02 05:08:10,043 [Thread-196] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(198)) - Adding replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2...
2020-04-02 05:08:10,043 [Thread-195] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(198)) - Adding replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9...
2020-04-02 05:08:10,082 [Thread-197] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(203)) - Time to add replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10: 39ms
2020-04-02 05:08:10,081 [Thread-179] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(414)) - Time taken to scan block pool BP-1786648874-172.17.0.4-1585804085136 on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6: 245ms
2020-04-02 05:08:10,050 [Thread-194] INFO  impl.BlockPoolSlice (BlockPoolSlice.java:readReplicasFromCache(871)) - Replica Cache file: /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/replicas doesn't exist 
2020-04-02 05:08:10,106 [Thread-195] INFO  impl.BlockPoolSlice (BlockPoolSlice.java:readReplicasFromCache(871)) - Replica Cache file: /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/replicas doesn't exist 
2020-04-02 05:08:10,106 [Thread-196] INFO  impl.BlockPoolSlice (BlockPoolSlice.java:readReplicasFromCache(871)) - Replica Cache file: /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/replicas doesn't exist 
2020-04-02 05:08:10,101 [Thread-178] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(414)) - Time taken to scan block pool BP-1786648874-172.17.0.4-1585804085136 on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5: 263ms
2020-04-02 05:08:10,108 [Thread-107] INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(440)) - Total time to scan all replicas for block pool BP-1786648874-172.17.0.4-1585804085136: 277ms
2020-04-02 05:08:10,109 [Thread-194] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(203)) - Time to add replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1: 71ms
2020-04-02 05:08:10,113 [Thread-180] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(414)) - Time taken to scan block pool BP-1786648874-172.17.0.4-1585804085136 on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7: 235ms
2020-04-02 05:08:10,114 [Thread-130] INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(440)) - Total time to scan all replicas for block pool BP-1786648874-172.17.0.4-1585804085136: 282ms
2020-04-02 05:08:10,114 [Thread-184] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(414)) - Time taken to scan block pool BP-1786648874-172.17.0.4-1585804085136 on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4: 235ms
2020-04-02 05:08:10,115 [Thread-84] INFO  impl.FsDatasetImpl (FsVolumeList.java:addBlockPool(440)) - Total time to scan all replicas for block pool BP-1786648874-172.17.0.4-1585804085136: 279ms
2020-04-02 05:08:10,117 [Thread-198] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(198)) - Adding replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5...
2020-04-02 05:08:10,118 [Thread-198] INFO  impl.BlockPoolSlice (BlockPoolSlice.java:readReplicasFromCache(871)) - Replica Cache file: /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/replicas doesn't exist 
2020-04-02 05:08:10,119 [Thread-196] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(203)) - Time to add replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2: 75ms
2020-04-02 05:08:10,119 [Thread-200] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(198)) - Adding replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6...
2020-04-02 05:08:10,119 [Thread-59] INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(230)) - Total time to add all replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136: 84ms
2020-04-02 05:08:10,119 [Thread-201] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(198)) - Adding replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3...
2020-04-02 05:08:10,120 [Thread-201] INFO  impl.BlockPoolSlice (BlockPoolSlice.java:readReplicasFromCache(871)) - Replica Cache file: /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/replicas doesn't exist 
2020-04-02 05:08:10,121 [Thread-195] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(203)) - Time to add replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9: 27ms
2020-04-02 05:08:10,121 [Thread-153] INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(230)) - Total time to add all replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136: 84ms
2020-04-02 05:08:10,121 [Thread-200] INFO  impl.BlockPoolSlice (BlockPoolSlice.java:readReplicasFromCache(871)) - Replica Cache file: /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/replicas doesn't exist 
2020-04-02 05:08:10,121 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(386)) - Now scanning bpid BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
2020-04-02 05:08:10,149 [Thread-198] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(203)) - Time to add replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5: 32ms
2020-04-02 05:08:10,149 [Thread-200] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(203)) - Time to add replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6: 30ms
2020-04-02 05:08:10,150 [Thread-107] INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(230)) - Total time to add all replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136: 42ms
2020-04-02 05:08:10,122 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(386)) - Now scanning bpid BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
2020-04-02 05:08:10,153 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1)] INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(544)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1, DS-2d1f4083-d7c8-4136-8351-6f589a4451bd): finished scanning block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:10,154 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9)] INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(544)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9, DS-6946cabd-2f8d-451f-81bc-4884ebba8665): finished scanning block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:10,122 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(386)) - Now scanning bpid BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
2020-04-02 05:08:10,155 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10)] INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(544)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10, DS-d49b8d06-4514-41da-af7b-faacf4f00b86): finished scanning block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:10,121 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(386)) - Now scanning bpid BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
2020-04-02 05:08:10,155 [Thread-199] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(198)) - Adding replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7...
2020-04-02 05:08:10,151 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(386)) - Now scanning bpid BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5
2020-04-02 05:08:10,164 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5)] INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(544)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5, DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3): finished scanning block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:10,150 [Thread-201] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(203)) - Time to add replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3: 30ms
2020-04-02 05:08:10,170 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(386)) - Now scanning bpid BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
2020-04-02 05:08:10,171 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6)] INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(544)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6, DS-9396c1fd-c034-40b5-99a4-7728fe5d066f): finished scanning block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:10,158 [Thread-202] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(198)) - Adding replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4...
2020-04-02 05:08:10,188 [Thread-202] INFO  impl.BlockPoolSlice (BlockPoolSlice.java:readReplicasFromCache(871)) - Replica Cache file: /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/current/BP-1786648874-172.17.0.4-1585804085136/current/replicas doesn't exist 
2020-04-02 05:08:10,156 [Thread-199] INFO  impl.BlockPoolSlice (BlockPoolSlice.java:readReplicasFromCache(871)) - Replica Cache file: /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/replicas doesn't exist 
2020-04-02 05:08:10,156 [Thread-203] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(198)) - Adding replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8...
2020-04-02 05:08:10,155 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2)] INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(544)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2, DS-089629a9-5898-4562-bd81-79a4f45c96c1): finished scanning block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:10,189 [Thread-203] INFO  impl.BlockPoolSlice (BlockPoolSlice.java:readReplicasFromCache(871)) - Replica Cache file: /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/replicas doesn't exist 
2020-04-02 05:08:10,189 [Thread-203] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(203)) - Time to add replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8: 1ms
2020-04-02 05:08:10,189 [Thread-202] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(203)) - Time to add replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4: 1ms
2020-04-02 05:08:10,190 [Thread-84] INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(230)) - Total time to add all replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136: 73ms
2020-04-02 05:08:10,191 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(386)) - Now scanning bpid BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3
2020-04-02 05:08:10,191 [Thread-199] INFO  impl.FsDatasetImpl (FsVolumeList.java:run(203)) - Time to add replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7: 37ms
2020-04-02 05:08:10,192 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3)] INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(544)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3, DS-9e64160f-8239-40bc-b495-871e2ebb5a3a): finished scanning block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:10,192 [Thread-130] INFO  impl.FsDatasetImpl (FsVolumeList.java:getAllVolumesMap(230)) - Total time to add all replicas to map for block pool BP-1786648874-172.17.0.4-1585804085136: 78ms
2020-04-02 05:08:10,192 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(386)) - Now scanning bpid BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4
2020-04-02 05:08:10,192 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4)] INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(544)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4, DS-5ce71111-7ef9-40e4-bd53-df33411df409): finished scanning block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:10,192 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(386)) - Now scanning bpid BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
2020-04-02 05:08:10,193 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(386)) - Now scanning bpid BP-1786648874-172.17.0.4-1585804085136 on volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
2020-04-02 05:08:10,193 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8)] INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(544)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8, DS-29df15fa-b2ca-4eca-89df-87135d5e3b76): finished scanning block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:10,193 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7)] INFO  datanode.VolumeScanner (VolumeScanner.java:runLoop(544)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7, DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e): finished scanning block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:10,199 [Thread-153] INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(283)) - Periodic Directory Tree Verification scan starting at 4/2/20 7:18 AM with interval of 21600000ms
2020-04-02 05:08:10,215 [Thread-84] INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(283)) - Periodic Directory Tree Verification scan starting at 4/2/20 10:33 AM with interval of 21600000ms
2020-04-02 05:08:10,204 [Thread-130] INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(283)) - Periodic Directory Tree Verification scan starting at 4/2/20 8:25 AM with interval of 21600000ms
2020-04-02 05:08:10,205 [Thread-59] INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(283)) - Periodic Directory Tree Verification scan starting at 4/2/20 6:22 AM with interval of 21600000ms
2020-04-02 05:08:10,205 [Thread-107] INFO  datanode.DirectoryScanner (DirectoryScanner.java:start(283)) - Periodic Directory Tree Verification scan starting at 4/2/20 6:11 AM with interval of 21600000ms
2020-04-02 05:08:10,258 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:register(764)) - Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215 beginning handshake with NN
2020-04-02 05:08:10,259 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:register(764)) - Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215 beginning handshake with NN
2020-04-02 05:08:10,259 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:register(764)) - Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215 beginning handshake with NN
2020-04-02 05:08:10,259 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:register(764)) - Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215 beginning handshake with NN
2020-04-02 05:08:10,259 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:register(764)) - Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215 beginning handshake with NN
2020-04-02 05:08:10,285 [IPC Server handler 7 on 35215] INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(1040)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) storage 519e1267-21af-4106-9b82-32175ae0f5c5
2020-04-02 05:08:10,289 [IPC Server handler 7 on 35215] INFO  net.NetworkTopology (NetworkTopology.java:add(145)) - Adding a new node: /default-rack/127.0.0.1:44971
2020-04-02 05:08:10,290 [IPC Server handler 7 on 35215] INFO  blockmanagement.BlockReportLeaseManager (BlockReportLeaseManager.java:registerNode(204)) - Registered DN 519e1267-21af-4106-9b82-32175ae0f5c5 (127.0.0.1:44971).
2020-04-02 05:08:10,286 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(403)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7, DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e): no suitable block pools found to scan.  Waiting 1814399907 ms.
2020-04-02 05:08:10,295 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:register(783)) - Block pool Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215 successfully registered with NN
2020-04-02 05:08:10,295 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:offerService(612)) - For namenode localhost/127.0.0.1:35215 using BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2020-04-02 05:08:10,296 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(403)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3, DS-9e64160f-8239-40bc-b495-871e2ebb5a3a): no suitable block pools found to scan.  Waiting 1814399895 ms.
2020-04-02 05:08:10,297 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(403)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5, DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3): no suitable block pools found to scan.  Waiting 1814399854 ms.
2020-04-02 05:08:10,303 [IPC Server handler 5 on 35215] INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(1040)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) storage 85182ebc-cd1c-4941-89fb-8d9b64eeaece
2020-04-02 05:08:10,304 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(403)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4, DS-5ce71111-7ef9-40e4-bd53-df33411df409): no suitable block pools found to scan.  Waiting 1814399887 ms.
2020-04-02 05:08:10,302 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(403)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2, DS-089629a9-5898-4562-bd81-79a4f45c96c1): no suitable block pools found to scan.  Waiting 1814399819 ms.
2020-04-02 05:08:10,302 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(403)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10, DS-d49b8d06-4514-41da-af7b-faacf4f00b86): no suitable block pools found to scan.  Waiting 1814399819 ms.
2020-04-02 05:08:10,304 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(403)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9, DS-6946cabd-2f8d-451f-81bc-4884ebba8665): no suitable block pools found to scan.  Waiting 1814399817 ms.
2020-04-02 05:08:10,304 [IPC Server handler 5 on 35215] INFO  net.NetworkTopology (NetworkTopology.java:add(145)) - Adding a new node: /default-rack/127.0.0.1:45739
2020-04-02 05:08:10,304 [IPC Server handler 5 on 35215] INFO  blockmanagement.BlockReportLeaseManager (BlockReportLeaseManager.java:registerNode(204)) - Registered DN 85182ebc-cd1c-4941-89fb-8d9b64eeaece (127.0.0.1:45739).
2020-04-02 05:08:10,305 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(403)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1, DS-2d1f4083-d7c8-4136-8351-6f589a4451bd): no suitable block pools found to scan.  Waiting 1814399816 ms.
2020-04-02 05:08:10,305 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(403)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8, DS-29df15fa-b2ca-4eca-89df-87135d5e3b76): no suitable block pools found to scan.  Waiting 1814399887 ms.
2020-04-02 05:08:10,305 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(403)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6, DS-9396c1fd-c034-40b5-99a4-7728fe5d066f): no suitable block pools found to scan.  Waiting 1814399846 ms.
2020-04-02 05:08:10,310 [IPC Server handler 3 on 35215] INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(1040)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) storage 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4
2020-04-02 05:08:10,310 [IPC Server handler 3 on 35215] INFO  net.NetworkTopology (NetworkTopology.java:add(145)) - Adding a new node: /default-rack/127.0.0.1:43230
2020-04-02 05:08:10,310 [IPC Server handler 3 on 35215] INFO  blockmanagement.BlockReportLeaseManager (BlockReportLeaseManager.java:registerNode(204)) - Registered DN 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4 (127.0.0.1:43230).
2020-04-02 05:08:10,312 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:register(783)) - Block pool Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215 successfully registered with NN
2020-04-02 05:08:10,312 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:offerService(612)) - For namenode localhost/127.0.0.1:35215 using BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2020-04-02 05:08:10,318 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:register(783)) - Block pool Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215 successfully registered with NN
2020-04-02 05:08:10,318 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:offerService(612)) - For namenode localhost/127.0.0.1:35215 using BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2020-04-02 05:08:10,320 [IPC Server handler 9 on 35215] INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(1040)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) storage fa2f4855-186d-4810-9249-db4686eb92b3
2020-04-02 05:08:10,321 [IPC Server handler 9 on 35215] INFO  net.NetworkTopology (NetworkTopology.java:add(145)) - Adding a new node: /default-rack/127.0.0.1:45580
2020-04-02 05:08:10,321 [IPC Server handler 9 on 35215] INFO  blockmanagement.BlockReportLeaseManager (BlockReportLeaseManager.java:registerNode(204)) - Registered DN fa2f4855-186d-4810-9249-db4686eb92b3 (127.0.0.1:45580).
2020-04-02 05:08:10,321 [IPC Server handler 8 on 35215] INFO  hdfs.StateChange (DatanodeManager.java:registerDatanode(1040)) - BLOCK* registerDatanode: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) storage 5207c5c0-37c7-443f-94c4-771a605480e4
2020-04-02 05:08:10,322 [IPC Server handler 8 on 35215] INFO  net.NetworkTopology (NetworkTopology.java:add(145)) - Adding a new node: /default-rack/127.0.0.1:43434
2020-04-02 05:08:10,322 [IPC Server handler 8 on 35215] INFO  blockmanagement.BlockReportLeaseManager (BlockReportLeaseManager.java:registerNode(204)) - Registered DN 5207c5c0-37c7-443f-94c4-771a605480e4 (127.0.0.1:43434).
2020-04-02 05:08:10,322 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:register(783)) - Block pool Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215 successfully registered with NN
2020-04-02 05:08:10,322 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:offerService(612)) - For namenode localhost/127.0.0.1:35215 using BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2020-04-02 05:08:10,325 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:register(783)) - Block pool Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215 successfully registered with NN
2020-04-02 05:08:10,325 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:offerService(612)) - For namenode localhost/127.0.0.1:35215 using BLOCKREPORT_INTERVAL of 21600000msec CACHEREPORT_INTERVAL of 10000msec Initial delay: 0msec; heartBeatInterval=3000
2020-04-02 05:08:10,386 [IPC Server handler 6 on 35215] INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(987)) - Adding new storage ID DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e for DN 127.0.0.1:43434
2020-04-02 05:08:10,387 [IPC Server handler 6 on 35215] INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(987)) - Adding new storage ID DS-29df15fa-b2ca-4eca-89df-87135d5e3b76 for DN 127.0.0.1:43434
2020-04-02 05:08:10,391 [IPC Server handler 0 on 35215] INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(987)) - Adding new storage ID DS-2d1f4083-d7c8-4136-8351-6f589a4451bd for DN 127.0.0.1:45580
2020-04-02 05:08:10,393 [IPC Server handler 0 on 35215] INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(987)) - Adding new storage ID DS-089629a9-5898-4562-bd81-79a4f45c96c1 for DN 127.0.0.1:45580
2020-04-02 05:08:10,396 [IPC Server handler 2 on 35215] INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(987)) - Adding new storage ID DS-9e64160f-8239-40bc-b495-871e2ebb5a3a for DN 127.0.0.1:43230
2020-04-02 05:08:10,396 [IPC Server handler 2 on 35215] INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(987)) - Adding new storage ID DS-5ce71111-7ef9-40e4-bd53-df33411df409 for DN 127.0.0.1:43230
2020-04-02 05:08:10,397 [IPC Server handler 4 on 35215] INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(987)) - Adding new storage ID DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3 for DN 127.0.0.1:44971
2020-04-02 05:08:10,403 [IPC Server handler 4 on 35215] INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(987)) - Adding new storage ID DS-9396c1fd-c034-40b5-99a4-7728fe5d066f for DN 127.0.0.1:44971
2020-04-02 05:08:10,410 [IPC Server handler 1 on 35215] INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(987)) - Adding new storage ID DS-6946cabd-2f8d-451f-81bc-4884ebba8665 for DN 127.0.0.1:45739
2020-04-02 05:08:10,410 [IPC Server handler 1 on 35215] INFO  blockmanagement.DatanodeDescriptor (DatanodeDescriptor.java:updateStorage(987)) - Adding new storage ID DS-d49b8d06-4514-41da-af7b-faacf4f00b86 for DN 127.0.0.1:45739
2020-04-02 05:08:10,478 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2541)) - BLOCK* processReport 0xa3f563a750d17a13: Processing first storage report for DS-6946cabd-2f8d-451f-81bc-4884ebba8665 from datanode 85182ebc-cd1c-4941-89fb-8d9b64eeaece
2020-04-02 05:08:10,481 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2570)) - BLOCK* processReport 0xa3f563a750d17a13: from storage DS-6946cabd-2f8d-451f-81bc-4884ebba8665 node DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136), blocks: 0, hasStaleStorage: true, processing time: 3 msecs, invalidatedBlocks: 0
2020-04-02 05:08:10,481 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2541)) - BLOCK* processReport 0x5f6c7857262a53a: Processing first storage report for DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e from datanode 5207c5c0-37c7-443f-94c4-771a605480e4
2020-04-02 05:08:10,481 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2570)) - BLOCK* processReport 0x5f6c7857262a53a: from storage DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e node DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136), blocks: 0, hasStaleStorage: true, processing time: 0 msecs, invalidatedBlocks: 0
2020-04-02 05:08:10,481 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2541)) - BLOCK* processReport 0xe7922683427494d1: Processing first storage report for DS-9e64160f-8239-40bc-b495-871e2ebb5a3a from datanode 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4
2020-04-02 05:08:10,481 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2570)) - BLOCK* processReport 0xe7922683427494d1: from storage DS-9e64160f-8239-40bc-b495-871e2ebb5a3a node DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136), blocks: 0, hasStaleStorage: true, processing time: 0 msecs, invalidatedBlocks: 0
2020-04-02 05:08:10,481 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2541)) - BLOCK* processReport 0xe140bb24a1e54bc8: Processing first storage report for DS-089629a9-5898-4562-bd81-79a4f45c96c1 from datanode fa2f4855-186d-4810-9249-db4686eb92b3
2020-04-02 05:08:10,481 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2570)) - BLOCK* processReport 0xe140bb24a1e54bc8: from storage DS-089629a9-5898-4562-bd81-79a4f45c96c1 node DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136), blocks: 0, hasStaleStorage: true, processing time: 0 msecs, invalidatedBlocks: 0
2020-04-02 05:08:10,482 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2541)) - BLOCK* processReport 0xbf8ac4a6f9734a4d: Processing first storage report for DS-9396c1fd-c034-40b5-99a4-7728fe5d066f from datanode 519e1267-21af-4106-9b82-32175ae0f5c5
2020-04-02 05:08:10,482 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2570)) - BLOCK* processReport 0xbf8ac4a6f9734a4d: from storage DS-9396c1fd-c034-40b5-99a4-7728fe5d066f node DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136), blocks: 0, hasStaleStorage: true, processing time: 0 msecs, invalidatedBlocks: 0
2020-04-02 05:08:10,482 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2541)) - BLOCK* processReport 0xe7922683427494d1: Processing first storage report for DS-5ce71111-7ef9-40e4-bd53-df33411df409 from datanode 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4
2020-04-02 05:08:10,482 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2570)) - BLOCK* processReport 0xe7922683427494d1: from storage DS-5ce71111-7ef9-40e4-bd53-df33411df409 node DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136), blocks: 0, hasStaleStorage: false, processing time: 1 msecs, invalidatedBlocks: 0
2020-04-02 05:08:10,483 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2541)) - BLOCK* processReport 0x5f6c7857262a53a: Processing first storage report for DS-29df15fa-b2ca-4eca-89df-87135d5e3b76 from datanode 5207c5c0-37c7-443f-94c4-771a605480e4
2020-04-02 05:08:10,483 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2570)) - BLOCK* processReport 0x5f6c7857262a53a: from storage DS-29df15fa-b2ca-4eca-89df-87135d5e3b76 node DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136), blocks: 0, hasStaleStorage: false, processing time: 0 msecs, invalidatedBlocks: 0
2020-04-02 05:08:10,483 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2541)) - BLOCK* processReport 0xa3f563a750d17a13: Processing first storage report for DS-d49b8d06-4514-41da-af7b-faacf4f00b86 from datanode 85182ebc-cd1c-4941-89fb-8d9b64eeaece
2020-04-02 05:08:10,483 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2570)) - BLOCK* processReport 0xa3f563a750d17a13: from storage DS-d49b8d06-4514-41da-af7b-faacf4f00b86 node DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136), blocks: 0, hasStaleStorage: false, processing time: 0 msecs, invalidatedBlocks: 0
2020-04-02 05:08:10,483 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2541)) - BLOCK* processReport 0xe140bb24a1e54bc8: Processing first storage report for DS-2d1f4083-d7c8-4136-8351-6f589a4451bd from datanode fa2f4855-186d-4810-9249-db4686eb92b3
2020-04-02 05:08:10,483 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2570)) - BLOCK* processReport 0xe140bb24a1e54bc8: from storage DS-2d1f4083-d7c8-4136-8351-6f589a4451bd node DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136), blocks: 0, hasStaleStorage: false, processing time: 0 msecs, invalidatedBlocks: 0
2020-04-02 05:08:10,483 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2541)) - BLOCK* processReport 0xbf8ac4a6f9734a4d: Processing first storage report for DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3 from datanode 519e1267-21af-4106-9b82-32175ae0f5c5
2020-04-02 05:08:10,483 [Block report processor] INFO  BlockStateChange (BlockManager.java:processReport(2570)) - BLOCK* processReport 0xbf8ac4a6f9734a4d: from storage DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3 node DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136), blocks: 0, hasStaleStorage: false, processing time: 0 msecs, invalidatedBlocks: 0
2020-04-02 05:08:10,521 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:blockReport(422)) - Successfully sent block report 0xbf8ac4a6f9734a4d,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 8 msec to generate and 87 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2020-04-02 05:08:10,522 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(759)) - Got finalize command for block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:10,528 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:blockReport(422)) - Successfully sent block report 0xe140bb24a1e54bc8,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 3 msec to generate and 92 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2020-04-02 05:08:10,529 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(759)) - Got finalize command for block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:10,541 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:blockReport(422)) - Successfully sent block report 0xe7922683427494d1,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 9 msec to generate and 110 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2020-04-02 05:08:10,542 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(759)) - Got finalize command for block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:10,542 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:blockReport(422)) - Successfully sent block report 0x5f6c7857262a53a,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 5 msec to generate and 114 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2020-04-02 05:08:10,542 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(759)) - Got finalize command for block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:10,544 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPServiceActor.java:blockReport(422)) - Successfully sent block report 0xa3f563a750d17a13,  containing 2 storage report(s), of which we sent 2. The reports had 0 total blocks and used 1 RPC(s). This took 9 msec to generate and 110 msecs for RPC and NN processing. Got back one command: FinalizeCommand/5.
2020-04-02 05:08:10,544 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BPOfferService.java:processCommandFromActive(759)) - Got finalize command for block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:10,627 [IPC Server handler 0 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=datanodeReport	src=null	dst=null	perm=null	proto=rpc
2020-04-02 05:08:10,641 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:waitActive(2678)) - Cluster is active
[msx] test Started org.apache.hadoop.hdfs.TestFileAppend3#testTC12ForAppend2
[msx] unitTestCounterInClass = 0
p=/TC12/foo0
2020-04-02 05:08:10,662 [main] DEBUG hdfs.DFSClient (DFSClient.java:create(1210)) - /TC12/foo0: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-04-02 05:08:10,675 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(757)) - *DIR* NameNode.create: file /TC12/foo0 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:10,677 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2385)) - DIR* NameSystem.startFile: src=/TC12/foo0, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1, createParent=true, replication=3, createFlag=[CREATE], blockSize=65536, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-04-02 05:08:10,697 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirMkdirOp.java:createSingleDirectory(182)) - mkdirs: created directory /TC12
2020-04-02 05:08:10,706 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(585)) - DIR* addFile: foo0 is added
2020-04-02 05:08:10,707 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(416)) - DIR* NameSystem.startFile: added /TC12/foo0 inode 16387 DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:10,719 [IPC Server handler 2 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/TC12/foo0	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:10,738 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC12/foo0, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:10,770 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC12/foo0, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:10,782 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC12/foo0  inodeId 16387 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:10,791 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC12/foo0 with blk_1073741825_1001 block is added to the in-memory file system
2020-04-02 05:08:10,791 [IPC Server handler 4 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741825_1001, replicas=127.0.0.1:45739, 127.0.0.1:43434, 127.0.0.1:45580 for /TC12/foo0
2020-04-02 05:08:10,792 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC12/foo0 with new block blk_1073741825_1001, current total block count is 1
2020-04-02 05:08:10,822 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:10,879 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60198 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43434, 127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:10,879 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60198 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:10,880 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60198 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:10,880 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60198 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001 src: /127.0.0.1:60198 dest: /127.0.0.1:45739
2020-04-02 05:08:10,889 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60198 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001
 storageType=DISK, inAddr=/127.0.0.1:60198, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:10,900 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60198 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741825 of size 0
2020-04-02 05:08:10,900 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60198 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741825_1001.meta of size 0
2020-04-02 05:08:10,902 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60198 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:10,906 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:10,915 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37804 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:10,915 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37804 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:10,916 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37804 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:10,916 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37804 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001 src: /127.0.0.1:37804 dest: /127.0.0.1:43434
2020-04-02 05:08:10,916 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37804 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001
 storageType=DISK, inAddr=/127.0.0.1:37804, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:10,917 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37804 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741825 of size 0
2020-04-02 05:08:10,918 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37804 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741825_1001.meta of size 0
2020-04-02 05:08:10,918 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37804 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:10,918 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:10,921 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34980 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:10,921 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34980 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:10,921 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34980 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:10,922 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34980 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001 src: /127.0.0.1:34980 dest: /127.0.0.1:45580
2020-04-02 05:08:10,922 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34980 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001
 storageType=DISK, inAddr=/127.0.0.1:34980, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:10,922 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34980 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741825 of size 0
2020-04-02 05:08:10,922 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34980 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741825_1001.meta of size 0
2020-04-02 05:08:10,938 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:10,955 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60198 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001: PacketHeader with packetLen=25895 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 25687

2020-04-02 05:08:10,955 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60198 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=25687, ackEnqueueNanoTime=689260333834768, ackStatus=SUCCESS)
2020-04-02 05:08:10,956 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37804 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001: PacketHeader with packetLen=25895 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 25687

2020-04-02 05:08:10,957 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37804 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=25687, ackEnqueueNanoTime=689260335686680, ackStatus=SUCCESS)
2020-04-02 05:08:10,960 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34980 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001: PacketHeader with packetLen=25895 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 25687

2020-04-02 05:08:10,961 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34980 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=25687, ackEnqueueNanoTime=689260339446158, ackStatus=SUCCESS)
2020-04-02 05:08:10,975 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:10,975 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:10,975 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:10,977 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 10534627 flag: 0 flag: 0
2020-04-02 05:08:10,977 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 10534627 flag: 0 flag: 0
2020-04-02 05:08:10,990 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 21565591 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:10,992 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60198 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001: PacketHeader with packetLen=4 header data: offsetInBlock: 25687
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:10,992 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60198 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=25687, ackEnqueueNanoTime=689260370404906, ackStatus=SUCCESS)
2020-04-02 05:08:10,992 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60198 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001
2020-04-02 05:08:10,992 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37804 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001: PacketHeader with packetLen=4 header data: offsetInBlock: 25687
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:10,993 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37804 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=25687, ackEnqueueNanoTime=689260371562732, ackStatus=SUCCESS)
2020-04-02 05:08:10,993 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37804 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001
2020-04-02 05:08:10,994 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34980 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001: PacketHeader with packetLen=4 header data: offsetInBlock: 25687
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:10,994 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34980 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001
2020-04-02 05:08:10,994 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34980 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=25687, ackEnqueueNanoTime=689260372404266, ackStatus=SUCCESS)
2020-04-02 05:08:11,001 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:34980, dest: /127.0.0.1:45580, bytes: 25687, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, duration(ns): 56978490
2020-04-02 05:08:11,001 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:11,002 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:11,002 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:11,004 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34980 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:11,005 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34980 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 2
2020-04-02 05:08:11,006 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:37804, dest: /127.0.0.1:43434, bytes: 25687, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, duration(ns): 64867896
2020-04-02 05:08:11,015 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8483911 flag: 0 flag: 0
2020-04-02 05:08:11,016 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8483911 flag: 0 flag: 0
2020-04-02 05:08:11,016 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37804 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: closing
2020-04-02 05:08:11,016 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] terminating
2020-04-02 05:08:11,017 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37804 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:11,032 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60198, dest: /127.0.0.1:45739, bytes: 25687, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, duration(ns): 82453270
2020-04-02 05:08:11,033 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 23302185 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:11,033 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580] terminating
2020-04-02 05:08:11,063 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60198 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]: closing
2020-04-02 05:08:11,078 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC12/foo0 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:11,078 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60198 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 2
2020-04-02 05:08:11,078 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:11,082 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:11,091 [IPC Server handler 8 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:checkBlocksComplete(2908)) - BLOCK* blk_1073741825_1001 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /TC12/foo0
2020-04-02 05:08:11,092 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741825_1001 on 127.0.0.1:45739 size 25687 replicaState = FINALIZED
2020-04-02 05:08:11,092 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMMITTED
2020-04-02 05:08:11,092 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741825_1001 (size=25687)
2020-04-02 05:08:11,093 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741825_1001 is received from 127.0.0.1:45739
2020-04-02 05:08:11,094 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:11,094 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741825_1001
2020-04-02 05:08:11,094 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741825_1001 on 127.0.0.1:45580 size 25687 replicaState = FINALIZED
2020-04-02 05:08:11,094 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:11,094 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741825_1001 (size=25687)
2020-04-02 05:08:11,094 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741825_1001 is received from 127.0.0.1:45580
2020-04-02 05:08:11,095 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:11,095 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:11,095 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741825_1001
2020-04-02 05:08:11,095 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741825_1001 on 127.0.0.1:43434 size 25687 replicaState = FINALIZED
2020-04-02 05:08:11,096 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:11,096 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741825_1001 (size=25687)
2020-04-02 05:08:11,096 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741825_1001 is received from 127.0.0.1:43434
2020-04-02 05:08:11,096 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:11,498 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC12/foo0 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:11,499 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC12/foo0 with 1 blocks is persisted to the file system
2020-04-02 05:08:11,499 [IPC Server handler 5 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC12/foo0 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:11,510 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC12/foo0 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:11,511 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC12/foo0, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:11,513 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /TC12/foo0 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001 block size 25687
2020-04-02 05:08:11,514 [IPC Server handler 3 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TC12/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:11,519 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC12/foo0, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:11,526 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC12/foo0, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:blk_1073741825_1001
2020-04-02 05:08:11,538 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC12/foo0  inodeId 16387 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:11,540 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC12/foo0 with blk_1073741826_1002 block is added to the in-memory file system
2020-04-02 05:08:11,540 [IPC Server handler 0 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741826_1002, replicas=127.0.0.1:44971, 127.0.0.1:43230, 127.0.0.1:43434 for /TC12/foo0
2020-04-02 05:08:11,540 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC12/foo0 with new block blk_1073741826_1002, current total block count is 2
2020-04-02 05:08:11,548 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:11,554 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56742 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43230, 127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:11,554 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56742 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:11,555 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56742 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:11,555 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56742 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002 src: /127.0.0.1:56742 dest: /127.0.0.1:44971
2020-04-02 05:08:11,555 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56742 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002
 storageType=DISK, inAddr=/127.0.0.1:56742, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:11,555 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56742 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741826 of size 0
2020-04-02 05:08:11,555 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56742 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741826_1002.meta of size 0
2020-04-02 05:08:11,556 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56742 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43230
2020-04-02 05:08:11,556 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@4a9f80d3] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:11,572 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56894 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:11,572 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56894 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:11,573 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56894 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:11,573 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56894 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002 src: /127.0.0.1:56894 dest: /127.0.0.1:43230
2020-04-02 05:08:11,573 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56894 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002
 storageType=DISK, inAddr=/127.0.0.1:56894, myAddr=/127.0.0.1:43230
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43230
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9e64160f-8239-40bc-b495-871e2ebb5a3a
2020-04-02 05:08:11,573 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56894 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741826 of size 0
2020-04-02 05:08:11,573 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56894 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741826_1002.meta of size 0
2020-04-02 05:08:11,573 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56894 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:11,575 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:11,578 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:11,578 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:11,578 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:11,578 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002 src: /127.0.0.1:37836 dest: /127.0.0.1:43434
2020-04-02 05:08:11,578 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002
 storageType=DISK, inAddr=/127.0.0.1:37836, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:11,579 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741826 of size 0
2020-04-02 05:08:11,579 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741826_1002.meta of size 0
2020-04-02 05:08:11,606 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:11,613 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56742 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002: PacketHeader with packetLen=5929 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 5877

2020-04-02 05:08:11,613 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56742 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=5877, ackEnqueueNanoTime=689260991716674, ackStatus=SUCCESS)
2020-04-02 05:08:11,614 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56894 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002: PacketHeader with packetLen=5929 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 5877

2020-04-02 05:08:11,614 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56894 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=5877, ackEnqueueNanoTime=689260992598328, ackStatus=SUCCESS)
2020-04-02 05:08:11,618 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002: PacketHeader with packetLen=5929 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 5877

2020-04-02 05:08:11,631 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=5877, ackEnqueueNanoTime=689261009761591, ackStatus=SUCCESS)
2020-04-02 05:08:11,633 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:11,633 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:11,638 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:11,646 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 23736746 flag: 0 flag: 0
2020-04-02 05:08:11,646 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:43434] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 23736746 flag: 0 flag: 0
2020-04-02 05:08:11,649 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 32751336 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:11,649 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56742 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002: PacketHeader with packetLen=4 header data: offsetInBlock: 5877
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:11,650 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56742 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=5877, ackEnqueueNanoTime=689261028175964, ackStatus=SUCCESS)
2020-04-02 05:08:11,650 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56742 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002
2020-04-02 05:08:11,650 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56894 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002: PacketHeader with packetLen=4 header data: offsetInBlock: 5877
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:11,650 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56894 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=5877, ackEnqueueNanoTime=689261029016559, ackStatus=SUCCESS)
2020-04-02 05:08:11,651 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56894 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002
2020-04-02 05:08:11,652 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002: PacketHeader with packetLen=4 header data: offsetInBlock: 5877
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:11,652 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002
2020-04-02 05:08:11,652 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=5877, ackEnqueueNanoTime=689261030861027, ackStatus=SUCCESS)
2020-04-02 05:08:11,656 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:37836, dest: /127.0.0.1:43434, bytes: 5877, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, duration(ns): 49253122
2020-04-02 05:08:11,658 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:11,659 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:11,661 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:11,662 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:11,679 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:11,680 [IPC Server handler 2 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:11,681 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741826_1002 on 127.0.0.1:43434 size 5877 replicaState = FINALIZED
2020-04-02 05:08:11,681 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:11,682 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741826_1002 (size=0)
2020-04-02 05:08:11,682 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741826_1002 is received from 127.0.0.1:43434
2020-04-02 05:08:11,682 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:11,703 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:56894, dest: /127.0.0.1:43230, bytes: 5877, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, duration(ns): 117924775
2020-04-02 05:08:11,704 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9154028 flag: 0 flag: 0
2020-04-02 05:08:11,704 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:11,704 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56894 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:11,711 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:11,710 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:43434] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9154028 flag: 0 flag: 0
2020-04-02 05:08:11,711 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56894 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43230:Number of active connections is: 2
2020-04-02 05:08:11,711 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741826_1002 on 127.0.0.1:43230 size 5877 replicaState = FINALIZED
2020-04-02 05:08:11,712 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:11,712 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43230 is added to blk_1073741826_1002 (size=0)
2020-04-02 05:08:11,712 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741826_1002 is received from 127.0.0.1:43230
2020-04-02 05:08:11,712 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43230 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:11,716 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:56742, dest: /127.0.0.1:44971, bytes: 5877, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, duration(ns): 104744425
2020-04-02 05:08:11,717 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 60099077 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:11,717 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:43434] terminating
2020-04-02 05:08:11,727 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:11,728 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741826_1002 on 127.0.0.1:44971 size 5877 replicaState = FINALIZED
2020-04-02 05:08:11,729 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:11,728 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56742 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:43434]: closing
2020-04-02 05:08:11,729 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56742 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 2
2020-04-02 05:08:11,729 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741826_1002 (size=0)
2020-04-02 05:08:11,730 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741826_1002 is received from 127.0.0.1:44971
2020-04-02 05:08:11,730 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:11,744 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC12/foo0 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:11,744 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC12/foo0 with 2 blocks is persisted to the file system
2020-04-02 05:08:11,745 [IPC Server handler 6 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC12/foo0 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:11,751 [IPC Server handler 7 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/TC12/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:11,762 [IPC Server handler 8 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741825_1001, blk_1073741826_1002]
2020-04-02 05:08:11,763 [IPC Server handler 8 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC12/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:11,778 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(242)) - newInfo = LocatedBlocks{;  fileLength=31564;  underConstruction=false;  blocks=[LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001; getBlockSize()=25687; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK], DatanodeInfoWithStorage[127.0.0.1:45580,DS-2d1f4083-d7c8-4136-8351-6f589a4451bd,DISK], DatanodeInfoWithStorage[127.0.0.1:45739,DS-6946cabd-2f8d-451f-81bc-4884ebba8665,DISK]]}, LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002; getBlockSize()=5877; corrupt=false; offset=25687; locs=[DatanodeInfoWithStorage[127.0.0.1:44971,DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3,DISK], DatanodeInfoWithStorage[127.0.0.1:43230,DS-9e64160f-8239-40bc-b495-871e2ebb5a3a,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-29df15fa-b2ca-4eca-89df-87135d5e3b76,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002; getBlockSize()=5877; corrupt=false; offset=25687; locs=[DatanodeInfoWithStorage[127.0.0.1:43434,DS-29df15fa-b2ca-4eca-89df-87135d5e3b76,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3,DISK], DatanodeInfoWithStorage[127.0.0.1:43230,DS-9e64160f-8239-40bc-b495-871e2ebb5a3a,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-04-02 05:08:11,782 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:11,789 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:11,823 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37840 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, replica=FinalizedReplica, blk_1073741825_1001, FINALIZED
  getNumBytes()     = 25687
  getBytesOnDisk()  = 25687
  getVisibleLength()= 25687
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741825
2020-04-02 05:08:11,824 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37840 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741825_1001, FINALIZED
  getNumBytes()     = 25687
  getBytesOnDisk()  = 25687
  getVisibleLength()= 25687
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741825
2020-04-02 05:08:11,828 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37840 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:43434, dest: /127.0.0.1:37840, bytes: 25891, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, duration(ns): 1336935
2020-04-02 05:08:11,890 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:11,896 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:11,916 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, replica=FinalizedReplica, blk_1073741826_1002, FINALIZED
  getNumBytes()     = 5877
  getBytesOnDisk()  = 5877
  getVisibleLength()= 5877
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741826
2020-04-02 05:08:11,916 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741826_1002, FINALIZED
  getNumBytes()     = 5877
  getBytesOnDisk()  = 5877
  getVisibleLength()= 5877
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741826
2020-04-02 05:08:11,917 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:44971, dest: /127.0.0.1:56760, bytes: 5925, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, duration(ns): 361064
2020-04-02 05:08:11,932 [IPC Server handler 9 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741825_1001, blk_1073741826_1002]
2020-04-02 05:08:11,941 [IPC Server handler 9 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC12/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:11,955 [IPC Server handler 5 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741825_1001, blk_1073741826_1002]
2020-04-02 05:08:11,956 [IPC Server handler 5 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC12/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:11,960 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(242)) - newInfo = LocatedBlocks{;  fileLength=31564;  underConstruction=false;  blocks=[LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001; getBlockSize()=25687; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK], DatanodeInfoWithStorage[127.0.0.1:45580,DS-2d1f4083-d7c8-4136-8351-6f589a4451bd,DISK], DatanodeInfoWithStorage[127.0.0.1:45739,DS-6946cabd-2f8d-451f-81bc-4884ebba8665,DISK]]}, LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002; getBlockSize()=5877; corrupt=false; offset=25687; locs=[DatanodeInfoWithStorage[127.0.0.1:43230,DS-9e64160f-8239-40bc-b495-871e2ebb5a3a,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-29df15fa-b2ca-4eca-89df-87135d5e3b76,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002; getBlockSize()=5877; corrupt=false; offset=25687; locs=[DatanodeInfoWithStorage[127.0.0.1:44971,DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3,DISK], DatanodeInfoWithStorage[127.0.0.1:43230,DS-9e64160f-8239-40bc-b495-871e2ebb5a3a,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-29df15fa-b2ca-4eca-89df-87135d5e3b76,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-04-02 05:08:11,960 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:11,962 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37840 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, replica=FinalizedReplica, blk_1073741825_1001, FINALIZED
  getNumBytes()     = 25687
  getBytesOnDisk()  = 25687
  getVisibleLength()= 25687
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741825
2020-04-02 05:08:11,964 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37840 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741825_1001, FINALIZED
  getNumBytes()     = 25687
  getBytesOnDisk()  = 25687
  getVisibleLength()= 25687
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741825
2020-04-02 05:08:11,965 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37840 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:43434, dest: /127.0.0.1:37840, bytes: 25891, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001, duration(ns): 411494
2020-04-02 05:08:11,982 [IPC Server handler 3 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741825_1001, blk_1073741826_1002]
2020-04-02 05:08:11,983 [IPC Server handler 3 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC12/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:11,986 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(242)) - newInfo = LocatedBlocks{;  fileLength=31564;  underConstruction=false;  blocks=[LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741825_1001; getBlockSize()=25687; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:45580,DS-2d1f4083-d7c8-4136-8351-6f589a4451bd,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK], DatanodeInfoWithStorage[127.0.0.1:45739,DS-6946cabd-2f8d-451f-81bc-4884ebba8665,DISK]]}, LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002; getBlockSize()=5877; corrupt=false; offset=25687; locs=[DatanodeInfoWithStorage[127.0.0.1:44971,DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-29df15fa-b2ca-4eca-89df-87135d5e3b76,DISK], DatanodeInfoWithStorage[127.0.0.1:43230,DS-9e64160f-8239-40bc-b495-871e2ebb5a3a,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002; getBlockSize()=5877; corrupt=false; offset=25687; locs=[DatanodeInfoWithStorage[127.0.0.1:43230,DS-9e64160f-8239-40bc-b495-871e2ebb5a3a,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-29df15fa-b2ca-4eca-89df-87135d5e3b76,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-04-02 05:08:11,986 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:11,990 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, replica=FinalizedReplica, blk_1073741826_1002, FINALIZED
  getNumBytes()     = 5877
  getBytesOnDisk()  = 5877
  getVisibleLength()= 5877
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741826
2020-04-02 05:08:11,992 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741826_1002, FINALIZED
  getNumBytes()     = 5877
  getBytesOnDisk()  = 5877
  getVisibleLength()= 5877
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741826
2020-04-02 05:08:11,995 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:44971, dest: /127.0.0.1:56760, bytes: 5925, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741826_1002, duration(ns): 309882
[msx] test Finished org.apache.hadoop.hdfs.TestFileAppend3#testTC12ForAppend2
[msx] writeFile testName = org.apache.hadoop.hdfs.TestFileAppend3#testTC12ForAppend2
[msx] succeed
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
[msx] test Started org.apache.hadoop.hdfs.TestFileAppend3#testTC1ForAppend2
[msx] perform reset as unitTestCounterInClass 1 is larger than zero
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
2020-04-02 05:08:12,011 [main] DEBUG hdfs.DFSClient (DFSClient.java:create(1210)) - /TC1/foo2: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-04-02 05:08:12,013 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(757)) - *DIR* NameNode.create: file /TC1/foo2 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:12,014 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2385)) - DIR* NameSystem.startFile: src=/TC1/foo2, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1, createParent=true, replication=3, createFlag=[CREATE], blockSize=65536, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-04-02 05:08:12,014 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirMkdirOp.java:createSingleDirectory(182)) - mkdirs: created directory /TC1
2020-04-02 05:08:12,014 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(585)) - DIR* addFile: foo2 is added
2020-04-02 05:08:12,014 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(416)) - DIR* NameSystem.startFile: added /TC1/foo2 inode 16389 DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,015 [IPC Server handler 0 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/TC1/foo2	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:12,022 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC1/foo2, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:12,025 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC1/foo2, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:12,027 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC1/foo2, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:12,029 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/TC1/foo2, packetSize=516, chunksPerPacket=1, bytesCurBlock=64512, DFSOutputStream:block==null
2020-04-02 05:08:12,029 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC1/foo2, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:12,029 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=2, src=/TC1/foo2, packetSize=516, chunksPerPacket=1, bytesCurBlock=65024, DFSOutputStream:block==null
2020-04-02 05:08:12,029 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC1/foo2, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:12,029 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC1/foo2  inodeId 16389 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,031 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC1/foo2 with blk_1073741827_1003 block is added to the in-memory file system
2020-04-02 05:08:12,031 [IPC Server handler 2 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741827_1003, replicas=127.0.0.1:44971, 127.0.0.1:45739, 127.0.0.1:43434 for /TC1/foo2
2020-04-02 05:08:12,031 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC1/foo2 with new block blk_1073741827_1003, current total block count is 1
2020-04-02 05:08:12,034 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:12,036 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45739, 127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,036 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,036 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,036 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003 src: /127.0.0.1:56786 dest: /127.0.0.1:44971
2020-04-02 05:08:12,036 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003
 storageType=DISK, inAddr=/127.0.0.1:56786, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:12,037 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741827 of size 0
2020-04-02 05:08:12,037 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741827_1003.meta of size 0
2020-04-02 05:08:12,037 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:12,037 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:12,040 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,041 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,041 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,041 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003 src: /127.0.0.1:60286 dest: /127.0.0.1:45739
2020-04-02 05:08:12,041 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003
 storageType=DISK, inAddr=/127.0.0.1:60286, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:12,042 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741827 of size 0
2020-04-02 05:08:12,043 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741827_1003.meta of size 0
2020-04-02 05:08:12,043 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:12,043 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:12,046 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,046 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,046 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,046 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003 src: /127.0.0.1:37880 dest: /127.0.0.1:43434
2020-04-02 05:08:12,046 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003
 storageType=DISK, inAddr=/127.0.0.1:37880, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:12,046 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741827 of size 0
2020-04-02 05:08:12,046 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741827_1003.meta of size 0
2020-04-02 05:08:12,064 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:12,071 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:12,071 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689261449414777, ackStatus=SUCCESS)
2020-04-02 05:08:12,072 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:12,072 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689261450592666, ackStatus=SUCCESS)
2020-04-02 05:08:12,073 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:12,074 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689261452542802, ackStatus=SUCCESS)
2020-04-02 05:08:12,078 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,078 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689261456382508, ackStatus=SUCCESS)
2020-04-02 05:08:12,078 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,078 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,091 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689261469790780, ackStatus=SUCCESS)
2020-04-02 05:08:12,078 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689261456982103, ackStatus=SUCCESS)
2020-04-02 05:08:12,092 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,092 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,097 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689261475092574, ackStatus=SUCCESS)
2020-04-02 05:08:12,092 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689261470736389, ackStatus=SUCCESS)
2020-04-02 05:08:12,097 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,097 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689261476020750, ackStatus=SUCCESS)
2020-04-02 05:08:12,098 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,098 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,099 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,099 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:12,106 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,108 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 33647483 flag: 0 flag: 0
2020-04-02 05:08:12,108 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 33647483 flag: 0 flag: 0
2020-04-02 05:08:12,109 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,109 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 17454784 flag: 0 flag: 0
2020-04-02 05:08:12,111 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 37160998 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,111 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 17454784 flag: 0 flag: 0
2020-04-02 05:08:12,112 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 33529107 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,113 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,118 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 16536164 flag: 0 flag: 0
2020-04-02 05:08:12,119 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 39438600 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,119 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 16536164 flag: 0 flag: 0
2020-04-02 05:08:12,123 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,124 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689261502937574, ackStatus=SUCCESS)
2020-04-02 05:08:12,125 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,125 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689261503434214, ackStatus=SUCCESS)
2020-04-02 05:08:12,125 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003
2020-04-02 05:08:12,125 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003
2020-04-02 05:08:12,127 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,127 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003
2020-04-02 05:08:12,127 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689261505331103, ackStatus=SUCCESS)
2020-04-02 05:08:12,131 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:37880, dest: /127.0.0.1:43434, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, duration(ns): 66288473
2020-04-02 05:08:12,132 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE, replyAck=seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,132 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:12,132 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:12,135 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:12,134 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,141 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,141 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741827_1003 on 127.0.0.1:43434 size 65536 replicaState = FINALIZED
2020-04-02 05:08:12,141 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,142 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741827_1003 (size=0)
2020-04-02 05:08:12,142 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741827_1003 is received from 127.0.0.1:43434
2020-04-02 05:08:12,142 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,143 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60286, dest: /127.0.0.1:45739, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, duration(ns): 72126993
2020-04-02 05:08:12,143 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 3 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8982064 flag: 0 flag: 0
2020-04-02 05:08:12,143 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 3 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8982064 flag: 0 flag: 0
2020-04-02 05:08:12,143 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:12,150 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:12,151 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 2
2020-04-02 05:08:12,149 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:56786, dest: /127.0.0.1:44971, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, duration(ns): 91564099
2020-04-02 05:08:12,152 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 3 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 18739215 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,152 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] terminating
2020-04-02 05:08:12,152 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: closing
2020-04-02 05:08:12,156 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56786 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 3
2020-04-02 05:08:12,158 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,158 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,158 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741827_1003 on 127.0.0.1:44971 size 65536 replicaState = FINALIZED
2020-04-02 05:08:12,159 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,159 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741827_1003 (size=0)
2020-04-02 05:08:12,159 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741827_1003 is received from 127.0.0.1:44971
2020-04-02 05:08:12,159 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,159 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741827_1003 on 127.0.0.1:45739 size 65536 replicaState = FINALIZED
2020-04-02 05:08:12,159 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,159 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741827_1003 (size=0)
2020-04-02 05:08:12,159 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741827_1003 is received from 127.0.0.1:45739
2020-04-02 05:08:12,160 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,160 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC1/foo2 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,161 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC1/foo2 with 1 blocks is persisted to the file system
2020-04-02 05:08:12,161 [IPC Server handler 7 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC1/foo2 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,163 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC1/foo2 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:12,163 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC1/foo2, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:12,164 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /TC1/foo2 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003 block size 65536
2020-04-02 05:08:12,164 [IPC Server handler 8 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TC1/foo2	dst=null	perm=null	proto=rpc
2020-04-02 05:08:12,166 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC1/foo2, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:12,167 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC1/foo2, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:blk_1073741827_1003
2020-04-02 05:08:12,177 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC1/foo2  inodeId 16389 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,179 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC1/foo2 with blk_1073741828_1004 block is added to the in-memory file system
2020-04-02 05:08:12,179 [IPC Server handler 9 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741828_1004, replicas=127.0.0.1:44971, 127.0.0.1:43434, 127.0.0.1:45739 for /TC1/foo2
2020-04-02 05:08:12,179 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC1/foo2 with new block blk_1073741828_1004, current total block count is 2
2020-04-02 05:08:12,184 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:12,187 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43434, 127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,187 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,194 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,194 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004 src: /127.0.0.1:56812 dest: /127.0.0.1:44971
2020-04-02 05:08:12,194 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004
 storageType=DISK, inAddr=/127.0.0.1:56812, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:12,195 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741828 of size 0
2020-04-02 05:08:12,195 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741828_1004.meta of size 0
2020-04-02 05:08:12,195 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:12,198 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:12,230 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37904 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,230 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37904 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,231 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37904 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,231 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37904 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004 src: /127.0.0.1:37904 dest: /127.0.0.1:43434
2020-04-02 05:08:12,231 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37904 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004
 storageType=DISK, inAddr=/127.0.0.1:37904, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:12,231 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37904 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741828 of size 0
2020-04-02 05:08:12,232 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37904 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741828_1004.meta of size 0
2020-04-02 05:08:12,232 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37904 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:12,233 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:12,238 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60320 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,238 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60320 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,238 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60320 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,238 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60320 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004 src: /127.0.0.1:60320 dest: /127.0.0.1:45739
2020-04-02 05:08:12,238 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60320 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004
 storageType=DISK, inAddr=/127.0.0.1:60320, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:12,239 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60320 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741828 of size 0
2020-04-02 05:08:12,239 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60320 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741828_1004.meta of size 0
2020-04-02 05:08:12,240 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:12,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:12,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689261649391738, ackStatus=SUCCESS)
2020-04-02 05:08:12,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37904 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:12,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37904 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689261649987311, ackStatus=SUCCESS)
2020-04-02 05:08:12,274 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60320 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:12,275 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60320 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689261653192563, ackStatus=SUCCESS)
2020-04-02 05:08:12,278 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,278 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:12,278 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,280 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6625966 flag: 0 flag: 0
2020-04-02 05:08:12,280 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6625966 flag: 0 flag: 0
2020-04-02 05:08:12,281 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8909416 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,286 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,286 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689261664920257, ackStatus=SUCCESS)
2020-04-02 05:08:12,287 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004
2020-04-02 05:08:12,287 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37904 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,291 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37904 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689261669502398, ackStatus=SUCCESS)
2020-04-02 05:08:12,291 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37904 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004
2020-04-02 05:08:12,294 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60320 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,294 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60320 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004
2020-04-02 05:08:12,294 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60320 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689261672836234, ackStatus=SUCCESS)
2020-04-02 05:08:12,296 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60320, dest: /127.0.0.1:45739, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, duration(ns): 54952598
2020-04-02 05:08:12,297 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,297 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:12,297 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60320 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:12,297 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,310 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60320 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 2
2020-04-02 05:08:12,311 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,311 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:37904, dest: /127.0.0.1:43434, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, duration(ns): 36414042
2020-04-02 05:08:12,312 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,312 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6318353 flag: 0 flag: 0
2020-04-02 05:08:12,312 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] terminating
2020-04-02 05:08:12,312 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741828_1004 on 127.0.0.1:45739 size 32768 replicaState = FINALIZED
2020-04-02 05:08:12,312 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,312 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741828_1004 (size=0)
2020-04-02 05:08:12,312 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741828_1004 is received from 127.0.0.1:45739
2020-04-02 05:08:12,313 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,313 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741828_1004 on 127.0.0.1:43434 size 32768 replicaState = FINALIZED
2020-04-02 05:08:12,313 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,313 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741828_1004 (size=0)
2020-04-02 05:08:12,313 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37904 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: closing
2020-04-02 05:08:12,313 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741828_1004 is received from 127.0.0.1:43434
2020-04-02 05:08:12,316 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,317 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6318353 flag: 0 flag: 0
2020-04-02 05:08:12,314 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37904 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:12,348 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:56812, dest: /127.0.0.1:44971, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, duration(ns): 76846927
2020-04-02 05:08:12,348 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 30134766 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,348 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739] terminating
2020-04-02 05:08:12,349 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]: closing
2020-04-02 05:08:12,353 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 3
2020-04-02 05:08:12,355 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,355 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741828_1004 on 127.0.0.1:44971 size 32768 replicaState = FINALIZED
2020-04-02 05:08:12,355 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,355 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741828_1004 (size=0)
2020-04-02 05:08:12,355 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741828_1004 is received from 127.0.0.1:44971
2020-04-02 05:08:12,355 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,356 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC1/foo2 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,357 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC1/foo2 with 2 blocks is persisted to the file system
2020-04-02 05:08:12,357 [IPC Server handler 0 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC1/foo2 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,368 [IPC Server handler 4 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/TC1/foo2	dst=null	perm=null	proto=rpc
2020-04-02 05:08:12,369 [IPC Server handler 1 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741827_1003, blk_1073741828_1004]
2020-04-02 05:08:12,370 [IPC Server handler 1 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC1/foo2	dst=null	perm=null	proto=rpc
2020-04-02 05:08:12,372 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(242)) - newInfo = LocatedBlocks{;  fileLength=98304;  underConstruction=false;  blocks=[LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003; getBlockSize()=65536; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:44971,DS-9396c1fd-c034-40b5-99a4-7728fe5d066f,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK], DatanodeInfoWithStorage[127.0.0.1:45739,DS-d49b8d06-4514-41da-af7b-faacf4f00b86,DISK]]}, LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004; getBlockSize()=32768; corrupt=false; offset=65536; locs=[DatanodeInfoWithStorage[127.0.0.1:45739,DS-6946cabd-2f8d-451f-81bc-4884ebba8665,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-29df15fa-b2ca-4eca-89df-87135d5e3b76,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004; getBlockSize()=32768; corrupt=false; offset=65536; locs=[DatanodeInfoWithStorage[127.0.0.1:43434,DS-29df15fa-b2ca-4eca-89df-87135d5e3b76,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3,DISK], DatanodeInfoWithStorage[127.0.0.1:45739,DS-6946cabd-2f8d-451f-81bc-4884ebba8665,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-04-02 05:08:12,373 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:12,378 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, replica=FinalizedReplica, blk_1073741827_1003, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741827
2020-04-02 05:08:12,380 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741827_1003, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741827
2020-04-02 05:08:12,381 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:44971, dest: /127.0.0.1:56760, bytes: 66048, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741827_1003, duration(ns): 298726
2020-04-02 05:08:12,443 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:12,444 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:12,445 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, replica=FinalizedReplica, blk_1073741828_1004, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741828
2020-04-02 05:08:12,446 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741828_1004, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741828
2020-04-02 05:08:12,446 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:45739, dest: /127.0.0.1:60328, bytes: 33024, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741828_1004, duration(ns): 267157
[msx] test Finished org.apache.hadoop.hdfs.TestFileAppend3#testTC1ForAppend2
[msx] writeFile testName = org.apache.hadoop.hdfs.TestFileAppend3#testTC1ForAppend2
[msx] succeed
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
[msx] test Started org.apache.hadoop.hdfs.TestFileAppend3#testTC1
[msx] perform reset as unitTestCounterInClass 2 is larger than zero
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
p=/TC1/foo
2020-04-02 05:08:12,457 [main] DEBUG hdfs.DFSClient (DFSClient.java:create(1210)) - /TC1/foo: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-04-02 05:08:12,466 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(757)) - *DIR* NameNode.create: file /TC1/foo for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:12,466 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2385)) - DIR* NameSystem.startFile: src=/TC1/foo, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1, createParent=true, replication=3, createFlag=[CREATE], blockSize=65536, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-04-02 05:08:12,467 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(585)) - DIR* addFile: foo is added
2020-04-02 05:08:12,467 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(416)) - DIR* NameSystem.startFile: added /TC1/foo inode 16390 DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,467 [IPC Server handler 6 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/TC1/foo	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:12,468 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC1/foo, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:12,469 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC1/foo, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:12,470 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC1/foo, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:12,470 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/TC1/foo, packetSize=516, chunksPerPacket=1, bytesCurBlock=64512, DFSOutputStream:block==null
2020-04-02 05:08:12,471 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC1/foo, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:12,471 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=2, src=/TC1/foo, packetSize=516, chunksPerPacket=1, bytesCurBlock=65024, DFSOutputStream:block==null
2020-04-02 05:08:12,471 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC1/foo, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:12,478 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC1/foo  inodeId 16390 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,480 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC1/foo with blk_1073741829_1005 block is added to the in-memory file system
2020-04-02 05:08:12,480 [IPC Server handler 7 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741829_1005, replicas=127.0.0.1:45739, 127.0.0.1:44971, 127.0.0.1:45580 for /TC1/foo
2020-04-02 05:08:12,480 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC1/foo with new block blk_1073741829_1005, current total block count is 1
2020-04-02 05:08:12,482 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:12,498 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:44971, 127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,498 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,498 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,498 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005 src: /127.0.0.1:60330 dest: /127.0.0.1:45739
2020-04-02 05:08:12,498 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005
 storageType=DISK, inAddr=/127.0.0.1:60330, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:12,499 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741829 of size 0
2020-04-02 05:08:12,499 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741829_1005.meta of size 0
2020-04-02 05:08:12,499 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:12,499 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:12,501 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,501 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,501 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,501 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005 src: /127.0.0.1:56834 dest: /127.0.0.1:44971
2020-04-02 05:08:12,501 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005
 storageType=DISK, inAddr=/127.0.0.1:56834, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:12,502 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741829 of size 0
2020-04-02 05:08:12,502 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741829_1005.meta of size 0
2020-04-02 05:08:12,502 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:12,502 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:12,504 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,504 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,504 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,504 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005 src: /127.0.0.1:35100 dest: /127.0.0.1:45580
2020-04-02 05:08:12,504 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005
 storageType=DISK, inAddr=/127.0.0.1:35100, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:12,504 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741829 of size 0
2020-04-02 05:08:12,504 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741829_1005.meta of size 0
2020-04-02 05:08:12,505 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:12,507 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:12,508 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689261886214552, ackStatus=SUCCESS)
2020-04-02 05:08:12,508 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,508 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:12,508 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689261886882730, ackStatus=SUCCESS)
2020-04-02 05:08:12,508 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689261886757644, ackStatus=SUCCESS)
2020-04-02 05:08:12,509 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:12,509 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,509 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689261887525030, ackStatus=SUCCESS)
2020-04-02 05:08:12,509 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,509 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689261887587930, ackStatus=SUCCESS)
2020-04-02 05:08:12,511 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580]: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689261887781932, ackStatus=SUCCESS)
2020-04-02 05:08:12,511 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,511 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689261889967398, ackStatus=SUCCESS)
2020-04-02 05:08:12,512 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,512 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689261890456505, ackStatus=SUCCESS)
2020-04-02 05:08:12,512 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,512 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689261890767319, ackStatus=SUCCESS)
2020-04-02 05:08:12,515 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,516 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,519 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,519 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:12,516 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,530 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7703493 flag: 0 flag: 0
2020-04-02 05:08:12,530 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,530 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 21145517 flag: 0 flag: 0
2020-04-02 05:08:12,531 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,531 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7703493 flag: 0 flag: 0
2020-04-02 05:08:12,531 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 19157692 flag: 0 flag: 0
2020-04-02 05:08:12,532 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 22979977 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,532 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 21145517 flag: 0 flag: 0
2020-04-02 05:08:12,532 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 23755215 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,533 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580] got seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 19157692 flag: 0 flag: 0
2020-04-02 05:08:12,533 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 23391769 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,533 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,533 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580]: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689261911785126, ackStatus=SUCCESS)
2020-04-02 05:08:12,533 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005
2020-04-02 05:08:12,533 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,533 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689261912092269, ackStatus=SUCCESS)
2020-04-02 05:08:12,534 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005
2020-04-02 05:08:12,534 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,534 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005
2020-04-02 05:08:12,534 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689261912495018, ackStatus=SUCCESS)
2020-04-02 05:08:12,542 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35100, dest: /127.0.0.1:45580, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, duration(ns): 35950475
2020-04-02 05:08:12,543 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE, replyAck=seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,543 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:12,543 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,544 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:12,545 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 2
2020-04-02 05:08:12,550 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,550 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741829_1005 on 127.0.0.1:45580 size 65536 replicaState = FINALIZED
2020-04-02 05:08:12,550 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,551 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741829_1005 (size=0)
2020-04-02 05:08:12,551 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741829_1005 is received from 127.0.0.1:45580
2020-04-02 05:08:12,551 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,562 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:56834, dest: /127.0.0.1:44971, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, duration(ns): 39960638
2020-04-02 05:08:12,562 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 3 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9873668 flag: 0 flag: 0
2020-04-02 05:08:12,562 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] terminating
2020-04-02 05:08:12,563 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: closing
2020-04-02 05:08:12,565 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580] got seqno: 3 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9873668 flag: 0 flag: 0
2020-04-02 05:08:12,565 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,569 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741829_1005 on 127.0.0.1:44971 size 65536 replicaState = FINALIZED
2020-04-02 05:08:12,569 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,569 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741829_1005 (size=0)
2020-04-02 05:08:12,569 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741829_1005 is received from 127.0.0.1:44971
2020-04-02 05:08:12,569 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,576 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56834 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 3
2020-04-02 05:08:12,576 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60330, dest: /127.0.0.1:45739, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, duration(ns): 63295502
2020-04-02 05:08:12,577 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580], replyAck=seqno: 3 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 30726425 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,577 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580] terminating
2020-04-02 05:08:12,577 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45580]: closing
2020-04-02 05:08:12,578 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC1/foo for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,584 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,584 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60330 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:12,584 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC1/foo with 1 blocks is persisted to the file system
2020-04-02 05:08:12,584 [IPC Server handler 5 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC1/foo is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,584 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741829_1005
2020-04-02 05:08:12,585 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741829_1005 on 127.0.0.1:45739 size 65536 replicaState = FINALIZED
2020-04-02 05:08:12,585 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:12,585 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741829_1005 (size=65536)
2020-04-02 05:08:12,585 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741829_1005 is received from 127.0.0.1:45739
2020-04-02 05:08:12,585 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,589 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC1/foo for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:12,589 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC1/foo, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:12,590 [IPC Server handler 2 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TC1/foo	dst=null	perm=null	proto=rpc
2020-04-02 05:08:12,591 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC1/foo, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:12,598 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC1/foo, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:12,600 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC1/foo  inodeId 16390 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,601 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:analyzeFileState(641)) - BLOCK* NameSystem.allocateBlock: handling block allocation writing to a file with a complete previous block: src=/TC1/foo lastBlock=blk_1073741829_1005
2020-04-02 05:08:12,602 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:analyzeFileState(641)) - BLOCK* NameSystem.allocateBlock: handling block allocation writing to a file with a complete previous block: src=/TC1/foo lastBlock=blk_1073741829_1005
2020-04-02 05:08:12,602 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC1/foo with blk_1073741830_1006 block is added to the in-memory file system
2020-04-02 05:08:12,602 [IPC Server handler 0 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741830_1006, replicas=127.0.0.1:45580, 127.0.0.1:43230, 127.0.0.1:45739 for /TC1/foo
2020-04-02 05:08:12,602 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC1/foo with new block blk_1073741830_1006, current total block count is 2
2020-04-02 05:08:12,604 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:12,606 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43230, 127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,606 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,606 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,606 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006 src: /127.0.0.1:35110 dest: /127.0.0.1:45580
2020-04-02 05:08:12,606 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006
 storageType=DISK, inAddr=/127.0.0.1:35110, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:12,606 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741830 of size 0
2020-04-02 05:08:12,607 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741830_1006.meta of size 0
2020-04-02 05:08:12,607 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43230
2020-04-02 05:08:12,608 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@4a9f80d3] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:12,609 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,610 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,610 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,610 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006 src: /127.0.0.1:56998 dest: /127.0.0.1:43230
2020-04-02 05:08:12,610 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006
 storageType=DISK, inAddr=/127.0.0.1:56998, myAddr=/127.0.0.1:43230
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43230
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9e64160f-8239-40bc-b495-871e2ebb5a3a
2020-04-02 05:08:12,610 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741830 of size 0
2020-04-02 05:08:12,610 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741830_1006.meta of size 0
2020-04-02 05:08:12,611 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:12,611 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:12,618 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60348 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,618 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60348 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,618 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60348 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,618 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60348 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006 src: /127.0.0.1:60348 dest: /127.0.0.1:45739
2020-04-02 05:08:12,618 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60348 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006
 storageType=DISK, inAddr=/127.0.0.1:60348, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:12,619 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60348 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741830 of size 0
2020-04-02 05:08:12,619 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60348 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741830_1006.meta of size 0
2020-04-02 05:08:12,619 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:12,625 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:12,625 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689262003979495, ackStatus=SUCCESS)
2020-04-02 05:08:12,626 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:12,626 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689262004617597, ackStatus=SUCCESS)
2020-04-02 05:08:12,627 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60348 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:12,627 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60348 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689262005542880, ackStatus=SUCCESS)
2020-04-02 05:08:12,635 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,635 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,636 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:12,638 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9338526 flag: 0 flag: 0
2020-04-02 05:08:12,638 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:45739] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9338526 flag: 0 flag: 0
2020-04-02 05:08:12,641 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 12266804 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,642 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,642 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689262020452144, ackStatus=SUCCESS)
2020-04-02 05:08:12,642 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006
2020-04-02 05:08:12,642 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,642 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689262020864834, ackStatus=SUCCESS)
2020-04-02 05:08:12,642 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006
2020-04-02 05:08:12,643 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60348 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,643 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60348 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006
2020-04-02 05:08:12,643 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60348 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689262021300682, ackStatus=SUCCESS)
2020-04-02 05:08:12,650 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60348, dest: /127.0.0.1:45739, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, duration(ns): 29524198
2020-04-02 05:08:12,651 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,651 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:12,651 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,651 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60348 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:12,655 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60348 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:12,655 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:56998, dest: /127.0.0.1:43230, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, duration(ns): 32822038
2020-04-02 05:08:12,656 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8465698 flag: 0 flag: 0
2020-04-02 05:08:12,656 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] terminating
2020-04-02 05:08:12,657 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: closing
2020-04-02 05:08:12,658 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:45739] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8465698 flag: 0 flag: 0
2020-04-02 05:08:12,659 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,660 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,660 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43230:Number of active connections is: 2
2020-04-02 05:08:12,665 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741830_1006 on 127.0.0.1:45739 size 32768 replicaState = FINALIZED
2020-04-02 05:08:12,668 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35110, dest: /127.0.0.1:45580, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, duration(ns): 35746284
2020-04-02 05:08:12,669 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,669 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741830_1006 (size=0)
2020-04-02 05:08:12,669 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 15660913 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,669 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:45739] terminating
2020-04-02 05:08:12,670 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,669 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741830_1006 is received from 127.0.0.1:45739
2020-04-02 05:08:12,670 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,670 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741830_1006 on 127.0.0.1:43230 size 32768 replicaState = FINALIZED
2020-04-02 05:08:12,670 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,671 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43230 is added to blk_1073741830_1006 (size=0)
2020-04-02 05:08:12,671 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741830_1006 is received from 127.0.0.1:43230
2020-04-02 05:08:12,671 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43230 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,671 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741830_1006 on 127.0.0.1:45580 size 32768 replicaState = FINALIZED
2020-04-02 05:08:12,671 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,671 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741830_1006 (size=0)
2020-04-02 05:08:12,671 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741830_1006 is received from 127.0.0.1:45580
2020-04-02 05:08:12,671 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,670 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43230, 127.0.0.1:45739]: closing
2020-04-02 05:08:12,671 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 2
2020-04-02 05:08:12,674 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC1/foo for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,675 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC1/foo with 2 blocks is persisted to the file system
2020-04-02 05:08:12,675 [IPC Server handler 7 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC1/foo is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,678 [IPC Server handler 8 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/TC1/foo	dst=null	perm=null	proto=rpc
2020-04-02 05:08:12,680 [IPC Server handler 9 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741829_1005, blk_1073741830_1006]
2020-04-02 05:08:12,680 [IPC Server handler 9 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC1/foo	dst=null	perm=null	proto=rpc
2020-04-02 05:08:12,683 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(242)) - newInfo = LocatedBlocks{;  fileLength=98304;  underConstruction=false;  blocks=[LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005; getBlockSize()=65536; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:45580,DS-089629a9-5898-4562-bd81-79a4f45c96c1,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-9396c1fd-c034-40b5-99a4-7728fe5d066f,DISK], DatanodeInfoWithStorage[127.0.0.1:45739,DS-d49b8d06-4514-41da-af7b-faacf4f00b86,DISK]]}, LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006; getBlockSize()=32768; corrupt=false; offset=65536; locs=[DatanodeInfoWithStorage[127.0.0.1:45580,DS-2d1f4083-d7c8-4136-8351-6f589a4451bd,DISK], DatanodeInfoWithStorage[127.0.0.1:45739,DS-6946cabd-2f8d-451f-81bc-4884ebba8665,DISK], DatanodeInfoWithStorage[127.0.0.1:43230,DS-5ce71111-7ef9-40e4-bd53-df33411df409,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006; getBlockSize()=32768; corrupt=false; offset=65536; locs=[DatanodeInfoWithStorage[127.0.0.1:43230,DS-5ce71111-7ef9-40e4-bd53-df33411df409,DISK], DatanodeInfoWithStorage[127.0.0.1:45739,DS-6946cabd-2f8d-451f-81bc-4884ebba8665,DISK], DatanodeInfoWithStorage[127.0.0.1:45580,DS-2d1f4083-d7c8-4136-8351-6f589a4451bd,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-04-02 05:08:12,686 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:12,690 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:12,691 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35120 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, replica=FinalizedReplica, blk_1073741829_1005, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741829
2020-04-02 05:08:12,691 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35120 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741829_1005, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741829
2020-04-02 05:08:12,692 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35120 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:45580, dest: /127.0.0.1:35120, bytes: 66048, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741829_1005, duration(ns): 284692
2020-04-02 05:08:12,710 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:12,711 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35120 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, replica=FinalizedReplica, blk_1073741830_1006, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741830
2020-04-02 05:08:12,712 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35120 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741830_1006, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741830
2020-04-02 05:08:12,713 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35120 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:45580, dest: /127.0.0.1:35120, bytes: 33024, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741830_1006, duration(ns): 286299
[msx] test Finished org.apache.hadoop.hdfs.TestFileAppend3#testTC1
[msx] writeFile testName = org.apache.hadoop.hdfs.TestFileAppend3#testTC1
[msx] succeed
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
[msx] test Started org.apache.hadoop.hdfs.TestFileAppend3#testTC2
[msx] perform reset as unitTestCounterInClass 3 is larger than zero
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
p=/TC2/foo
2020-04-02 05:08:12,727 [main] DEBUG hdfs.DFSClient (DFSClient.java:create(1210)) - /TC2/foo: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-04-02 05:08:12,729 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(757)) - *DIR* NameNode.create: file /TC2/foo for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:12,729 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2385)) - DIR* NameSystem.startFile: src=/TC2/foo, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1, createParent=true, replication=3, createFlag=[CREATE], blockSize=65536, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-04-02 05:08:12,729 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirMkdirOp.java:createSingleDirectory(182)) - mkdirs: created directory /TC2
2020-04-02 05:08:12,730 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(585)) - DIR* addFile: foo is added
2020-04-02 05:08:12,730 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(416)) - DIR* NameSystem.startFile: added /TC2/foo inode 16392 DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,730 [IPC Server handler 3 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/TC2/foo	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:12,731 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC2/foo, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:12,733 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC2/foo, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:12,733 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC2/foo, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:12,733 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/TC2/foo, packetSize=516, chunksPerPacket=1, bytesCurBlock=64512, DFSOutputStream:block==null
2020-04-02 05:08:12,733 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC2/foo, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:12,734 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=2, src=/TC2/foo, packetSize=516, chunksPerPacket=1, bytesCurBlock=65024, DFSOutputStream:block==null
2020-04-02 05:08:12,734 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC2/foo, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:12,734 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=4, src=/TC2/foo, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:12,734 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC2/foo, chunkSize=516, chunksPerPacket=125, packetSize=64500
2020-04-02 05:08:12,734 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=5, src=/TC2/foo, packetSize=64500, chunksPerPacket=125, bytesCurBlock=512, DFSOutputStream:block==null
2020-04-02 05:08:12,739 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC2/foo  inodeId 16392 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,741 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC2/foo with blk_1073741831_1007 block is added to the in-memory file system
2020-04-02 05:08:12,741 [IPC Server handler 5 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741831_1007, replicas=127.0.0.1:45580, 127.0.0.1:45739, 127.0.0.1:44971 for /TC2/foo
2020-04-02 05:08:12,742 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC2/foo with new block blk_1073741831_1007, current total block count is 1
2020-04-02 05:08:12,744 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:12,745 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45739, 127.0.0.1:44971]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,745 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,745 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,745 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007 src: /127.0.0.1:35128 dest: /127.0.0.1:45580
2020-04-02 05:08:12,745 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007
 storageType=DISK, inAddr=/127.0.0.1:35128, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:12,746 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741831 of size 0
2020-04-02 05:08:12,746 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741831_1007.meta of size 0
2020-04-02 05:08:12,746 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:12,746 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:12,748 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:44971]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,748 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,748 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,748 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007 src: /127.0.0.1:60364 dest: /127.0.0.1:45739
2020-04-02 05:08:12,748 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007
 storageType=DISK, inAddr=/127.0.0.1:60364, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:12,748 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741831 of size 0
2020-04-02 05:08:12,749 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741831_1007.meta of size 0
2020-04-02 05:08:12,749 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:12,749 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:12,750 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,750 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,750 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,750 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007 src: /127.0.0.1:56868 dest: /127.0.0.1:44971
2020-04-02 05:08:12,750 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007
 storageType=DISK, inAddr=/127.0.0.1:56868, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:12,751 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741831 of size 0
2020-04-02 05:08:12,751 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741831_1007.meta of size 0
2020-04-02 05:08:12,751 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:12,767 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:12,768 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689262146104810, ackStatus=SUCCESS)
2020-04-02 05:08:12,768 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:12,768 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689262146980468, ackStatus=SUCCESS)
2020-04-02 05:08:12,769 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:12,770 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689262148179052, ackStatus=SUCCESS)
2020-04-02 05:08:12,794 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,794 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689262172418730, ackStatus=SUCCESS)
2020-04-02 05:08:12,799 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,799 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,799 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689262177440108, ackStatus=SUCCESS)
2020-04-02 05:08:12,799 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689262177537963, ackStatus=SUCCESS)
2020-04-02 05:08:12,806 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,806 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,806 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689262184813089, ackStatus=SUCCESS)
2020-04-02 05:08:12,806 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689262184886469, ackStatus=SUCCESS)
2020-04-02 05:08:12,806 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,807 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,807 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:12,806 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,807 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,811 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689262189106600, ackStatus=SUCCESS)
2020-04-02 05:08:12,811 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,811 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:12,813 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 37906001 flag: 0 flag: 0
2020-04-02 05:08:12,813 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 37906001 flag: 0 flag: 0
2020-04-02 05:08:12,820 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,820 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 45633048 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,821 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 20804691 flag: 0 flag: 0
2020-04-02 05:08:12,821 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 26851711 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,821 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 20804691 flag: 0 flag: 0
2020-04-02 05:08:12,821 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,821 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 14928192 flag: 0 flag: 0
2020-04-02 05:08:12,823 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971] got seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 14928192 flag: 0 flag: 0
2020-04-02 05:08:12,824 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 22621162 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,829 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,829 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689262208046726, ackStatus=SUCCESS)
2020-04-02 05:08:12,830 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007
2020-04-02 05:08:12,832 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,832 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689262210463370, ackStatus=SUCCESS)
2020-04-02 05:08:12,832 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,832 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007
2020-04-02 05:08:12,832 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689262210949859, ackStatus=SUCCESS)
2020-04-02 05:08:12,833 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007
2020-04-02 05:08:12,834 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:56868, dest: /127.0.0.1:44971, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, duration(ns): 81076898
2020-04-02 05:08:12,835 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE, replyAck=seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,835 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:12,835 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,835 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:12,840 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60364, dest: /127.0.0.1:45739, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, duration(ns): 81395800
2020-04-02 05:08:12,840 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 3 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3182287 flag: 0 flag: 0
2020-04-02 05:08:12,841 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] terminating
2020-04-02 05:08:12,842 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971] got seqno: 3 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3182287 flag: 0 flag: 0
2020-04-02 05:08:12,842 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35128, dest: /127.0.0.1:45580, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, duration(ns): 87597824
2020-04-02 05:08:12,843 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,843 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741831_1007 on 127.0.0.1:45739 size 65536 replicaState = FINALIZED
2020-04-02 05:08:12,843 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,843 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741831_1007 (size=0)
2020-04-02 05:08:12,844 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: closing
2020-04-02 05:08:12,845 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56868 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 3
2020-04-02 05:08:12,845 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60364 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:12,845 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741831_1007 is received from 127.0.0.1:45739
2020-04-02 05:08:12,845 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,842 [IPC Server handler 2 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,846 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741831_1007 on 127.0.0.1:44971 size 65536 replicaState = FINALIZED
2020-04-02 05:08:12,846 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,846 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741831_1007 (size=0)
2020-04-02 05:08:12,846 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741831_1007 is received from 127.0.0.1:44971
2020-04-02 05:08:12,846 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,843 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971], replyAck=seqno: 3 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 12174549 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,846 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971] terminating
2020-04-02 05:08:12,846 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]: closing
2020-04-02 05:08:12,847 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35128 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:12,847 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC2/foo  inodeId 16392 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,848 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC2/foo with blk_1073741832_1008 block is added to the in-memory file system
2020-04-02 05:08:12,848 [IPC Server handler 4 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741832_1008, replicas=127.0.0.1:43230, 127.0.0.1:43434, 127.0.0.1:44971 for /TC2/foo
2020-04-02 05:08:12,848 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC2/foo with new block blk_1073741832_1008, current total block count is 2
2020-04-02 05:08:12,850 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,850 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741831_1007
2020-04-02 05:08:12,850 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741831_1007 on 127.0.0.1:45580 size 65536 replicaState = FINALIZED
2020-04-02 05:08:12,851 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:12,851 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741831_1007 (size=65536)
2020-04-02 05:08:12,851 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741831_1007 is received from 127.0.0.1:45580
2020-04-02 05:08:12,851 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,855 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@4a9f80d3] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:12,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43434, 127.0.0.1:44971]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008 src: /127.0.0.1:57030 dest: /127.0.0.1:43230
2020-04-02 05:08:12,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008
 storageType=DISK, inAddr=/127.0.0.1:57030, myAddr=/127.0.0.1:43230
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43230
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9e64160f-8239-40bc-b495-871e2ebb5a3a
2020-04-02 05:08:12,857 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741832 of size 0
2020-04-02 05:08:12,857 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741832_1008.meta of size 0
2020-04-02 05:08:12,857 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:12,857 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:12,858 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:44971]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,858 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,859 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,859 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008 src: /127.0.0.1:37974 dest: /127.0.0.1:43434
2020-04-02 05:08:12,859 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008
 storageType=DISK, inAddr=/127.0.0.1:37974, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:12,859 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741832 of size 0
2020-04-02 05:08:12,860 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741832_1008.meta of size 0
2020-04-02 05:08:12,860 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:12,860 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:12,862 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:12,862 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:12,862 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:12,862 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008 src: /127.0.0.1:56886 dest: /127.0.0.1:44971
2020-04-02 05:08:12,862 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008
 storageType=DISK, inAddr=/127.0.0.1:56886, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:12,862 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741832 of size 0
2020-04-02 05:08:12,862 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741832_1008.meta of size 0
2020-04-02 05:08:12,863 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:12,892 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 4
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,892 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]: enqueue Packet(seqno=4, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=689262270321501, ackStatus=SUCCESS)
2020-04-02 05:08:12,892 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 4
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,892 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=4, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=689262270953861, ackStatus=SUCCESS)
2020-04-02 05:08:12,893 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008: PacketHeader with packetLen=32512 header data: offsetInBlock: 512
seqno: 5
lastPacketInBlock: false
dataLen: 32256

2020-04-02 05:08:12,893 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 4
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:12,893 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]: enqueue Packet(seqno=5, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689262271380704, ackStatus=SUCCESS)
2020-04-02 05:08:12,893 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE: enqueue Packet(seqno=4, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=689262271601630, ackStatus=SUCCESS)
2020-04-02 05:08:12,893 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008: PacketHeader with packetLen=32512 header data: offsetInBlock: 512
seqno: 5
lastPacketInBlock: false
dataLen: 32256

2020-04-02 05:08:12,894 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=5, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689262272213968, ackStatus=SUCCESS)
2020-04-02 05:08:12,894 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008: PacketHeader with packetLen=32512 header data: offsetInBlock: 512
seqno: 5
lastPacketInBlock: false
dataLen: 32256

2020-04-02 05:08:12,896 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE: enqueue Packet(seqno=5, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689262274212309, ackStatus=SUCCESS)
2020-04-02 05:08:12,896 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE, replyAck=seqno: 4 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,896 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 4 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,896 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE, replyAck=seqno: 5 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,896 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:12,898 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 4 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3474947 flag: 0 flag: 0
2020-04-02 05:08:12,898 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 5 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,898 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 5 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 4447642 flag: 0 flag: 0
2020-04-02 05:08:12,899 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971] got seqno: 4 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3474947 flag: 0 flag: 0
2020-04-02 05:08:12,900 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971], replyAck=seqno: 4 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6886607 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,901 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971] got seqno: 5 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 4447642 flag: 0 flag: 0
2020-04-02 05:08:12,901 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971], replyAck=seqno: 5 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7726249 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,902 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 6
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,902 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]: enqueue Packet(seqno=6, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689262280619643, ackStatus=SUCCESS)
2020-04-02 05:08:12,902 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008
2020-04-02 05:08:12,902 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 6
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,903 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=6, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689262281138619, ackStatus=SUCCESS)
2020-04-02 05:08:12,903 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 6
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:12,903 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008
2020-04-02 05:08:12,903 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE: enqueue Packet(seqno=6, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689262281521630, ackStatus=SUCCESS)
2020-04-02 05:08:12,903 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008
2020-04-02 05:08:12,906 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,906 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:56886, dest: /127.0.0.1:44971, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, duration(ns): 40141766
2020-04-02 05:08:12,907 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741832_1008 on 127.0.0.1:44971 size 32768 replicaState = FINALIZED
2020-04-02 05:08:12,907 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,907 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE, replyAck=seqno: 6 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,907 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741832_1008 (size=0)
2020-04-02 05:08:12,907 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:12,907 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:12,907 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741832_1008 is received from 127.0.0.1:44971
2020-04-02 05:08:12,907 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,907 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56886 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 3
2020-04-02 05:08:12,908 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 6 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:12,916 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:37974, dest: /127.0.0.1:43434, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, duration(ns): 44816916
2020-04-02 05:08:12,917 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 6 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 5321309 flag: 0 flag: 0
2020-04-02 05:08:12,917 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] terminating
2020-04-02 05:08:12,917 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: closing
2020-04-02 05:08:12,917 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971] got seqno: 6 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 5321309 flag: 0 flag: 0
2020-04-02 05:08:12,917 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37974 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:12,918 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,919 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741832_1008 on 127.0.0.1:43434 size 32768 replicaState = FINALIZED
2020-04-02 05:08:12,919 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,921 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741832_1008 (size=0)
2020-04-02 05:08:12,921 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741832_1008 is received from 127.0.0.1:43434
2020-04-02 05:08:12,921 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57030, dest: /127.0.0.1:43230, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, duration(ns): 39900249
2020-04-02 05:08:12,921 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,922 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971], replyAck=seqno: 6 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 14868900 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:12,926 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971] terminating
2020-04-02 05:08:12,927 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]: closing
2020-04-02 05:08:12,927 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:12,927 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57030 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43230:Number of active connections is: 2
2020-04-02 05:08:12,927 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741832_1008 on 127.0.0.1:43230 size 32768 replicaState = FINALIZED
2020-04-02 05:08:12,928 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:12,928 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43230 is added to blk_1073741832_1008 (size=0)
2020-04-02 05:08:12,928 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741832_1008 is received from 127.0.0.1:43230
2020-04-02 05:08:12,928 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43230 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:12,942 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC2/foo for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,943 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC2/foo with 2 blocks is persisted to the file system
2020-04-02 05:08:12,943 [IPC Server handler 9 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC2/foo is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:12,947 [IPC Server handler 3 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/TC2/foo	dst=null	perm=null	proto=rpc
2020-04-02 05:08:12,950 [IPC Server handler 5 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741831_1007, blk_1073741832_1008]
2020-04-02 05:08:12,950 [IPC Server handler 5 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC2/foo	dst=null	perm=null	proto=rpc
2020-04-02 05:08:12,953 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(242)) - newInfo = LocatedBlocks{;  fileLength=98304;  underConstruction=false;  blocks=[LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007; getBlockSize()=65536; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:45580,DS-089629a9-5898-4562-bd81-79a4f45c96c1,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3,DISK], DatanodeInfoWithStorage[127.0.0.1:45739,DS-d49b8d06-4514-41da-af7b-faacf4f00b86,DISK]]}, LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008; getBlockSize()=32768; corrupt=false; offset=65536; locs=[DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK], DatanodeInfoWithStorage[127.0.0.1:43230,DS-9e64160f-8239-40bc-b495-871e2ebb5a3a,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-9396c1fd-c034-40b5-99a4-7728fe5d066f,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008; getBlockSize()=32768; corrupt=false; offset=65536; locs=[DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK], DatanodeInfoWithStorage[127.0.0.1:43230,DS-9e64160f-8239-40bc-b495-871e2ebb5a3a,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-9396c1fd-c034-40b5-99a4-7728fe5d066f,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-04-02 05:08:12,953 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:12,956 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35120 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, replica=FinalizedReplica, blk_1073741831_1007, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741831
2020-04-02 05:08:12,956 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35120 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741831_1007, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741831
2020-04-02 05:08:12,957 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35120 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:45580, dest: /127.0.0.1:35120, bytes: 66048, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, duration(ns): 248609
2020-04-02 05:08:12,984 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:12,986 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37840 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, replica=FinalizedReplica, blk_1073741832_1008, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741832
2020-04-02 05:08:12,986 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37840 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741832_1008, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741832
2020-04-02 05:08:12,987 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37840 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:43434, dest: /127.0.0.1:37840, bytes: 33024, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, duration(ns): 265344
2020-04-02 05:08:12,995 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC2/foo for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:12,995 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC2/foo, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:13,005 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /TC2/foo for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008 block size 32768
2020-04-02 05:08:13,005 [IPC Server handler 0 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TC2/foo	dst=null	perm=null	proto=rpc
2020-04-02 05:08:13,007 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC2/foo, chunkSize=516, chunksPerPacket=63, packetSize=32508
2020-04-02 05:08:13,007 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC2/foo, packetSize=32508, chunksPerPacket=63, bytesCurBlock=32768, DFSOutputStream:blk_1073741832_1008
2020-04-02 05:08:13,027 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:13,038 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, newGs=1009, bytesRcvd=[32768, 32768]
  targets=[127.0.0.1:43434, 127.0.0.1:43230]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:13,038 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:13,038 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:13,038 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008 src: /127.0.0.1:56910 dest: /127.0.0.1:44971
2020-04-02 05:08:13,039 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008
 storageType=DISK, inAddr=/127.0.0.1:56910, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_APPEND, newGs=1009, minBytesRcvd=32768, maxBytesRcvd=32768
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:13,039 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741832_1008, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741832
2020-04-02 05:08:13,095 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741832 of size 32768
2020-04-02 05:08:13,095 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741832_1009.meta of size 263
2020-04-02 05:08:13,096 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:13,098 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:13,099 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, newGs=1009, bytesRcvd=[32768, 32768]
  targets=[127.0.0.1:43230]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:13,099 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:13,099 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:13,099 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008 src: /127.0.0.1:38008 dest: /127.0.0.1:43434
2020-04-02 05:08:13,099 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008
 storageType=DISK, inAddr=/127.0.0.1:38008, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1009, minBytesRcvd=32768, maxBytesRcvd=32768
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:13,099 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741832_1008, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741832
2020-04-02 05:08:13,129 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741832 of size 32768
2020-04-02 05:08:13,130 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741832_1009.meta of size 263
2020-04-02 05:08:13,130 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43230
2020-04-02 05:08:13,130 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@4a9f80d3] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:13,131 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008, newGs=1009, bytesRcvd=[32768, 32768]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:13,131 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:13,131 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:13,131 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008 src: /127.0.0.1:57072 dest: /127.0.0.1:43230
2020-04-02 05:08:13,132 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008
 storageType=DISK, inAddr=/127.0.0.1:57072, myAddr=/127.0.0.1:43230
 stage=PIPELINE_SETUP_APPEND, newGs=1009, minBytesRcvd=32768, maxBytesRcvd=32768
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43230
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9e64160f-8239-40bc-b495-871e2ebb5a3a
2020-04-02 05:08:13,132 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741832_1008, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741832
2020-04-02 05:08:13,166 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741832 of size 32768
2020-04-02 05:08:13,166 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741832_1009.meta of size 263
2020-04-02 05:08:13,167 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:13,175 [IPC Server handler 4 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741832_1008, newGS=1009, newLength=32768, newNodes=[127.0.0.1:44971, 127.0.0.1:43434, 127.0.0.1:43230], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:13,176 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741832_1009 from 127.0.0.1:44971
2020-04-02 05:08:13,178 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-9396c1fd-c034-40b5-99a4-7728fe5d066f:NORMAL:127.0.0.1:44971|RBW] of blk_1073741832_1008
2020-04-02 05:08:13,178 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741832_1009 from 127.0.0.1:43434
2020-04-02 05:08:13,178 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e:NORMAL:127.0.0.1:43434|RBW] of blk_1073741832_1008
2020-04-02 05:08:13,178 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741832_1009 from 127.0.0.1:43230
2020-04-02 05:08:13,178 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-9e64160f-8239-40bc-b495-871e2ebb5a3a:NORMAL:127.0.0.1:43230|RBW] of blk_1073741832_1008
2020-04-02 05:08:13,180 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /TC2/foo with 2 blocks is persisted to the file system
2020-04-02 05:08:13,180 [IPC Server handler 4 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741832_1008 => blk_1073741832_1009) success
2020-04-02 05:08:13,186 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009: PacketHeader with packetLen=16516 header data: offsetInBlock: 32768
seqno: 0
lastPacketInBlock: false
dataLen: 16384

2020-04-02 05:08:13,186 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:43230]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=49152, ackEnqueueNanoTime=689262564785302, ackStatus=SUCCESS)
2020-04-02 05:08:13,187 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009: PacketHeader with packetLen=16516 header data: offsetInBlock: 32768
seqno: 0
lastPacketInBlock: false
dataLen: 16384

2020-04-02 05:08:13,187 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=49152, ackEnqueueNanoTime=689262565723554, ackStatus=SUCCESS)
2020-04-02 05:08:13,188 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009: PacketHeader with packetLen=16516 header data: offsetInBlock: 32768
seqno: 0
lastPacketInBlock: false
dataLen: 16384

2020-04-02 05:08:13,188 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=49152, ackEnqueueNanoTime=689262566437939, ackStatus=SUCCESS)
2020-04-02 05:08:13,192 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,192 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:13,194 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,196 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7039583 flag: 0 flag: 0
2020-04-02 05:08:13,202 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:43230] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7039583 flag: 0 flag: 0
2020-04-02 05:08:13,203 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:43230], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 15521515 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:13,216 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-04-02 05:08:13,218 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009: PacketHeader with packetLen=4 header data: offsetInBlock: 49152
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:13,218 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:43230]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=49152, ackEnqueueNanoTime=689262596696026, ackStatus=SUCCESS)
2020-04-02 05:08:13,218 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009
2020-04-02 05:08:13,219 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009: PacketHeader with packetLen=4 header data: offsetInBlock: 49152
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:13,219 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=49152, ackEnqueueNanoTime=689262597286809, ackStatus=SUCCESS)
2020-04-02 05:08:13,219 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009: PacketHeader with packetLen=4 header data: offsetInBlock: 49152
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:13,219 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009
2020-04-02 05:08:13,219 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=49152, ackEnqueueNanoTime=689262597770475, ackStatus=SUCCESS)
2020-04-02 05:08:13,219 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009
2020-04-02 05:08:13,222 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57072, dest: /127.0.0.1:43230, bytes: 49152, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, duration(ns): 53680172
2020-04-02 05:08:13,222 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,222 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:13,222 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:13,222 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,222 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43230:Number of active connections is: 2
2020-04-02 05:08:13,224 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38008, dest: /127.0.0.1:43434, bytes: 49152, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, duration(ns): 53102794
2020-04-02 05:08:13,225 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3339669 flag: 0 flag: 0
2020-04-02 05:08:13,225 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230] terminating
2020-04-02 05:08:13,225 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:43230] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3339669 flag: 0 flag: 0
2020-04-02 05:08:13,225 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]: closing
2020-04-02 05:08:13,238 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38008 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:13,240 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:43230]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:56910, dest: /127.0.0.1:44971, bytes: 49152, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, duration(ns): 66727410
2020-04-02 05:08:13,245 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:13,245 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:43230], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6614234 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:13,245 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741832_1009 on 127.0.0.1:43230 size 49152 replicaState = FINALIZED
2020-04-02 05:08:13,245 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:43230]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:43230] terminating
2020-04-02 05:08:13,245 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:13,245 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:13,246 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:13,246 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43230 is added to blk_1073741832_1009 (size=32768)
2020-04-02 05:08:13,246 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741832_1009 is received from 127.0.0.1:43230
2020-04-02 05:08:13,246 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:43230]: closing
2020-04-02 05:08:13,246 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56910 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1008]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 3
2020-04-02 05:08:13,246 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43230 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:13,247 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741832_1009 on 127.0.0.1:44971 size 49152 replicaState = FINALIZED
2020-04-02 05:08:13,247 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:13,247 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741832_1009 (size=32768)
2020-04-02 05:08:13,247 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741832_1009 is received from 127.0.0.1:44971
2020-04-02 05:08:13,247 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:13,247 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741832_1009 on 127.0.0.1:43434 size 49152 replicaState = FINALIZED
2020-04-02 05:08:13,247 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:13,248 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741832_1009 (size=32768)
2020-04-02 05:08:13,248 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741832_1009 is received from 127.0.0.1:43434
2020-04-02 05:08:13,248 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:13,248 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC2/foo for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:13,248 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC2/foo with 2 blocks is persisted to the file system
2020-04-02 05:08:13,249 [IPC Server handler 8 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC2/foo is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:13,253 [IPC Server handler 9 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/TC2/foo	dst=null	perm=null	proto=rpc
2020-04-02 05:08:13,257 [IPC Server handler 3 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741831_1007, blk_1073741832_1009]
2020-04-02 05:08:13,257 [IPC Server handler 3 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC2/foo	dst=null	perm=null	proto=rpc
2020-04-02 05:08:13,260 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(242)) - newInfo = LocatedBlocks{;  fileLength=114688;  underConstruction=false;  blocks=[LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007; getBlockSize()=65536; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:45739,DS-d49b8d06-4514-41da-af7b-faacf4f00b86,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3,DISK], DatanodeInfoWithStorage[127.0.0.1:45580,DS-089629a9-5898-4562-bd81-79a4f45c96c1,DISK]]}, LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009; getBlockSize()=49152; corrupt=false; offset=65536; locs=[DatanodeInfoWithStorage[127.0.0.1:44971,DS-9396c1fd-c034-40b5-99a4-7728fe5d066f,DISK], DatanodeInfoWithStorage[127.0.0.1:43230,DS-9e64160f-8239-40bc-b495-871e2ebb5a3a,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009; getBlockSize()=49152; corrupt=false; offset=65536; locs=[DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK], DatanodeInfoWithStorage[127.0.0.1:43230,DS-9e64160f-8239-40bc-b495-871e2ebb5a3a,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-9396c1fd-c034-40b5-99a4-7728fe5d066f,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-04-02 05:08:13,260 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:13,262 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, replica=FinalizedReplica, blk_1073741831_1007, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741831
2020-04-02 05:08:13,262 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741831_1007, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741831
2020-04-02 05:08:13,263 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:45739, dest: /127.0.0.1:60328, bytes: 66048, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741831_1007, duration(ns): 301947
2020-04-02 05:08:13,276 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:13,278 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, replica=FinalizedReplica, blk_1073741832_1009, FINALIZED
  getNumBytes()     = 49152
  getBytesOnDisk()  = 49152
  getVisibleLength()= 49152
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741832
2020-04-02 05:08:13,278 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741832_1009, FINALIZED
  getNumBytes()     = 49152
  getBytesOnDisk()  = 49152
  getVisibleLength()= 49152
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741832
2020-04-02 05:08:13,279 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:44971, dest: /127.0.0.1:56760, bytes: 49536, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741832_1009, duration(ns): 261888
[msx] test Finished org.apache.hadoop.hdfs.TestFileAppend3#testTC2
[msx] writeFile testName = org.apache.hadoop.hdfs.TestFileAppend3#testTC2
[msx] succeed
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
[msx] test Started org.apache.hadoop.hdfs.TestFileAppend3#testTC5
[msx] perform reset as unitTestCounterInClass 4 is larger than zero
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
p=/TC5/foo
2020-04-02 05:08:13,291 [main] DEBUG hdfs.DFSClient (DFSClient.java:create(1210)) - /TC5/foo: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-04-02 05:08:13,292 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(757)) - *DIR* NameNode.create: file /TC5/foo for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:13,292 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2385)) - DIR* NameSystem.startFile: src=/TC5/foo, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1, createParent=true, replication=3, createFlag=[CREATE], blockSize=65536, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-04-02 05:08:13,293 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirMkdirOp.java:createSingleDirectory(182)) - mkdirs: created directory /TC5
2020-04-02 05:08:13,293 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(585)) - DIR* addFile: foo is added
2020-04-02 05:08:13,293 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(416)) - DIR* NameSystem.startFile: added /TC5/foo inode 16394 DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:13,294 [IPC Server handler 5 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/TC5/foo	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:13,295 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC5/foo, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:13,296 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC5/foo, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:13,297 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:13,298 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC5/foo  inodeId 16394 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:13,301 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC5/foo with blk_1073741833_1010 block is added to the in-memory file system
2020-04-02 05:08:13,302 [IPC Server handler 0 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741833_1010, replicas=127.0.0.1:43230, 127.0.0.1:44971, 127.0.0.1:45739 for /TC5/foo
2020-04-02 05:08:13,302 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC5/foo with new block blk_1073741833_1010, current total block count is 1
2020-04-02 05:08:13,304 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@4a9f80d3] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:13,304 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57090 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:44971, 127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:13,304 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57090 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:13,304 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57090 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:13,304 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57090 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010 src: /127.0.0.1:57090 dest: /127.0.0.1:43230
2020-04-02 05:08:13,305 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57090 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010
 storageType=DISK, inAddr=/127.0.0.1:57090, myAddr=/127.0.0.1:43230
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43230
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9e64160f-8239-40bc-b495-871e2ebb5a3a
2020-04-02 05:08:13,305 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57090 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741833 of size 0
2020-04-02 05:08:13,305 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57090 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741833_1010.meta of size 0
2020-04-02 05:08:13,305 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57090 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:13,305 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:13,306 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56942 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:13,306 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56942 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:13,306 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56942 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:13,306 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56942 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010 src: /127.0.0.1:56942 dest: /127.0.0.1:44971
2020-04-02 05:08:13,306 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56942 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010
 storageType=DISK, inAddr=/127.0.0.1:56942, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:13,307 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56942 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741833 of size 0
2020-04-02 05:08:13,307 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56942 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741833_1010.meta of size 0
2020-04-02 05:08:13,307 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56942 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:13,308 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:13,308 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:13,308 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:13,309 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:13,309 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010 src: /127.0.0.1:60442 dest: /127.0.0.1:45739
2020-04-02 05:08:13,309 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010
 storageType=DISK, inAddr=/127.0.0.1:60442, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:13,309 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741833 of size 0
2020-04-02 05:08:13,309 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741833_1010.meta of size 0
2020-04-02 05:08:13,310 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:13,318 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:13,318 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57090 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:13,319 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57090 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689262697299510, ackStatus=SUCCESS)
2020-04-02 05:08:13,322 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:13,322 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741833_1010 on 127.0.0.1:43230 size 65536 replicaState = RBW
2020-04-02 05:08:13,322 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:13,322 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741833_1010 is received from 127.0.0.1:43230
2020-04-02 05:08:13,322 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43230 receiving: 1, received: 0, deleted: 0
2020-04-02 05:08:13,323 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:13,323 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56942 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:13,324 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56942 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689262702167909, ackStatus=SUCCESS)
2020-04-02 05:08:13,323 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:13,334 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:13,334 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689262712817306, ackStatus=SUCCESS)
2020-04-02 05:08:13,339 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,339 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,339 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:13,340 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:13,354 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 15021393 flag: 0 flag: 0
2020-04-02 05:08:13,355 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 15021393 flag: 0 flag: 0
2020-04-02 05:08:13,355 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:13,356 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741833_1010 on 127.0.0.1:45739 size 65536 replicaState = RBW
2020-04-02 05:08:13,356 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:13,356 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741833_1010 is received from 127.0.0.1:45739
2020-04-02 05:08:13,356 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 1, received: 0, deleted: 0
2020-04-02 05:08:13,357 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 35813960 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:13,366 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57090 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:13,366 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57090 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689262744525168, ackStatus=SUCCESS)
2020-04-02 05:08:13,366 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56942 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:13,366 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56942 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689262744896577, ackStatus=SUCCESS)
2020-04-02 05:08:13,366 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56942 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010
2020-04-02 05:08:13,366 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57090 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010
2020-04-02 05:08:13,370 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:13,370 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010
2020-04-02 05:08:13,370 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689262748509175, ackStatus=SUCCESS)
2020-04-02 05:08:13,375 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60442, dest: /127.0.0.1:45739, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, duration(ns): 63675315
2020-04-02 05:08:13,376 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,376 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:13,377 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:13,377 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:13,377 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:13,378 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741833_1010 on 127.0.0.1:45739 size 32768 replicaState = FINALIZED
2020-04-02 05:08:13,378 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:13,378 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741833_1010 (size=0)
2020-04-02 05:08:13,378 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741833_1010 is received from 127.0.0.1:45739
2020-04-02 05:08:13,378 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:13,380 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,382 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:56942, dest: /127.0.0.1:44971, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, duration(ns): 69986000
2020-04-02 05:08:13,382 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 13467143 flag: 0 flag: 0
2020-04-02 05:08:13,382 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] terminating
2020-04-02 05:08:13,382 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56942 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: closing
2020-04-02 05:08:13,383 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56942 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 3
2020-04-02 05:08:13,383 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:13,384 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741833_1010 on 127.0.0.1:44971 size 32768 replicaState = FINALIZED
2020-04-02 05:08:13,384 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:13,384 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741833_1010 (size=0)
2020-04-02 05:08:13,384 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741833_1010 is received from 127.0.0.1:44971
2020-04-02 05:08:13,384 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:13,385 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 13467143 flag: 0 flag: 0
2020-04-02 05:08:13,387 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57090, dest: /127.0.0.1:43230, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, duration(ns): 75026206
2020-04-02 05:08:13,387 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 19383252 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:13,387 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739] terminating
2020-04-02 05:08:13,388 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57090 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]: closing
2020-04-02 05:08:13,388 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57090 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43230:Number of active connections is: 2
2020-04-02 05:08:13,389 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC5/foo for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:13,389 [IPC Server handler 2 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:13,389 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC5/foo with 1 blocks is persisted to the file system
2020-04-02 05:08:13,390 [IPC Server handler 0 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC5/foo is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:13,392 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC5/foo for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:13,392 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC5/foo, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:13,393 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741833_1010
2020-04-02 05:08:13,393 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741833_1010 on 127.0.0.1:43230 size 32768 replicaState = FINALIZED
2020-04-02 05:08:13,393 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:13,393 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43230 is added to blk_1073741833_1010 (size=32768)
2020-04-02 05:08:13,394 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741833_1010 is received from 127.0.0.1:43230
2020-04-02 05:08:13,394 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43230 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:13,395 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /TC5/foo for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010 block size 32768
2020-04-02 05:08:13,395 [IPC Server handler 4 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TC5/foo	dst=null	perm=null	proto=rpc
2020-04-02 05:08:13,397 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC5/foo, chunkSize=516, chunksPerPacket=63, packetSize=32508
2020-04-02 05:08:13,408 [main] DEBUG hdfs.DFSClient (DFSClient.java:<init>(316)) - Sets dfs.client.block.write.replace-datanode-on-failure.min-replication to 0
2020-04-02 05:08:13,426 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC5/foo for DFSClient_NONMAPREDUCE_663062808_1 at 127.0.0.1
2020-04-02 05:08:13,426 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC5/foo, holder=DFSClient_NONMAPREDUCE_663062808_1, clientMachine=127.0.0.1
2020-04-02 05:08:13,427 [IPC Server handler 1 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /TC5/foo for DFSClient_NONMAPREDUCE_663062808_1 on 127.0.0.1 because this file lease is currently owned by DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1
2020-04-02 05:08:13,428 [IPC Server handler 1 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 1 on 35215, call Call#103 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:60240: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /TC5/foo for DFSClient_NONMAPREDUCE_663062808_1 on 127.0.0.1 because this file lease is currently owned by DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1
2020-04-02 05:08:13,441 [main] INFO  hdfs.AppendTestUtil (TestFileAppend3.java:testTC5(236)) - GOOD: got an exception
org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException): Failed to APPEND_FILE /TC5/foo for DFSClient_NONMAPREDUCE_663062808_1 on 127.0.0.1 because this file lease is currently owned by DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.recoverLeaseInternal(FSNamesystem.java:2600)
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:124)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2635)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:805)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:487)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:523)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:991)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:872)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:818)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1729)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2678)

	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1511)
	at org.apache.hadoop.ipc.Client.call(Client.java:1457)
	at org.apache.hadoop.ipc.Client.call(Client.java:1367)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:228)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:116)
	at com.sun.proxy.$Proxy24.append(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.append(ClientNamenodeProtocolTranslatorPB.java:393)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:422)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeMethod(RetryInvocationHandler.java:165)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invoke(RetryInvocationHandler.java:157)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeOnce(RetryInvocationHandler.java:95)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:359)
	at com.sun.proxy.$Proxy28.append(Unknown Source)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1322)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1344)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1413)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1383)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:427)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:423)
	at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)
	at org.apache.hadoop.hdfs.DistributedFileSystem.append(DistributedFileSystem.java:435)
	at org.apache.hadoop.hdfs.DistributedFileSystem.append(DistributedFileSystem.java:404)
	at org.apache.hadoop.fs.FileSystem.append(FileSystem.java:1379)
	at org.apache.hadoop.hdfs.TestFileAppend3.testTC5(TestFileAppend3.java:233)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2020-04-02 05:08:13,445 [main] DEBUG hdfs.DFSClient (DFSClient.java:<init>(316)) - Sets dfs.client.block.write.replace-datanode-on-failure.min-replication to 0
2020-04-02 05:08:13,454 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC5/foo for DFSClient_NONMAPREDUCE_-91913444_1 at 127.0.0.1
2020-04-02 05:08:13,454 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC5/foo, holder=DFSClient_NONMAPREDUCE_-91913444_1, clientMachine=127.0.0.1
2020-04-02 05:08:13,454 [IPC Server handler 6 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /TC5/foo for DFSClient_NONMAPREDUCE_-91913444_1 on 127.0.0.1 because this file lease is currently owned by DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1
2020-04-02 05:08:13,454 [IPC Server handler 6 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 6 on 35215, call Call#104 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:60242: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /TC5/foo for DFSClient_NONMAPREDUCE_-91913444_1 on 127.0.0.1 because this file lease is currently owned by DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1
2020-04-02 05:08:13,458 [main] INFO  hdfs.AppendTestUtil (TestFileAppend3.java:testTC5(245)) - GOOD: got an exception
org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException): Failed to APPEND_FILE /TC5/foo for DFSClient_NONMAPREDUCE_-91913444_1 on 127.0.0.1 because this file lease is currently owned by DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.recoverLeaseInternal(FSNamesystem.java:2600)
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:124)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2635)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:805)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:487)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:523)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:991)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:872)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:818)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1729)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2678)

	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1511)
	at org.apache.hadoop.ipc.Client.call(Client.java:1457)
	at org.apache.hadoop.ipc.Client.call(Client.java:1367)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:228)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:116)
	at com.sun.proxy.$Proxy24.append(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.append(ClientNamenodeProtocolTranslatorPB.java:393)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:422)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeMethod(RetryInvocationHandler.java:165)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invoke(RetryInvocationHandler.java:157)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeOnce(RetryInvocationHandler.java:95)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:359)
	at com.sun.proxy.$Proxy28.append(Unknown Source)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1322)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1344)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1413)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1383)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:427)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:423)
	at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)
	at org.apache.hadoop.hdfs.DistributedFileSystem.append(DistributedFileSystem.java:435)
	at org.apache.hadoop.hdfs.TestFileAppend3.testTC5(TestFileAppend3.java:241)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2020-04-02 05:08:13,466 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:13,468 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60450 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, newGs=1011, bytesRcvd=[32768, 32768]
  targets=[127.0.0.1:44971, 127.0.0.1:43230]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:13,468 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60450 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:13,468 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60450 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:13,468 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60450 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010 src: /127.0.0.1:60450 dest: /127.0.0.1:45739
2020-04-02 05:08:13,468 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60450 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010
 storageType=DISK, inAddr=/127.0.0.1:60450, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1011, minBytesRcvd=32768, maxBytesRcvd=32768
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:13,469 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60450 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741833_1010, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741833
2020-04-02 05:08:13,503 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60450 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741833 of size 32768
2020-04-02 05:08:13,504 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60450 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741833_1011.meta of size 263
2020-04-02 05:08:13,504 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60450 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:13,505 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:13,506 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, newGs=1011, bytesRcvd=[32768, 32768]
  targets=[127.0.0.1:43230]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:13,506 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:13,506 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:13,506 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010 src: /127.0.0.1:56954 dest: /127.0.0.1:44971
2020-04-02 05:08:13,506 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010
 storageType=DISK, inAddr=/127.0.0.1:56954, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_APPEND, newGs=1011, minBytesRcvd=32768, maxBytesRcvd=32768
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3
2020-04-02 05:08:13,506 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741833_1010, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741833
2020-04-02 05:08:13,562 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741833 of size 32768
2020-04-02 05:08:13,562 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741833_1011.meta of size 263
2020-04-02 05:08:13,562 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43230
2020-04-02 05:08:13,563 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@4a9f80d3] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:13,566 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57108 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010, newGs=1011, bytesRcvd=[32768, 32768]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:13,566 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57108 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:13,566 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57108 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:13,566 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57108 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010 src: /127.0.0.1:57108 dest: /127.0.0.1:43230
2020-04-02 05:08:13,567 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57108 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010
 storageType=DISK, inAddr=/127.0.0.1:57108, myAddr=/127.0.0.1:43230
 stage=PIPELINE_SETUP_APPEND, newGs=1011, minBytesRcvd=32768, maxBytesRcvd=32768
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43230
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5ce71111-7ef9-40e4-bd53-df33411df409
2020-04-02 05:08:13,567 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57108 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741833_1010, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741833
2020-04-02 05:08:13,596 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57108 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741833 of size 32768
2020-04-02 05:08:13,597 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57108 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741833_1011.meta of size 263
2020-04-02 05:08:13,597 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:13,601 [IPC Server handler 8 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741833_1010, newGS=1011, newLength=32768, newNodes=[127.0.0.1:45739, 127.0.0.1:44971, 127.0.0.1:43230], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:13,601 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741833_1011 from 127.0.0.1:45739
2020-04-02 05:08:13,601 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-6946cabd-2f8d-451f-81bc-4884ebba8665:NORMAL:127.0.0.1:45739|RBW] of blk_1073741833_1010
2020-04-02 05:08:13,601 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741833_1011 from 127.0.0.1:44971
2020-04-02 05:08:13,601 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3:NORMAL:127.0.0.1:44971|RBW] of blk_1073741833_1010
2020-04-02 05:08:13,602 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741833_1011 from 127.0.0.1:43230
2020-04-02 05:08:13,602 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-5ce71111-7ef9-40e4-bd53-df33411df409:NORMAL:127.0.0.1:43230|RBW] of blk_1073741833_1010
2020-04-02 05:08:13,602 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /TC5/foo with 1 blocks is persisted to the file system
2020-04-02 05:08:13,602 [IPC Server handler 8 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741833_1010 => blk_1073741833_1011) success
2020-04-02 05:08:13,606 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60450 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 0
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:13,606 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60450 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43230]: enqueue Packet(seqno=0, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689262984965681, ackStatus=SUCCESS)
2020-04-02 05:08:13,607 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60450 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011
2020-04-02 05:08:13,607 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 0
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:13,607 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]: enqueue Packet(seqno=0, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689262985531991, ackStatus=SUCCESS)
2020-04-02 05:08:13,607 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011
2020-04-02 05:08:13,607 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57108 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 0
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:13,607 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57108 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011
2020-04-02 05:08:13,607 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57108 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689262985936553, ackStatus=SUCCESS)
2020-04-02 05:08:13,609 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57108, dest: /127.0.0.1:43230, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, duration(ns): 10932359
2020-04-02 05:08:13,610 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,610 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:13,610 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57108 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:13,611 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:13,612 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57108 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43230:Number of active connections is: 2
2020-04-02 05:08:13,611 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,616 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:56954, dest: /127.0.0.1:44971, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, duration(ns): 16376891
2020-04-02 05:08:13,616 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741833_1011 on 127.0.0.1:43230 size 32768 replicaState = FINALIZED
2020-04-02 05:08:13,616 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:13,616 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43230 is added to blk_1073741833_1011 (size=32768)
2020-04-02 05:08:13,616 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:13,617 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3495076 flag: 0 flag: 0
2020-04-02 05:08:13,617 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230] terminating
2020-04-02 05:08:13,617 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43230] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3495076 flag: 0 flag: 0
2020-04-02 05:08:13,618 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741833_1011 is received from 127.0.0.1:43230
2020-04-02 05:08:13,618 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43230 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:13,618 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741833_1011 on 127.0.0.1:44971 size 32768 replicaState = FINALIZED
2020-04-02 05:08:13,618 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:13,618 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741833_1011 (size=32768)
2020-04-02 05:08:13,618 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741833_1011 is received from 127.0.0.1:44971
2020-04-02 05:08:13,619 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:13,620 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43230]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60450, dest: /127.0.0.1:45739, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, duration(ns): 21140500
2020-04-02 05:08:13,621 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43230], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 10929544 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:13,621 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43230]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43230] terminating
2020-04-02 05:08:13,625 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60450 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43230]: closing
2020-04-02 05:08:13,626 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC5/foo for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:13,626 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC5/foo with 1 blocks is persisted to the file system
2020-04-02 05:08:13,626 [IPC Server handler 2 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC5/foo is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:13,624 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1011, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]: closing
2020-04-02 05:08:13,630 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 3
2020-04-02 05:08:13,626 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:13,631 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741833_1011
2020-04-02 05:08:13,631 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741833_1011 on 127.0.0.1:45739 size 32768 replicaState = FINALIZED
2020-04-02 05:08:13,631 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:13,631 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741833_1011 (size=32768)
2020-04-02 05:08:13,631 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741833_1011 is received from 127.0.0.1:45739
2020-04-02 05:08:13,631 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:13,626 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60450 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741833_1010]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
[msx] test Finished org.apache.hadoop.hdfs.TestFileAppend3#testTC5
[msx] writeFile testName = org.apache.hadoop.hdfs.TestFileAppend3#testTC5
[msx] succeed
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
[msx] test Started org.apache.hadoop.hdfs.TestFileAppend3#testTC7
[msx] perform reset as unitTestCounterInClass 5 is larger than zero
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
p=/TC7/foo1
2020-04-02 05:08:13,640 [main] DEBUG hdfs.DFSClient (DFSClient.java:create(1210)) - /TC7/foo1: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-04-02 05:08:13,641 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(757)) - *DIR* NameNode.create: file /TC7/foo1 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:13,642 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2385)) - DIR* NameSystem.startFile: src=/TC7/foo1, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1, createParent=true, replication=2, createFlag=[CREATE], blockSize=65536, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-04-02 05:08:13,642 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirMkdirOp.java:createSingleDirectory(182)) - mkdirs: created directory /TC7
2020-04-02 05:08:13,642 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(585)) - DIR* addFile: foo1 is added
2020-04-02 05:08:13,642 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(416)) - DIR* NameSystem.startFile: added /TC7/foo1 inode 16396 DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:13,643 [IPC Server handler 0 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/TC7/foo1	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:13,644 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC7/foo1, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:13,645 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC7/foo1, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:13,647 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC7/foo1  inodeId 16396 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:13,649 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC7/foo1 with blk_1073741834_1012 block is added to the in-memory file system
2020-04-02 05:08:13,649 [IPC Server handler 4 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741834_1012, replicas=127.0.0.1:44971, 127.0.0.1:43434 for /TC7/foo1
2020-04-02 05:08:13,649 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC7/foo1 with new block blk_1073741834_1012, current total block count is 1
2020-04-02 05:08:13,651 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:13,652 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56964 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43434]; pipelineSize=2, srcDataNode=:0, pinning=false
2020-04-02 05:08:13,652 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56964 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:13,652 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56964 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:13,652 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56964 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012 src: /127.0.0.1:56964 dest: /127.0.0.1:44971
2020-04-02 05:08:13,652 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56964 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012
 storageType=DISK, inAddr=/127.0.0.1:56964, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:13,652 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56964 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741834 of size 0
2020-04-02 05:08:13,652 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56964 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741834_1012.meta of size 0
2020-04-02 05:08:13,653 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56964 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:13,653 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:13,654 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38056 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=2, srcDataNode=:0, pinning=false
2020-04-02 05:08:13,654 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38056 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:13,654 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38056 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:13,654 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38056 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012 src: /127.0.0.1:38056 dest: /127.0.0.1:43434
2020-04-02 05:08:13,654 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38056 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012
 storageType=DISK, inAddr=/127.0.0.1:38056, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:13,655 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38056 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741834 of size 0
2020-04-02 05:08:13,655 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38056 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741834_1012.meta of size 0
2020-04-02 05:08:13,655 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:13,660 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56964 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:13,660 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56964 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689263038887139, ackStatus=SUCCESS)
2020-04-02 05:08:13,661 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38056 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:13,661 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38056 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689263039472786, ackStatus=SUCCESS)
2020-04-02 05:08:13,663 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,663 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:13,666 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,667 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 5923818 flag: 0 flag: 0
2020-04-02 05:08:13,676 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56964 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:13,676 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56964 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689263055032237, ackStatus=SUCCESS)
2020-04-02 05:08:13,677 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56964 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012
2020-04-02 05:08:13,677 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38056 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:13,677 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38056 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012
2020-04-02 05:08:13,677 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38056 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689263055381688, ackStatus=SUCCESS)
2020-04-02 05:08:13,678 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38056, dest: /127.0.0.1:43434, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, duration(ns): 21686492
2020-04-02 05:08:13,678 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,679 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:13,679 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,679 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38056 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:13,679 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38056 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:13,680 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:13,681 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741834_1012 on 127.0.0.1:43434 size 32768 replicaState = FINALIZED
2020-04-02 05:08:13,681 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:13,681 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741834_1012 (size=0)
2020-04-02 05:08:13,681 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741834_1012 is received from 127.0.0.1:43434
2020-04-02 05:08:13,681 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:13,691 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:56964, dest: /127.0.0.1:44971, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, duration(ns): 23482295
2020-04-02 05:08:13,691 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2093365 flag: 0 flag: 0
2020-04-02 05:08:13,691 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:13,691 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56964 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:13,692 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56964 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 3
2020-04-02 05:08:13,695 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:13,695 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741834_1012 on 127.0.0.1:44971 size 32768 replicaState = FINALIZED
2020-04-02 05:08:13,695 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:13,695 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741834_1012 (size=0)
2020-04-02 05:08:13,695 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741834_1012 is received from 127.0.0.1:44971
2020-04-02 05:08:13,695 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:13,696 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC7/foo1 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:13,697 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC7/foo1 with 1 blocks is persisted to the file system
2020-04-02 05:08:13,697 [IPC Server handler 7 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC7/foo1 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:13,707 [IPC Server handler 8 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/TC7/foo1	dst=null	perm=null	proto=rpc
2020-04-02 05:08:13,710 [IPC Server handler 9 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741834_1012]
2020-04-02 05:08:13,710 [IPC Server handler 9 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC7/foo1	dst=null	perm=null	proto=rpc
All blocks of file /TC7/foo1 verified to have replication factor 2
2020-04-02 05:08:13,719 [IPC Server handler 3 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741834_1012]
2020-04-02 05:08:13,719 [IPC Server handler 3 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC7/foo1	dst=null	perm=null	proto=rpc
2020-04-02 05:08:13,726 [main] INFO  impl.FsDatasetImplTestUtils (FsDatasetImplTestUtils.java:truncateData(147)) - Truncating block file: /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741834
2020-04-02 05:08:13,728 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC7/foo1 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:13,728 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC7/foo1, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:13,729 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /TC7/foo1 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012 block size 32768
2020-04-02 05:08:13,729 [IPC Server handler 2 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TC7/foo1	dst=null	perm=null	proto=rpc
2020-04-02 05:08:13,730 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC7/foo1, chunkSize=516, chunksPerPacket=63, packetSize=32508
2020-04-02 05:08:13,731 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC7/foo1, packetSize=32508, chunksPerPacket=63, bytesCurBlock=32768, DFSOutputStream:blk_1073741834_1012
2020-04-02 05:08:13,731 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC7/foo1, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:13,732 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/TC7/foo1, packetSize=516, chunksPerPacket=1, bytesCurBlock=65024, DFSOutputStream:blk_1073741834_1012
2020-04-02 05:08:13,732 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC7/foo1, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:13,732 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=3, src=/TC7/foo1, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:blk_1073741834_1012
2020-04-02 05:08:13,732 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC7/foo1, chunkSize=516, chunksPerPacket=125, packetSize=64500
2020-04-02 05:08:13,732 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=4, src=/TC7/foo1, packetSize=64500, chunksPerPacket=125, bytesCurBlock=512, DFSOutputStream:blk_1073741834_1012
2020-04-02 05:08:13,734 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:13,736 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38064 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, newGs=1013, bytesRcvd=[32768, 32768]
  targets=[127.0.0.1:44971]; pipelineSize=2, srcDataNode=:0, pinning=false
2020-04-02 05:08:13,736 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38064 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:13,736 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38064 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:13,736 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38064 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012 src: /127.0.0.1:38064 dest: /127.0.0.1:43434
2020-04-02 05:08:13,737 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38064 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012
 storageType=DISK, inAddr=/127.0.0.1:38064, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1013, minBytesRcvd=32768, maxBytesRcvd=32768
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:13,737 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38064 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741834_1012, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741834
2020-04-02 05:08:13,771 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38064 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741834 of size 0
2020-04-02 05:08:13,771 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38064 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741834_1013.meta of size 263
2020-04-02 05:08:13,771 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38064 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] WARN  datanode.DataNode (BlockReceiver.java:<init>(289)) - IOException in BlockReceiver constructor :Corrupted block: ReplicaBeingWritten, blk_1073741834_1013, RBW
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741834
  bytesAcked=32768
  bytesOnDisk=32768
2020-04-02 05:08:13,772 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38064 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(922)) - opWriteBlock BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1013 received exception java.io.IOException: Corrupted block: ReplicaBeingWritten, blk_1073741834_1013, RBW
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741834
  bytesAcked=32768
  bytesOnDisk=32768
2020-04-02 05:08:13,775 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38064 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] ERROR datanode.DataNode (DataXceiver.java:run(321)) - 127.0.0.1:43434:DataXceiver error processing WRITE_BLOCK operation  src: /127.0.0.1:38064 dst: /127.0.0.1:43434
java.io.IOException: Corrupted block: ReplicaBeingWritten, blk_1073741834_1013, RBW
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741834
  bytesAcked=32768
  bytesOnDisk=32768
	at org.apache.hadoop.hdfs.server.datanode.LocalReplicaInPipeline.createStreams(LocalReplicaInPipeline.java:292)
	at org.apache.hadoop.hdfs.server.datanode.BlockReceiver.<init>(BlockReceiver.java:258)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.getBlockReceiver(DataXceiver.java:1289)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.writeBlock(DataXceiver.java:754)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.opWriteBlock(Receiver.java:173)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.processOp(Receiver.java:107)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.run(DataXceiver.java:290)
	at java.lang.Thread.run(Thread.java:748)
2020-04-02 05:08:13,775 [Thread-335] INFO  hdfs.DataStreamer (DataStreamer.java:createBlockOutputStream(1790)) - Exception in createBlockOutputStream blk_1073741834_1012
java.io.EOFException: Unexpected EOF while trying to read response from server
	at org.apache.hadoop.hdfs.protocolPB.PBHelperClient.vintPrefixed(PBHelperClient.java:549)
	at org.apache.hadoop.hdfs.DataStreamer.createBlockOutputStream(DataStreamer.java:1762)
	at org.apache.hadoop.hdfs.DataStreamer.setupPipelineInternal(DataStreamer.java:1507)
	at org.apache.hadoop.hdfs.DataStreamer.setupPipelineForAppendOrRecovery(DataStreamer.java:1481)
	at org.apache.hadoop.hdfs.DataStreamer.run(DataStreamer.java:720)
2020-04-02 05:08:13,775 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38064 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:13,775 [Thread-335] WARN  hdfs.DataStreamer (DataStreamer.java:handleBadDatanode(1571)) - Error Recovery for BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012 in pipeline [DatanodeInfoWithStorage[127.0.0.1:43434,DS-29df15fa-b2ca-4eca-89df-87135d5e3b76,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-9396c1fd-c034-40b5-99a4-7728fe5d066f,DISK]]: datanode 0(DatanodeInfoWithStorage[127.0.0.1:43434,DS-29df15fa-b2ca-4eca-89df-87135d5e3b76,DISK]) is bad.
2020-04-02 05:08:13,778 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:13,779 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND_RECOVERY, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012, newGs=1014, bytesRcvd=[32768, 32768]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-04-02 05:08:13,779 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:13,779 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:13,779 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012 src: /127.0.0.1:56978 dest: /127.0.0.1:44971
2020-04-02 05:08:13,779 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012
 storageType=DISK, inAddr=/127.0.0.1:56978, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_APPEND_RECOVERY, newGs=1014, minBytesRcvd=32768, maxBytesRcvd=32768
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:13,779 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:recoverAppend(1318)) - Recover failed append to BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012
2020-04-02 05:08:13,814 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741834 of size 32768
2020-04-02 05:08:13,814 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741834_1014.meta of size 263
2020-04-02 05:08:13,815 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:13,817 [IPC Server handler 4 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741834_1012, newGS=1014, newLength=32768, newNodes=[127.0.0.1:44971], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:13,818 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741834_1014 from 127.0.0.1:43434
2020-04-02 05:08:13,818 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741834_1012
2020-04-02 05:08:13,818 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741834_1014 from 127.0.0.1:44971
2020-04-02 05:08:13,818 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-9396c1fd-c034-40b5-99a4-7728fe5d066f:NORMAL:127.0.0.1:44971|RBW] of blk_1073741834_1012
2020-04-02 05:08:13,818 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /TC7/foo1 with 1 blocks is persisted to the file system
2020-04-02 05:08:13,818 [IPC Server handler 4 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741834_1012 => blk_1073741834_1014) success
2020-04-02 05:08:13,822 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014: PacketHeader with packetLen=32512 header data: offsetInBlock: 32768
seqno: 0
lastPacketInBlock: false
dataLen: 32256

2020-04-02 05:08:13,823 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689263201213229, ackStatus=SUCCESS)
2020-04-02 05:08:13,823 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:13,823 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689263201558329, ackStatus=SUCCESS)
2020-04-02 05:08:13,828 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,829 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,829 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:13,830 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:13,830 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014
2020-04-02 05:08:13,830 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689263208984040, ackStatus=SUCCESS)
2020-04-02 05:08:13,834 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:56978, dest: /127.0.0.1:44971, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, duration(ns): 17219644
2020-04-02 05:08:13,834 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:13,835 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,835 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:13,835 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:13,835 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741834_1014 on 127.0.0.1:44971 size 65536 replicaState = FINALIZED
2020-04-02 05:08:13,835 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56978 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1012]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 3
2020-04-02 05:08:13,835 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:13,835 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741834_1014 (size=32768)
2020-04-02 05:08:13,835 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC7/foo1  inodeId 16396 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:13,835 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741834_1014 is received from 127.0.0.1:44971
2020-04-02 05:08:13,835 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:13,836 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC7/foo1 with blk_1073741835_1015 block is added to the in-memory file system
2020-04-02 05:08:13,836 [IPC Server handler 6 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741835_1015, replicas=127.0.0.1:43230, 127.0.0.1:43434 for /TC7/foo1
2020-04-02 05:08:13,836 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC7/foo1 with new block blk_1073741835_1015, current total block count is 2
2020-04-02 05:08:13,838 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@4a9f80d3] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:13,839 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43434]; pipelineSize=2, srcDataNode=:0, pinning=false
2020-04-02 05:08:13,839 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:13,839 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:13,839 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015 src: /127.0.0.1:57130 dest: /127.0.0.1:43230
2020-04-02 05:08:13,839 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015
 storageType=DISK, inAddr=/127.0.0.1:57130, myAddr=/127.0.0.1:43230
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43230
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9e64160f-8239-40bc-b495-871e2ebb5a3a
2020-04-02 05:08:13,839 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741835 of size 0
2020-04-02 05:08:13,839 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741835_1015.meta of size 0
2020-04-02 05:08:13,840 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:13,840 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:13,841 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=2, srcDataNode=:0, pinning=false
2020-04-02 05:08:13,841 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:13,841 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:13,841 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015 src: /127.0.0.1:38072 dest: /127.0.0.1:43434
2020-04-02 05:08:13,841 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015
 storageType=DISK, inAddr=/127.0.0.1:38072, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:13,842 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741835 of size 0
2020-04-02 05:08:13,842 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741835_1015.meta of size 0
2020-04-02 05:08:13,842 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:13,850 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 3
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:13,850 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=3, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=689263228900904, ackStatus=SUCCESS)
2020-04-02 05:08:13,851 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 3
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:13,851 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE: enqueue Packet(seqno=3, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=689263229424462, ackStatus=SUCCESS)
2020-04-02 05:08:13,851 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015: PacketHeader with packetLen=32512 header data: offsetInBlock: 512
seqno: 4
lastPacketInBlock: false
dataLen: 32256

2020-04-02 05:08:13,851 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE, replyAck=seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,851 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,851 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=4, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689263229890291, ackStatus=SUCCESS)
2020-04-02 05:08:13,852 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 3 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 970652 flag: 0 flag: 0
2020-04-02 05:08:13,851 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:13,852 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015: PacketHeader with packetLen=32512 header data: offsetInBlock: 512
seqno: 4
lastPacketInBlock: false
dataLen: 32256

2020-04-02 05:08:13,852 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE: enqueue Packet(seqno=4, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689263230650549, ackStatus=SUCCESS)
2020-04-02 05:08:13,862 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE, replyAck=seqno: 4 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,862 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 4 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,862 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 4 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 10515742 flag: 0 flag: 0
2020-04-02 05:08:13,862 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:13,870 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 5
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:13,870 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=5, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689263248693141, ackStatus=SUCCESS)
2020-04-02 05:08:13,870 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015
2020-04-02 05:08:13,870 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 5
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:13,870 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015
2020-04-02 05:08:13,871 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE: enqueue Packet(seqno=5, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689263249164728, ackStatus=SUCCESS)
2020-04-02 05:08:13,873 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38072, dest: /127.0.0.1:43434, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, duration(ns): 28467368
2020-04-02 05:08:13,873 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE, replyAck=seqno: 5 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,873 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 5 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:13,873 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:13,873 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:13,874 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38072 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:13,882 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57130, dest: /127.0.0.1:43230, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, duration(ns): 29817744
2020-04-02 05:08:13,882 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 5 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3162594 flag: 0 flag: 0
2020-04-02 05:08:13,882 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:13,882 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:13,883 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57130 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43230:Number of active connections is: 2
2020-04-02 05:08:13,883 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC7/foo1 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:13,884 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 2 blocks.
2020-04-02 05:08:13,884 [IPC Server handler 8 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:checkBlocksComplete(2908)) - BLOCK* blk_1073741835_1015 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /TC7/foo1
2020-04-02 05:08:13,884 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741835_1015 on 127.0.0.1:43434 size 32768 replicaState = FINALIZED
2020-04-02 05:08:13,884 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMMITTED
2020-04-02 05:08:13,884 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741835_1015 (size=32768)
2020-04-02 05:08:13,885 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741835_1015 is received from 127.0.0.1:43434
2020-04-02 05:08:13,885 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:13,885 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:13,885 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741834_1013 on 127.0.0.1:43434 size 65536 replicaState = RBW
2020-04-02 05:08:13,885 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:13,888 [Block report processor] DEBUG BlockStateChange (CorruptReplicasMap.java:addToCorruptReplicasMap(88)) - BLOCK NameSystem.addToCorruptReplicasMap: blk_1073741834_1013 added as corrupt on 127.0.0.1:43434 by null  because reported RBW replica with genstamp 1013 does not match COMPLETE block's genstamp in block map 1014
2020-04-02 05:08:13,888 [Block report processor] DEBUG BlockStateChange (BlockManager.java:invalidateBlock(1722)) - BLOCK* invalidateBlock: blk_1073741834_1013(stored=blk_1073741834_1014) on 127.0.0.1:43434
2020-04-02 05:08:13,888 [Block report processor] DEBUG BlockStateChange (InvalidateBlocks.java:add(190)) - BLOCK* InvalidateBlocks: add blk_1073741834_1013 to 127.0.0.1:43434
2020-04-02 05:08:13,888 [Block report processor] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741834_1014 from 127.0.0.1:43434
2020-04-02 05:08:13,888 [Block report processor] DEBUG hdfs.StateChange (LowRedundancyBlocks.java:update(453)) - LowRedundancyBlocks.update blk_1073741834_1014 curReplicas 1 curExpectedReplicas 2 oldReplicas 2 oldExpectedReplicas  2 curPri  0 oldPri  3
2020-04-02 05:08:13,889 [Block report processor] DEBUG BlockStateChange (LowRedundancyBlocks.java:update(466)) - BLOCK* NameSystem.LowRedundancyBlock.update: blk_1073741834_1014 has only 1 replicas and needs 2 replicas so is added to neededReconstructions at priority level 0
2020-04-02 05:08:13,889 [Block report processor] DEBUG BlockStateChange (BlockManager.java:invalidateBlock(1742)) - BLOCK* invalidateBlocks: blk_1073741834_1013(stored=blk_1073741834_1014) on 127.0.0.1:43434 listed for deletion.
2020-04-02 05:08:13,889 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741834_1013 is received from 127.0.0.1:43434
2020-04-02 05:08:13,889 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 1, received: 0, deleted: 0
2020-04-02 05:08:13,889 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741835_1015
2020-04-02 05:08:13,889 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741835_1015 on 127.0.0.1:43230 size 32768 replicaState = FINALIZED
2020-04-02 05:08:13,889 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:13,889 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43230 is added to blk_1073741835_1015 (size=32768)
2020-04-02 05:08:13,889 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741835_1015 is received from 127.0.0.1:43230
2020-04-02 05:08:13,889 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43230 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,292 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC7/foo1 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,293 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC7/foo1 with 2 blocks is persisted to the file system
2020-04-02 05:08:14,293 [IPC Server handler 3 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC7/foo1 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,294 [IPC Server handler 2 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/TC7/foo1	dst=null	perm=null	proto=rpc
2020-04-02 05:08:14,296 [IPC Server handler 5 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741834_1014, blk_1073741835_1015]
2020-04-02 05:08:14,296 [IPC Server handler 5 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC7/foo1	dst=null	perm=null	proto=rpc
2020-04-02 05:08:14,298 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(242)) - newInfo = LocatedBlocks{;  fileLength=98304;  underConstruction=false;  blocks=[LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014; getBlockSize()=65536; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:44971,DS-9396c1fd-c034-40b5-99a4-7728fe5d066f,DISK]]}, LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015; getBlockSize()=32768; corrupt=false; offset=65536; locs=[DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK], DatanodeInfoWithStorage[127.0.0.1:43230,DS-9e64160f-8239-40bc-b495-871e2ebb5a3a,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015; getBlockSize()=32768; corrupt=false; offset=65536; locs=[DatanodeInfoWithStorage[127.0.0.1:43230,DS-9e64160f-8239-40bc-b495-871e2ebb5a3a,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-04-02 05:08:14,298 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:14,299 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, replica=FinalizedReplica, blk_1073741834_1014, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741834
2020-04-02 05:08:14,299 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741834_1014, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741834
2020-04-02 05:08:14,300 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:44971, dest: /127.0.0.1:56760, bytes: 66048, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, duration(ns): 238914
2020-04-02 05:08:14,312 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:14,314 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37840 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, replica=FinalizedReplica, blk_1073741835_1015, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741835
2020-04-02 05:08:14,314 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37840 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741835_1015, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741835
2020-04-02 05:08:14,315 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37840 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:43434, dest: /127.0.0.1:37840, bytes: 33024, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741835_1015, duration(ns): 237414
[msx] test Finished org.apache.hadoop.hdfs.TestFileAppend3#testTC7
[msx] writeFile testName = org.apache.hadoop.hdfs.TestFileAppend3#testTC7
[msx] succeed
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
[msx] test Started org.apache.hadoop.hdfs.TestFileAppend3#testTC11
[msx] perform reset as unitTestCounterInClass 6 is larger than zero
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
p=/TC11/foo1
2020-04-02 05:08:14,323 [main] DEBUG hdfs.DFSClient (DFSClient.java:create(1210)) - /TC11/foo1: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-04-02 05:08:14,324 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(757)) - *DIR* NameNode.create: file /TC11/foo1 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:14,324 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2385)) - DIR* NameSystem.startFile: src=/TC11/foo1, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1, createParent=true, replication=3, createFlag=[CREATE], blockSize=65536, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-04-02 05:08:14,325 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirMkdirOp.java:createSingleDirectory(182)) - mkdirs: created directory /TC11
2020-04-02 05:08:14,325 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(585)) - DIR* addFile: foo1 is added
2020-04-02 05:08:14,325 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(416)) - DIR* NameSystem.startFile: added /TC11/foo1 inode 16398 DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,325 [IPC Server handler 0 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/TC11/foo1	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:14,327 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC11/foo1, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:14,328 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC11/foo1, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:14,328 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC11/foo1, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:14,329 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/TC11/foo1, packetSize=516, chunksPerPacket=1, bytesCurBlock=64512, DFSOutputStream:block==null
2020-04-02 05:08:14,329 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC11/foo1, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:14,329 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=2, src=/TC11/foo1, packetSize=516, chunksPerPacket=1, bytesCurBlock=65024, DFSOutputStream:block==null
2020-04-02 05:08:14,329 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC11/foo1, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:14,330 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC11/foo1  inodeId 16398 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,331 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC11/foo1 with blk_1073741836_1016 block is added to the in-memory file system
2020-04-02 05:08:14,332 [IPC Server handler 4 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741836_1016, replicas=127.0.0.1:43434, 127.0.0.1:45580, 127.0.0.1:44971 for /TC11/foo1
2020-04-02 05:08:14,332 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC11/foo1 with new block blk_1073741836_1016, current total block count is 1
2020-04-02 05:08:14,338 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:14,339 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45580, 127.0.0.1:44971]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:14,339 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:14,339 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:14,339 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016 src: /127.0.0.1:38084 dest: /127.0.0.1:43434
2020-04-02 05:08:14,339 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016
 storageType=DISK, inAddr=/127.0.0.1:38084, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:14,340 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741836 of size 0
2020-04-02 05:08:14,340 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741836_1016.meta of size 0
2020-04-02 05:08:14,340 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:14,341 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:14,343 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:44971]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:14,343 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:14,343 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:14,343 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016 src: /127.0.0.1:35260 dest: /127.0.0.1:45580
2020-04-02 05:08:14,343 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016
 storageType=DISK, inAddr=/127.0.0.1:35260, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:14,344 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741836 of size 0
2020-04-02 05:08:14,344 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741836_1016.meta of size 0
2020-04-02 05:08:14,344 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:14,345 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:14,346 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:14,346 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:14,346 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:14,346 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016 src: /127.0.0.1:56998 dest: /127.0.0.1:44971
2020-04-02 05:08:14,346 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016
 storageType=DISK, inAddr=/127.0.0.1:56998, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:14,346 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741836 of size 0
2020-04-02 05:08:14,346 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741836_1016.meta of size 0
2020-04-02 05:08:14,347 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:14,378 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:14,378 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689263756575158, ackStatus=SUCCESS)
2020-04-02 05:08:14,379 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:14,379 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689263757296110, ackStatus=SUCCESS)
2020-04-02 05:08:14,379 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:14,379 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971]: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689263757632022, ackStatus=SUCCESS)
2020-04-02 05:08:14,382 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:14,382 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689263760518429, ackStatus=SUCCESS)
2020-04-02 05:08:14,382 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:14,382 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:14,382 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689263761097553, ackStatus=SUCCESS)
2020-04-02 05:08:14,383 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689263761229939, ackStatus=SUCCESS)
2020-04-02 05:08:14,383 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:14,383 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:14,383 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689263761504886, ackStatus=SUCCESS)
2020-04-02 05:08:14,383 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689263761403677, ackStatus=SUCCESS)
2020-04-02 05:08:14,384 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,393 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,393 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 10529241 flag: 0 flag: 0
2020-04-02 05:08:14,393 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,393 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:14,396 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,398 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 13612640 flag: 0 flag: 0
2020-04-02 05:08:14,398 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 10529241 flag: 0 flag: 0
2020-04-02 05:08:14,398 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 19573848 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:14,398 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 13612640 flag: 0 flag: 0
2020-04-02 05:08:14,398 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 19315265 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:14,419 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:14,419 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689263797903922, ackStatus=SUCCESS)
2020-04-02 05:08:14,421 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,421 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:14,421 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,421 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 38184513 flag: 0 flag: 0
2020-04-02 05:08:14,421 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971] got seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 38184513 flag: 0 flag: 0
2020-04-02 05:08:14,421 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 42266360 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:14,422 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:14,423 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971]: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689263801152170, ackStatus=SUCCESS)
2020-04-02 05:08:14,423 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016
2020-04-02 05:08:14,424 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:14,424 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689263802366487, ackStatus=SUCCESS)
2020-04-02 05:08:14,424 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016
2020-04-02 05:08:14,429 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:14,429 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016
2020-04-02 05:08:14,429 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689263807953354, ackStatus=SUCCESS)
2020-04-02 05:08:14,432 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:56998, dest: /127.0.0.1:44971, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, duration(ns): 83055565
2020-04-02 05:08:14,432 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE, replyAck=seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,432 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:14,432 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:14,432 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,432 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56998 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 3
2020-04-02 05:08:14,432 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:14,434 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35260, dest: /127.0.0.1:45580, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, duration(ns): 62837158
2020-04-02 05:08:14,434 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 3 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8495538 flag: 0 flag: 0
2020-04-02 05:08:14,434 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] terminating
2020-04-02 05:08:14,435 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: closing
2020-04-02 05:08:14,435 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35260 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:14,435 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741836_1016 on 127.0.0.1:44971 size 65536 replicaState = FINALIZED
2020-04-02 05:08:14,435 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:14,435 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971] got seqno: 3 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8495538 flag: 0 flag: 0
2020-04-02 05:08:14,436 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:14,435 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741836_1016 (size=0)
2020-04-02 05:08:14,436 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741836_1016 is received from 127.0.0.1:44971
2020-04-02 05:08:14,436 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,436 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741836_1016 on 127.0.0.1:45580 size 65536 replicaState = FINALIZED
2020-04-02 05:08:14,436 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:14,437 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741836_1016 (size=0)
2020-04-02 05:08:14,437 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741836_1016 is received from 127.0.0.1:45580
2020-04-02 05:08:14,437 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,448 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38084, dest: /127.0.0.1:43434, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, duration(ns): 68979823
2020-04-02 05:08:14,448 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971], replyAck=seqno: 3 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 12388259 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:14,448 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971] terminating
2020-04-02 05:08:14,448 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:44971]: closing
2020-04-02 05:08:14,448 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38084 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741836_1016]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:14,449 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:14,449 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC11/foo1 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,449 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC11/foo1 with 1 blocks is persisted to the file system
2020-04-02 05:08:14,449 [IPC Server handler 8 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC11/foo1 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,450 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741836_1016
2020-04-02 05:08:14,450 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741836_1016 on 127.0.0.1:43434 size 65536 replicaState = FINALIZED
2020-04-02 05:08:14,450 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:14,450 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741836_1016 (size=65536)
2020-04-02 05:08:14,450 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741836_1016 is received from 127.0.0.1:43434
2020-04-02 05:08:14,450 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,453 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC11/foo1 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:14,453 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC11/foo1, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:14,454 [IPC Server handler 9 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TC11/foo1	dst=null	perm=null	proto=rpc
2020-04-02 05:08:14,454 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC11/foo1, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:14,455 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC11/foo1, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:14,456 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:flushOrSync(635)) - DFSClient flush():  bytesCurBlock=32768, lastFlushOffset=0, createNewBlock=false
2020-04-02 05:08:14,466 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC11/foo1  inodeId 16398 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,467 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:analyzeFileState(641)) - BLOCK* NameSystem.allocateBlock: handling block allocation writing to a file with a complete previous block: src=/TC11/foo1 lastBlock=blk_1073741836_1016
2020-04-02 05:08:14,467 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:analyzeFileState(641)) - BLOCK* NameSystem.allocateBlock: handling block allocation writing to a file with a complete previous block: src=/TC11/foo1 lastBlock=blk_1073741836_1016
2020-04-02 05:08:14,468 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC11/foo1 with blk_1073741837_1017 block is added to the in-memory file system
2020-04-02 05:08:14,468 [IPC Server handler 3 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741837_1017, replicas=127.0.0.1:45580, 127.0.0.1:44971, 127.0.0.1:45739 for /TC11/foo1
2020-04-02 05:08:14,468 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC11/foo1 with new block blk_1073741837_1017, current total block count is 2
2020-04-02 05:08:14,474 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:14,478 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35264 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:44971, 127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:14,478 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35264 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:14,478 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35264 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:14,478 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35264 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017 src: /127.0.0.1:35264 dest: /127.0.0.1:45580
2020-04-02 05:08:14,479 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35264 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017
 storageType=DISK, inAddr=/127.0.0.1:35264, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:14,479 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35264 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741837 of size 0
2020-04-02 05:08:14,479 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35264 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741837_1017.meta of size 0
2020-04-02 05:08:14,479 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35264 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:14,482 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:14,486 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57002 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:14,486 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57002 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:14,486 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57002 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:14,486 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57002 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017 src: /127.0.0.1:57002 dest: /127.0.0.1:44971
2020-04-02 05:08:14,486 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57002 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017
 storageType=DISK, inAddr=/127.0.0.1:57002, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:14,487 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57002 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741837 of size 0
2020-04-02 05:08:14,487 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57002 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741837_1017.meta of size 0
2020-04-02 05:08:14,487 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57002 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:14,488 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:14,489 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60502 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:14,489 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60502 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:14,489 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60502 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:14,489 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60502 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017 src: /127.0.0.1:60502 dest: /127.0.0.1:45739
2020-04-02 05:08:14,489 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60502 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017
 storageType=DISK, inAddr=/127.0.0.1:60502, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:14,489 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60502 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741837 of size 0
2020-04-02 05:08:14,489 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60502 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741837_1017.meta of size 0
2020-04-02 05:08:14,490 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:14,506 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35264 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:14,506 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35264 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689263884905100, ackStatus=SUCCESS)
2020-04-02 05:08:14,507 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57002 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:14,507 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57002 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689263885460650, ackStatus=SUCCESS)
2020-04-02 05:08:14,507 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60502 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:14,508 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60502 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689263886141161, ackStatus=SUCCESS)
2020-04-02 05:08:14,511 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,511 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:14,514 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,515 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7326459 flag: 0 flag: 0
2020-04-02 05:08:14,515 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7326459 flag: 0 flag: 0
2020-04-02 05:08:14,515 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8742803 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:14,523 [IPC Server handler 2 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:fsync(3274)) - BLOCK* fsync: /TC11/foo1 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,523 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /TC11/foo1 with 2 blocks is persisted to the file system
2020-04-02 05:08:14,527 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:rename(995)) - *DIR* NameNode.rename: /TC11/foo1 to /TC11/foo1.new
2020-04-02 05:08:14,529 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirRenameOp.java:renameToInt(53)) - DIR* NameSystem.renameTo: /TC11/foo1 to /TC11/foo1.new
2020-04-02 05:08:14,530 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirRenameOp.java:renameTo(478)) - DIR* FSDirectory.renameTo: /TC11/foo1 to /TC11/foo1.new
2020-04-02 05:08:14,533 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirRenameOp.java:unprotectedRenameTo(208)) - DIR* FSDirectory.unprotectedRenameTo: /TC11/foo1 is renamed to /TC11/foo1.new
2020-04-02 05:08:14,534 [IPC Server handler 5 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=rename	src=/TC11/foo1	dst=/TC11/foo1.new	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:14,539 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35264 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:14,539 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35264 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689263917458035, ackStatus=SUCCESS)
2020-04-02 05:08:14,539 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35264 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017
2020-04-02 05:08:14,541 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57002 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:14,541 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57002 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689263919670680, ackStatus=SUCCESS)
2020-04-02 05:08:14,541 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57002 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017
2020-04-02 05:08:14,541 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60502 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:14,541 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60502 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017
2020-04-02 05:08:14,541 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60502 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689263920090859, ackStatus=SUCCESS)
2020-04-02 05:08:14,544 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60502, dest: /127.0.0.1:45739, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, duration(ns): 51987401
2020-04-02 05:08:14,544 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,544 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60502 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:14,544 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:14,544 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,544 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60502 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:14,544 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:14,545 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57002, dest: /127.0.0.1:44971, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, duration(ns): 54325601
2020-04-02 05:08:14,545 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2864660 flag: 0 flag: 0
2020-04-02 05:08:14,545 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57002 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: closing
2020-04-02 05:08:14,545 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] terminating
2020-04-02 05:08:14,545 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741837_1017 on 127.0.0.1:45739 size 32768 replicaState = FINALIZED
2020-04-02 05:08:14,546 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:14,546 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57002 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 3
2020-04-02 05:08:14,546 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:14,546 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2864660 flag: 0 flag: 0
2020-04-02 05:08:14,547 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35264, dest: /127.0.0.1:45580, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, duration(ns): 54923612
2020-04-02 05:08:14,547 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7332417 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:14,547 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739] terminating
2020-04-02 05:08:14,547 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35264 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]: closing
2020-04-02 05:08:14,548 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35264 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741837_1017]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:14,548 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:14,546 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741837_1017 (size=32768)
2020-04-02 05:08:14,551 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741837_1017 is received from 127.0.0.1:45739
2020-04-02 05:08:14,551 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,551 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741837_1017 on 127.0.0.1:44971 size 32768 replicaState = FINALIZED
2020-04-02 05:08:14,552 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:14,552 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741837_1017 (size=32768)
2020-04-02 05:08:14,552 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741837_1017 is received from 127.0.0.1:44971
2020-04-02 05:08:14,552 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,552 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741837_1017 on 127.0.0.1:45580 size 32768 replicaState = FINALIZED
2020-04-02 05:08:14,552 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:14,552 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741837_1017 (size=32768)
2020-04-02 05:08:14,552 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741837_1017 is received from 127.0.0.1:45580
2020-04-02 05:08:14,552 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,558 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC11/foo1 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,559 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC11/foo1.new with 2 blocks is persisted to the file system
2020-04-02 05:08:14,559 [IPC Server handler 6 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC11/foo1 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,561 [IPC Server handler 7 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/TC11/foo1.new	dst=null	perm=null	proto=rpc
2020-04-02 05:08:14,562 [IPC Server handler 8 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741836_1016, blk_1073741837_1017]
2020-04-02 05:08:14,563 [IPC Server handler 8 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC11/foo1.new	dst=null	perm=null	proto=rpc
[msx] test Finished org.apache.hadoop.hdfs.TestFileAppend3#testTC11
[msx] writeFile testName = org.apache.hadoop.hdfs.TestFileAppend3#testTC11
[msx] succeed
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
[msx] test Started org.apache.hadoop.hdfs.TestFileAppend3#testTC12
[msx] perform reset as unitTestCounterInClass 7 is larger than zero
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
p=/TC12/foo1
2020-04-02 05:08:14,567 [main] DEBUG hdfs.DFSClient (DFSClient.java:create(1210)) - /TC12/foo1: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-04-02 05:08:14,568 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(757)) - *DIR* NameNode.create: file /TC12/foo1 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:14,568 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2385)) - DIR* NameSystem.startFile: src=/TC12/foo1, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1, createParent=true, replication=3, createFlag=[CREATE], blockSize=65536, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-04-02 05:08:14,569 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(585)) - DIR* addFile: foo1 is added
2020-04-02 05:08:14,569 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(416)) - DIR* NameSystem.startFile: added /TC12/foo1 inode 16399 DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,569 [IPC Server handler 9 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/TC12/foo1	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:14,571 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC12/foo1, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:14,574 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC12/foo1, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:14,582 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC12/foo1  inodeId 16399 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,584 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC12/foo1 with blk_1073741838_1018 block is added to the in-memory file system
2020-04-02 05:08:14,584 [IPC Server handler 3 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741838_1018, replicas=127.0.0.1:45580, 127.0.0.1:45739, 127.0.0.1:43434 for /TC12/foo1
2020-04-02 05:08:14,584 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC12/foo1 with new block blk_1073741838_1018, current total block count is 1
2020-04-02 05:08:14,591 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:14,592 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35270 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45739, 127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:14,592 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35270 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:14,592 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35270 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:14,592 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35270 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018 src: /127.0.0.1:35270 dest: /127.0.0.1:45580
2020-04-02 05:08:14,592 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35270 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018
 storageType=DISK, inAddr=/127.0.0.1:35270, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:14,592 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35270 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741838 of size 0
2020-04-02 05:08:14,593 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35270 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741838_1018.meta of size 0
2020-04-02 05:08:14,593 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35270 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:14,593 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:14,594 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60506 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:14,594 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60506 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:14,594 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60506 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:14,594 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60506 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018 src: /127.0.0.1:60506 dest: /127.0.0.1:45739
2020-04-02 05:08:14,594 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60506 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018
 storageType=DISK, inAddr=/127.0.0.1:60506, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:14,595 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60506 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741838 of size 0
2020-04-02 05:08:14,595 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60506 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741838_1018.meta of size 0
2020-04-02 05:08:14,595 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60506 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:14,595 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:14,596 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:14,596 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:14,596 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:14,596 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018 src: /127.0.0.1:38100 dest: /127.0.0.1:43434
2020-04-02 05:08:14,596 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018
 storageType=DISK, inAddr=/127.0.0.1:38100, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:14,597 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741838 of size 0
2020-04-02 05:08:14,597 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741838_1018.meta of size 0
2020-04-02 05:08:14,598 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:14,601 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35270 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018: PacketHeader with packetLen=25895 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 25687

2020-04-02 05:08:14,601 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35270 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=25687, ackEnqueueNanoTime=689263979582554, ackStatus=SUCCESS)
2020-04-02 05:08:14,602 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60506 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018: PacketHeader with packetLen=25895 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 25687

2020-04-02 05:08:14,602 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60506 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=25687, ackEnqueueNanoTime=689263980494937, ackStatus=SUCCESS)
2020-04-02 05:08:14,602 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018: PacketHeader with packetLen=25895 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 25687

2020-04-02 05:08:14,603 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=25687, ackEnqueueNanoTime=689263981162656, ackStatus=SUCCESS)
2020-04-02 05:08:14,603 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,603 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,603 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:14,603 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1019442 flag: 0 flag: 0
2020-04-02 05:08:14,603 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1019442 flag: 0 flag: 0
2020-04-02 05:08:14,604 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2439277 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:14,605 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35270 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018: PacketHeader with packetLen=4 header data: offsetInBlock: 25687
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:14,605 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35270 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=25687, ackEnqueueNanoTime=689263983654553, ackStatus=SUCCESS)
2020-04-02 05:08:14,605 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35270 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018
2020-04-02 05:08:14,606 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60506 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018: PacketHeader with packetLen=4 header data: offsetInBlock: 25687
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:14,606 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60506 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=25687, ackEnqueueNanoTime=689263984520148, ackStatus=SUCCESS)
2020-04-02 05:08:14,606 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60506 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018
2020-04-02 05:08:14,607 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018: PacketHeader with packetLen=4 header data: offsetInBlock: 25687
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:14,607 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018
2020-04-02 05:08:14,607 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=25687, ackEnqueueNanoTime=689263985415696, ackStatus=SUCCESS)
2020-04-02 05:08:14,610 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38100, dest: /127.0.0.1:43434, bytes: 25687, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, duration(ns): 12199550
2020-04-02 05:08:14,612 [IPC Server handler 2 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:14,613 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741838_1018 on 127.0.0.1:43434 size 25687 replicaState = FINALIZED
2020-04-02 05:08:14,613 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:14,613 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741838_1018 (size=0)
2020-04-02 05:08:14,613 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741838_1018 is received from 127.0.0.1:43434
2020-04-02 05:08:14,613 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,614 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,614 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60506, dest: /127.0.0.1:45739, bytes: 25687, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, duration(ns): 16015647
2020-04-02 05:08:14,615 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 5065690 flag: 0 flag: 0
2020-04-02 05:08:14,615 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:14,615 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 5065690 flag: 0 flag: 0
2020-04-02 05:08:14,615 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,615 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:14,615 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:14,615 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38100 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:14,616 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35270, dest: /127.0.0.1:45580, bytes: 25687, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, duration(ns): 15610586
2020-04-02 05:08:14,616 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9857701 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:14,616 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] terminating
2020-04-02 05:08:14,616 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35270 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: closing
2020-04-02 05:08:14,616 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35270 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:14,616 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:14,617 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741838_1018 on 127.0.0.1:45580 size 25687 replicaState = FINALIZED
2020-04-02 05:08:14,617 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:14,617 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741838_1018 (size=0)
2020-04-02 05:08:14,617 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741838_1018 is received from 127.0.0.1:45580
2020-04-02 05:08:14,617 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,618 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60506 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:14,618 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:14,618 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60506 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:14,618 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741838_1018 on 127.0.0.1:45739 size 25687 replicaState = FINALIZED
2020-04-02 05:08:14,618 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:14,618 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741838_1018 (size=0)
2020-04-02 05:08:14,618 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741838_1018 is received from 127.0.0.1:45739
2020-04-02 05:08:14,618 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,624 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC12/foo1 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,625 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC12/foo1 with 1 blocks is persisted to the file system
2020-04-02 05:08:14,625 [IPC Server handler 4 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC12/foo1 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,632 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC12/foo1 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:14,632 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC12/foo1, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:14,633 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /TC12/foo1 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018 block size 25687
2020-04-02 05:08:14,633 [IPC Server handler 1 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TC12/foo1	dst=null	perm=null	proto=rpc
2020-04-02 05:08:14,635 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC12/foo1, chunkSize=429, chunksPerPacket=1, packetSize=429
2020-04-02 05:08:14,636 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC12/foo1, packetSize=429, chunksPerPacket=1, bytesCurBlock=25687, DFSOutputStream:blk_1073741838_1018
2020-04-02 05:08:14,636 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC12/foo1, chunkSize=516, chunksPerPacket=76, packetSize=39216
2020-04-02 05:08:14,637 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/TC12/foo1, packetSize=39216, chunksPerPacket=76, bytesCurBlock=26112, DFSOutputStream:blk_1073741838_1018
2020-04-02 05:08:14,644 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:14,645 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, newGs=1019, bytesRcvd=[25687, 25687]
  targets=[127.0.0.1:45580, 127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:14,646 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:14,646 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:14,646 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018 src: /127.0.0.1:38110 dest: /127.0.0.1:43434
2020-04-02 05:08:14,646 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018
 storageType=DISK, inAddr=/127.0.0.1:38110, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1019, minBytesRcvd=25687, maxBytesRcvd=25687
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:14,646 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741838_1018, FINALIZED
  getNumBytes()     = 25687
  getBytesOnDisk()  = 25687
  getVisibleLength()= 25687
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741838
2020-04-02 05:08:14,677 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741838 of size 25687
2020-04-02 05:08:14,677 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741838_1019.meta of size 211
2020-04-02 05:08:14,678 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:14,679 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:14,680 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, newGs=1019, bytesRcvd=[25687, 25687]
  targets=[127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:14,680 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:14,680 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:14,680 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018 src: /127.0.0.1:35286 dest: /127.0.0.1:45580
2020-04-02 05:08:14,680 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018
 storageType=DISK, inAddr=/127.0.0.1:35286, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_APPEND, newGs=1019, minBytesRcvd=25687, maxBytesRcvd=25687
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-2d1f4083-d7c8-4136-8351-6f589a4451bd
2020-04-02 05:08:14,680 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741838_1018, FINALIZED
  getNumBytes()     = 25687
  getBytesOnDisk()  = 25687
  getVisibleLength()= 25687
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741838
2020-04-02 05:08:14,714 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741838 of size 25687
2020-04-02 05:08:14,714 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741838_1019.meta of size 211
2020-04-02 05:08:14,714 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:14,715 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:14,715 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018, newGs=1019, bytesRcvd=[25687, 25687]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:14,715 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:14,715 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:14,715 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018 src: /127.0.0.1:60522 dest: /127.0.0.1:45739
2020-04-02 05:08:14,716 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018
 storageType=DISK, inAddr=/127.0.0.1:60522, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1019, minBytesRcvd=25687, maxBytesRcvd=25687
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:14,716 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741838_1018, FINALIZED
  getNumBytes()     = 25687
  getBytesOnDisk()  = 25687
  getVisibleLength()= 25687
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741838
2020-04-02 05:08:14,760 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741838 of size 25687
2020-04-02 05:08:14,761 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741838_1019.meta of size 211
2020-04-02 05:08:14,763 [IPC Server handler 7 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741838_1018, newGS=1019, newLength=25687, newNodes=[127.0.0.1:43434, 127.0.0.1:45580, 127.0.0.1:45739], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:14,763 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741838_1019 from 127.0.0.1:43434
2020-04-02 05:08:14,763 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e:NORMAL:127.0.0.1:43434|RBW] of blk_1073741838_1018
2020-04-02 05:08:14,763 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741838_1019 from 127.0.0.1:45580
2020-04-02 05:08:14,763 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-2d1f4083-d7c8-4136-8351-6f589a4451bd:NORMAL:127.0.0.1:45580|RBW] of blk_1073741838_1018
2020-04-02 05:08:14,763 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741838_1019 from 127.0.0.1:45739
2020-04-02 05:08:14,763 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-6946cabd-2f8d-451f-81bc-4884ebba8665:NORMAL:127.0.0.1:45739|RBW] of blk_1073741838_1018
2020-04-02 05:08:14,763 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /TC12/foo1 with 1 blocks is persisted to the file system
2020-04-02 05:08:14,764 [IPC Server handler 7 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741838_1018 => blk_1073741838_1019) success
2020-04-02 05:08:14,766 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:14,771 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019: PacketHeader with packetLen=433 header data: offsetInBlock: 25687
seqno: 0
lastPacketInBlock: false
dataLen: 425

2020-04-02 05:08:14,771 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=26112, ackEnqueueNanoTime=689264149774260, ackStatus=SUCCESS)
2020-04-02 05:08:14,771 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019: previous write did not end at the chunk boundary. onDiskLen=25687
2020-04-02 05:08:14,771 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019: sizePartialChunk=87, block offset=25600, metafile offset=207
2020-04-02 05:08:14,773 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019
2020-04-02 05:08:14,773 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 425, skip=0
2020-04-02 05:08:14,773 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019: PacketHeader with packetLen=5500 header data: offsetInBlock: 26112
seqno: 1
lastPacketInBlock: false
dataLen: 5452

2020-04-02 05:08:14,773 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=31564, ackEnqueueNanoTime=689264151838552, ackStatus=SUCCESS)
2020-04-02 05:08:14,778 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019: PacketHeader with packetLen=433 header data: offsetInBlock: 25687
seqno: 0
lastPacketInBlock: false
dataLen: 425

2020-04-02 05:08:14,778 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=26112, ackEnqueueNanoTime=689264156583475, ackStatus=SUCCESS)
2020-04-02 05:08:14,778 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019: previous write did not end at the chunk boundary. onDiskLen=25687
2020-04-02 05:08:14,778 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019: sizePartialChunk=87, block offset=25600, metafile offset=207
2020-04-02 05:08:14,779 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019
2020-04-02 05:08:14,779 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 425, skip=0
2020-04-02 05:08:14,779 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019: PacketHeader with packetLen=5500 header data: offsetInBlock: 26112
seqno: 1
lastPacketInBlock: false
dataLen: 5452

2020-04-02 05:08:14,779 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=31564, ackEnqueueNanoTime=689264157668322, ackStatus=SUCCESS)
2020-04-02 05:08:14,786 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019: PacketHeader with packetLen=433 header data: offsetInBlock: 25687
seqno: 0
lastPacketInBlock: false
dataLen: 425

2020-04-02 05:08:14,786 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019: previous write did not end at the chunk boundary. onDiskLen=25687
2020-04-02 05:08:14,786 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019: sizePartialChunk=87, block offset=25600, metafile offset=207
2020-04-02 05:08:14,787 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019
2020-04-02 05:08:14,787 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 425, skip=0
2020-04-02 05:08:14,787 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=26112, ackEnqueueNanoTime=689264165547892, ackStatus=SUCCESS)
2020-04-02 05:08:14,787 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019: PacketHeader with packetLen=5500 header data: offsetInBlock: 26112
seqno: 1
lastPacketInBlock: false
dataLen: 5452

2020-04-02 05:08:14,787 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,787 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,788 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:14,787 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=31564, ackEnqueueNanoTime=689264166006332, ackStatus=SUCCESS)
2020-04-02 05:08:14,788 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9452553 flag: 0 flag: 0
2020-04-02 05:08:14,788 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9452553 flag: 0 flag: 0
2020-04-02 05:08:14,788 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,788 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,788 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:14,788 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8999723 flag: 0 flag: 0
2020-04-02 05:08:14,788 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 16743186 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:14,791 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8999723 flag: 0 flag: 0
2020-04-02 05:08:14,791 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 17712738 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:14,794 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019: PacketHeader with packetLen=4 header data: offsetInBlock: 31564
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:14,794 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=31564, ackEnqueueNanoTime=689264172849986, ackStatus=SUCCESS)
2020-04-02 05:08:14,794 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019
2020-04-02 05:08:14,795 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019: PacketHeader with packetLen=4 header data: offsetInBlock: 31564
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:14,795 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=31564, ackEnqueueNanoTime=689264173677175, ackStatus=SUCCESS)
2020-04-02 05:08:14,795 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019
2020-04-02 05:08:14,795 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019: PacketHeader with packetLen=4 header data: offsetInBlock: 31564
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:14,796 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019
2020-04-02 05:08:14,796 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=31564, ackEnqueueNanoTime=689264174245040, ackStatus=SUCCESS)
2020-04-02 05:08:14,798 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60522, dest: /127.0.0.1:45739, bytes: 31564, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, duration(ns): 31670026
2020-04-02 05:08:14,798 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,798 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:14,798 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,798 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:14,802 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:14,801 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35286, dest: /127.0.0.1:45580, bytes: 31564, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, duration(ns): 38541179
2020-04-02 05:08:14,803 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60522 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:14,803 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741838_1019 on 127.0.0.1:45580 size 31564 replicaState = FINALIZED
2020-04-02 05:08:14,804 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739] got seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3250231 flag: 0 flag: 0
2020-04-02 05:08:14,804 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3250231 flag: 0 flag: 0
2020-04-02 05:08:14,804 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] terminating
2020-04-02 05:08:14,804 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: closing
2020-04-02 05:08:14,804 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:14,807 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38110, dest: /127.0.0.1:43434, bytes: 31564, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, duration(ns): 44186232
2020-04-02 05:08:14,807 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:14,807 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741838_1019 (size=25687)
2020-04-02 05:08:14,808 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:14,807 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35286 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:14,808 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741838_1019 is received from 127.0.0.1:45580
2020-04-02 05:08:14,812 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,807 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9279173 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:14,812 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC12/foo1 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,812 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]: closing
2020-04-02 05:08:14,812 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739] terminating
2020-04-02 05:08:14,812 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38110 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1018]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:14,813 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC12/foo1 with 1 blocks is persisted to the file system
2020-04-02 05:08:14,813 [IPC Server handler 2 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC12/foo1 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,813 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741838_1019
2020-04-02 05:08:14,813 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741838_1019 on 127.0.0.1:45739 size 31564 replicaState = FINALIZED
2020-04-02 05:08:14,814 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:14,814 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741838_1019 (size=31564)
2020-04-02 05:08:14,814 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741838_1019 is received from 127.0.0.1:45739
2020-04-02 05:08:14,814 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,814 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741838_1019
2020-04-02 05:08:14,814 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741838_1019 on 127.0.0.1:43434 size 31564 replicaState = FINALIZED
2020-04-02 05:08:14,814 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:14,814 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741838_1019 (size=31564)
2020-04-02 05:08:14,814 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741838_1019 is received from 127.0.0.1:43434
2020-04-02 05:08:14,814 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,815 [IPC Server handler 5 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/TC12/foo1	dst=null	perm=null	proto=rpc
2020-04-02 05:08:14,817 [IPC Server handler 0 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741838_1019]
2020-04-02 05:08:14,817 [IPC Server handler 0 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC12/foo1	dst=null	perm=null	proto=rpc
2020-04-02 05:08:14,820 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(242)) - newInfo = LocatedBlocks{;  fileLength=31564;  underConstruction=false;  blocks=[LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019; getBlockSize()=31564; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:45739,DS-6946cabd-2f8d-451f-81bc-4884ebba8665,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK], DatanodeInfoWithStorage[127.0.0.1:45580,DS-2d1f4083-d7c8-4136-8351-6f589a4451bd,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019; getBlockSize()=31564; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:45580,DS-2d1f4083-d7c8-4136-8351-6f589a4451bd,DISK], DatanodeInfoWithStorage[127.0.0.1:45739,DS-6946cabd-2f8d-451f-81bc-4884ebba8665,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-04-02 05:08:14,820 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:14,822 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, replica=FinalizedReplica, blk_1073741838_1019, FINALIZED
  getNumBytes()     = 31564
  getBytesOnDisk()  = 31564
  getVisibleLength()= 31564
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741838
2020-04-02 05:08:14,822 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741838_1019, FINALIZED
  getNumBytes()     = 31564
  getBytesOnDisk()  = 31564
  getVisibleLength()= 31564
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741838
2020-04-02 05:08:14,823 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:45739, dest: /127.0.0.1:60328, bytes: 31812, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741838_1019, duration(ns): 291851
[msx] test Finished org.apache.hadoop.hdfs.TestFileAppend3#testTC12
[msx] writeFile testName = org.apache.hadoop.hdfs.TestFileAppend3#testTC12
[msx] succeed
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
[msx] test Started org.apache.hadoop.hdfs.TestFileAppend3#testSmallAppendRace
[msx] perform reset as unitTestCounterInClass 8 is larger than zero
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
2020-04-02 05:08:14,833 [main] DEBUG hdfs.DFSClient (DFSClient.java:create(1210)) - /testSmallAppendRace: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-04-02 05:08:14,834 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(757)) - *DIR* NameNode.create: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:14,834 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2385)) - DIR* NameSystem.startFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1, createParent=true, replication=3, createFlag=[CREATE, OVERWRITE], blockSize=134217728, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-04-02 05:08:14,834 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(585)) - DIR* addFile: testSmallAppendRace is added
2020-04-02 05:08:14,835 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(416)) - DIR* NameSystem.startFile: added /testSmallAppendRace inode 16400 DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,835 [IPC Server handler 4 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/testSmallAppendRace	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:14,836 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:14,842 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:14,846 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /testSmallAppendRace  inodeId 16400 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,847 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /testSmallAppendRace with blk_1073741839_1020 block is added to the in-memory file system
2020-04-02 05:08:14,847 [IPC Server handler 1 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741839_1020, replicas=127.0.0.1:45739, 127.0.0.1:45580, 127.0.0.1:43434 for /testSmallAppendRace
2020-04-02 05:08:14,847 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /testSmallAppendRace with new block blk_1073741839_1020, current total block count is 1
2020-04-02 05:08:14,850 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:14,851 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60526 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45580, 127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:14,851 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60526 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:14,851 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60526 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:14,852 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60526 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020 src: /127.0.0.1:60526 dest: /127.0.0.1:45739
2020-04-02 05:08:14,852 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60526 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020
 storageType=DISK, inAddr=/127.0.0.1:60526, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:14,852 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60526 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 0
2020-04-02 05:08:14,852 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60526 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1020.meta of size 0
2020-04-02 05:08:14,852 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60526 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:14,853 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:14,854 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35294 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:14,854 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35294 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:14,854 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35294 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:14,854 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35294 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020 src: /127.0.0.1:35294 dest: /127.0.0.1:45580
2020-04-02 05:08:14,854 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35294 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020
 storageType=DISK, inAddr=/127.0.0.1:35294, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:14,854 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35294 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 0
2020-04-02 05:08:14,854 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35294 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1020.meta of size 0
2020-04-02 05:08:14,854 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35294 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:14,855 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:14,855 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38122 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:14,855 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38122 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:14,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38122 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:14,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38122 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020 src: /127.0.0.1:38122 dest: /127.0.0.1:43434
2020-04-02 05:08:14,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38122 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020
 storageType=DISK, inAddr=/127.0.0.1:38122, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:14,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38122 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 0
2020-04-02 05:08:14,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38122 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1020.meta of size 0
2020-04-02 05:08:14,857 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:14,860 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60526 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020: PacketHeader with packetLen=131 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:14,861 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60526 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=123, ackEnqueueNanoTime=689264239228610, ackStatus=SUCCESS)
2020-04-02 05:08:14,861 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35294 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020: PacketHeader with packetLen=131 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:14,861 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35294 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=123, ackEnqueueNanoTime=689264239595486, ackStatus=SUCCESS)
2020-04-02 05:08:14,861 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38122 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020: PacketHeader with packetLen=131 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:14,861 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38122 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=123, ackEnqueueNanoTime=689264239951431, ackStatus=SUCCESS)
2020-04-02 05:08:14,862 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,862 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,862 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:14,862 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 721605 flag: 0 flag: 0
2020-04-02 05:08:14,862 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 721605 flag: 0 flag: 0
2020-04-02 05:08:14,862 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1380812 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:14,865 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60526 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020: PacketHeader with packetLen=4 header data: offsetInBlock: 123
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:14,865 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60526 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=123, ackEnqueueNanoTime=689264243860301, ackStatus=SUCCESS)
2020-04-02 05:08:14,865 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60526 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020
2020-04-02 05:08:14,866 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35294 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020: PacketHeader with packetLen=4 header data: offsetInBlock: 123
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:14,866 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35294 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=123, ackEnqueueNanoTime=689264244210083, ackStatus=SUCCESS)
2020-04-02 05:08:14,866 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35294 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020
2020-04-02 05:08:14,866 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38122 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020: PacketHeader with packetLen=4 header data: offsetInBlock: 123
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:14,866 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38122 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020
2020-04-02 05:08:14,867 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38122 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=123, ackEnqueueNanoTime=689264245157155, ackStatus=SUCCESS)
2020-04-02 05:08:14,867 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38122, dest: /127.0.0.1:43434, bytes: 123, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, duration(ns): 9992700
2020-04-02 05:08:14,867 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,867 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:14,867 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:14,868 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35294, dest: /127.0.0.1:45580, bytes: 123, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, duration(ns): 10436127
2020-04-02 05:08:14,868 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1792416 flag: 0 flag: 0
2020-04-02 05:08:14,868 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:14,868 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35294 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:14,869 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35294 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:14,868 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38122 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:14,869 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:14,868 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1792416 flag: 0 flag: 0
2020-04-02 05:08:14,870 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1020 on 127.0.0.1:45580 size 123 replicaState = FINALIZED
2020-04-02 05:08:14,870 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:14,869 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38122 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:14,871 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:14,870 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741839_1020 (size=0)
2020-04-02 05:08:14,873 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1020 is received from 127.0.0.1:45580
2020-04-02 05:08:14,873 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,873 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1020 on 127.0.0.1:45739 size 123 replicaState = FINALIZED
2020-04-02 05:08:14,873 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:14,873 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1020 (size=0)
2020-04-02 05:08:14,874 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1020 is received from 127.0.0.1:45739
2020-04-02 05:08:14,874 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,870 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60526, dest: /127.0.0.1:45739, bytes: 123, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, duration(ns): 12724528
2020-04-02 05:08:14,870 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:14,874 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3154833 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:14,874 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434] terminating
2020-04-02 05:08:14,874 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1020 on 127.0.0.1:43434 size 123 replicaState = FINALIZED
2020-04-02 05:08:14,874 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:14,875 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1020 (size=0)
2020-04-02 05:08:14,875 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1020 is received from 127.0.0.1:43434
2020-04-02 05:08:14,875 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:14,875 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60526 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]: closing
2020-04-02 05:08:14,875 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60526 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:14,885 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:14,886 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:14,886 [IPC Server handler 8 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:15,190 [IPC Server handler 3 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:15,210 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,210 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,211 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020 block size 123
2020-04-02 05:08:15,211 [IPC Server handler 2 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:15,216 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,216 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,216 [IPC Server handler 5 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,217 [IPC Server handler 5 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 5 on 35215, call Call#170 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,222 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,222 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,222 [IPC Server handler 4 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,222 [IPC Server handler 4 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 4 on 35215, call Call#172 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,223 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,223 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,223 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=393, chunksPerPacket=1, packetSize=393
2020-04-02 05:08:15,240 [IPC Server handler 0 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,240 [IPC Server handler 0 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 0 on 35215, call Call#171 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,246 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,246 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,246 [IPC Server handler 1 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,246 [IPC Server handler 1 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 1 on 35215, call Call#173 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,250 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,250 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,250 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,250 [IPC Server handler 6 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,251 [IPC Server handler 6 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 6 on 35215, call Call#174 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,250 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,251 [IPC Server handler 9 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,251 [IPC Server handler 9 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 9 on 35215, call Call#175 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,252 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=393, chunksPerPacket=1, bytesCurBlock=123, DFSOutputStream:blk_1073741839_1020
2020-04-02 05:08:15,260 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:15,263 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,263 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,264 [IPC Server handler 8 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,264 [IPC Server handler 8 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 8 on 35215, call Call#177 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,264 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, newGs=1021, bytesRcvd=[123, 123]
  targets=[127.0.0.1:45739, 127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:15,264 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:15,264 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:15,264 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020 src: /127.0.0.1:35326 dest: /127.0.0.1:45580
2020-04-02 05:08:15,264 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020
 storageType=DISK, inAddr=/127.0.0.1:35326, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_APPEND, newGs=1021, minBytesRcvd=123, maxBytesRcvd=123
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:15,268 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,268 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,268 [IPC Server handler 3 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,269 [IPC Server handler 3 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 3 on 35215, call Call#178 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,274 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1020, FINALIZED
  getNumBytes()     = 123
  getBytesOnDisk()  = 123
  getVisibleLength()= 123
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:15,276 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,276 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,277 [IPC Server handler 5 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,277 [IPC Server handler 5 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 5 on 35215, call Call#179 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,291 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,291 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,292 [IPC Server handler 2 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,292 [IPC Server handler 2 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 2 on 35215, call Call#181 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,300 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,300 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,301 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,301 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,301 [IPC Server handler 0 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,302 [IPC Server handler 0 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 0 on 35215, call Call#182 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,302 [IPC Server handler 4 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,303 [IPC Server handler 4 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 4 on 35215, call Call#180 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,307 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,308 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,308 [IPC Server handler 1 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,308 [IPC Server handler 1 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 1 on 35215, call Call#183 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,310 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,310 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,310 [IPC Server handler 6 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,310 [IPC Server handler 6 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 6 on 35215, call Call#184 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,311 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,312 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,312 [IPC Server handler 6 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,312 [IPC Server handler 6 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 6 on 35215, call Call#185 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,320 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,321 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,321 [IPC Server handler 7 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,321 [IPC Server handler 7 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 7 on 35215, call Call#186 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,329 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 123
2020-04-02 05:08:15,330 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1021.meta of size 11
2020-04-02 05:08:15,330 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:15,333 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,334 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,334 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:15,334 [IPC Server handler 8 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,334 [IPC Server handler 8 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 8 on 35215, call Call#187 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,336 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, newGs=1021, bytesRcvd=[123, 123]
  targets=[127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:15,336 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:15,336 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:15,336 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020 src: /127.0.0.1:60572 dest: /127.0.0.1:45739
2020-04-02 05:08:15,336 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020
 storageType=DISK, inAddr=/127.0.0.1:60572, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1021, minBytesRcvd=123, maxBytesRcvd=123
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:15,336 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1020, FINALIZED
  getNumBytes()     = 123
  getBytesOnDisk()  = 123
  getVisibleLength()= 123
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:15,342 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,342 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,342 [IPC Server handler 3 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,342 [IPC Server handler 3 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 3 on 35215, call Call#188 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,343 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,343 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,343 [IPC Server handler 5 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,343 [IPC Server handler 5 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 5 on 35215, call Call#189 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,349 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,350 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,350 [IPC Server handler 2 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,355 [IPC Server handler 2 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 2 on 35215, call Call#190 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,375 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,375 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,375 [IPC Server handler 0 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,375 [IPC Server handler 0 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 0 on 35215, call Call#191 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,389 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,389 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,389 [IPC Server handler 4 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,389 [IPC Server handler 4 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 4 on 35215, call Call#193 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,391 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,391 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,392 [IPC Server handler 1 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,392 [IPC Server handler 1 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 1 on 35215, call Call#192 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,398 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 123
2020-04-02 05:08:15,398 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1021.meta of size 11
2020-04-02 05:08:15,398 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:15,402 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:15,402 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020, newGs=1021, bytesRcvd=[123, 123]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:15,403 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:15,403 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:15,403 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020 src: /127.0.0.1:38172 dest: /127.0.0.1:43434
2020-04-02 05:08:15,403 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020
 storageType=DISK, inAddr=/127.0.0.1:38172, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1021, minBytesRcvd=123, maxBytesRcvd=123
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:15,403 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1020, FINALIZED
  getNumBytes()     = 123
  getBytesOnDisk()  = 123
  getVisibleLength()= 123
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:15,404 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,404 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,404 [IPC Server handler 9 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,404 [IPC Server handler 9 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 9 on 35215, call Call#195 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,406 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,406 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,406 [IPC Server handler 6 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,406 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,406 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,406 [IPC Server handler 6 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 6 on 35215, call Call#194 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,407 [IPC Server handler 7 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,407 [IPC Server handler 7 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 7 on 35215, call Call#196 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,410 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,411 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,411 [IPC Server handler 8 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,411 [IPC Server handler 8 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 8 on 35215, call Call#198 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,411 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,413 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,413 [IPC Server handler 5 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,413 [IPC Server handler 5 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 5 on 35215, call Call#197 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,420 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,420 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,420 [IPC Server handler 3 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,421 [IPC Server handler 3 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 3 on 35215, call Call#200 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,435 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,435 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,435 [IPC Server handler 0 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,436 [IPC Server handler 0 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 0 on 35215, call Call#199 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,436 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,436 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,437 [IPC Server handler 2 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,437 [IPC Server handler 2 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 2 on 35215, call Call#201 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,438 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,438 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,439 [IPC Server handler 4 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,439 [IPC Server handler 4 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 4 on 35215, call Call#202 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,441 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,441 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,441 [IPC Server handler 1 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,441 [IPC Server handler 1 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 1 on 35215, call Call#203 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,441 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,443 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,444 [IPC Server handler 9 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,444 [IPC Server handler 9 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 9 on 35215, call Call#204 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,450 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 123
2020-04-02 05:08:15,450 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1021.meta of size 11
2020-04-02 05:08:15,451 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,451 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,452 [IPC Server handler 6 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,452 [IPC Server handler 6 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 6 on 35215, call Call#206 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,452 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:15,454 [IPC Server handler 7 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1020, newGS=1021, newLength=123, newNodes=[127.0.0.1:45580, 127.0.0.1:45739, 127.0.0.1:43434], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:15,455 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1021 from 127.0.0.1:45580
2020-04-02 05:08:15,455 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-089629a9-5898-4562-bd81-79a4f45c96c1:NORMAL:127.0.0.1:45580|RBW] of blk_1073741839_1020
2020-04-02 05:08:15,456 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1021 from 127.0.0.1:45739
2020-04-02 05:08:15,456 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1020
2020-04-02 05:08:15,456 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1021 from 127.0.0.1:43434
2020-04-02 05:08:15,456 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1020
2020-04-02 05:08:15,456 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:15,456 [IPC Server handler 7 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1020 => blk_1073741839_1021) success
2020-04-02 05:08:15,456 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,456 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,457 [IPC Server handler 8 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,457 [IPC Server handler 8 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 8 on 35215, call Call#208 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,461 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021: PacketHeader with packetLen=131 header data: offsetInBlock: 123
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:15,461 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=246, ackEnqueueNanoTime=689264839893811, ackStatus=SUCCESS)
2020-04-02 05:08:15,461 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021: previous write did not end at the chunk boundary. onDiskLen=123
2020-04-02 05:08:15,462 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021: sizePartialChunk=123, block offset=0, metafile offset=7
2020-04-02 05:08:15,462 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021: PacketHeader with packetLen=131 header data: offsetInBlock: 123
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:15,462 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=246, ackEnqueueNanoTime=689264840354882, ackStatus=SUCCESS)
2020-04-02 05:08:15,462 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021: previous write did not end at the chunk boundary. onDiskLen=123
2020-04-02 05:08:15,462 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021: sizePartialChunk=123, block offset=0, metafile offset=7
2020-04-02 05:08:15,462 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,462 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021
2020-04-02 05:08:15,462 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:15,462 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021
2020-04-02 05:08:15,463 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:15,462 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,462 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021: PacketHeader with packetLen=131 header data: offsetInBlock: 123
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:15,463 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021: previous write did not end at the chunk boundary. onDiskLen=123
2020-04-02 05:08:15,463 [IPC Server handler 5 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,463 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021: sizePartialChunk=123, block offset=0, metafile offset=7
2020-04-02 05:08:15,464 [IPC Server handler 5 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 5 on 35215, call Call#205 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,465 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021
2020-04-02 05:08:15,465 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:15,465 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=246, ackEnqueueNanoTime=689264843478966, ackStatus=SUCCESS)
2020-04-02 05:08:15,466 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:15,466 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:15,466 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:15,466 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 4170958 flag: 0 flag: 0
2020-04-02 05:08:15,467 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 4170958 flag: 0 flag: 0
2020-04-02 05:08:15,467 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 5553302 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:15,470 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,472 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021: PacketHeader with packetLen=4 header data: offsetInBlock: 246
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:15,472 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=246, ackEnqueueNanoTime=689264850940366, ackStatus=SUCCESS)
2020-04-02 05:08:15,472 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021
2020-04-02 05:08:15,473 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021: PacketHeader with packetLen=4 header data: offsetInBlock: 246
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:15,473 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=246, ackEnqueueNanoTime=689264851439772, ackStatus=SUCCESS)
2020-04-02 05:08:15,473 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021
2020-04-02 05:08:15,473 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021: PacketHeader with packetLen=4 header data: offsetInBlock: 246
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:15,473 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021
2020-04-02 05:08:15,473 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=246, ackEnqueueNanoTime=689264851893420, ackStatus=SUCCESS)
2020-04-02 05:08:15,479 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,480 [IPC Server handler 3 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,480 [IPC Server handler 3 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 3 on 35215, call Call#209 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,480 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38172, dest: /127.0.0.1:43434, bytes: 246, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, duration(ns): 26930938
2020-04-02 05:08:15,481 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:15,481 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:15,496 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1021 on 127.0.0.1:43434 size 246 replicaState = FINALIZED
2020-04-02 05:08:15,496 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:15,496 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1021 (size=123)
2020-04-02 05:08:15,496 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1021 is received from 127.0.0.1:43434
2020-04-02 05:08:15,496 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:15,481 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:15,481 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:15,481 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:15,498 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38172 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:15,503 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60572, dest: /127.0.0.1:45739, bytes: 246, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, duration(ns): 50929656
2020-04-02 05:08:15,503 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7815729 flag: 0 flag: 0
2020-04-02 05:08:15,503 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7815729 flag: 0 flag: 0
2020-04-02 05:08:15,503 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:15,504 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,505 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,505 [IPC Server handler 2 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,505 [IPC Server handler 2 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 2 on 35215, call Call#211 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,505 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:15,505 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:15,507 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60572 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:15,508 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1021 on 127.0.0.1:45739 size 246 replicaState = FINALIZED
2020-04-02 05:08:15,508 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:15,508 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1021 (size=123)
2020-04-02 05:08:15,508 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1021 is received from 127.0.0.1:45739
2020-04-02 05:08:15,508 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:15,508 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:15,508 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1021 on 127.0.0.1:45580 size 246 replicaState = FINALIZED
2020-04-02 05:08:15,509 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:15,509 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741839_1021 (size=123)
2020-04-02 05:08:15,509 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1021 is received from 127.0.0.1:45580
2020-04-02 05:08:15,509 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:15,512 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,512 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,512 [IPC Server handler 9 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
2020-04-02 05:08:15,512 [IPC Server handler 9 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 9 on 35215, call Call#214 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:59962: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1 because DFSClient_NONMAPREDUCE_-96199515_1 is already the current lease holder.
[msx] test Finished org.apache.hadoop.hdfs.TestFileAppend3#testSmallAppendRace
[msx] writeFile testName = org.apache.hadoop.hdfs.TestFileAppend3#testSmallAppendRace
[msx] succeed
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
[msx] test Started org.apache.hadoop.hdfs.TestFileAppend3#testTC5ForAppend2
[msx] perform reset as unitTestCounterInClass 9 is larger than zero
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
2020-04-02 05:08:15,515 [main] DEBUG hdfs.DFSClient (DFSClient.java:create(1210)) - /TC5/foo2: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-04-02 05:08:15,517 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(757)) - *DIR* NameNode.create: file /TC5/foo2 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,517 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2385)) - DIR* NameSystem.startFile: src=/TC5/foo2, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1, createParent=true, replication=3, createFlag=[CREATE], blockSize=65536, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-04-02 05:08:15,518 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(585)) - DIR* addFile: foo2 is added
2020-04-02 05:08:15,518 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(416)) - DIR* NameSystem.startFile: added /TC5/foo2 inode 16401 DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:15,519 [IPC Server handler 6 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/TC5/foo2	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:15,521 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC5/foo2, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:15,524 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35326, dest: /127.0.0.1:45580, bytes: 246, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, duration(ns): 55609387
2020-04-02 05:08:15,525 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 30735788 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:15,525 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] terminating
2020-04-02 05:08:15,525 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: closing
2020-04-02 05:08:15,527 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:15,527 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:15,527 [IPC Server handler 7 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:15,531 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35326 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1020]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:15,532 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,533 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,533 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021 block size 246
2020-04-02 05:08:15,534 [IPC Server handler 8 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:15,534 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC5/foo2, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:15,609 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=270, chunksPerPacket=1, packetSize=270
2020-04-02 05:08:15,612 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=270, chunksPerPacket=1, bytesCurBlock=246, DFSOutputStream:blk_1073741839_1021
2020-04-02 05:08:15,644 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:15,654 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC5/foo2  inodeId 16401 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:15,657 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, newGs=1022, bytesRcvd=[246, 246]
  targets=[127.0.0.1:45739, 127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:15,657 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:15,657 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:15,657 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021 src: /127.0.0.1:38192 dest: /127.0.0.1:43434
2020-04-02 05:08:15,657 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021
 storageType=DISK, inAddr=/127.0.0.1:38192, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1022, minBytesRcvd=246, maxBytesRcvd=246
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:15,658 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1021, FINALIZED
  getNumBytes()     = 246
  getBytesOnDisk()  = 246
  getVisibleLength()= 246
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:15,660 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC5/foo2 with blk_1073741840_1023 block is added to the in-memory file system
2020-04-02 05:08:15,660 [IPC Server handler 0 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741840_1023, replicas=127.0.0.1:43434, 127.0.0.1:45739, 127.0.0.1:43230 for /TC5/foo2
2020-04-02 05:08:15,661 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC5/foo2 with new block blk_1073741840_1023, current total block count is 1
2020-04-02 05:08:15,686 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 4
2020-04-02 05:08:15,699 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38194 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45739, 127.0.0.1:43230]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:15,699 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38194 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:15,699 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38194 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:15,699 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38194 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023 src: /127.0.0.1:38194 dest: /127.0.0.1:43434
2020-04-02 05:08:15,699 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38194 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023
 storageType=DISK, inAddr=/127.0.0.1:38194, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:15,730 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 246
2020-04-02 05:08:15,730 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1022.meta of size 11
2020-04-02 05:08:15,730 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38194 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741840 of size 0
2020-04-02 05:08:15,731 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:15,731 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38194 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741840_1023.meta of size 0
2020-04-02 05:08:15,731 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38194 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:15,731 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:15,732 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 3
2020-04-02 05:08:15,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, newGs=1022, bytesRcvd=[246, 246]
  targets=[127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:15,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:15,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:15,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021 src: /127.0.0.1:60604 dest: /127.0.0.1:45739
2020-04-02 05:08:15,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60606 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43230]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:15,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60606 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:15,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021
 storageType=DISK, inAddr=/127.0.0.1:60604, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1022, minBytesRcvd=246, maxBytesRcvd=246
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:15,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60606 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:15,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60606 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023 src: /127.0.0.1:60606 dest: /127.0.0.1:45739
2020-04-02 05:08:15,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1021, FINALIZED
  getNumBytes()     = 246
  getBytesOnDisk()  = 246
  getVisibleLength()= 246
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:15,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60606 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023
 storageType=DISK, inAddr=/127.0.0.1:60606, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:15,770 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 246
2020-04-02 05:08:15,770 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1022.meta of size 11
2020-04-02 05:08:15,771 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:15,774 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:15,774 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60606 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741840 of size 0
2020-04-02 05:08:15,774 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60606 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741840_1023.meta of size 0
2020-04-02 05:08:15,774 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60606 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43230
2020-04-02 05:08:15,775 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@4a9f80d3] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:15,778 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021, newGs=1022, bytesRcvd=[246, 246]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:15,778 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57262 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:15,778 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57262 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:15,778 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57262 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:15,779 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57262 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023 src: /127.0.0.1:57262 dest: /127.0.0.1:43230
2020-04-02 05:08:15,779 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57262 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023
 storageType=DISK, inAddr=/127.0.0.1:57262, myAddr=/127.0.0.1:43230
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43230
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9e64160f-8239-40bc-b495-871e2ebb5a3a
2020-04-02 05:08:15,779 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57262 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741840 of size 0
2020-04-02 05:08:15,779 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57262 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741840_1023.meta of size 0
2020-04-02 05:08:15,778 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:15,780 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:15,780 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021 src: /127.0.0.1:35374 dest: /127.0.0.1:45580
2020-04-02 05:08:15,780 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021
 storageType=DISK, inAddr=/127.0.0.1:35374, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_APPEND, newGs=1022, minBytesRcvd=246, maxBytesRcvd=246
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:15,780 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1021, FINALIZED
  getNumBytes()     = 246
  getBytesOnDisk()  = 246
  getVisibleLength()= 246
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:15,786 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:15,799 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38194 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:15,799 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38194 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43230]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689265177984886, ackStatus=SUCCESS)
2020-04-02 05:08:15,800 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60606 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:15,800 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60606 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689265178383936, ackStatus=SUCCESS)
2020-04-02 05:08:15,800 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57262 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:15,800 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57262 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689265178900898, ackStatus=SUCCESS)
2020-04-02 05:08:15,801 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:15,801 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:15,801 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:15,801 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1011157 flag: 0 flag: 0
2020-04-02 05:08:15,802 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43230] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1011157 flag: 0 flag: 0
2020-04-02 05:08:15,802 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43230], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2290187 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:15,810 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38194 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:15,810 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38194 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43230]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689265188846432, ackStatus=SUCCESS)
2020-04-02 05:08:15,810 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60606 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:15,811 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60606 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689265189185346, ackStatus=SUCCESS)
2020-04-02 05:08:15,811 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60606 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023
2020-04-02 05:08:15,811 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38194 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023
2020-04-02 05:08:15,814 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57262 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:15,814 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57262 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023
2020-04-02 05:08:15,814 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57262 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689265192708589, ackStatus=SUCCESS)
2020-04-02 05:08:15,815 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57262, dest: /127.0.0.1:43230, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, duration(ns): 28691766
2020-04-02 05:08:15,815 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:15,815 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:15,815 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57262 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:15,815 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57262 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43230:Number of active connections is: 2
2020-04-02 05:08:15,816 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:15,817 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60606, dest: /127.0.0.1:45739, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, duration(ns): 17759960
2020-04-02 05:08:15,817 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 5060123 flag: 0 flag: 0
2020-04-02 05:08:15,819 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60606 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]: closing
2020-04-02 05:08:15,819 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43230] terminating
2020-04-02 05:08:15,819 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60606 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 4
2020-04-02 05:08:15,822 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 2 blocks.
2020-04-02 05:08:15,826 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43230] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 5060123 flag: 0 flag: 0
2020-04-02 05:08:15,826 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741840_1023 on 127.0.0.1:45739 size 32768 replicaState = FINALIZED
2020-04-02 05:08:15,834 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:15,834 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741840_1023 (size=0)
2020-04-02 05:08:15,834 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741840_1023 is received from 127.0.0.1:45739
2020-04-02 05:08:15,834 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:15,834 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1022 on 127.0.0.1:45739 size 134217728 replicaState = RBW
2020-04-02 05:08:15,834 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:15,834 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741839_1022 is received from 127.0.0.1:45739
2020-04-02 05:08:15,834 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 1, received: 0, deleted: 0
2020-04-02 05:08:15,834 [IPC Server handler 2 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:15,834 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 246
2020-04-02 05:08:15,834 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43230]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38194, dest: /127.0.0.1:43434, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, duration(ns): 43775528
2020-04-02 05:08:15,835 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1022.meta of size 11
2020-04-02 05:08:15,835 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741840_1023 on 127.0.0.1:43230 size 32768 replicaState = FINALIZED
2020-04-02 05:08:15,835 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:15,835 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43230]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43230], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 15300502 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:15,835 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43230 is added to blk_1073741840_1023 (size=0)
2020-04-02 05:08:15,835 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38194 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43230]: closing
2020-04-02 05:08:15,835 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43230]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43230] terminating
2020-04-02 05:08:15,835 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741840_1023 is received from 127.0.0.1:43230
2020-04-02 05:08:15,836 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43230 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:15,836 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:15,836 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38194 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 4
2020-04-02 05:08:15,837 [IPC Server handler 4 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1021, newGS=1022, newLength=246, newNodes=[127.0.0.1:43434, 127.0.0.1:45739, 127.0.0.1:45580], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:15,837 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1022 from 127.0.0.1:43434
2020-04-02 05:08:15,837 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1021
2020-04-02 05:08:15,837 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1022 from 127.0.0.1:45580
2020-04-02 05:08:15,837 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-089629a9-5898-4562-bd81-79a4f45c96c1:NORMAL:127.0.0.1:45580|RBW] of blk_1073741839_1021
2020-04-02 05:08:15,837 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:15,837 [IPC Server handler 4 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1021 => blk_1073741839_1022) success
2020-04-02 05:08:15,838 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC5/foo2 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:15,838 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC5/foo2 with 1 blocks is persisted to the file system
2020-04-02 05:08:15,838 [IPC Server handler 1 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC5/foo2 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:15,843 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 2 blocks.
2020-04-02 05:08:15,843 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC5/foo2 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,844 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC5/foo2, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,844 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741840_1023
2020-04-02 05:08:15,844 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741840_1023 on 127.0.0.1:43434 size 32768 replicaState = FINALIZED
2020-04-02 05:08:15,844 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:15,844 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741840_1023 (size=32768)
2020-04-02 05:08:15,844 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741840_1023 is received from 127.0.0.1:43434
2020-04-02 05:08:15,844 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:15,844 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1022 on 127.0.0.1:43434 size 134217728 replicaState = RBW
2020-04-02 05:08:15,844 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:15,844 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741839_1022 is received from 127.0.0.1:43434
2020-04-02 05:08:15,844 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 1, received: 0, deleted: 0
2020-04-02 05:08:15,845 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /TC5/foo2 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741840_1023 block size 32768
2020-04-02 05:08:15,845 [IPC Server handler 6 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TC5/foo2	dst=null	perm=null	proto=rpc
2020-04-02 05:08:15,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022: PacketHeader with packetLen=131 header data: offsetInBlock: 246
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:15,857 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=369, ackEnqueueNanoTime=689265235447033, ackStatus=SUCCESS)
2020-04-02 05:08:15,857 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022: previous write did not end at the chunk boundary. onDiskLen=246
2020-04-02 05:08:15,857 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022: PacketHeader with packetLen=131 header data: offsetInBlock: 246
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:15,864 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=369, ackEnqueueNanoTime=689265242406938, ackStatus=SUCCESS)
2020-04-02 05:08:15,864 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022: previous write did not end at the chunk boundary. onDiskLen=246
2020-04-02 05:08:15,864 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022: sizePartialChunk=246, block offset=0, metafile offset=7
2020-04-02 05:08:15,865 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022
2020-04-02 05:08:15,865 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:15,865 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022: PacketHeader with packetLen=131 header data: offsetInBlock: 246
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:15,863 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022: sizePartialChunk=246, block offset=0, metafile offset=7
2020-04-02 05:08:15,865 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022: previous write did not end at the chunk boundary. onDiskLen=246
2020-04-02 05:08:15,865 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022: sizePartialChunk=246, block offset=0, metafile offset=7
2020-04-02 05:08:15,865 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022
2020-04-02 05:08:15,866 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022
2020-04-02 05:08:15,866 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:15,866 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=369, ackEnqueueNanoTime=689265244326478, ackStatus=SUCCESS)
2020-04-02 05:08:15,865 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC5/foo2, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:15,866 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:15,868 [main] DEBUG hdfs.DFSClient (DFSClient.java:<init>(316)) - Sets dfs.client.block.write.replace-datanode-on-failure.min-replication to 0
2020-04-02 05:08:15,870 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:15,870 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:15,871 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:15,871 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6754553 flag: 0 flag: 0
2020-04-02 05:08:15,871 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6754553 flag: 0 flag: 0
2020-04-02 05:08:15,871 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 14030533 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:15,872 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022: PacketHeader with packetLen=4 header data: offsetInBlock: 369
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:15,872 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=369, ackEnqueueNanoTime=689265250939253, ackStatus=SUCCESS)
2020-04-02 05:08:15,872 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC5/foo2 for DFSClient_NONMAPREDUCE_1459596895_1 at 127.0.0.1
2020-04-02 05:08:15,872 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022
2020-04-02 05:08:15,873 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC5/foo2, holder=DFSClient_NONMAPREDUCE_1459596895_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,873 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022: PacketHeader with packetLen=4 header data: offsetInBlock: 369
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:15,873 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=369, ackEnqueueNanoTime=689265251401881, ackStatus=SUCCESS)
2020-04-02 05:08:15,873 [IPC Server handler 7 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /TC5/foo2 for DFSClient_NONMAPREDUCE_1459596895_1 on 127.0.0.1 because this file lease is currently owned by DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1
2020-04-02 05:08:15,873 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022: PacketHeader with packetLen=4 header data: offsetInBlock: 369
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:15,873 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022
2020-04-02 05:08:15,873 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=369, ackEnqueueNanoTime=689265251811873, ackStatus=SUCCESS)
2020-04-02 05:08:15,873 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022
2020-04-02 05:08:15,881 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:15,880 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35374, dest: /127.0.0.1:45580, bytes: 369, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, duration(ns): 43170868
2020-04-02 05:08:15,873 [IPC Server handler 7 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 7 on 35215, call Call#226 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:60408: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /TC5/foo2 for DFSClient_NONMAPREDUCE_1459596895_1 on 127.0.0.1 because this file lease is currently owned by DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1
2020-04-02 05:08:15,882 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1022 on 127.0.0.1:45580 size 369 replicaState = FINALIZED
2020-04-02 05:08:15,882 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:15,882 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741839_1022 (size=246)
2020-04-02 05:08:15,882 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1022 is received from 127.0.0.1:45580
2020-04-02 05:08:15,882 [main] INFO  hdfs.AppendTestUtil (TestFileAppend3.java:testTC5ForAppend2(275)) - GOOD: got an exception
org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException): Failed to APPEND_FILE /TC5/foo2 for DFSClient_NONMAPREDUCE_1459596895_1 on 127.0.0.1 because this file lease is currently owned by DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.recoverLeaseInternal(FSNamesystem.java:2600)
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:124)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2635)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:805)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:487)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:523)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:991)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:872)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:818)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1729)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2678)

	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1511)
	at org.apache.hadoop.ipc.Client.call(Client.java:1457)
	at org.apache.hadoop.ipc.Client.call(Client.java:1367)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:228)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:116)
	at com.sun.proxy.$Proxy24.append(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.append(ClientNamenodeProtocolTranslatorPB.java:393)
	at sun.reflect.GeneratedMethodAccessor24.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:422)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeMethod(RetryInvocationHandler.java:165)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invoke(RetryInvocationHandler.java:157)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeOnce(RetryInvocationHandler.java:95)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:359)
	at com.sun.proxy.$Proxy28.append(Unknown Source)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1322)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1344)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1413)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1383)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:427)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:423)
	at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)
	at org.apache.hadoop.hdfs.DistributedFileSystem.append(DistributedFileSystem.java:435)
	at org.apache.hadoop.hdfs.TestFileAppend3.testTC5ForAppend2(TestFileAppend3.java:271)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2020-04-02 05:08:15,883 [main] DEBUG hdfs.DFSClient (DFSClient.java:<init>(316)) - Sets dfs.client.block.write.replace-datanode-on-failure.min-replication to 0
2020-04-02 05:08:15,882 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:15,884 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:15,882 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:15,882 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:15,884 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:15,898 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60604, dest: /127.0.0.1:45739, bytes: 369, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, duration(ns): 60998210
2020-04-02 05:08:15,898 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35374 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:15,898 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8889706 flag: 0 flag: 0
2020-04-02 05:08:15,898 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: closing
2020-04-02 05:08:15,899 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] terminating
2020-04-02 05:08:15,898 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8889706 flag: 0 flag: 0
2020-04-02 05:08:15,899 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60604 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:15,900 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38192, dest: /127.0.0.1:43434, bytes: 369, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, duration(ns): 63824597
2020-04-02 05:08:15,906 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:15,906 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 25794944 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:15,907 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580] terminating
2020-04-02 05:08:15,909 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]: closing
2020-04-02 05:08:15,910 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:15,910 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC5/foo2 for DFSClient_NONMAPREDUCE_-1193487698_1 at 127.0.0.1
2020-04-02 05:08:15,910 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC5/foo2, holder=DFSClient_NONMAPREDUCE_-1193487698_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,911 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38192 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1021]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:15,910 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1022 on 127.0.0.1:45739 size 369 replicaState = FINALIZED
2020-04-02 05:08:15,914 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:15,914 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1022 is received from 127.0.0.1:45739
2020-04-02 05:08:15,914 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:15,914 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1022 on 127.0.0.1:43434 size 369 replicaState = FINALIZED
2020-04-02 05:08:15,914 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:15,914 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1022 (size=246)
2020-04-02 05:08:15,914 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1022 is received from 127.0.0.1:43434
2020-04-02 05:08:15,914 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:15,914 [IPC Server handler 0 on 35215] WARN  hdfs.StateChange (FSDirAppendOp.java:appendFile(145)) - DIR* NameSystem.append: Failed to APPEND_FILE /TC5/foo2 for DFSClient_NONMAPREDUCE_-1193487698_1 on 127.0.0.1 because this file lease is currently owned by DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1
2020-04-02 05:08:15,915 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:15,915 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:15,915 [IPC Server handler 2 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:15,915 [IPC Server handler 0 on 35215] INFO  ipc.Server (Server.java:logException(2715)) - IPC Server handler 0 on 35215, call Call#228 Retry#0 org.apache.hadoop.hdfs.protocol.ClientProtocol.append from 127.0.0.1:60410: org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException: Failed to APPEND_FILE /TC5/foo2 for DFSClient_NONMAPREDUCE_-1193487698_1 on 127.0.0.1 because this file lease is currently owned by DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1
2020-04-02 05:08:15,918 [main] INFO  hdfs.AppendTestUtil (TestFileAppend3.java:testTC5ForAppend2(282)) - GOOD: got an exception
org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.hdfs.protocol.AlreadyBeingCreatedException): Failed to APPEND_FILE /TC5/foo2 for DFSClient_NONMAPREDUCE_-1193487698_1 on 127.0.0.1 because this file lease is currently owned by DFSClient_NONMAPREDUCE_-96199515_1 on 127.0.0.1
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.recoverLeaseInternal(FSNamesystem.java:2600)
	at org.apache.hadoop.hdfs.server.namenode.FSDirAppendOp.appendFile(FSDirAppendOp.java:124)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.appendFile(FSNamesystem.java:2635)
	at org.apache.hadoop.hdfs.server.namenode.NameNodeRpcServer.append(NameNodeRpcServer.java:805)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolServerSideTranslatorPB.append(ClientNamenodeProtocolServerSideTranslatorPB.java:487)
	at org.apache.hadoop.hdfs.protocol.proto.ClientNamenodeProtocolProtos$ClientNamenodeProtocol$2.callBlockingMethod(ClientNamenodeProtocolProtos.java)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Server$ProtoBufRpcInvoker.call(ProtobufRpcEngine.java:523)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:991)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:872)
	at org.apache.hadoop.ipc.Server$RpcCall.run(Server.java:818)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1729)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:2678)

	at org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1511)
	at org.apache.hadoop.ipc.Client.call(Client.java:1457)
	at org.apache.hadoop.ipc.Client.call(Client.java:1367)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:228)
	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:116)
	at com.sun.proxy.$Proxy24.append(Unknown Source)
	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.append(ClientNamenodeProtocolTranslatorPB.java:393)
	at sun.reflect.GeneratedMethodAccessor24.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:422)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeMethod(RetryInvocationHandler.java:165)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invoke(RetryInvocationHandler.java:157)
	at org.apache.hadoop.io.retry.RetryInvocationHandler$Call.invokeOnce(RetryInvocationHandler.java:95)
	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:359)
	at com.sun.proxy.$Proxy28.append(Unknown Source)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1322)
	at org.apache.hadoop.hdfs.DFSClient.callAppend(DFSClient.java:1344)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1413)
	at org.apache.hadoop.hdfs.DFSClient.append(DFSClient.java:1383)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:427)
	at org.apache.hadoop.hdfs.DistributedFileSystem$5.doCall(DistributedFileSystem.java:423)
	at org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)
	at org.apache.hadoop.hdfs.DistributedFileSystem.append(DistributedFileSystem.java:435)
	at org.apache.hadoop.hdfs.DistributedFileSystem.append(DistributedFileSystem.java:404)
	at org.apache.hadoop.fs.FileSystem.append(FileSystem.java:1379)
	at org.apache.hadoop.hdfs.TestFileAppend3.testTC5ForAppend2(TestFileAppend3.java:279)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2020-04-02 05:08:15,918 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,919 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:15,919 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022 block size 369
2020-04-02 05:08:15,920 [IPC Server handler 4 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:15,920 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC5/foo2 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:15,920 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC5/foo2 with 1 blocks is persisted to the file system
2020-04-02 05:08:15,920 [IPC Server handler 1 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC5/foo2 is closed by DFSClient_NONMAPREDUCE_-96199515_1
[msx] test Finished org.apache.hadoop.hdfs.TestFileAppend3#testTC5ForAppend2
[msx] writeFile testName = org.apache.hadoop.hdfs.TestFileAppend3#testTC5ForAppend2
2020-04-02 05:08:15,922 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=147, chunksPerPacket=1, packetSize=147
[msx] succeed
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
[msx] test Started org.apache.hadoop.hdfs.TestFileAppend3#testAppendToPartialChunkforAppend2
[msx] perform reset as unitTestCounterInClass 10 is larger than zero
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
p=/partialChunk/foo0
2020-04-02 05:08:15,923 [main] INFO  hdfs.AppendTestUtil (AppendTestUtil.java:initialValue(64)) - main: seed=6868110525040172249
2020-04-02 05:08:15,923 [main] INFO  hdfs.AppendTestUtil (AppendTestUtil.java:randomBytes(79)) - seed=-1012752960, size=513
2020-04-02 05:08:15,923 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=147, chunksPerPacket=1, bytesCurBlock=369, DFSOutputStream:blk_1073741839_1022
2020-04-02 05:08:15,927 [main] DEBUG hdfs.DFSClient (DFSClient.java:create(1210)) - /partialChunk/foo0: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-04-02 05:08:15,927 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:15,929 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(757)) - *DIR* NameNode.create: file /partialChunk/foo0 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:15,929 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2385)) - DIR* NameSystem.startFile: src=/partialChunk/foo0, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1, createParent=true, replication=1, createFlag=[CREATE, OVERWRITE], blockSize=1024, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-04-02 05:08:15,930 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirMkdirOp.java:createSingleDirectory(182)) - mkdirs: created directory /partialChunk
2020-04-02 05:08:15,930 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(585)) - DIR* addFile: foo0 is added
2020-04-02 05:08:15,930 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(416)) - DIR* NameSystem.startFile: added /partialChunk/foo0 inode 16403 DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:15,930 [IPC Server handler 6 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/partialChunk/foo0	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:15,932 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/partialChunk/foo0, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:15,935 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/partialChunk/foo0, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:15,935 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, newGs=1024, bytesRcvd=[369, 369]
  targets=[127.0.0.1:45580, 127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:15,935 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:15,935 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:15,936 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022 src: /127.0.0.1:60618 dest: /127.0.0.1:45739
2020-04-02 05:08:15,936 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022
 storageType=DISK, inAddr=/127.0.0.1:60618, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1024, minBytesRcvd=369, maxBytesRcvd=369
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:15,936 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1022, FINALIZED
  getNumBytes()     = 369
  getBytesOnDisk()  = 369
  getVisibleLength()= 369
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:15,942 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /partialChunk/foo0  inodeId 16403 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:15,943 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /partialChunk/foo0 with blk_1073741841_1025 block is added to the in-memory file system
2020-04-02 05:08:15,943 [IPC Server handler 8 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741841_1025, replicas=127.0.0.1:43230 for /partialChunk/foo0
2020-04-02 05:08:15,943 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /partialChunk/foo0 with new block blk_1073741841_1025, current total block count is 1
2020-04-02 05:08:15,945 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@4a9f80d3] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:15,947 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-04-02 05:08:15,947 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:15,948 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:15,948 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025 src: /127.0.0.1:57272 dest: /127.0.0.1:43230
2020-04-02 05:08:15,948 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025
 storageType=DISK, inAddr=/127.0.0.1:57272, myAddr=/127.0.0.1:43230
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43230
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9e64160f-8239-40bc-b495-871e2ebb5a3a
2020-04-02 05:08:15,948 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741841 of size 0
2020-04-02 05:08:15,949 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741841_1025.meta of size 0
2020-04-02 05:08:15,950 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:15,951 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025: PacketHeader with packetLen=9 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 1

2020-04-02 05:08:15,959 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1, ackEnqueueNanoTime=689265337175405, ackStatus=SUCCESS)
2020-04-02 05:08:15,961 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:15,961 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:15,977 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 369
2020-04-02 05:08:15,977 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1024.meta of size 11
2020-04-02 05:08:15,977 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:15,978 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:15,979 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, newGs=1024, bytesRcvd=[369, 369]
  targets=[127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:15,980 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:15,980 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:15,980 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022 src: /127.0.0.1:35394 dest: /127.0.0.1:45580
2020-04-02 05:08:15,980 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022
 storageType=DISK, inAddr=/127.0.0.1:35394, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_APPEND, newGs=1024, minBytesRcvd=369, maxBytesRcvd=369
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:15,980 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1022, FINALIZED
  getNumBytes()     = 369
  getBytesOnDisk()  = 369
  getVisibleLength()= 369
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:15,985 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025: PacketHeader with packetLen=4 header data: offsetInBlock: 1
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:15,985 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025
2020-04-02 05:08:15,986 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1, ackEnqueueNanoTime=689265364131413, ackStatus=SUCCESS)
2020-04-02 05:08:15,986 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57272, dest: /127.0.0.1:43230, bytes: 1, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, duration(ns): 35698614
2020-04-02 05:08:15,987 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:15,987 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:15,987 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:15,987 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:15,987 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43230:Number of active connections is: 2
2020-04-02 05:08:15,996 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741841_1025 on 127.0.0.1:43230 size 1 replicaState = FINALIZED
2020-04-02 05:08:15,996 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:15,997 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43230 is added to blk_1073741841_1025 (size=0)
2020-04-02 05:08:15,997 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741841_1025 is received from 127.0.0.1:43230
2020-04-02 05:08:15,997 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43230 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:15,998 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /partialChunk/foo0 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:15,998 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /partialChunk/foo0 with 1 blocks is persisted to the file system
2020-04-02 05:08:15,998 [IPC Server handler 5 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /partialChunk/foo0 is closed by DFSClient_NONMAPREDUCE_-96199515_1
Wrote 1 byte and closed the file /partialChunk/foo0
2020-04-02 05:08:16,002 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /partialChunk/foo0 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:16,002 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/partialChunk/foo0, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:16,002 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /partialChunk/foo0 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025 block size 1
2020-04-02 05:08:16,002 [IPC Server handler 3 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/partialChunk/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:16,004 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/partialChunk/foo0, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:16,006 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/partialChunk/foo0, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:blk_1073741841_1025
2020-04-02 05:08:16,010 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:flushOrSync(635)) - DFSClient flush():  bytesCurBlock=1, lastFlushOffset=0, createNewBlock=false
2020-04-02 05:08:16,014 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 369
2020-04-02 05:08:16,014 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1024.meta of size 11
2020-04-02 05:08:16,014 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:16,015 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /partialChunk/foo0  inodeId 16403 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,016 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /partialChunk/foo0 with blk_1073741842_1026 block is added to the in-memory file system
2020-04-02 05:08:16,016 [IPC Server handler 2 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741842_1026, replicas=127.0.0.1:45739 for /partialChunk/foo0
2020-04-02 05:08:16,016 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /partialChunk/foo0 with new block blk_1073741842_1026, current total block count is 2
2020-04-02 05:08:16,018 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 3
2020-04-02 05:08:16,020 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,021 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,021 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,021 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026 src: /127.0.0.1:60640 dest: /127.0.0.1:45739
2020-04-02 05:08:16,021 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026
 storageType=DISK, inAddr=/127.0.0.1:60640, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:16,021 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741842 of size 0
2020-04-02 05:08:16,021 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741842_1026.meta of size 0
2020-04-02 05:08:16,022 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:16,026 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026: PacketHeader with packetLen=9 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 1

2020-04-02 05:08:16,026 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1, ackEnqueueNanoTime=689265404874624, ackStatus=SUCCESS)
2020-04-02 05:08:16,027 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,027 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,031 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022, newGs=1024, bytesRcvd=[369, 369]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,031 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,031 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,031 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022 src: /127.0.0.1:38230 dest: /127.0.0.1:43434
2020-04-02 05:08:16,031 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022
 storageType=DISK, inAddr=/127.0.0.1:38230, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1024, minBytesRcvd=369, maxBytesRcvd=369
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:16,031 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1022, FINALIZED
  getNumBytes()     = 369
  getBytesOnDisk()  = 369
  getVisibleLength()= 369
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:16,041 [IPC Server handler 0 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:fsync(3274)) - BLOCK* fsync: /partialChunk/foo0 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,041 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /partialChunk/foo0 with 2 blocks is persisted to the file system
2020-04-02 05:08:16,043 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/partialChunk/foo0, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:blk_1073741842_1026
2020-04-02 05:08:16,044 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026: PacketHeader with packetLen=9 header data: offsetInBlock: 0
seqno: 1
lastPacketInBlock: false
dataLen: 1

2020-04-02 05:08:16,044 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=1, ackEnqueueNanoTime=689265422923366, ackStatus=SUCCESS)
2020-04-02 05:08:16,050 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,050 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,051 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026: PacketHeader with packetLen=4 header data: offsetInBlock: 1
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,051 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026
2020-04-02 05:08:16,051 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=1, ackEnqueueNanoTime=689265429350175, ackStatus=SUCCESS)
2020-04-02 05:08:16,053 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,053 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60640, dest: /127.0.0.1:45739, bytes: 1, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, duration(ns): 24470562
2020-04-02 05:08:16,054 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,054 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:16,054 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:16,054 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60640 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 4
2020-04-02 05:08:16,058 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741842_1026 on 127.0.0.1:45739 size 1 replicaState = FINALIZED
2020-04-02 05:08:16,058 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,058 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741842_1026 (size=1)
2020-04-02 05:08:16,058 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741842_1026 is received from 127.0.0.1:45739
2020-04-02 05:08:16,058 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1024 on 127.0.0.1:45739 size 134217728 replicaState = RBW
2020-04-02 05:08:16,058 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,058 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741839_1024 is received from 127.0.0.1:45739
2020-04-02 05:08:16,058 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 1, received: 1, deleted: 0
2020-04-02 05:08:16,067 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /partialChunk/foo0 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,067 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /partialChunk/foo0 with 2 blocks is persisted to the file system
2020-04-02 05:08:16,067 [IPC Server handler 1 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /partialChunk/foo0 is closed by DFSClient_NONMAPREDUCE_-96199515_1
Append 1 byte and closed the file /partialChunk/foo0
2020-04-02 05:08:16,073 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /partialChunk/foo0 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:16,073 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/partialChunk/foo0, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:16,074 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /partialChunk/foo0 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026 block size 1
2020-04-02 05:08:16,074 [IPC Server handler 9 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/partialChunk/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:16,076 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/partialChunk/foo0, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:16,078 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/partialChunk/foo0, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:blk_1073741842_1026
2020-04-02 05:08:16,078 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:flushOrSync(635)) - DFSClient flush():  bytesCurBlock=1, lastFlushOffset=0, createNewBlock=false
2020-04-02 05:08:16,080 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /partialChunk/foo0  inodeId 16403 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,081 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /partialChunk/foo0 with blk_1073741843_1027 block is added to the in-memory file system
2020-04-02 05:08:16,081 [IPC Server handler 6 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741843_1027, replicas=127.0.0.1:45739 for /partialChunk/foo0
2020-04-02 05:08:16,081 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /partialChunk/foo0 with new block blk_1073741843_1027, current total block count is 3
2020-04-02 05:08:16,083 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 369
2020-04-02 05:08:16,083 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1024.meta of size 11
2020-04-02 05:08:16,084 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,087 [IPC Server handler 8 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1022, newGS=1024, newLength=369, newNodes=[127.0.0.1:45739, 127.0.0.1:45580, 127.0.0.1:43434], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:16,087 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1024 from 127.0.0.1:45580
2020-04-02 05:08:16,087 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-089629a9-5898-4562-bd81-79a4f45c96c1:NORMAL:127.0.0.1:45580|RBW] of blk_1073741839_1022
2020-04-02 05:08:16,087 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1024 from 127.0.0.1:43434
2020-04-02 05:08:16,087 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1022
2020-04-02 05:08:16,088 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:16,088 [IPC Server handler 8 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1022 => blk_1073741839_1024) success
2020-04-02 05:08:16,090 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 4
2020-04-02 05:08:16,094 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024: PacketHeader with packetLen=131 header data: offsetInBlock: 369
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:16,094 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=492, ackEnqueueNanoTime=689265472955029, ackStatus=SUCCESS)
2020-04-02 05:08:16,094 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,095 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,095 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,100 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027 src: /127.0.0.1:60648 dest: /127.0.0.1:45739
2020-04-02 05:08:16,100 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027
 storageType=DISK, inAddr=/127.0.0.1:60648, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:16,100 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741843 of size 0
2020-04-02 05:08:16,101 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741843_1027.meta of size 0
2020-04-02 05:08:16,095 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024: previous write did not end at the chunk boundary. onDiskLen=369
2020-04-02 05:08:16,099 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024: PacketHeader with packetLen=131 header data: offsetInBlock: 369
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:16,101 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=492, ackEnqueueNanoTime=689265479788211, ackStatus=SUCCESS)
2020-04-02 05:08:16,101 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024: previous write did not end at the chunk boundary. onDiskLen=369
2020-04-02 05:08:16,101 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024: sizePartialChunk=369, block offset=0, metafile offset=7
2020-04-02 05:08:16,102 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024
2020-04-02 05:08:16,102 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:16,102 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024: sizePartialChunk=369, block offset=0, metafile offset=7
2020-04-02 05:08:16,102 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024
2020-04-02 05:08:16,102 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:16,102 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024: PacketHeader with packetLen=131 header data: offsetInBlock: 369
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:16,103 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,103 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024: previous write did not end at the chunk boundary. onDiskLen=369
2020-04-02 05:08:16,110 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024: sizePartialChunk=369, block offset=0, metafile offset=7
2020-04-02 05:08:16,111 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024
2020-04-02 05:08:16,111 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:16,111 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=492, ackEnqueueNanoTime=689265489968592, ackStatus=SUCCESS)
2020-04-02 05:08:16,113 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,113 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,113 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,113 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 11929759 flag: 0 flag: 0
2020-04-02 05:08:16,114 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 11929759 flag: 0 flag: 0
2020-04-02 05:08:16,114 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027: PacketHeader with packetLen=9 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 1

2020-04-02 05:08:16,114 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 19343191 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:16,114 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1, ackEnqueueNanoTime=689265492659114, ackStatus=SUCCESS)
2020-04-02 05:08:16,118 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024: PacketHeader with packetLen=4 header data: offsetInBlock: 492
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,119 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=492, ackEnqueueNanoTime=689265497605007, ackStatus=SUCCESS)
2020-04-02 05:08:16,119 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024
2020-04-02 05:08:16,119 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024: PacketHeader with packetLen=4 header data: offsetInBlock: 492
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,119 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,120 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=492, ackEnqueueNanoTime=689265498784094, ackStatus=SUCCESS)
2020-04-02 05:08:16,120 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024
2020-04-02 05:08:16,121 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024: PacketHeader with packetLen=4 header data: offsetInBlock: 492
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,121 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024
2020-04-02 05:08:16,121 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,121 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=492, ackEnqueueNanoTime=689265499395148, ackStatus=SUCCESS)
2020-04-02 05:08:16,127 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38230, dest: /127.0.0.1:43434, bytes: 492, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, duration(ns): 42271764
2020-04-02 05:08:16,128 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,128 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:16,128 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,128 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:16,129 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38230 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:16,131 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35394, dest: /127.0.0.1:45580, bytes: 492, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, duration(ns): 45083875
2020-04-02 05:08:16,131 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7781779 flag: 0 flag: 0
2020-04-02 05:08:16,131 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7781779 flag: 0 flag: 0
2020-04-02 05:08:16,131 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:16,131 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:16,142 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,143 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1024 on 127.0.0.1:43434 size 492 replicaState = FINALIZED
2020-04-02 05:08:16,143 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,143 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1024 (size=369)
2020-04-02 05:08:16,143 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1024 is received from 127.0.0.1:43434
2020-04-02 05:08:16,143 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:16,144 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35394 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:16,145 [IPC Server handler 2 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 2 blocks.
2020-04-02 05:08:16,136 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60618, dest: /127.0.0.1:45739, bytes: 492, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, duration(ns): 48729352
2020-04-02 05:08:16,138 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,150 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 12211123 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:16,137 [IPC Server handler 5 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:fsync(3274)) - BLOCK* fsync: /partialChunk/foo0 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,151 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]: closing
2020-04-02 05:08:16,150 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:43434] terminating
2020-04-02 05:08:16,150 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741843_1027 on 127.0.0.1:45739 size 1024 replicaState = RBW
2020-04-02 05:08:16,151 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,151 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741843_1027 is received from 127.0.0.1:45739
2020-04-02 05:08:16,151 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 1, received: 0, deleted: 0
2020-04-02 05:08:16,152 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /partialChunk/foo0 with 3 blocks is persisted to the file system
2020-04-02 05:08:16,152 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1024 on 127.0.0.1:45739 size 492 replicaState = FINALIZED
2020-04-02 05:08:16,152 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,152 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1024 is received from 127.0.0.1:45739
2020-04-02 05:08:16,153 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:16,153 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1024 on 127.0.0.1:45580 size 492 replicaState = FINALIZED
2020-04-02 05:08:16,153 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,153 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741839_1024 (size=369)
2020-04-02 05:08:16,153 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1024 is received from 127.0.0.1:45580
2020-04-02 05:08:16,153 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:16,152 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60618 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1022]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 5
Append and flush 1 byte
2020-04-02 05:08:16,154 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/partialChunk/foo0, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:blk_1073741843_1027
2020-04-02 05:08:16,154 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:flushOrSync(635)) - DFSClient flush():  bytesCurBlock=3, lastFlushOffset=1, createNewBlock=false
2020-04-02 05:08:16,158 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027: PacketHeader with packetLen=11 header data: offsetInBlock: 0
seqno: 1
lastPacketInBlock: false
dataLen: 3

2020-04-02 05:08:16,159 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=3, ackEnqueueNanoTime=689265537218377, ackStatus=SUCCESS)
2020-04-02 05:08:16,161 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,162 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,162 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,173 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:16,173 [IPC Server handler 0 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,175 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:16,175 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:16,176 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024 block size 492
2020-04-02 05:08:16,176 [IPC Server handler 4 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
Append and flush 2 byte
2020-04-02 05:08:16,177 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=24, chunksPerPacket=1, packetSize=24
2020-04-02 05:08:16,178 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=2, src=/partialChunk/foo0, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:blk_1073741843_1027
2020-04-02 05:08:16,178 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027: PacketHeader with packetLen=519 header data: offsetInBlock: 0
seqno: 2
lastPacketInBlock: false
dataLen: 511

2020-04-02 05:08:16,179 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=511, ackEnqueueNanoTime=689265557163750, ackStatus=SUCCESS)
2020-04-02 05:08:16,179 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=24, chunksPerPacket=1, bytesCurBlock=492, DFSOutputStream:blk_1073741839_1024
2020-04-02 05:08:16,179 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:16,179 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/testSmallAppendRace, packetSize=65016, chunksPerPacket=126, bytesCurBlock=512, DFSOutputStream:blk_1073741839_1024
2020-04-02 05:08:16,182 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,182 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,183 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027: PacketHeader with packetLen=4 header data: offsetInBlock: 511
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,183 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027
2020-04-02 05:08:16,183 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=511, ackEnqueueNanoTime=689265561592069, ackStatus=SUCCESS)
2020-04-02 05:08:16,188 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60648, dest: /127.0.0.1:45739, bytes: 511, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, duration(ns): 83609961
2020-04-02 05:08:16,188 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,188 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE, replyAck=seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,188 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741843_1027 on 127.0.0.1:45739 size 511 replicaState = FINALIZED
2020-04-02 05:08:16,188 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:16,188 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:16,188 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,189 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741843_1027 (size=1)
2020-04-02 05:08:16,189 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741843_1027 is received from 127.0.0.1:45739
2020-04-02 05:08:16,189 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:16,190 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60648 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:16,215 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /partialChunk/foo0 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,215 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /partialChunk/foo0 with 3 blocks is persisted to the file system
2020-04-02 05:08:16,215 [IPC Server handler 6 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /partialChunk/foo0 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,217 [RedundancyMonitor] DEBUG blockmanagement.BlockManager (ReplicationWork.java:<init>(36)) - Creating a ReplicationWork to reconstruct blk_1073741834_1014
Flush 508 byte and closed the file /partialChunk/foo0
2020-04-02 05:08:16,219 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:validateReconstructionWork(2054)) - BLOCK* block blk_1073741834_1014 is moved from neededReconstruction to pendingReconstruction
2020-04-02 05:08:16,219 [RedundancyMonitor] DEBUG BlockStateChange (LowRedundancyBlocks.java:remove(376)) - BLOCK* NameSystem.LowRedundancyBlock.remove: Removing block blk_1073741834_1014 from priority queue 0
2020-04-02 05:08:16,219 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1895)) - BLOCK* ask [127.0.0.1:44971] to replicate blk_1073741834_1014 to datanode(s) 127.0.0.1:45580
2020-04-02 05:08:16,219 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 1
2020-04-02 05:08:16,219 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:invalidateWorkForOneNode(4375)) - BLOCK* BlockManager: ask 127.0.0.1:43434 to delete [blk_1073741834_1013]
2020-04-02 05:08:16,220 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:16,222 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, newGs=1028, bytesRcvd=[492, 492]
  targets=[127.0.0.1:43434, 127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,222 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,222 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,222 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024 src: /127.0.0.1:60658 dest: /127.0.0.1:45739
2020-04-02 05:08:16,222 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024
 storageType=DISK, inAddr=/127.0.0.1:60658, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1028, minBytesRcvd=492, maxBytesRcvd=492
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:16,222 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1024, FINALIZED
  getNumBytes()     = 492
  getBytesOnDisk()  = 492
  getVisibleLength()= 492
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:16,234 [IPC Server handler 8 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/partialChunk/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:16,250 [IPC Server handler 7 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741841_1025, blk_1073741842_1026, blk_1073741843_1027]
2020-04-02 05:08:16,251 [IPC Server handler 7 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/partialChunk/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:16,253 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(242)) - newInfo = LocatedBlocks{;  fileLength=513;  underConstruction=false;  blocks=[LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025; getBlockSize()=1; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:43230,DS-9e64160f-8239-40bc-b495-871e2ebb5a3a,DISK]]}, LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026; getBlockSize()=1; corrupt=false; offset=1; locs=[DatanodeInfoWithStorage[127.0.0.1:45739,DS-d49b8d06-4514-41da-af7b-faacf4f00b86,DISK]]}, LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027; getBlockSize()=511; corrupt=false; offset=2; locs=[DatanodeInfoWithStorage[127.0.0.1:45739,DS-6946cabd-2f8d-451f-81bc-4884ebba8665,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027; getBlockSize()=511; corrupt=false; offset=2; locs=[DatanodeInfoWithStorage[127.0.0.1:45739,DS-6946cabd-2f8d-451f-81bc-4884ebba8665,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-04-02 05:08:16,254 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:43230
2020-04-02 05:08:16,255 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@4a9f80d3] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:16,258 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, replica=FinalizedReplica, blk_1073741841_1025, FINALIZED
  getNumBytes()     = 1
  getBytesOnDisk()  = 1
  getVisibleLength()= 1
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741841
2020-04-02 05:08:16,259 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741841_1025, FINALIZED
  getNumBytes()     = 1
  getBytesOnDisk()  = 1
  getVisibleLength()= 1
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741841
2020-04-02 05:08:16,259 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:43230, dest: /127.0.0.1:57312, bytes: 5, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741841_1025, duration(ns): 281370
2020-04-02 05:08:16,261 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:16,266 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 492
2020-04-02 05:08:16,267 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1028.meta of size 11
2020-04-02 05:08:16,267 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:16,268 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:16,269 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, newGs=1028, bytesRcvd=[492, 492]
  targets=[127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,269 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,269 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,269 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024 src: /127.0.0.1:38254 dest: /127.0.0.1:43434
2020-04-02 05:08:16,270 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024
 storageType=DISK, inAddr=/127.0.0.1:38254, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1028, minBytesRcvd=492, maxBytesRcvd=492
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:16,270 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1024, FINALIZED
  getNumBytes()     = 492
  getBytesOnDisk()  = 492
  getVisibleLength()= 492
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:16,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, replica=FinalizedReplica, blk_1073741842_1026, FINALIZED
  getNumBytes()     = 1
  getBytesOnDisk()  = 1
  getVisibleLength()= 1
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741842
2020-04-02 05:08:16,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741842_1026, FINALIZED
  getNumBytes()     = 1
  getBytesOnDisk()  = 1
  getVisibleLength()= 1
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741842
2020-04-02 05:08:16,272 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:45739, dest: /127.0.0.1:60328, bytes: 5, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741842_1026, duration(ns): 245464
2020-04-02 05:08:16,272 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:16,274 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, replica=FinalizedReplica, blk_1073741843_1027, FINALIZED
  getNumBytes()     = 511
  getBytesOnDisk()  = 511
  getVisibleLength()= 511
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741843
2020-04-02 05:08:16,274 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741843_1027, FINALIZED
  getNumBytes()     = 511
  getBytesOnDisk()  = 511
  getVisibleLength()= 511
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741843
2020-04-02 05:08:16,275 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:45739, dest: /127.0.0.1:60328, bytes: 515, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741843_1027, duration(ns): 165461
[msx] test Finished org.apache.hadoop.hdfs.TestFileAppend3#testAppendToPartialChunkforAppend2
[msx] writeFile testName = org.apache.hadoop.hdfs.TestFileAppend3#testAppendToPartialChunkforAppend2
[msx] succeed
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
[msx] test Started org.apache.hadoop.hdfs.TestFileAppend3#testAppendToPartialChunk
[msx] perform reset as unitTestCounterInClass 11 is larger than zero
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
p=/partialChunk/foo1
2020-04-02 05:08:16,285 [main] INFO  hdfs.AppendTestUtil (AppendTestUtil.java:randomBytes(79)) - seed=-1012752960, size=513
2020-04-02 05:08:16,287 [main] DEBUG hdfs.DFSClient (DFSClient.java:create(1210)) - /partialChunk/foo1: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-04-02 05:08:16,289 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(757)) - *DIR* NameNode.create: file /partialChunk/foo1 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:16,289 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2385)) - DIR* NameSystem.startFile: src=/partialChunk/foo1, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1, createParent=true, replication=1, createFlag=[CREATE, OVERWRITE], blockSize=1024, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-04-02 05:08:16,289 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(585)) - DIR* addFile: foo1 is added
2020-04-02 05:08:16,290 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(416)) - DIR* NameSystem.startFile: added /partialChunk/foo1 inode 16404 DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,290 [IPC Server handler 2 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/partialChunk/foo1	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:16,291 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/partialChunk/foo1, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:16,293 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/partialChunk/foo1, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:16,297 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /partialChunk/foo1  inodeId 16404 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,298 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:16,298 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /partialChunk/foo1 with blk_1073741844_1029 block is added to the in-memory file system
2020-04-02 05:08:16,298 [IPC Server handler 3 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741844_1029, replicas=127.0.0.1:45580 for /partialChunk/foo1
2020-04-02 05:08:16,298 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /partialChunk/foo1 with new block blk_1073741844_1029, current total block count is 1
2020-04-02 05:08:16,303 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:16,305 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35430 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,305 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35430 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,305 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35430 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,306 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35430 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029 src: /127.0.0.1:35430 dest: /127.0.0.1:45580
2020-04-02 05:08:16,306 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35430 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029
 storageType=DISK, inAddr=/127.0.0.1:35430, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:16,306 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35430 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741844 of size 0
2020-04-02 05:08:16,306 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35430 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741844_1029.meta of size 0
2020-04-02 05:08:16,314 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,314 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 492
2020-04-02 05:08:16,314 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1028.meta of size 11
2020-04-02 05:08:16,315 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:16,315 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 4
2020-04-02 05:08:16,317 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35430 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029: PacketHeader with packetLen=9 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 1

2020-04-02 05:08:16,318 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:16,321 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35430 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1, ackEnqueueNanoTime=689265700024418, ackStatus=SUCCESS)
2020-04-02 05:08:16,322 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024, newGs=1028, bytesRcvd=[492, 492]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,322 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,322 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,322 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024 src: /127.0.0.1:35432 dest: /127.0.0.1:45580
2020-04-02 05:08:16,322 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024
 storageType=DISK, inAddr=/127.0.0.1:35432, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_APPEND, newGs=1028, minBytesRcvd=492, maxBytesRcvd=492
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:16,323 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1024, FINALIZED
  getNumBytes()     = 492
  getBytesOnDisk()  = 492
  getVisibleLength()= 492
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:16,323 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:16,322 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,326 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,326 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:16,331 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,332 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741844_1029 on 127.0.0.1:45580 size 1024 replicaState = RBW
2020-04-02 05:08:16,332 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,332 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741844_1029 is received from 127.0.0.1:45580
2020-04-02 05:08:16,332 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 1, received: 0, deleted: 0
2020-04-02 05:08:16,333 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (DataNode.java:transferBlock(2353)) - DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) Starting thread to transfer BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014 to 127.0.0.1:45580 
2020-04-02 05:08:16,337 [org.apache.hadoop.hdfs.server.datanode.DataNode$DataTransfer@58e0d9b5] DEBUG datanode.DataNode (DataNode.java:run(2522)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:16,337 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 5
2020-04-02 05:08:16,338 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35430 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029: PacketHeader with packetLen=4 header data: offsetInBlock: 1
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,338 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35430 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029
2020-04-02 05:08:16,338 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35430 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1, ackEnqueueNanoTime=689265716433528, ackStatus=SUCCESS)
2020-04-02 05:08:16,339 [org.apache.hadoop.hdfs.server.datanode.DataNode$DataTransfer@58e0d9b5] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, replica=FinalizedReplica, blk_1073741834_1014, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741834
2020-04-02 05:08:16,340 [org.apache.hadoop.hdfs.server.datanode.DataNode$DataTransfer@58e0d9b5] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741834_1014, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741834
2020-04-02 05:08:16,341 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:16,342 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,342 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1028 on 127.0.0.1:45739 size 134217728 replicaState = RBW
2020-04-02 05:08:16,342 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,343 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741839_1028 is received from 127.0.0.1:45739
2020-04-02 05:08:16,343 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 1, received: 0, deleted: 0
2020-04-02 05:08:16,343 [DataXceiver for client  at /127.0.0.1:35434 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=0, srcDataNode=127.0.0.1:44971, pinning=false
2020-04-02 05:08:16,343 [DataXceiver for client  at /127.0.0.1:35434 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=true, isClient=false, isTransfer=false
2020-04-02 05:08:16,345 [DataXceiver for client  at /127.0.0.1:35434 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,345 [DataXceiver for client  at /127.0.0.1:35434 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014 src: /127.0.0.1:35434 dest: /127.0.0.1:45580
2020-04-02 05:08:16,345 [DataXceiver for client  at /127.0.0.1:35434 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014
 storageType=DISK, inAddr=/127.0.0.1:35434, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=, srcDataNode=127.0.0.1:44971, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=true, readahead=4194304)
 allowLazyPersist=false, pinning=false, isClient=false, isDatanode=true, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:16,345 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:deleteAsync(225)) - Scheduling blk_1073741834_1013 replica ReplicaBeingWritten, blk_1073741834_1013, RBW
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741834
  bytesAcked=32768
  bytesOnDisk=32768 for deletion
2020-04-02 05:08:16,347 [org.apache.hadoop.hdfs.server.datanode.DataNode$DataTransfer@58e0d9b5] INFO  datanode.DataNode (DataNode.java:run(2566)) - DataTransfer, at 127.0.0.1:44971: Transmitted BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014 (numBytes=65536) to /127.0.0.1:45580
2020-04-02 05:08:16,351 [Async disk worker #0 for volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:run(333)) - Deleted BP-1786648874-172.17.0.4-1585804085136 blk_1073741834_1013 URI file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741834
2020-04-02 05:08:16,363 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 492
2020-04-02 05:08:16,364 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,364 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35430, dest: /127.0.0.1:45580, bytes: 1, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, duration(ns): 24437182
2020-04-02 05:08:16,364 [DataXceiver for client  at /127.0.0.1:35434 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/tmp/blk_1073741834 of size 0
2020-04-02 05:08:16,364 [DataXceiver for client  at /127.0.0.1:35434 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/tmp/blk_1073741834_1014.meta of size 0
2020-04-02 05:08:16,364 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1028.meta of size 11
2020-04-02 05:08:16,365 [DataXceiver for client  at /127.0.0.1:35434 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014: PacketHeader with packetLen=66052 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 65536

2020-04-02 05:08:16,365 [IPC Server handler 2 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 2 blocks.
2020-04-02 05:08:16,364 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,366 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:16,366 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35430 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:16,364 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1028 on 127.0.0.1:43434 size 134217728 replicaState = RBW
2020-04-02 05:08:16,366 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,366 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,366 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35430 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 6
2020-04-02 05:08:16,365 [DataXceiver for client  at /127.0.0.1:35434 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,366 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741839_1028 is received from 127.0.0.1:43434
2020-04-02 05:08:16,367 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 1, received: 0, deleted: 0
2020-04-02 05:08:16,367 [IPC Server handler 0 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1024, newGS=1028, newLength=492, newNodes=[127.0.0.1:45739, 127.0.0.1:43434, 127.0.0.1:45580], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:16,367 [DataXceiver for client  at /127.0.0.1:35434 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014
2020-04-02 05:08:16,367 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1028 on 127.0.0.1:45580 size 134217728 replicaState = RBW
2020-04-02 05:08:16,367 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,367 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741839_1028 is received from 127.0.0.1:45580
2020-04-02 05:08:16,367 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 1, received: 0, deleted: 0
2020-04-02 05:08:16,367 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741844_1029 on 127.0.0.1:45580 size 1 replicaState = FINALIZED
2020-04-02 05:08:16,367 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,368 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741844_1029 (size=0)
2020-04-02 05:08:16,368 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741844_1029 is received from 127.0.0.1:45580
2020-04-02 05:08:16,368 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:16,368 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /partialChunk/foo1 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,368 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /partialChunk/foo1 with 1 blocks is persisted to the file system
2020-04-02 05:08:16,368 [DataXceiver for client  at /127.0.0.1:35434 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(914)) - Received BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014 src: /127.0.0.1:35434 dest: /127.0.0.1:45580 of size 65536
2020-04-02 05:08:16,368 [IPC Server handler 3 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /partialChunk/foo1 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,369 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:16,369 [DataXceiver for client  at /127.0.0.1:35434 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741834_1014]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 5
2020-04-02 05:08:16,369 [IPC Server handler 0 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1024 => blk_1073741839_1028) success
Wrote 1 byte and closed the file /partialChunk/foo1
2020-04-02 05:08:16,370 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,370 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741834_1014
2020-04-02 05:08:16,370 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741834_1014 on 127.0.0.1:45580 size 65536 replicaState = FINALIZED
2020-04-02 05:08:16,370 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /partialChunk/foo1 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:16,370 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:16,370 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741834_1014 (size=65536)
2020-04-02 05:08:16,371 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741834_1014 is received from 127.0.0.1:45580
2020-04-02 05:08:16,371 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:16,370 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/partialChunk/foo1, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:16,372 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /partialChunk/foo1 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029 block size 1
2020-04-02 05:08:16,378 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028: PacketHeader with packetLen=28 header data: offsetInBlock: 492
seqno: 0
lastPacketInBlock: false
dataLen: 20

2020-04-02 05:08:16,378 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=689265756764674, ackStatus=SUCCESS)
2020-04-02 05:08:16,378 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028: previous write did not end at the chunk boundary. onDiskLen=492
2020-04-02 05:08:16,378 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028: sizePartialChunk=492, block offset=0, metafile offset=7
2020-04-02 05:08:16,379 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028
2020-04-02 05:08:16,379 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 20, skip=0
2020-04-02 05:08:16,379 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028: PacketHeader with packetLen=111 header data: offsetInBlock: 512
seqno: 1
lastPacketInBlock: false
dataLen: 103

2020-04-02 05:08:16,379 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=615, ackEnqueueNanoTime=689265757761439, ackStatus=SUCCESS)
2020-04-02 05:08:16,380 [IPC Server handler 9 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/partialChunk/foo1	dst=null	perm=null	proto=rpc
2020-04-02 05:08:16,382 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028: PacketHeader with packetLen=28 header data: offsetInBlock: 492
seqno: 0
lastPacketInBlock: false
dataLen: 20

2020-04-02 05:08:16,382 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=689265760560601, ackStatus=SUCCESS)
2020-04-02 05:08:16,382 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028: previous write did not end at the chunk boundary. onDiskLen=492
2020-04-02 05:08:16,382 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028: sizePartialChunk=492, block offset=0, metafile offset=7
2020-04-02 05:08:16,383 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028
2020-04-02 05:08:16,383 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 20, skip=0
2020-04-02 05:08:16,383 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028: PacketHeader with packetLen=111 header data: offsetInBlock: 512
seqno: 1
lastPacketInBlock: false
dataLen: 103

2020-04-02 05:08:16,383 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/partialChunk/foo1, chunkSize=515, chunksPerPacket=1, packetSize=515
2020-04-02 05:08:16,383 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=615, ackEnqueueNanoTime=689265761534338, ackStatus=SUCCESS)
2020-04-02 05:08:16,384 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/partialChunk/foo1, packetSize=515, chunksPerPacket=1, bytesCurBlock=1, DFSOutputStream:blk_1073741844_1029
2020-04-02 05:08:16,385 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:flushOrSync(635)) - DFSClient flush():  bytesCurBlock=2, lastFlushOffset=0, createNewBlock=false
2020-04-02 05:08:16,390 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028: PacketHeader with packetLen=28 header data: offsetInBlock: 492
seqno: 0
lastPacketInBlock: false
dataLen: 20

2020-04-02 05:08:16,390 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028: previous write did not end at the chunk boundary. onDiskLen=492
2020-04-02 05:08:16,390 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028: sizePartialChunk=492, block offset=0, metafile offset=7
2020-04-02 05:08:16,391 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028
2020-04-02 05:08:16,391 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 20, skip=0
2020-04-02 05:08:16,391 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=689265769619525, ackStatus=SUCCESS)
2020-04-02 05:08:16,391 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028: PacketHeader with packetLen=111 header data: offsetInBlock: 512
seqno: 1
lastPacketInBlock: false
dataLen: 103

2020-04-02 05:08:16,391 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=615, ackEnqueueNanoTime=689265770038145, ackStatus=SUCCESS)
2020-04-02 05:08:16,392 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,392 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,392 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,393 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,393 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 10731952 flag: 0 flag: 0
2020-04-02 05:08:16,393 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 10731952 flag: 0 flag: 0
2020-04-02 05:08:16,393 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 4
2020-04-02 05:08:16,393 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 14978954 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:16,393 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,394 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 10237431 flag: 0 flag: 0
2020-04-02 05:08:16,394 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 10237431 flag: 0 flag: 0
2020-04-02 05:08:16,394 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 14779581 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:16,395 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029, newGs=1030, bytesRcvd=[1, 1]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,395 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,395 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,395 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029 src: /127.0.0.1:35438 dest: /127.0.0.1:45580
2020-04-02 05:08:16,396 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029
 storageType=DISK, inAddr=/127.0.0.1:35438, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_APPEND, newGs=1030, minBytesRcvd=1, maxBytesRcvd=1
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-2d1f4083-d7c8-4136-8351-6f589a4451bd
2020-04-02 05:08:16,397 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741844_1029, FINALIZED
  getNumBytes()     = 1
  getBytesOnDisk()  = 1
  getVisibleLength()= 1
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741844
2020-04-02 05:08:16,399 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028: PacketHeader with packetLen=4 header data: offsetInBlock: 615
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,399 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=615, ackEnqueueNanoTime=689265778027496, ackStatus=SUCCESS)
2020-04-02 05:08:16,400 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028
2020-04-02 05:08:16,400 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028: PacketHeader with packetLen=4 header data: offsetInBlock: 615
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,400 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=615, ackEnqueueNanoTime=689265778442261, ackStatus=SUCCESS)
2020-04-02 05:08:16,400 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028
2020-04-02 05:08:16,400 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028: PacketHeader with packetLen=4 header data: offsetInBlock: 615
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,400 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028
2020-04-02 05:08:16,400 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=615, ackEnqueueNanoTime=689265778856367, ackStatus=SUCCESS)
2020-04-02 05:08:16,423 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741844 of size 1
2020-04-02 05:08:16,423 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741844_1030.meta of size 11
2020-04-02 05:08:16,424 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35432, dest: /127.0.0.1:45580, bytes: 615, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, duration(ns): 43187518
2020-04-02 05:08:16,424 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,424 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:16,424 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,425 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 2 blocks.
2020-04-02 05:08:16,425 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38254, dest: /127.0.0.1:43434, bytes: 615, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, duration(ns): 58538783
2020-04-02 05:08:16,425 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1028 on 127.0.0.1:45580 size 615 replicaState = FINALIZED
2020-04-02 05:08:16,425 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,425 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 24518425 flag: 0 flag: 0
2020-04-02 05:08:16,425 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1028 is received from 127.0.0.1:45580
2020-04-02 05:08:16,426 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:16,426 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741844_1030 on 127.0.0.1:45580 size 1024 replicaState = RBW
2020-04-02 05:08:16,426 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,426 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741844_1030 is received from 127.0.0.1:45580
2020-04-02 05:08:16,426 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 1, received: 0, deleted: 0
2020-04-02 05:08:16,426 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] terminating
2020-04-02 05:08:16,426 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: closing
2020-04-02 05:08:16,428 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:16,428 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,428 [Block report processor] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741834_1014 from 127.0.0.1:43434
2020-04-02 05:08:16,428 [Block report processor] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3785)) - BLOCK* removeStoredBlock: blk_1073741834_1014 has already been removed from node 127.0.0.1:43434
2020-04-02 05:08:16,428 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block DELETED_BLOCK: blk_1073741834_1013 is received from 127.0.0.1:43434
2020-04-02 05:08:16,429 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1028 on 127.0.0.1:43434 size 615 replicaState = FINALIZED
2020-04-02 05:08:16,429 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,429 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1028 is received from 127.0.0.1:43434
2020-04-02 05:08:16,429 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 1
2020-04-02 05:08:16,430 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580] got seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 24518425 flag: 0 flag: 0
2020-04-02 05:08:16,430 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60658, dest: /127.0.0.1:45739, bytes: 615, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, duration(ns): 64134774
2020-04-02 05:08:16,434 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,435 [IPC Server handler 8 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741844_1029, newGS=1030, newLength=1, newNodes=[127.0.0.1:45580], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:16,435 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /partialChunk/foo1 with 1 blocks is persisted to the file system
2020-04-02 05:08:16,435 [IPC Server handler 8 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741844_1029 => blk_1073741844_1030) success
2020-04-02 05:08:16,438 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 30129614 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:16,438 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580] terminating
2020-04-02 05:08:16,439 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]: closing
2020-04-02 05:08:16,439 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60658 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:16,438 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35432 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 5
2020-04-02 05:08:16,439 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030: PacketHeader with packetLen=9 header data: offsetInBlock: 1
seqno: 0
lastPacketInBlock: false
dataLen: 1

2020-04-02 05:08:16,439 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030: previous write did not end at the chunk boundary. onDiskLen=1
2020-04-02 05:08:16,439 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030: sizePartialChunk=1, block offset=0, metafile offset=7
2020-04-02 05:08:16,440 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030
2020-04-02 05:08:16,440 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 1, skip=0
2020-04-02 05:08:16,440 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2, ackEnqueueNanoTime=689265818591491, ackStatus=SUCCESS)
2020-04-02 05:08:16,440 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,438 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,443 [IPC Server handler 3 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:fsync(3274)) - BLOCK* fsync: /partialChunk/foo1 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,451 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,439 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,452 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:16,452 [IPC Server handler 2 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,453 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1028 on 127.0.0.1:45739 size 615 replicaState = FINALIZED
2020-04-02 05:08:16,453 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:16,453 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1028 is received from 127.0.0.1:45739
2020-04-02 05:08:16,453 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:16,453 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /partialChunk/foo1 with 1 blocks is persisted to the file system
2020-04-02 05:08:16,455 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:16,456 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:16,456 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028 block size 615
2020-04-02 05:08:16,456 [IPC Server handler 0 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:16,439 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1024]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:16,459 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/partialChunk/foo1, packetSize=515, chunksPerPacket=1, bytesCurBlock=1, DFSOutputStream:blk_1073741844_1030
2020-04-02 05:08:16,459 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030: PacketHeader with packetLen=9 header data: offsetInBlock: 1
seqno: 1
lastPacketInBlock: false
dataLen: 1

2020-04-02 05:08:16,460 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=2, ackEnqueueNanoTime=689265838137852, ackStatus=SUCCESS)
2020-04-02 05:08:16,460 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,460 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,460 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=413, chunksPerPacket=1, packetSize=413
2020-04-02 05:08:16,461 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=413, chunksPerPacket=1, bytesCurBlock=615, DFSOutputStream:blk_1073741839_1028
2020-04-02 05:08:16,466 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030: PacketHeader with packetLen=4 header data: offsetInBlock: 2
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,466 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:16,466 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030
2020-04-02 05:08:16,466 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=2, ackEnqueueNanoTime=689265844590586, ackStatus=SUCCESS)
2020-04-02 05:08:16,467 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35438, dest: /127.0.0.1:45580, bytes: 2, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, duration(ns): 32172495
2020-04-02 05:08:16,467 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,467 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:16,467 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:16,467 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, newGs=1031, bytesRcvd=[615, 615]
  targets=[127.0.0.1:43434, 127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,468 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,468 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,468 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028 src: /127.0.0.1:60678 dest: /127.0.0.1:45739
2020-04-02 05:08:16,468 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028
 storageType=DISK, inAddr=/127.0.0.1:60678, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1031, minBytesRcvd=615, maxBytesRcvd=615
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:16,468 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1028, FINALIZED
  getNumBytes()     = 615
  getBytesOnDisk()  = 615
  getVisibleLength()= 615
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:16,468 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1029]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:16,478 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /partialChunk/foo1 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,478 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /partialChunk/foo1 with 1 blocks is persisted to the file system
2020-04-02 05:08:16,478 [IPC Server handler 9 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /partialChunk/foo1 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,479 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,479 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741844_1030 on 127.0.0.1:45580 size 2 replicaState = FINALIZED
2020-04-02 05:08:16,479 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:16,479 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741844_1030 is received from 127.0.0.1:45580
2020-04-02 05:08:16,479 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
Append 1 byte and closed the file /partialChunk/foo1
2020-04-02 05:08:16,481 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /partialChunk/foo1 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:16,481 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/partialChunk/foo1, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:16,482 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /partialChunk/foo1 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030 block size 2
2020-04-02 05:08:16,482 [IPC Server handler 4 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/partialChunk/foo1	dst=null	perm=null	proto=rpc
2020-04-02 05:08:16,487 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/partialChunk/foo1, chunkSize=514, chunksPerPacket=1, packetSize=514
2020-04-02 05:08:16,490 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/partialChunk/foo1, packetSize=514, chunksPerPacket=1, bytesCurBlock=2, DFSOutputStream:blk_1073741844_1030
2020-04-02 05:08:16,491 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:flushOrSync(635)) - DFSClient flush():  bytesCurBlock=3, lastFlushOffset=0, createNewBlock=false
2020-04-02 05:08:16,498 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 615
2020-04-02 05:08:16,498 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1031.meta of size 15
2020-04-02 05:08:16,499 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:16,499 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:16,501 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:16,540 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, newGs=1031, bytesRcvd=[615, 615]
  targets=[127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,541 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,541 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,541 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028 src: /127.0.0.1:38272 dest: /127.0.0.1:43434
2020-04-02 05:08:16,541 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028
 storageType=DISK, inAddr=/127.0.0.1:38272, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1031, minBytesRcvd=615, maxBytesRcvd=615
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:16,542 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1028, FINALIZED
  getNumBytes()     = 615
  getBytesOnDisk()  = 615
  getVisibleLength()= 615
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:16,541 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030, newGs=1032, bytesRcvd=[2, 2]
  targets=[]; pipelineSize=1, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,542 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,542 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,542 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030 src: /127.0.0.1:35448 dest: /127.0.0.1:45580
2020-04-02 05:08:16,542 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030
 storageType=DISK, inAddr=/127.0.0.1:35448, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_APPEND, newGs=1032, minBytesRcvd=2, maxBytesRcvd=2
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-2d1f4083-d7c8-4136-8351-6f589a4451bd
2020-04-02 05:08:16,543 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741844_1030, FINALIZED
  getNumBytes()     = 2
  getBytesOnDisk()  = 2
  getVisibleLength()= 2
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741844
2020-04-02 05:08:16,586 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741844 of size 2
2020-04-02 05:08:16,586 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741844_1032.meta of size 11
2020-04-02 05:08:16,587 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,588 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 615
2020-04-02 05:08:16,588 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1031.meta of size 15
2020-04-02 05:08:16,588 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:16,589 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 4
2020-04-02 05:08:16,590 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028, newGs=1031, bytesRcvd=[615, 615]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,590 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,590 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,590 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028 src: /127.0.0.1:35460 dest: /127.0.0.1:45580
2020-04-02 05:08:16,590 [IPC Server handler 8 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741844_1030, newGS=1032, newLength=2, newNodes=[127.0.0.1:45580], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:16,590 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741844_1032 from 127.0.0.1:45580
2020-04-02 05:08:16,591 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-2d1f4083-d7c8-4136-8351-6f589a4451bd:NORMAL:127.0.0.1:45580|RBW] of blk_1073741844_1030
2020-04-02 05:08:16,591 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /partialChunk/foo1 with 1 blocks is persisted to the file system
2020-04-02 05:08:16,591 [IPC Server handler 8 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741844_1030 => blk_1073741844_1032) success
2020-04-02 05:08:16,590 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028
 storageType=DISK, inAddr=/127.0.0.1:35460, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_APPEND, newGs=1031, minBytesRcvd=615, maxBytesRcvd=615
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:16,593 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1028, FINALIZED
  getNumBytes()     = 615
  getBytesOnDisk()  = 615
  getVisibleLength()= 615
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:16,600 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032: PacketHeader with packetLen=9 header data: offsetInBlock: 2
seqno: 0
lastPacketInBlock: false
dataLen: 1

2020-04-02 05:08:16,600 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032: previous write did not end at the chunk boundary. onDiskLen=2
2020-04-02 05:08:16,600 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032: sizePartialChunk=2, block offset=0, metafile offset=7
2020-04-02 05:08:16,630 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 615
2020-04-02 05:08:16,630 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1031.meta of size 15
2020-04-02 05:08:16,631 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,633 [IPC Server handler 7 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1028, newGS=1031, newLength=615, newNodes=[127.0.0.1:45739, 127.0.0.1:43434, 127.0.0.1:45580], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:16,634 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1031 from 127.0.0.1:45739
2020-04-02 05:08:16,634 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1028
2020-04-02 05:08:16,634 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1031 from 127.0.0.1:43434
2020-04-02 05:08:16,634 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1028
2020-04-02 05:08:16,634 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1031 from 127.0.0.1:45580
2020-04-02 05:08:16,634 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-089629a9-5898-4562-bd81-79a4f45c96c1:NORMAL:127.0.0.1:45580|RBW] of blk_1073741839_1028
2020-04-02 05:08:16,634 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:16,634 [IPC Server handler 7 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1028 => blk_1073741839_1031) success
2020-04-02 05:08:16,636 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032
2020-04-02 05:08:16,636 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 1, skip=0
2020-04-02 05:08:16,636 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=3, ackEnqueueNanoTime=689266014991043, ackStatus=SUCCESS)
2020-04-02 05:08:16,637 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,637 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,638 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031: PacketHeader with packetLen=131 header data: offsetInBlock: 615
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:16,638 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=738, ackEnqueueNanoTime=689266016641747, ackStatus=SUCCESS)
2020-04-02 05:08:16,638 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031: previous write did not end at the chunk boundary. onDiskLen=615
2020-04-02 05:08:16,638 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031: sizePartialChunk=103, block offset=512, metafile offset=11
2020-04-02 05:08:16,639 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031
2020-04-02 05:08:16,639 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:16,639 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031: PacketHeader with packetLen=131 header data: offsetInBlock: 615
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:16,639 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=738, ackEnqueueNanoTime=689266017699770, ackStatus=SUCCESS)
2020-04-02 05:08:16,639 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031: previous write did not end at the chunk boundary. onDiskLen=615
2020-04-02 05:08:16,639 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031: sizePartialChunk=103, block offset=512, metafile offset=11
2020-04-02 05:08:16,639 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031: PacketHeader with packetLen=131 header data: offsetInBlock: 615
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:16,639 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031
2020-04-02 05:08:16,640 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031: previous write did not end at the chunk boundary. onDiskLen=615
2020-04-02 05:08:16,640 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031: sizePartialChunk=103, block offset=512, metafile offset=11
2020-04-02 05:08:16,640 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:16,640 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031
2020-04-02 05:08:16,640 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:16,640 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=738, ackEnqueueNanoTime=689266018807375, ackStatus=SUCCESS)
2020-04-02 05:08:16,640 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,641 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,641 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,641 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1483561 flag: 0 flag: 0
2020-04-02 05:08:16,641 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1483561 flag: 0 flag: 0
2020-04-02 05:08:16,641 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2846814 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:16,643 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031: PacketHeader with packetLen=4 header data: offsetInBlock: 738
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,643 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=738, ackEnqueueNanoTime=689266021299595, ackStatus=SUCCESS)
2020-04-02 05:08:16,643 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031
2020-04-02 05:08:16,643 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031: PacketHeader with packetLen=4 header data: offsetInBlock: 738
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,643 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=738, ackEnqueueNanoTime=689266021710456, ackStatus=SUCCESS)
2020-04-02 05:08:16,643 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031
2020-04-02 05:08:16,643 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031: PacketHeader with packetLen=4 header data: offsetInBlock: 738
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,643 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031
2020-04-02 05:08:16,644 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=738, ackEnqueueNanoTime=689266022160742, ackStatus=SUCCESS)
2020-04-02 05:08:16,645 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35460, dest: /127.0.0.1:45580, bytes: 738, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, duration(ns): 12977495
2020-04-02 05:08:16,645 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,645 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:16,645 [IPC Server handler 2 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 2 blocks.
2020-04-02 05:08:16,645 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:16,646 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,646 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1031 on 127.0.0.1:45580 size 738 replicaState = FINALIZED
2020-04-02 05:08:16,646 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35460 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 5
2020-04-02 05:08:16,646 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,646 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741839_1031 (size=615)
2020-04-02 05:08:16,646 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1031 is received from 127.0.0.1:45580
2020-04-02 05:08:16,646 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:16,646 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741844_1032 on 127.0.0.1:45580 size 1024 replicaState = RBW
2020-04-02 05:08:16,646 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,646 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741844_1032 is received from 127.0.0.1:45580
2020-04-02 05:08:16,646 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 1, received: 0, deleted: 0
2020-04-02 05:08:16,648 [IPC Server handler 3 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:fsync(3274)) - BLOCK* fsync: /partialChunk/foo1 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,649 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /partialChunk/foo1 with 1 blocks is persisted to the file system
2020-04-02 05:08:16,649 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38272, dest: /127.0.0.1:43434, bytes: 738, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, duration(ns): 12160272
Append and flush 1 byte
2020-04-02 05:08:16,653 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2413752 flag: 0 flag: 0
2020-04-02 05:08:16,653 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2413752 flag: 0 flag: 0
2020-04-02 05:08:16,653 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] terminating
2020-04-02 05:08:16,653 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: closing
2020-04-02 05:08:16,655 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60678, dest: /127.0.0.1:45739, bytes: 738, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, duration(ns): 18964059
2020-04-02 05:08:16,654 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/partialChunk/foo1, packetSize=514, chunksPerPacket=1, bytesCurBlock=2, DFSOutputStream:blk_1073741844_1032
2020-04-02 05:08:16,656 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,656 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:flushOrSync(635)) - DFSClient flush():  bytesCurBlock=5, lastFlushOffset=3, createNewBlock=false
2020-04-02 05:08:16,655 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,655 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38272 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:16,656 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032: PacketHeader with packetLen=11 header data: offsetInBlock: 2
seqno: 1
lastPacketInBlock: false
dataLen: 3

2020-04-02 05:08:16,657 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032: previous write did not end at the chunk boundary. onDiskLen=3
2020-04-02 05:08:16,657 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032: sizePartialChunk=3, block offset=0, metafile offset=7
2020-04-02 05:08:16,656 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1031 on 127.0.0.1:45739 size 738 replicaState = FINALIZED
2020-04-02 05:08:16,657 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032
2020-04-02 05:08:16,657 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,657 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 3, skip=0
2020-04-02 05:08:16,657 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1031 (size=615)
2020-04-02 05:08:16,657 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=5, ackEnqueueNanoTime=689266035802478, ackStatus=SUCCESS)
2020-04-02 05:08:16,657 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1031 is received from 127.0.0.1:45739
2020-04-02 05:08:16,657 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:16,657 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1031 on 127.0.0.1:43434 size 738 replicaState = FINALIZED
2020-04-02 05:08:16,657 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,658 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1031 (size=615)
2020-04-02 05:08:16,658 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1031 is received from 127.0.0.1:43434
2020-04-02 05:08:16,658 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:16,658 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9771338 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:16,658 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580] terminating
2020-04-02 05:08:16,658 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]: closing
2020-04-02 05:08:16,658 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60678 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1028]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:16,659 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,659 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
Append and flush 2 byte
2020-04-02 05:08:16,660 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,660 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=2, src=/partialChunk/foo1, packetSize=514, chunksPerPacket=1, bytesCurBlock=2, DFSOutputStream:blk_1073741844_1032
2020-04-02 05:08:16,660 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:16,660 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/partialChunk/foo1, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:16,660 [IPC Server handler 9 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,660 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032: PacketHeader with packetLen=518 header data: offsetInBlock: 2
seqno: 2
lastPacketInBlock: false
dataLen: 510

2020-04-02 05:08:16,661 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032: previous write did not end at the chunk boundary. onDiskLen=5
2020-04-02 05:08:16,661 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=3, src=/partialChunk/foo1, packetSize=516, chunksPerPacket=1, bytesCurBlock=512, DFSOutputStream:blk_1073741844_1032
2020-04-02 05:08:16,661 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/partialChunk/foo1, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:16,661 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032: sizePartialChunk=5, block offset=0, metafile offset=7
2020-04-02 05:08:16,662 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:16,662 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032
2020-04-02 05:08:16,662 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:16,662 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 510, skip=0
2020-04-02 05:08:16,662 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=689266040548327, ackStatus=SUCCESS)
2020-04-02 05:08:16,662 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032: PacketHeader with packetLen=9 header data: offsetInBlock: 512
seqno: 3
lastPacketInBlock: false
dataLen: 1

2020-04-02 05:08:16,662 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE: enqueue Packet(seqno=3, lastPacketInBlock=false, offsetInBlock=513, ackEnqueueNanoTime=689266040797989, ackStatus=SUCCESS)
2020-04-02 05:08:16,662 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,662 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031 block size 738
2020-04-02 05:08:16,664 [IPC Server handler 5 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:16,664 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032: PacketHeader with packetLen=4 header data: offsetInBlock: 513
seqno: 4
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,667 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032
2020-04-02 05:08:16,667 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE: enqueue Packet(seqno=4, lastPacketInBlock=true, offsetInBlock=513, ackEnqueueNanoTime=689266045430468, ackStatus=SUCCESS)
2020-04-02 05:08:16,663 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE, replyAck=seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,667 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=290, chunksPerPacket=1, packetSize=290
2020-04-02 05:08:16,668 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35448, dest: /127.0.0.1:45580, bytes: 513, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, duration(ns): 80060712
2020-04-02 05:08:16,668 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=290, chunksPerPacket=1, bytesCurBlock=738, DFSOutputStream:blk_1073741839_1031
2020-04-02 05:08:16,668 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE, replyAck=seqno: 4 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,671 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:16,671 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:16,671 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35448 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1030]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:16,678 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /partialChunk/foo1 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,678 [IPC Server handler 6 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:checkBlocksComplete(2908)) - BLOCK* blk_1073741844_1032 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /partialChunk/foo1
2020-04-02 05:08:16,679 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:16,681 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, newGs=1033, bytesRcvd=[738, 738]
  targets=[127.0.0.1:45739, 127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,681 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,681 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,681 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031 src: /127.0.0.1:35480 dest: /127.0.0.1:45580
2020-04-02 05:08:16,681 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031
 storageType=DISK, inAddr=/127.0.0.1:35480, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_APPEND, newGs=1033, minBytesRcvd=738, maxBytesRcvd=738
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:16,678 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,681 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1031, FINALIZED
  getNumBytes()     = 738
  getBytesOnDisk()  = 738
  getVisibleLength()= 738
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:16,682 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741844_1032 on 127.0.0.1:45580 size 513 replicaState = FINALIZED
2020-04-02 05:08:16,682 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMMITTED
2020-04-02 05:08:16,682 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741844_1032 (size=513)
2020-04-02 05:08:16,683 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741844_1032 is received from 127.0.0.1:45580
2020-04-02 05:08:16,683 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:16,719 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 738
2020-04-02 05:08:16,719 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1033.meta of size 15
2020-04-02 05:08:16,719 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:16,720 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:16,721 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, newGs=1033, bytesRcvd=[738, 738]
  targets=[127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,721 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,721 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,721 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031 src: /127.0.0.1:60718 dest: /127.0.0.1:45739
2020-04-02 05:08:16,721 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031
 storageType=DISK, inAddr=/127.0.0.1:60718, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1033, minBytesRcvd=738, maxBytesRcvd=738
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:16,722 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1031, FINALIZED
  getNumBytes()     = 738
  getBytesOnDisk()  = 738
  getVisibleLength()= 738
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:16,759 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 738
2020-04-02 05:08:16,760 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1033.meta of size 15
2020-04-02 05:08:16,760 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:16,762 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:16,763 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031, newGs=1033, bytesRcvd=[738, 738]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,763 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,763 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,763 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031 src: /127.0.0.1:38312 dest: /127.0.0.1:43434
2020-04-02 05:08:16,763 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031
 storageType=DISK, inAddr=/127.0.0.1:38312, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1033, minBytesRcvd=738, maxBytesRcvd=738
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:16,763 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1031, FINALIZED
  getNumBytes()     = 738
  getBytesOnDisk()  = 738
  getVisibleLength()= 738
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:16,794 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 738
2020-04-02 05:08:16,794 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1033.meta of size 15
2020-04-02 05:08:16,795 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,799 [IPC Server handler 7 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1031, newGS=1033, newLength=738, newNodes=[127.0.0.1:45580, 127.0.0.1:45739, 127.0.0.1:43434], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:16,799 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1033 from 127.0.0.1:45580
2020-04-02 05:08:16,799 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-089629a9-5898-4562-bd81-79a4f45c96c1:NORMAL:127.0.0.1:45580|RBW] of blk_1073741839_1031
2020-04-02 05:08:16,799 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1033 from 127.0.0.1:45739
2020-04-02 05:08:16,799 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1031
2020-04-02 05:08:16,800 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1033 from 127.0.0.1:43434
2020-04-02 05:08:16,800 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1031
2020-04-02 05:08:16,800 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:16,800 [IPC Server handler 7 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1031 => blk_1073741839_1033) success
2020-04-02 05:08:16,806 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033: PacketHeader with packetLen=131 header data: offsetInBlock: 738
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:16,806 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=861, ackEnqueueNanoTime=689266184996200, ackStatus=SUCCESS)
2020-04-02 05:08:16,807 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033: PacketHeader with packetLen=131 header data: offsetInBlock: 738
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:16,807 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=861, ackEnqueueNanoTime=689266185446636, ackStatus=SUCCESS)
2020-04-02 05:08:16,807 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033: previous write did not end at the chunk boundary. onDiskLen=738
2020-04-02 05:08:16,807 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033: sizePartialChunk=226, block offset=512, metafile offset=11
2020-04-02 05:08:16,807 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033
2020-04-02 05:08:16,807 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:16,808 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033: previous write did not end at the chunk boundary. onDiskLen=738
2020-04-02 05:08:16,808 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033: sizePartialChunk=226, block offset=512, metafile offset=11
2020-04-02 05:08:16,808 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033: PacketHeader with packetLen=131 header data: offsetInBlock: 738
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:16,808 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033
2020-04-02 05:08:16,808 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:16,808 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033: previous write did not end at the chunk boundary. onDiskLen=738
2020-04-02 05:08:16,809 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033: sizePartialChunk=226, block offset=512, metafile offset=11
2020-04-02 05:08:16,810 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033
2020-04-02 05:08:16,814 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:16,814 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=861, ackEnqueueNanoTime=689266192376365, ackStatus=SUCCESS)
2020-04-02 05:08:16,820 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,820 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,822 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,822 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 14742500 flag: 0 flag: 0
2020-04-02 05:08:16,822 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 14742500 flag: 0 flag: 0
2020-04-02 05:08:16,822 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 15824369 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:16,826 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033: PacketHeader with packetLen=4 header data: offsetInBlock: 861
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,826 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=861, ackEnqueueNanoTime=689266204803268, ackStatus=SUCCESS)
2020-04-02 05:08:16,826 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033: PacketHeader with packetLen=4 header data: offsetInBlock: 861
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,827 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=861, ackEnqueueNanoTime=689266205149094, ackStatus=SUCCESS)
2020-04-02 05:08:16,827 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033
2020-04-02 05:08:16,827 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033
2020-04-02 05:08:16,827 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033: PacketHeader with packetLen=4 header data: offsetInBlock: 861
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,827 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033
2020-04-02 05:08:16,827 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=861, ackEnqueueNanoTime=689266205861035, ackStatus=SUCCESS)
2020-04-02 05:08:16,828 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38312, dest: /127.0.0.1:43434, bytes: 861, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, duration(ns): 32448873
2020-04-02 05:08:16,828 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,828 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:16,830 [IPC Server handler 2 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,828 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,832 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60718, dest: /127.0.0.1:45739, bytes: 861, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, duration(ns): 36350670
2020-04-02 05:08:16,832 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1675790 flag: 0 flag: 0
2020-04-02 05:08:16,828 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:16,833 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:16,833 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:16,833 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:16,833 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60718 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:16,833 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,833 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1033 on 127.0.0.1:43434 size 861 replicaState = FINALIZED
2020-04-02 05:08:16,834 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,834 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1033 (size=738)
2020-04-02 05:08:16,834 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1033 is received from 127.0.0.1:43434
2020-04-02 05:08:16,834 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:16,834 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1033 on 127.0.0.1:45739 size 861 replicaState = FINALIZED
2020-04-02 05:08:16,834 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:16,834 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1033 (size=738)
2020-04-02 05:08:16,834 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1033 is received from 127.0.0.1:45739
2020-04-02 05:08:16,834 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:16,834 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1675790 flag: 0 flag: 0
2020-04-02 05:08:16,835 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35480, dest: /127.0.0.1:45580, bytes: 861, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, duration(ns): 39319168
2020-04-02 05:08:16,835 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7316435 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:16,835 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] terminating
2020-04-02 05:08:16,836 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: closing
2020-04-02 05:08:16,836 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,837 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:16,837 [IPC Server handler 1 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:16,837 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:16,836 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35480 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1031]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:16,838 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741839_1033
2020-04-02 05:08:16,838 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1033 on 127.0.0.1:45580 size 861 replicaState = FINALIZED
2020-04-02 05:08:16,838 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:16,838 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741839_1033 (size=861)
2020-04-02 05:08:16,838 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1033 is received from 127.0.0.1:45580
2020-04-02 05:08:16,838 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:16,842 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:16,842 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:16,843 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033 block size 861
2020-04-02 05:08:16,843 [IPC Server handler 9 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:16,851 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=167, chunksPerPacket=1, packetSize=167
2020-04-02 05:08:16,852 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=167, chunksPerPacket=1, bytesCurBlock=861, DFSOutputStream:blk_1073741839_1033
2020-04-02 05:08:16,869 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:16,870 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, newGs=1034, bytesRcvd=[861, 861]
  targets=[127.0.0.1:45739, 127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,870 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,870 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,870 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033 src: /127.0.0.1:38314 dest: /127.0.0.1:43434
2020-04-02 05:08:16,870 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033
 storageType=DISK, inAddr=/127.0.0.1:38314, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1034, minBytesRcvd=861, maxBytesRcvd=861
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:16,871 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1033, FINALIZED
  getNumBytes()     = 861
  getBytesOnDisk()  = 861
  getVisibleLength()= 861
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:16,906 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 861
2020-04-02 05:08:16,906 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1034.meta of size 15
2020-04-02 05:08:16,906 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:16,909 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:16,910 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, newGs=1034, bytesRcvd=[861, 861]
  targets=[127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,910 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,910 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,910 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033 src: /127.0.0.1:60724 dest: /127.0.0.1:45739
2020-04-02 05:08:16,910 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033
 storageType=DISK, inAddr=/127.0.0.1:60724, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1034, minBytesRcvd=861, maxBytesRcvd=861
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:16,910 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1033, FINALIZED
  getNumBytes()     = 861
  getBytesOnDisk()  = 861
  getVisibleLength()= 861
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:16,946 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 861
2020-04-02 05:08:16,946 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1034.meta of size 15
2020-04-02 05:08:16,946 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:16,950 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:16,950 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033, newGs=1034, bytesRcvd=[861, 861]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:16,951 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:16,951 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:16,952 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033 src: /127.0.0.1:35492 dest: /127.0.0.1:45580
2020-04-02 05:08:16,952 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033
 storageType=DISK, inAddr=/127.0.0.1:35492, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_APPEND, newGs=1034, minBytesRcvd=861, maxBytesRcvd=861
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:16,952 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1033, FINALIZED
  getNumBytes()     = 861
  getBytesOnDisk()  = 861
  getVisibleLength()= 861
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:16,958 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35120 [Waiting for operation #4]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:16,981 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 861
2020-04-02 05:08:16,982 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1034.meta of size 15
2020-04-02 05:08:16,983 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,984 [IPC Server handler 6 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1033, newGS=1034, newLength=861, newNodes=[127.0.0.1:43434, 127.0.0.1:45739, 127.0.0.1:45580], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:16,984 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1034 from 127.0.0.1:43434
2020-04-02 05:08:16,984 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1033
2020-04-02 05:08:16,985 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1034 from 127.0.0.1:45739
2020-04-02 05:08:16,985 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1033
2020-04-02 05:08:16,985 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1034 from 127.0.0.1:45580
2020-04-02 05:08:16,985 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-089629a9-5898-4562-bd81-79a4f45c96c1:NORMAL:127.0.0.1:45580|RBW] of blk_1073741839_1033
2020-04-02 05:08:16,985 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:16,985 [IPC Server handler 6 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1033 => blk_1073741839_1034) success
2020-04-02 05:08:16,987 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034: PacketHeader with packetLen=131 header data: offsetInBlock: 861
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:16,987 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=984, ackEnqueueNanoTime=689266365898555, ackStatus=SUCCESS)
2020-04-02 05:08:16,987 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034: previous write did not end at the chunk boundary. onDiskLen=861
2020-04-02 05:08:16,987 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034: sizePartialChunk=349, block offset=512, metafile offset=11
2020-04-02 05:08:16,988 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034
2020-04-02 05:08:16,988 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:16,988 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034: PacketHeader with packetLen=131 header data: offsetInBlock: 861
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:16,988 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=984, ackEnqueueNanoTime=689266366716098, ackStatus=SUCCESS)
2020-04-02 05:08:16,988 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034: previous write did not end at the chunk boundary. onDiskLen=861
2020-04-02 05:08:16,988 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034: sizePartialChunk=349, block offset=512, metafile offset=11
2020-04-02 05:08:16,988 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034: PacketHeader with packetLen=131 header data: offsetInBlock: 861
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:16,988 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034: previous write did not end at the chunk boundary. onDiskLen=861
2020-04-02 05:08:16,988 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034
2020-04-02 05:08:16,989 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034: sizePartialChunk=349, block offset=512, metafile offset=11
2020-04-02 05:08:16,989 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:16,989 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034
2020-04-02 05:08:16,989 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:16,989 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=984, ackEnqueueNanoTime=689266367710044, ackStatus=SUCCESS)
2020-04-02 05:08:16,989 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,989 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:16,990 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:16,990 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1413010 flag: 0 flag: 0
2020-04-02 05:08:16,995 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1413010 flag: 0 flag: 0
2020-04-02 05:08:16,996 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7903512 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:16,997 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034: PacketHeader with packetLen=4 header data: offsetInBlock: 984
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,997 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=984, ackEnqueueNanoTime=689266375968044, ackStatus=SUCCESS)
2020-04-02 05:08:16,997 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034
2020-04-02 05:08:16,998 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034: PacketHeader with packetLen=4 header data: offsetInBlock: 984
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,998 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=984, ackEnqueueNanoTime=689266376339420, ackStatus=SUCCESS)
2020-04-02 05:08:16,998 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034
2020-04-02 05:08:16,998 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034: PacketHeader with packetLen=4 header data: offsetInBlock: 984
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:16,998 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034
2020-04-02 05:08:16,998 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=984, ackEnqueueNanoTime=689266376813475, ackStatus=SUCCESS)
2020-04-02 05:08:17,001 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35492, dest: /127.0.0.1:45580, bytes: 984, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, duration(ns): 16346806
2020-04-02 05:08:17,001 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,001 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1034 on 127.0.0.1:45580 size 984 replicaState = FINALIZED
2020-04-02 05:08:17,002 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,002 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741839_1034 (size=861)
2020-04-02 05:08:17,002 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,003 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60724, dest: /127.0.0.1:45739, bytes: 984, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, duration(ns): 17822696
2020-04-02 05:08:17,003 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3901940 flag: 0 flag: 0
2020-04-02 05:08:17,003 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] terminating
2020-04-02 05:08:17,004 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,004 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3901940 flag: 0 flag: 0
2020-04-02 05:08:17,005 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38314, dest: /127.0.0.1:43434, bytes: 984, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, duration(ns): 20176026
2020-04-02 05:08:17,005 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6671670 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,005 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580] terminating
2020-04-02 05:08:17,001 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,006 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:17,006 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:17,005 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,006 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35492 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 2
2020-04-02 05:08:17,005 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]: closing
2020-04-02 05:08:17,003 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: closing
2020-04-02 05:08:17,006 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38314 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:17,006 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60724 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1033]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:17,002 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1034 is received from 127.0.0.1:45580
2020-04-02 05:08:17,010 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,010 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,010 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:17,010 [IPC Server handler 2 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,011 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741839_1034
2020-04-02 05:08:17,011 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1034 on 127.0.0.1:45739 size 984 replicaState = FINALIZED
2020-04-02 05:08:17,011 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:17,011 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1034 (size=984)
2020-04-02 05:08:17,012 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1034 is received from 127.0.0.1:45739
2020-04-02 05:08:17,012 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,012 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741839_1034
2020-04-02 05:08:17,012 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1034 on 127.0.0.1:43434 size 984 replicaState = FINALIZED
2020-04-02 05:08:17,012 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:17,012 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1034 (size=984)
2020-04-02 05:08:17,012 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1034 is received from 127.0.0.1:43434
2020-04-02 05:08:17,012 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,013 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:17,014 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:17,014 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034 block size 984
2020-04-02 05:08:17,015 [IPC Server handler 3 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:17,016 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=44, chunksPerPacket=1, packetSize=44
2020-04-02 05:08:17,017 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=44, chunksPerPacket=1, bytesCurBlock=984, DFSOutputStream:blk_1073741839_1034
2020-04-02 05:08:17,017 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:17,017 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/testSmallAppendRace, packetSize=65016, chunksPerPacket=126, bytesCurBlock=1024, DFSOutputStream:blk_1073741839_1034
2020-04-02 05:08:17,023 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:17,024 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, newGs=1035, bytesRcvd=[984, 984]
  targets=[127.0.0.1:45739, 127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,024 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,024 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,024 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034 src: /127.0.0.1:35494 dest: /127.0.0.1:45580
2020-04-02 05:08:17,024 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034
 storageType=DISK, inAddr=/127.0.0.1:35494, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_APPEND, newGs=1035, minBytesRcvd=984, maxBytesRcvd=984
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:17,024 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1034, FINALIZED
  getNumBytes()     = 984
  getBytesOnDisk()  = 984
  getVisibleLength()= 984
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,054 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 984
2020-04-02 05:08:17,054 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1035.meta of size 15
2020-04-02 05:08:17,054 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:17,055 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,056 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, newGs=1035, bytesRcvd=[984, 984]
  targets=[127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,056 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,056 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,056 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034 src: /127.0.0.1:60730 dest: /127.0.0.1:45739
2020-04-02 05:08:17,056 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034
 storageType=DISK, inAddr=/127.0.0.1:60730, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1035, minBytesRcvd=984, maxBytesRcvd=984
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:17,057 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1034, FINALIZED
  getNumBytes()     = 984
  getBytesOnDisk()  = 984
  getVisibleLength()= 984
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,082 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /partialChunk/foo1 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,082 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /partialChunk/foo1 with 1 blocks is persisted to the file system
2020-04-02 05:08:17,083 [IPC Server handler 0 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /partialChunk/foo1 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,085 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 984
2020-04-02 05:08:17,085 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1035.meta of size 15
2020-04-02 05:08:17,085 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:17,086 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
Flush 508 byte and closed the file /partialChunk/foo1
2020-04-02 05:08:17,087 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034, newGs=1035, bytesRcvd=[984, 984]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,087 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,087 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,087 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034 src: /127.0.0.1:38324 dest: /127.0.0.1:43434
2020-04-02 05:08:17,088 [IPC Server handler 9 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/partialChunk/foo1	dst=null	perm=null	proto=rpc
2020-04-02 05:08:17,088 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034
 storageType=DISK, inAddr=/127.0.0.1:38324, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1035, minBytesRcvd=984, maxBytesRcvd=984
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:17,088 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1034, FINALIZED
  getNumBytes()     = 984
  getBytesOnDisk()  = 984
  getVisibleLength()= 984
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,091 [IPC Server handler 5 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741844_1032]
2020-04-02 05:08:17,091 [IPC Server handler 5 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/partialChunk/foo1	dst=null	perm=null	proto=rpc
2020-04-02 05:08:17,092 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(242)) - newInfo = LocatedBlocks{;  fileLength=513;  underConstruction=false;  blocks=[LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032; getBlockSize()=513; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:45580,DS-2d1f4083-d7c8-4136-8351-6f589a4451bd,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032; getBlockSize()=513; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:45580,DS-2d1f4083-d7c8-4136-8351-6f589a4451bd,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-04-02 05:08:17,093 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:17,094 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,096 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35502 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, replica=FinalizedReplica, blk_1073741844_1032, FINALIZED
  getNumBytes()     = 513
  getBytesOnDisk()  = 513
  getVisibleLength()= 513
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741844
2020-04-02 05:08:17,097 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35502 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741844_1032, FINALIZED
  getNumBytes()     = 513
  getBytesOnDisk()  = 513
  getVisibleLength()= 513
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741844
2020-04-02 05:08:17,111 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35502 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:45580, dest: /127.0.0.1:35502, bytes: 521, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741844_1032, duration(ns): 11712862
[msx] test Finished org.apache.hadoop.hdfs.TestFileAppend3#testAppendToPartialChunk
[msx] writeFile testName = org.apache.hadoop.hdfs.TestFileAppend3#testAppendToPartialChunk
[msx] succeed
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
[msx] test Started org.apache.hadoop.hdfs.TestFileAppend3#testTC11ForAppend2
[msx] perform reset as unitTestCounterInClass 12 is larger than zero
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
p=/TC11/foo0
2020-04-02 05:08:17,119 [main] DEBUG hdfs.DFSClient (DFSClient.java:create(1210)) - /TC11/foo0: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-04-02 05:08:17,120 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(757)) - *DIR* NameNode.create: file /TC11/foo0 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:17,120 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2385)) - DIR* NameSystem.startFile: src=/TC11/foo0, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1, createParent=true, replication=3, createFlag=[CREATE], blockSize=65536, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-04-02 05:08:17,121 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(585)) - DIR* addFile: foo0 is added
2020-04-02 05:08:17,121 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(416)) - DIR* NameSystem.startFile: added /TC11/foo0 inode 16405 DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,121 [IPC Server handler 6 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/TC11/foo0	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:17,123 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC11/foo0, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:17,126 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC11/foo0, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:17,131 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 984
2020-04-02 05:08:17,131 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1035.meta of size 15
2020-04-02 05:08:17,132 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,134 [IPC Server handler 8 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1034, newGS=1035, newLength=984, newNodes=[127.0.0.1:45580, 127.0.0.1:45739, 127.0.0.1:43434], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:17,135 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1035 from 127.0.0.1:45580
2020-04-02 05:08:17,135 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-089629a9-5898-4562-bd81-79a4f45c96c1:NORMAL:127.0.0.1:45580|RBW] of blk_1073741839_1034
2020-04-02 05:08:17,135 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1035 from 127.0.0.1:45739
2020-04-02 05:08:17,135 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1034
2020-04-02 05:08:17,135 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1035 from 127.0.0.1:43434
2020-04-02 05:08:17,135 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1034
2020-04-02 05:08:17,135 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:17,135 [IPC Server handler 8 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1034 => blk_1073741839_1035) success
2020-04-02 05:08:17,138 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035: PacketHeader with packetLen=48 header data: offsetInBlock: 984
seqno: 0
lastPacketInBlock: false
dataLen: 40

2020-04-02 05:08:17,138 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=689266516986738, ackStatus=SUCCESS)
2020-04-02 05:08:17,139 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035: previous write did not end at the chunk boundary. onDiskLen=984
2020-04-02 05:08:17,139 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035: sizePartialChunk=472, block offset=512, metafile offset=11
2020-04-02 05:08:17,139 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035: PacketHeader with packetLen=48 header data: offsetInBlock: 984
seqno: 0
lastPacketInBlock: false
dataLen: 40

2020-04-02 05:08:17,139 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=689266517550467, ackStatus=SUCCESS)
2020-04-02 05:08:17,139 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035: previous write did not end at the chunk boundary. onDiskLen=984
2020-04-02 05:08:17,139 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035: sizePartialChunk=472, block offset=512, metafile offset=11
2020-04-02 05:08:17,139 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035
2020-04-02 05:08:17,139 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035
2020-04-02 05:08:17,140 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 40, skip=0
2020-04-02 05:08:17,140 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 40, skip=0
2020-04-02 05:08:17,141 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035: PacketHeader with packetLen=91 header data: offsetInBlock: 1024
seqno: 1
lastPacketInBlock: false
dataLen: 83

2020-04-02 05:08:17,141 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=1107, ackEnqueueNanoTime=689266519504562, ackStatus=SUCCESS)
2020-04-02 05:08:17,141 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035: PacketHeader with packetLen=91 header data: offsetInBlock: 1024
seqno: 1
lastPacketInBlock: false
dataLen: 83

2020-04-02 05:08:17,141 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=1107, ackEnqueueNanoTime=689266519882386, ackStatus=SUCCESS)
2020-04-02 05:08:17,142 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC11/foo0, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:17,142 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/TC11/foo0, packetSize=516, chunksPerPacket=1, bytesCurBlock=64512, DFSOutputStream:block==null
2020-04-02 05:08:17,142 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC11/foo0, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:17,142 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=2, src=/TC11/foo0, packetSize=516, chunksPerPacket=1, bytesCurBlock=65024, DFSOutputStream:block==null
2020-04-02 05:08:17,142 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC11/foo0, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:17,144 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035: PacketHeader with packetLen=48 header data: offsetInBlock: 984
seqno: 0
lastPacketInBlock: false
dataLen: 40

2020-04-02 05:08:17,145 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035: previous write did not end at the chunk boundary. onDiskLen=984
2020-04-02 05:08:17,145 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035: sizePartialChunk=472, block offset=512, metafile offset=11
2020-04-02 05:08:17,145 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035
2020-04-02 05:08:17,145 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 40, skip=0
2020-04-02 05:08:17,145 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC11/foo0  inodeId 16405 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,145 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1024, ackEnqueueNanoTime=689266523746856, ackStatus=SUCCESS)
2020-04-02 05:08:17,145 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035: PacketHeader with packetLen=91 header data: offsetInBlock: 1024
seqno: 1
lastPacketInBlock: false
dataLen: 83

2020-04-02 05:08:17,145 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=1107, ackEnqueueNanoTime=689266524085904, ackStatus=SUCCESS)
2020-04-02 05:08:17,146 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,146 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,146 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,146 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC11/foo0 with blk_1073741845_1036 block is added to the in-memory file system
2020-04-02 05:08:17,146 [IPC Server handler 4 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741845_1036, replicas=127.0.0.1:43434, 127.0.0.1:45739, 127.0.0.1:45580 for /TC11/foo0
2020-04-02 05:08:17,146 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC11/foo0 with new block blk_1073741845_1036, current total block count is 1
2020-04-02 05:08:17,149 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 4
2020-04-02 05:08:17,150 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45739, 127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,150 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,150 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,150 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036 src: /127.0.0.1:38336 dest: /127.0.0.1:43434
2020-04-02 05:08:17,150 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036
 storageType=DISK, inAddr=/127.0.0.1:38336, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:17,150 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741845 of size 0
2020-04-02 05:08:17,150 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741845_1036.meta of size 0
2020-04-02 05:08:17,151 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:17,151 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 4
2020-04-02 05:08:17,152 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,152 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,152 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,152 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036 src: /127.0.0.1:60746 dest: /127.0.0.1:45739
2020-04-02 05:08:17,152 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036
 storageType=DISK, inAddr=/127.0.0.1:60746, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:17,152 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,152 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741845 of size 0
2020-04-02 05:08:17,153 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741845_1036.meta of size 0
2020-04-02 05:08:17,153 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:17,154 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 4
2020-04-02 05:08:17,152 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 13202087 flag: 0 flag: 0
2020-04-02 05:08:17,157 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,157 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 15312840 flag: 0 flag: 0
2020-04-02 05:08:17,158 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,158 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,154 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 13202087 flag: 0 flag: 0
2020-04-02 05:08:17,158 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 15147749 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,158 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 15312840 flag: 0 flag: 0
2020-04-02 05:08:17,159 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 17558687 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,158 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,159 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036 src: /127.0.0.1:35514 dest: /127.0.0.1:45580
2020-04-02 05:08:17,159 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036
 storageType=DISK, inAddr=/127.0.0.1:35514, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:17,159 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741845 of size 0
2020-04-02 05:08:17,160 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741845_1036.meta of size 0
2020-04-02 05:08:17,162 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,173 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035: PacketHeader with packetLen=4 header data: offsetInBlock: 1107
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,173 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=1107, ackEnqueueNanoTime=689266551974312, ackStatus=SUCCESS)
2020-04-02 05:08:17,174 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035
2020-04-02 05:08:17,174 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035: PacketHeader with packetLen=4 header data: offsetInBlock: 1107
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,174 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=1107, ackEnqueueNanoTime=689266552527004, ackStatus=SUCCESS)
2020-04-02 05:08:17,174 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035
2020-04-02 05:08:17,174 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035: PacketHeader with packetLen=4 header data: offsetInBlock: 1107
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,174 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035
2020-04-02 05:08:17,174 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=1107, ackEnqueueNanoTime=689266552936489, ackStatus=SUCCESS)
2020-04-02 05:08:17,176 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:17,176 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38324, dest: /127.0.0.1:43434, bytes: 1107, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, duration(ns): 43141980
2020-04-02 05:08:17,176 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689266554570377, ackStatus=SUCCESS)
2020-04-02 05:08:17,176 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,176 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:17,176 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:17,176 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:17,177 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:17,177 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689266555191529, ackStatus=SUCCESS)
2020-04-02 05:08:17,177 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38324 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 5
2020-04-02 05:08:17,177 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,177 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689266555268271, ackStatus=SUCCESS)
2020-04-02 05:08:17,177 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:17,177 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:17,177 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:17,177 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,177 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689266555911615, ackStatus=SUCCESS)
2020-04-02 05:08:17,178 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,178 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741845_1036 on 127.0.0.1:43434 size 65536 replicaState = RBW
2020-04-02 05:08:17,178 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,178 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741845_1036 is received from 127.0.0.1:43434
2020-04-02 05:08:17,178 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1035 on 127.0.0.1:43434 size 1107 replicaState = FINALIZED
2020-04-02 05:08:17,178 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,178 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1035 (size=984)
2020-04-02 05:08:17,178 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1035 is received from 127.0.0.1:43434
2020-04-02 05:08:17,178 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 1, received: 1, deleted: 0
2020-04-02 05:08:17,178 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,179 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1886243 flag: 0 flag: 0
2020-04-02 05:08:17,179 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1886243 flag: 0 flag: 0
2020-04-02 05:08:17,179 [IPC Server handler 2 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,179 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2768930 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,177 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689266555874852, ackStatus=SUCCESS)
2020-04-02 05:08:17,177 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689266555817239, ackStatus=SUCCESS)
2020-04-02 05:08:17,181 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741845_1036 on 127.0.0.1:45739 size 65536 replicaState = RBW
2020-04-02 05:08:17,181 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,181 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741845_1036 is received from 127.0.0.1:45739
2020-04-02 05:08:17,182 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:17,178 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,177 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60730, dest: /127.0.0.1:45739, bytes: 1107, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, duration(ns): 44486634
2020-04-02 05:08:17,182 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689266560393829, ackStatus=SUCCESS)
2020-04-02 05:08:17,182 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1035 on 127.0.0.1:45739 size 1107 replicaState = FINALIZED
2020-04-02 05:08:17,182 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2725226 flag: 0 flag: 0
2020-04-02 05:08:17,182 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:17,182 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,182 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,182 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:17,182 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,182 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:17,182 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2725226 flag: 0 flag: 0
2020-04-02 05:08:17,182 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,183 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60730 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 5
2020-04-02 05:08:17,183 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 5165022 flag: 0 flag: 0
2020-04-02 05:08:17,183 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 5165022 flag: 0 flag: 0
2020-04-02 05:08:17,183 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689266561115520, ackStatus=SUCCESS)
2020-04-02 05:08:17,183 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6061814 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,183 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1035 (size=984)
2020-04-02 05:08:17,183 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35494, dest: /127.0.0.1:45580, bytes: 1107, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, duration(ns): 49068912
2020-04-02 05:08:17,183 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1035 is received from 127.0.0.1:45739
2020-04-02 05:08:17,183 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:17,183 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8768593 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,183 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 1, received: 1, deleted: 0
2020-04-02 05:08:17,187 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] terminating
2020-04-02 05:08:17,187 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: closing
2020-04-02 05:08:17,188 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35494 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1034]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 5
2020-04-02 05:08:17,188 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,188 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:17,189 [IPC Server handler 3 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,189 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689266567296713, ackStatus=SUCCESS)
2020-04-02 05:08:17,189 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,189 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,189 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,189 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6527969 flag: 0 flag: 0
2020-04-02 05:08:17,189 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 2 blocks.
2020-04-02 05:08:17,190 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741839_1035
2020-04-02 05:08:17,190 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1035 on 127.0.0.1:45580 size 1107 replicaState = FINALIZED
2020-04-02 05:08:17,190 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:17,190 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741839_1035 (size=1107)
2020-04-02 05:08:17,190 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1035 is received from 127.0.0.1:45580
2020-04-02 05:08:17,190 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,190 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741845_1036 on 127.0.0.1:45580 size 65536 replicaState = RBW
2020-04-02 05:08:17,190 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,190 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741845_1036 is received from 127.0.0.1:45580
2020-04-02 05:08:17,190 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 1, received: 0, deleted: 0
2020-04-02 05:08:17,192 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580] got seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6527969 flag: 0 flag: 0
2020-04-02 05:08:17,193 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 15025046 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,196 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,196 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689266574933958, ackStatus=SUCCESS)
2020-04-02 05:08:17,196 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036
2020-04-02 05:08:17,197 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,198 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689266576241305, ackStatus=SUCCESS)
2020-04-02 05:08:17,198 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036
2020-04-02 05:08:17,198 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,198 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036
2020-04-02 05:08:17,198 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689266576707879, ackStatus=SUCCESS)
2020-04-02 05:08:17,198 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:17,198 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:17,199 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35514, dest: /127.0.0.1:45580, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, duration(ns): 36622851
2020-04-02 05:08:17,199 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE, replyAck=seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,199 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:17,199 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035 block size 1107
2020-04-02 05:08:17,199 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,199 [IPC Server handler 0 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:17,200 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,200 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60746, dest: /127.0.0.1:45739, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, duration(ns): 28475589
2020-04-02 05:08:17,200 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741845_1036 on 127.0.0.1:45580 size 65536 replicaState = FINALIZED
2020-04-02 05:08:17,200 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,200 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 3 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1435675 flag: 0 flag: 0
2020-04-02 05:08:17,200 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741845_1036 (size=0)
2020-04-02 05:08:17,200 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580] got seqno: 3 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1435675 flag: 0 flag: 0
2020-04-02 05:08:17,200 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:17,200 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,201 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35514 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:17,201 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38336, dest: /127.0.0.1:43434, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, duration(ns): 38448178
2020-04-02 05:08:17,200 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741845_1036 is received from 127.0.0.1:45580
2020-04-02 05:08:17,201 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,201 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741845_1036 on 127.0.0.1:45739 size 65536 replicaState = FINALIZED
2020-04-02 05:08:17,201 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,201 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741845_1036 (size=0)
2020-04-02 05:08:17,201 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741845_1036 is received from 127.0.0.1:45739
2020-04-02 05:08:17,201 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,200 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: closing
2020-04-02 05:08:17,200 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] terminating
2020-04-02 05:08:17,201 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=433, chunksPerPacket=1, packetSize=433
2020-04-02 05:08:17,202 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60746 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:17,202 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,202 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=433, chunksPerPacket=1, bytesCurBlock=1107, DFSOutputStream:blk_1073741839_1035
2020-04-02 05:08:17,201 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580], replyAck=seqno: 3 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3689702 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,202 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741845_1036 on 127.0.0.1:43434 size 65536 replicaState = FINALIZED
2020-04-02 05:08:17,203 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,203 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741845_1036 (size=0)
2020-04-02 05:08:17,203 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741845_1036 is received from 127.0.0.1:43434
2020-04-02 05:08:17,203 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,203 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC11/foo0 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,203 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580] terminating
2020-04-02 05:08:17,204 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]: closing
2020-04-02 05:08:17,204 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC11/foo0 with 1 blocks is persisted to the file system
2020-04-02 05:08:17,205 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38336 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:17,205 [IPC Server handler 8 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC11/foo0 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,206 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC11/foo0 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:17,206 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,206 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC11/foo0, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:17,207 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /TC11/foo0 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741845_1036 block size 65536
2020-04-02 05:08:17,207 [IPC Server handler 7 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TC11/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:17,209 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC11/foo0, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:17,210 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, newGs=1037, bytesRcvd=[1107, 1107]
  targets=[127.0.0.1:45739, 127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,210 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,210 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,210 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035 src: /127.0.0.1:38350 dest: /127.0.0.1:43434
2020-04-02 05:08:17,211 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035
 storageType=DISK, inAddr=/127.0.0.1:38350, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1037, minBytesRcvd=1107, maxBytesRcvd=1107
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:17,211 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1035, FINALIZED
  getNumBytes()     = 1107
  getBytesOnDisk()  = 1107
  getVisibleLength()= 1107
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,211 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC11/foo0, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:blk_1073741845_1036
2020-04-02 05:08:17,217 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:flushOrSync(635)) - DFSClient flush():  bytesCurBlock=32768, lastFlushOffset=0, createNewBlock=false
2020-04-02 05:08:17,220 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC11/foo0  inodeId 16405 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,221 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC11/foo0 with blk_1073741846_1038 block is added to the in-memory file system
2020-04-02 05:08:17,221 [IPC Server handler 2 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741846_1038, replicas=127.0.0.1:43230, 127.0.0.1:44971, 127.0.0.1:43434 for /TC11/foo0
2020-04-02 05:08:17,221 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC11/foo0 with new block blk_1073741846_1038, current total block count is 2
2020-04-02 05:08:17,223 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@4a9f80d3] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,223 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57414 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:44971, 127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,224 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57414 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,224 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57414 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,224 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57414 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038 src: /127.0.0.1:57414 dest: /127.0.0.1:43230
2020-04-02 05:08:17,224 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57414 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038
 storageType=DISK, inAddr=/127.0.0.1:57414, myAddr=/127.0.0.1:43230
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43230
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9e64160f-8239-40bc-b495-871e2ebb5a3a
2020-04-02 05:08:17,224 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57414 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741846 of size 0
2020-04-02 05:08:17,224 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57414 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741846_1038.meta of size 0
2020-04-02 05:08:17,224 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57414 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:17,225 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,226 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57266 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,226 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57266 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,226 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57266 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,226 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57266 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038 src: /127.0.0.1:57266 dest: /127.0.0.1:44971
2020-04-02 05:08:17,226 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57266 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038
 storageType=DISK, inAddr=/127.0.0.1:57266, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:17,227 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57266 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741846 of size 0
2020-04-02 05:08:17,227 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57266 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741846_1038.meta of size 0
2020-04-02 05:08:17,227 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57266 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:17,230 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 3
2020-04-02 05:08:17,231 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38358 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,231 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38358 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,232 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38358 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,232 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38358 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038 src: /127.0.0.1:38358 dest: /127.0.0.1:43434
2020-04-02 05:08:17,232 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38358 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038
 storageType=DISK, inAddr=/127.0.0.1:38358, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:17,240 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1107
2020-04-02 05:08:17,240 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1037.meta of size 19
2020-04-02 05:08:17,241 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38358 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741846 of size 0
2020-04-02 05:08:17,241 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:17,241 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38358 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741846_1038.meta of size 0
2020-04-02 05:08:17,241 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,242 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, newGs=1037, bytesRcvd=[1107, 1107]
  targets=[127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,246 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,246 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,246 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035 src: /127.0.0.1:60770 dest: /127.0.0.1:45739
2020-04-02 05:08:17,247 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035
 storageType=DISK, inAddr=/127.0.0.1:60770, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1037, minBytesRcvd=1107, maxBytesRcvd=1107
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:17,247 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1035, FINALIZED
  getNumBytes()     = 1107
  getBytesOnDisk()  = 1107
  getVisibleLength()= 1107
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,250 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,254 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57414 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:17,254 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57414 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689266632966158, ackStatus=SUCCESS)
2020-04-02 05:08:17,255 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57266 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:17,255 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57266 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689266633526977, ackStatus=SUCCESS)
2020-04-02 05:08:17,256 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38358 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:17,256 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38358 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689266634967864, ackStatus=SUCCESS)
2020-04-02 05:08:17,257 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,257 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,262 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,262 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7072746 flag: 0 flag: 0
2020-04-02 05:08:17,263 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7072746 flag: 0 flag: 0
2020-04-02 05:08:17,263 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8127189 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,270 [IPC Server handler 3 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:fsync(3274)) - BLOCK* fsync: /TC11/foo0 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,270 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /TC11/foo0 with 2 blocks is persisted to the file system
2020-04-02 05:08:17,272 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:rename(995)) - *DIR* NameNode.rename: /TC11/foo0 to /TC11/foo0.new
2020-04-02 05:08:17,273 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSDirRenameOp.java:renameToInt(53)) - DIR* NameSystem.renameTo: /TC11/foo0 to /TC11/foo0.new
2020-04-02 05:08:17,273 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSDirRenameOp.java:renameTo(478)) - DIR* FSDirectory.renameTo: /TC11/foo0 to /TC11/foo0.new
2020-04-02 05:08:17,273 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSDirRenameOp.java:unprotectedRenameTo(208)) - DIR* FSDirectory.unprotectedRenameTo: /TC11/foo0 is renamed to /TC11/foo0.new
2020-04-02 05:08:17,274 [IPC Server handler 1 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=rename	src=/TC11/foo0	dst=/TC11/foo0.new	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:17,282 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57414 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,282 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57414 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689266660639142, ackStatus=SUCCESS)
2020-04-02 05:08:17,282 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57414 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038
2020-04-02 05:08:17,282 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57266 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,282 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57266 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689266661024189, ackStatus=SUCCESS)
2020-04-02 05:08:17,283 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57266 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038
2020-04-02 05:08:17,283 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38358 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,283 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38358 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038
2020-04-02 05:08:17,283 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38358 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689266661433612, ackStatus=SUCCESS)
2020-04-02 05:08:17,287 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 2 blocks.
2020-04-02 05:08:17,288 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741846_1038 on 127.0.0.1:43434 size 32768 replicaState = FINALIZED
2020-04-02 05:08:17,288 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,288 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741846_1038 (size=32768)
2020-04-02 05:08:17,288 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741846_1038 is received from 127.0.0.1:43434
2020-04-02 05:08:17,288 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,288 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1037 on 127.0.0.1:43434 size 134217728 replicaState = RBW
2020-04-02 05:08:17,288 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,288 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741839_1037 is received from 127.0.0.1:43434
2020-04-02 05:08:17,288 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 1, received: 0, deleted: 0
2020-04-02 05:08:17,288 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38358, dest: /127.0.0.1:43434, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, duration(ns): 35995796
2020-04-02 05:08:17,289 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,289 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:17,289 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38358 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:17,289 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38358 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 4
2020-04-02 05:08:17,289 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,290 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57266, dest: /127.0.0.1:44971, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, duration(ns): 39251670
2020-04-02 05:08:17,290 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6949592 flag: 0 flag: 0
2020-04-02 05:08:17,291 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:17,291 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57266 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:17,291 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57266 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 3
2020-04-02 05:08:17,293 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,293 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741846_1038 on 127.0.0.1:44971 size 32768 replicaState = FINALIZED
2020-04-02 05:08:17,293 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,293 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741846_1038 (size=32768)
2020-04-02 05:08:17,294 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741846_1038 is received from 127.0.0.1:44971
2020-04-02 05:08:17,294 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,295 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6949592 flag: 0 flag: 0
2020-04-02 05:08:17,296 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1107
2020-04-02 05:08:17,296 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1037.meta of size 19
2020-04-02 05:08:17,296 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57414, dest: /127.0.0.1:43230, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, duration(ns): 53764436
2020-04-02 05:08:17,296 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 13217454 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,296 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434] terminating
2020-04-02 05:08:17,298 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57414 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]: closing
2020-04-02 05:08:17,298 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57414 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741846_1038]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43230:Number of active connections is: 3
2020-04-02 05:08:17,304 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:17,306 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,306 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC11/foo0 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,306 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC11/foo0.new with 2 blocks is persisted to the file system
2020-04-02 05:08:17,306 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035, newGs=1037, bytesRcvd=[1107, 1107]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,307 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,307 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,307 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035 src: /127.0.0.1:35552 dest: /127.0.0.1:45580
2020-04-02 05:08:17,307 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035
 storageType=DISK, inAddr=/127.0.0.1:35552, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_APPEND, newGs=1037, minBytesRcvd=1107, maxBytesRcvd=1107
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:17,307 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1035, FINALIZED
  getNumBytes()     = 1107
  getBytesOnDisk()  = 1107
  getVisibleLength()= 1107
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,310 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,307 [IPC Server handler 5 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC11/foo0 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,310 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741846_1038
2020-04-02 05:08:17,311 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741846_1038 on 127.0.0.1:43230 size 32768 replicaState = FINALIZED
2020-04-02 05:08:17,311 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:17,311 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43230 is added to blk_1073741846_1038 (size=32768)
2020-04-02 05:08:17,311 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741846_1038 is received from 127.0.0.1:43230
2020-04-02 05:08:17,311 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43230 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,315 [IPC Server handler 8 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/TC11/foo0.new	dst=null	perm=null	proto=rpc
2020-04-02 05:08:17,318 [IPC Server handler 4 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741845_1036, blk_1073741846_1038]
2020-04-02 05:08:17,318 [IPC Server handler 4 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC11/foo0.new	dst=null	perm=null	proto=rpc
2020-04-02 05:08:17,343 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1107
2020-04-02 05:08:17,343 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1037.meta of size 19
2020-04-02 05:08:17,343 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
[msx] test Finished org.apache.hadoop.hdfs.TestFileAppend3#testTC11ForAppend2
[msx] writeFile testName = org.apache.hadoop.hdfs.TestFileAppend3#testTC11ForAppend2
[msx] succeed
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
[msx] test Started org.apache.hadoop.hdfs.TestFileAppend3#testTC7ForAppend2
[msx] perform reset as unitTestCounterInClass 13 is larger than zero
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
p=/TC7/foo0
2020-04-02 05:08:17,350 [IPC Server handler 7 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1035, newGS=1037, newLength=1107, newNodes=[127.0.0.1:43434, 127.0.0.1:45739, 127.0.0.1:45580], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:17,350 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1037 from 127.0.0.1:45739
2020-04-02 05:08:17,350 [main] DEBUG hdfs.DFSClient (DFSClient.java:create(1210)) - /TC7/foo0: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-04-02 05:08:17,351 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1035
2020-04-02 05:08:17,351 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1037 from 127.0.0.1:45580
2020-04-02 05:08:17,351 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-089629a9-5898-4562-bd81-79a4f45c96c1:NORMAL:127.0.0.1:45580|RBW] of blk_1073741839_1035
2020-04-02 05:08:17,351 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:17,351 [IPC Server handler 7 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1035 => blk_1073741839_1037) success
2020-04-02 05:08:17,353 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(757)) - *DIR* NameNode.create: file /TC7/foo0 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:17,353 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2385)) - DIR* NameSystem.startFile: src=/TC7/foo0, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1, createParent=true, replication=2, createFlag=[CREATE], blockSize=65536, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-04-02 05:08:17,354 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(585)) - DIR* addFile: foo0 is added
2020-04-02 05:08:17,354 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037: PacketHeader with packetLen=131 header data: offsetInBlock: 1107
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:17,354 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(416)) - DIR* NameSystem.startFile: added /TC7/foo0 inode 16406 DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,354 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1230, ackEnqueueNanoTime=689266732697158, ackStatus=SUCCESS)
2020-04-02 05:08:17,354 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037: previous write did not end at the chunk boundary. onDiskLen=1107
2020-04-02 05:08:17,354 [IPC Server handler 2 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/TC7/foo0	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:17,354 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037: PacketHeader with packetLen=131 header data: offsetInBlock: 1107
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:17,354 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037: sizePartialChunk=83, block offset=1024, metafile offset=15
2020-04-02 05:08:17,355 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1230, ackEnqueueNanoTime=689266733242151, ackStatus=SUCCESS)
2020-04-02 05:08:17,355 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037: previous write did not end at the chunk boundary. onDiskLen=1107
2020-04-02 05:08:17,355 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037: sizePartialChunk=83, block offset=1024, metafile offset=15
2020-04-02 05:08:17,355 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037: PacketHeader with packetLen=131 header data: offsetInBlock: 1107
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:17,355 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037: previous write did not end at the chunk boundary. onDiskLen=1107
2020-04-02 05:08:17,355 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037: sizePartialChunk=83, block offset=1024, metafile offset=15
2020-04-02 05:08:17,355 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037
2020-04-02 05:08:17,355 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037
2020-04-02 05:08:17,355 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037
2020-04-02 05:08:17,355 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:17,355 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:17,355 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:17,355 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1230, ackEnqueueNanoTime=689266734021573, ackStatus=SUCCESS)
2020-04-02 05:08:17,356 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC7/foo0, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:17,356 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,356 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,356 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,356 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1359431 flag: 0 flag: 0
2020-04-02 05:08:17,357 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1359431 flag: 0 flag: 0
2020-04-02 05:08:17,357 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2398307 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,358 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC7/foo0, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:17,358 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037: PacketHeader with packetLen=4 header data: offsetInBlock: 1230
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,358 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1230, ackEnqueueNanoTime=689266736725306, ackStatus=SUCCESS)
2020-04-02 05:08:17,358 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037
2020-04-02 05:08:17,358 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037: PacketHeader with packetLen=4 header data: offsetInBlock: 1230
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,359 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1230, ackEnqueueNanoTime=689266737124439, ackStatus=SUCCESS)
2020-04-02 05:08:17,359 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037
2020-04-02 05:08:17,359 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037: PacketHeader with packetLen=4 header data: offsetInBlock: 1230
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,359 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037
2020-04-02 05:08:17,359 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1230, ackEnqueueNanoTime=689266737685796, ackStatus=SUCCESS)
2020-04-02 05:08:17,360 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35552, dest: /127.0.0.1:45580, bytes: 1230, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, duration(ns): 15880211
2020-04-02 05:08:17,360 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,360 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:17,360 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:17,360 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,360 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35552 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:17,361 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,361 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60770, dest: /127.0.0.1:45739, bytes: 1230, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, duration(ns): 11465452
2020-04-02 05:08:17,361 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1368357 flag: 0 flag: 0
2020-04-02 05:08:17,361 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] terminating
2020-04-02 05:08:17,361 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: closing
2020-04-02 05:08:17,361 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60770 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:17,362 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,362 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1037 on 127.0.0.1:45580 size 1230 replicaState = FINALIZED
2020-04-02 05:08:17,362 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,366 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1368357 flag: 0 flag: 0
2020-04-02 05:08:17,367 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38350, dest: /127.0.0.1:43434, bytes: 1230, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, duration(ns): 17237071
2020-04-02 05:08:17,367 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8273203 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,367 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580] terminating
2020-04-02 05:08:17,368 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,370 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741839_1037 (size=1107)
2020-04-02 05:08:17,370 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1037 is received from 127.0.0.1:45580
2020-04-02 05:08:17,370 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,370 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1037 on 127.0.0.1:45739 size 1230 replicaState = FINALIZED
2020-04-02 05:08:17,370 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,370 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1037 (size=1107)
2020-04-02 05:08:17,370 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1037 is received from 127.0.0.1:45739
2020-04-02 05:08:17,370 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,370 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1037 on 127.0.0.1:43434 size 1230 replicaState = FINALIZED
2020-04-02 05:08:17,370 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,370 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1037 is received from 127.0.0.1:43434
2020-04-02 05:08:17,371 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,377 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:45580]: closing
2020-04-02 05:08:17,377 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38350 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1035]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:17,378 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,378 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:17,379 [IPC Server handler 9 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,390 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC7/foo0  inodeId 16406 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,391 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC7/foo0 with blk_1073741847_1039 block is added to the in-memory file system
2020-04-02 05:08:17,391 [IPC Server handler 6 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741847_1039, replicas=127.0.0.1:43230, 127.0.0.1:45739 for /TC7/foo0
2020-04-02 05:08:17,391 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC7/foo0 with new block blk_1073741847_1039, current total block count is 1
2020-04-02 05:08:17,393 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@4a9f80d3] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,394 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:17,394 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:17,394 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45739]; pipelineSize=2, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,394 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037 block size 1230
2020-04-02 05:08:17,395 [IPC Server handler 5 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:17,394 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,396 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,396 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039 src: /127.0.0.1:57442 dest: /127.0.0.1:43230
2020-04-02 05:08:17,396 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039
 storageType=DISK, inAddr=/127.0.0.1:57442, myAddr=/127.0.0.1:43230
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43230
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9e64160f-8239-40bc-b495-871e2ebb5a3a
2020-04-02 05:08:17,396 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741847 of size 0
2020-04-02 05:08:17,396 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741847_1039.meta of size 0
2020-04-02 05:08:17,396 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=310, chunksPerPacket=1, packetSize=310
2020-04-02 05:08:17,396 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:17,397 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=310, chunksPerPacket=1, bytesCurBlock=1230, DFSOutputStream:blk_1073741839_1037
2020-04-02 05:08:17,398 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,403 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60792 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=2, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,403 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60792 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,403 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60792 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,403 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60792 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039 src: /127.0.0.1:60792 dest: /127.0.0.1:45739
2020-04-02 05:08:17,403 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60792 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039
 storageType=DISK, inAddr=/127.0.0.1:60792, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:17,404 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60792 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741847 of size 0
2020-04-02 05:08:17,404 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60792 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741847_1039.meta of size 0
2020-04-02 05:08:17,404 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,406 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:17,407 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689266785725022, ackStatus=SUCCESS)
2020-04-02 05:08:17,408 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60792 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:17,408 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60792 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689266786418979, ackStatus=SUCCESS)
2020-04-02 05:08:17,409 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,409 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,409 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,409 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1832832 flag: 0 flag: 0
2020-04-02 05:08:17,412 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,412 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689266790303849, ackStatus=SUCCESS)
2020-04-02 05:08:17,412 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039
2020-04-02 05:08:17,412 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60792 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,412 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60792 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039
2020-04-02 05:08:17,412 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60792 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689266790611669, ackStatus=SUCCESS)
2020-04-02 05:08:17,414 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60792, dest: /127.0.0.1:45739, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, duration(ns): 8638176
2020-04-02 05:08:17,414 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,414 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,414 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,414 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60792 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:17,414 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:17,415 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57442, dest: /127.0.0.1:43230, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, duration(ns): 8876552
2020-04-02 05:08:17,415 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2246998 flag: 0 flag: 0
2020-04-02 05:08:17,415 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] terminating
2020-04-02 05:08:17,415 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, newGs=1040, bytesRcvd=[1230, 1230]
  targets=[127.0.0.1:45580, 127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,415 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,415 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60792 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:17,415 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,415 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: closing
2020-04-02 05:08:17,415 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037 src: /127.0.0.1:38386 dest: /127.0.0.1:43434
2020-04-02 05:08:17,416 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037
 storageType=DISK, inAddr=/127.0.0.1:38386, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1040, minBytesRcvd=1230, maxBytesRcvd=1230
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:17,416 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57442 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43230:Number of active connections is: 3
2020-04-02 05:08:17,416 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1037, FINALIZED
  getNumBytes()     = 1230
  getBytesOnDisk()  = 1230
  getVisibleLength()= 1230
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,417 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC7/foo0 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,417 [IPC Server handler 4 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:checkBlocksComplete(2908)) - BLOCK* blk_1073741847_1039 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /TC7/foo0
2020-04-02 05:08:17,418 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,418 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,418 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741847_1039 on 127.0.0.1:43230 size 32768 replicaState = FINALIZED
2020-04-02 05:08:17,418 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMMITTED
2020-04-02 05:08:17,419 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43230 is added to blk_1073741847_1039 (size=32768)
2020-04-02 05:08:17,419 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741847_1039 is received from 127.0.0.1:43230
2020-04-02 05:08:17,419 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43230 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,419 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741847_1039
2020-04-02 05:08:17,419 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741847_1039 on 127.0.0.1:45739 size 32768 replicaState = FINALIZED
2020-04-02 05:08:17,419 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:17,419 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741847_1039 (size=32768)
2020-04-02 05:08:17,419 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741847_1039 is received from 127.0.0.1:45739
2020-04-02 05:08:17,419 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,444 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1230
2020-04-02 05:08:17,444 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1040.meta of size 19
2020-04-02 05:08:17,445 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:17,445 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,446 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, newGs=1040, bytesRcvd=[1230, 1230]
  targets=[127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,446 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,446 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,446 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037 src: /127.0.0.1:35566 dest: /127.0.0.1:45580
2020-04-02 05:08:17,446 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037
 storageType=DISK, inAddr=/127.0.0.1:35566, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_APPEND, newGs=1040, minBytesRcvd=1230, maxBytesRcvd=1230
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:17,446 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1037, FINALIZED
  getNumBytes()     = 1230
  getBytesOnDisk()  = 1230
  getVisibleLength()= 1230
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,486 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1230
2020-04-02 05:08:17,486 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1040.meta of size 19
2020-04-02 05:08:17,486 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:17,489 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,490 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037, newGs=1040, bytesRcvd=[1230, 1230]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,490 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,491 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,491 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037 src: /127.0.0.1:60802 dest: /127.0.0.1:45739
2020-04-02 05:08:17,491 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037
 storageType=DISK, inAddr=/127.0.0.1:60802, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1040, minBytesRcvd=1230, maxBytesRcvd=1230
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:17,491 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1037, FINALIZED
  getNumBytes()     = 1230
  getBytesOnDisk()  = 1230
  getVisibleLength()= 1230
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,524 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1230
2020-04-02 05:08:17,525 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1040.meta of size 19
2020-04-02 05:08:17,525 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,527 [IPC Server handler 3 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1037, newGS=1040, newLength=1230, newNodes=[127.0.0.1:43434, 127.0.0.1:45580, 127.0.0.1:45739], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:17,528 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1040 from 127.0.0.1:43434
2020-04-02 05:08:17,528 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1037
2020-04-02 05:08:17,528 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1040 from 127.0.0.1:45580
2020-04-02 05:08:17,528 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-089629a9-5898-4562-bd81-79a4f45c96c1:NORMAL:127.0.0.1:45580|RBW] of blk_1073741839_1037
2020-04-02 05:08:17,528 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1040 from 127.0.0.1:45739
2020-04-02 05:08:17,528 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1037
2020-04-02 05:08:17,528 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:17,528 [IPC Server handler 3 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1037 => blk_1073741839_1040) success
2020-04-02 05:08:17,540 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040: PacketHeader with packetLen=131 header data: offsetInBlock: 1230
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:17,540 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1353, ackEnqueueNanoTime=689266918338198, ackStatus=SUCCESS)
2020-04-02 05:08:17,540 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040: previous write did not end at the chunk boundary. onDiskLen=1230
2020-04-02 05:08:17,548 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040: sizePartialChunk=206, block offset=1024, metafile offset=15
2020-04-02 05:08:17,549 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040
2020-04-02 05:08:17,549 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:17,548 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040: PacketHeader with packetLen=131 header data: offsetInBlock: 1230
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:17,549 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1353, ackEnqueueNanoTime=689266927768511, ackStatus=SUCCESS)
2020-04-02 05:08:17,549 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040: previous write did not end at the chunk boundary. onDiskLen=1230
2020-04-02 05:08:17,550 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040: sizePartialChunk=206, block offset=1024, metafile offset=15
2020-04-02 05:08:17,550 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040: PacketHeader with packetLen=131 header data: offsetInBlock: 1230
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:17,550 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040: previous write did not end at the chunk boundary. onDiskLen=1230
2020-04-02 05:08:17,550 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040: sizePartialChunk=206, block offset=1024, metafile offset=15
2020-04-02 05:08:17,550 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040
2020-04-02 05:08:17,550 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:17,551 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1353, ackEnqueueNanoTime=689266929158088, ackStatus=SUCCESS)
2020-04-02 05:08:17,550 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040
2020-04-02 05:08:17,551 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:17,551 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,551 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,551 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,551 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1837170 flag: 0 flag: 0
2020-04-02 05:08:17,551 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1837170 flag: 0 flag: 0
2020-04-02 05:08:17,552 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 11646888 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,553 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040: PacketHeader with packetLen=4 header data: offsetInBlock: 1353
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,553 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1353, ackEnqueueNanoTime=689266931538378, ackStatus=SUCCESS)
2020-04-02 05:08:17,553 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040
2020-04-02 05:08:17,553 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040: PacketHeader with packetLen=4 header data: offsetInBlock: 1353
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,553 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1353, ackEnqueueNanoTime=689266931916709, ackStatus=SUCCESS)
2020-04-02 05:08:17,553 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040
2020-04-02 05:08:17,554 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040: PacketHeader with packetLen=4 header data: offsetInBlock: 1353
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,554 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040
2020-04-02 05:08:17,554 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1353, ackEnqueueNanoTime=689266932234016, ackStatus=SUCCESS)
2020-04-02 05:08:17,554 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60802, dest: /127.0.0.1:45739, bytes: 1353, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, duration(ns): 28588453
2020-04-02 05:08:17,555 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,555 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:17,555 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:17,555 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60802 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:17,555 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,555 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35566, dest: /127.0.0.1:45580, bytes: 1353, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, duration(ns): 29386838
2020-04-02 05:08:17,556 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1524021 flag: 0 flag: 0
2020-04-02 05:08:17,556 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] terminating
2020-04-02 05:08:17,556 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: closing
2020-04-02 05:08:17,556 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1524021 flag: 0 flag: 0
2020-04-02 05:08:17,556 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35566 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:17,557 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38386, dest: /127.0.0.1:43434, bytes: 1353, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, duration(ns): 28747088
2020-04-02 05:08:17,557 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2715041 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,557 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739] terminating
2020-04-02 05:08:17,557 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45580, 127.0.0.1:45739]: closing
2020-04-02 05:08:17,558 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38386 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1037]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:17,559 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,559 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,559 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1040 on 127.0.0.1:45739 size 1353 replicaState = FINALIZED
2020-04-02 05:08:17,559 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,560 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1040 (size=1230)
2020-04-02 05:08:17,560 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1040 is received from 127.0.0.1:45739
2020-04-02 05:08:17,560 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,560 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1040 on 127.0.0.1:43434 size 1353 replicaState = FINALIZED
2020-04-02 05:08:17,560 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,560 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1040 (size=1230)
2020-04-02 05:08:17,560 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1040 is received from 127.0.0.1:43434
2020-04-02 05:08:17,560 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,562 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,563 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:17,563 [IPC Server handler 9 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,565 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:17,565 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:17,566 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040 block size 1353
2020-04-02 05:08:17,566 [IPC Server handler 6 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:17,566 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,566 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1040 on 127.0.0.1:45580 size 1353 replicaState = FINALIZED
2020-04-02 05:08:17,567 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,567 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741839_1040 (size=1353)
2020-04-02 05:08:17,567 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1040 is received from 127.0.0.1:45580
2020-04-02 05:08:17,567 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,568 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=187, chunksPerPacket=1, packetSize=187
2020-04-02 05:08:17,569 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=187, chunksPerPacket=1, bytesCurBlock=1353, DFSOutputStream:blk_1073741839_1040
2020-04-02 05:08:17,583 [IPC Server handler 8 on 35215] DEBUG namenode.NameNode (NameNodeRpcServer.java:getAdditionalDatanode(892)) - getAdditionalDatanode: src=/testSmallAppendRace, fileId=16400, blk=BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, existings=[127.0.0.1:45739, 127.0.0.1:43434], excludes=[], numAdditionalNodes=1, clientName=DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,592 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,599 [org.apache.hadoop.hdfs.server.datanode.DataNode$DataTransfer@67ebfb90] DEBUG datanode.DataNode (DataNode.java:run(2522)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:17,599 [org.apache.hadoop.hdfs.server.datanode.DataNode$DataTransfer@67ebfb90] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, replica=FinalizedReplica, blk_1073741839_1040, FINALIZED
  getNumBytes()     = 1353
  getBytesOnDisk()  = 1353
  getVisibleLength()= 1353
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,600 [org.apache.hadoop.hdfs.server.datanode.DataNode$DataTransfer@67ebfb90] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741839_1040, FINALIZED
  getNumBytes()     = 1353
  getBytesOnDisk()  = 1353
  getVisibleLength()= 1353
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,602 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,603 [org.apache.hadoop.hdfs.server.datanode.DataNode$DataTransfer@67ebfb90] INFO  datanode.DataNode (DataNode.java:run(2566)) - DataTransfer, at 127.0.0.1:45739: Transmitted BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040 (numBytes=1353) to /127.0.0.1:44971
2020-04-02 05:08:17,604 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=TRANSFER_FINALIZED, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=0, srcDataNode=127.0.0.1:45739, pinning=false
2020-04-02 05:08:17,604 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=true
2020-04-02 05:08:17,604 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,604 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040 src: /127.0.0.1:57312 dest: /127.0.0.1:44971
2020-04-02 05:08:17,604 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040
 storageType=DISK, inAddr=/127.0.0.1:57312, myAddr=/127.0.0.1:44971
 stage=TRANSFER_FINALIZED, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=127.0.0.1:45739, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=true, readahead=4194304)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:17,605 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/tmp/blk_1073741839 of size 0
2020-04-02 05:08:17,605 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/tmp/blk_1073741839_1040.meta of size 0
2020-04-02 05:08:17,605 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040: PacketHeader with packetLen=1369 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 1353

2020-04-02 05:08:17,605 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040: PacketHeader with packetLen=4 header data: offsetInBlock: 1353
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,605 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040
2020-04-02 05:08:17,606 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] TRACE datanode.DataNode (DataXceiver.java:writeBlock(896)) - TRANSFER: send close-ack
2020-04-02 05:08:17,606 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 3
2020-04-02 05:08:17,610 [org.apache.hadoop.hdfs.server.datanode.DataNode$DataTransfer@67ebfb90] DEBUG datanode.DataNode (DataNode.java:run(2574)) - DataTransfer: close-ack=status: SUCCESS

2020-04-02 05:08:17,611 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60808 [TRANSFER_BLOCK BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:17,614 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,615 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, newGs=1041, bytesRcvd=[1353, 1353]
  targets=[127.0.0.1:43434, 127.0.0.1:44971]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,615 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,615 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,615 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040 src: /127.0.0.1:60812 dest: /127.0.0.1:45739
2020-04-02 05:08:17,616 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040
 storageType=DISK, inAddr=/127.0.0.1:60812, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1041, minBytesRcvd=1353, maxBytesRcvd=1353
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:17,616 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1040, FINALIZED
  getNumBytes()     = 1353
  getBytesOnDisk()  = 1353
  getVisibleLength()= 1353
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,649 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1353
2020-04-02 05:08:17,649 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1041.meta of size 19
2020-04-02 05:08:17,650 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:17,651 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,652 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, newGs=1041, bytesRcvd=[1353, 1353]
  targets=[127.0.0.1:44971]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,652 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,653 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,653 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040 src: /127.0.0.1:38408 dest: /127.0.0.1:43434
2020-04-02 05:08:17,653 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040
 storageType=DISK, inAddr=/127.0.0.1:38408, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1041, minBytesRcvd=1353, maxBytesRcvd=1353
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:17,653 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1040, FINALIZED
  getNumBytes()     = 1353
  getBytesOnDisk()  = 1353
  getVisibleLength()= 1353
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,690 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1353
2020-04-02 05:08:17,690 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1041.meta of size 19
2020-04-02 05:08:17,690 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:17,691 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,696 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040, newGs=1041, bytesRcvd=[1353, 1353]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,696 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,696 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,696 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040 src: /127.0.0.1:57322 dest: /127.0.0.1:44971
2020-04-02 05:08:17,696 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040
 storageType=DISK, inAddr=/127.0.0.1:57322, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_APPEND, newGs=1041, minBytesRcvd=1353, maxBytesRcvd=1353
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:17,697 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1040, FINALIZED
  getNumBytes()     = 1353
  getBytesOnDisk()  = 1353
  getVisibleLength()= 1353
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,728 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1353
2020-04-02 05:08:17,728 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1041.meta of size 19
2020-04-02 05:08:17,729 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,730 [IPC Server handler 7 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1040, newGS=1041, newLength=1353, newNodes=[127.0.0.1:45739, 127.0.0.1:43434, 127.0.0.1:44971], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:17,730 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1041 from 127.0.0.1:45739
2020-04-02 05:08:17,730 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1040
2020-04-02 05:08:17,730 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1041 from 127.0.0.1:43434
2020-04-02 05:08:17,731 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1040
2020-04-02 05:08:17,731 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1041 from 127.0.0.1:45580
2020-04-02 05:08:17,731 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-089629a9-5898-4562-bd81-79a4f45c96c1:NORMAL:127.0.0.1:45580|FINALIZED] of blk_1073741839_1040
2020-04-02 05:08:17,731 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:17,731 [IPC Server handler 7 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1040 => blk_1073741839_1041) success
2020-04-02 05:08:17,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041: PacketHeader with packetLen=131 header data: offsetInBlock: 1353
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:17,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1476, ackEnqueueNanoTime=689267110453256, ackStatus=SUCCESS)
2020-04-02 05:08:17,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041: previous write did not end at the chunk boundary. onDiskLen=1353
2020-04-02 05:08:17,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041: sizePartialChunk=329, block offset=1024, metafile offset=15
2020-04-02 05:08:17,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041: PacketHeader with packetLen=131 header data: offsetInBlock: 1353
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:17,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1476, ackEnqueueNanoTime=689267110844567, ackStatus=SUCCESS)
2020-04-02 05:08:17,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041: previous write did not end at the chunk boundary. onDiskLen=1353
2020-04-02 05:08:17,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041: sizePartialChunk=329, block offset=1024, metafile offset=15
2020-04-02 05:08:17,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041
2020-04-02 05:08:17,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041: PacketHeader with packetLen=131 header data: offsetInBlock: 1353
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:17,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041
2020-04-02 05:08:17,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:17,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:17,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041: previous write did not end at the chunk boundary. onDiskLen=1353
2020-04-02 05:08:17,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041: sizePartialChunk=329, block offset=1024, metafile offset=15
2020-04-02 05:08:17,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041
2020-04-02 05:08:17,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:17,734 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1476, ackEnqueueNanoTime=689267112137285, ackStatus=SUCCESS)
2020-04-02 05:08:17,734 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,734 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,734 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,734 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1705788 flag: 0 flag: 0
2020-04-02 05:08:17,734 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1705788 flag: 0 flag: 0
2020-04-02 05:08:17,735 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2447408 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,738 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041: PacketHeader with packetLen=4 header data: offsetInBlock: 1476
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,738 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1476, ackEnqueueNanoTime=689267116578762, ackStatus=SUCCESS)
2020-04-02 05:08:17,738 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041
2020-04-02 05:08:17,738 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041: PacketHeader with packetLen=4 header data: offsetInBlock: 1476
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,738 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1476, ackEnqueueNanoTime=689267116963261, ackStatus=SUCCESS)
2020-04-02 05:08:17,738 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041
2020-04-02 05:08:17,741 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041: PacketHeader with packetLen=4 header data: offsetInBlock: 1476
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,741 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041
2020-04-02 05:08:17,741 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1476, ackEnqueueNanoTime=689267119684457, ackStatus=SUCCESS)
2020-04-02 05:08:17,742 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57322, dest: /127.0.0.1:44971, bytes: 1476, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, duration(ns): 12697460
2020-04-02 05:08:17,742 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,742 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:17,742 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:17,743 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57322 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 3
2020-04-02 05:08:17,743 [IPC Server handler 2 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,743 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1041 on 127.0.0.1:44971 size 1476 replicaState = FINALIZED
2020-04-02 05:08:17,743 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,743 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741839_1041 (size=1353)
2020-04-02 05:08:17,743 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1041 is received from 127.0.0.1:44971
2020-04-02 05:08:17,743 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,746 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,746 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38408, dest: /127.0.0.1:43434, bytes: 1476, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, duration(ns): 17097932
2020-04-02 05:08:17,747 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7187590 flag: 0 flag: 0
2020-04-02 05:08:17,747 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] terminating
2020-04-02 05:08:17,747 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: closing
2020-04-02 05:08:17,747 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38408 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:17,748 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7187590 flag: 0 flag: 0
2020-04-02 05:08:17,748 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60812, dest: /127.0.0.1:45739, bytes: 1476, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, duration(ns): 18705917
2020-04-02 05:08:17,748 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9562602 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,748 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971] terminating
2020-04-02 05:08:17,749 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]: closing
2020-04-02 05:08:17,750 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1040]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:17,752 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,752 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,753 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:17,753 [IPC Server handler 1 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,753 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741839_1041
2020-04-02 05:08:17,753 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1041 on 127.0.0.1:45739 size 1476 replicaState = FINALIZED
2020-04-02 05:08:17,753 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:17,753 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,753 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1041 (size=1476)
2020-04-02 05:08:17,754 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1041 is received from 127.0.0.1:45739
2020-04-02 05:08:17,754 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,754 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741839_1041
2020-04-02 05:08:17,754 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1041 on 127.0.0.1:43434 size 1476 replicaState = FINALIZED
2020-04-02 05:08:17,754 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:17,754 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1041 (size=1476)
2020-04-02 05:08:17,754 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1041 is received from 127.0.0.1:43434
2020-04-02 05:08:17,754 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,754 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:17,755 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:17,755 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041 block size 1476
2020-04-02 05:08:17,755 [IPC Server handler 9 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:17,758 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=64, chunksPerPacket=1, packetSize=64
2020-04-02 05:08:17,763 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=64, chunksPerPacket=1, bytesCurBlock=1476, DFSOutputStream:blk_1073741839_1041
2020-04-02 05:08:17,764 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:17,764 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/testSmallAppendRace, packetSize=65016, chunksPerPacket=126, bytesCurBlock=1536, DFSOutputStream:blk_1073741839_1041
2020-04-02 05:08:17,771 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,775 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, newGs=1042, bytesRcvd=[1476, 1476]
  targets=[127.0.0.1:45739, 127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,775 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,777 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,777 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041 src: /127.0.0.1:57332 dest: /127.0.0.1:44971
2020-04-02 05:08:17,777 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041
 storageType=DISK, inAddr=/127.0.0.1:57332, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_APPEND, newGs=1042, minBytesRcvd=1476, maxBytesRcvd=1476
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:17,777 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1041, FINALIZED
  getNumBytes()     = 1476
  getBytesOnDisk()  = 1476
  getVisibleLength()= 1476
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,804 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1476
2020-04-02 05:08:17,804 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1042.meta of size 19
2020-04-02 05:08:17,805 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:17,810 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,811 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, newGs=1042, bytesRcvd=[1476, 1476]
  targets=[127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,811 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,811 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,811 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041 src: /127.0.0.1:60836 dest: /127.0.0.1:45739
2020-04-02 05:08:17,811 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041
 storageType=DISK, inAddr=/127.0.0.1:60836, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1042, minBytesRcvd=1476, maxBytesRcvd=1476
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:17,811 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1041, FINALIZED
  getNumBytes()     = 1476
  getBytesOnDisk()  = 1476
  getVisibleLength()= 1476
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,818 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC7/foo0 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,818 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC7/foo0 with 1 blocks is persisted to the file system
2020-04-02 05:08:17,819 [IPC Server handler 6 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC7/foo0 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,821 [IPC Server handler 8 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/TC7/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:17,824 [IPC Server handler 4 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741847_1039]
2020-04-02 05:08:17,824 [IPC Server handler 4 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC7/foo0	dst=null	perm=null	proto=rpc
All blocks of file /TC7/foo0 verified to have replication factor 2
2020-04-02 05:08:17,826 [IPC Server handler 7 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741847_1039]
2020-04-02 05:08:17,827 [IPC Server handler 7 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC7/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:17,828 [main] INFO  impl.FsDatasetImplTestUtils (FsDatasetImplTestUtils.java:truncateData(147)) - Truncating block file: /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741847
2020-04-02 05:08:17,829 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC7/foo0 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:17,829 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC7/foo0, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:17,829 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /TC7/foo0 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039 block size 32768
2020-04-02 05:08:17,830 [IPC Server handler 2 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TC7/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:17,831 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC7/foo0, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:17,832 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC7/foo0, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:blk_1073741847_1039
2020-04-02 05:08:17,844 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC7/foo0, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:17,844 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC7/foo0  inodeId 16406 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,844 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/TC7/foo0, packetSize=516, chunksPerPacket=1, bytesCurBlock=64512, DFSOutputStream:blk_1073741847_1039
2020-04-02 05:08:17,845 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC7/foo0, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:17,845 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=2, src=/TC7/foo0, packetSize=516, chunksPerPacket=1, bytesCurBlock=65024, DFSOutputStream:blk_1073741847_1039
2020-04-02 05:08:17,845 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC7/foo0 with blk_1073741848_1043 block is added to the in-memory file system
2020-04-02 05:08:17,845 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC7/foo0, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:17,845 [IPC Server handler 1 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741848_1043, replicas=127.0.0.1:45580, 127.0.0.1:43434 for /TC7/foo0
2020-04-02 05:08:17,846 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC7/foo0 with new block blk_1073741848_1043, current total block count is 2
2020-04-02 05:08:17,854 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,854 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1476
2020-04-02 05:08:17,854 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1042.meta of size 19
2020-04-02 05:08:17,855 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:17,856 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:17,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041, newGs=1042, bytesRcvd=[1476, 1476]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43434]; pipelineSize=2, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,856 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,857 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041 src: /127.0.0.1:38436 dest: /127.0.0.1:43434
2020-04-02 05:08:17,857 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,857 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043 src: /127.0.0.1:35608 dest: /127.0.0.1:45580
2020-04-02 05:08:17,857 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041
 storageType=DISK, inAddr=/127.0.0.1:38436, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1042, minBytesRcvd=1476, maxBytesRcvd=1476
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:17,857 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043
 storageType=DISK, inAddr=/127.0.0.1:35608, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:17,857 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1041, FINALIZED
  getNumBytes()     = 1476
  getBytesOnDisk()  = 1476
  getVisibleLength()= 1476
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:17,857 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741848 of size 0
2020-04-02 05:08:17,857 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741848_1043.meta of size 0
2020-04-02 05:08:17,857 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:17,858 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 3
2020-04-02 05:08:17,858 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=2, srcDataNode=:0, pinning=false
2020-04-02 05:08:17,859 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:17,859 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:17,859 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043 src: /127.0.0.1:38438 dest: /127.0.0.1:43434
2020-04-02 05:08:17,859 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043
 storageType=DISK, inAddr=/127.0.0.1:38438, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:17,891 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1476
2020-04-02 05:08:17,891 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1042.meta of size 19
2020-04-02 05:08:17,891 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741848 of size 0
2020-04-02 05:08:17,891 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741848_1043.meta of size 0
2020-04-02 05:08:17,892 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,892 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,892 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Waiting for operation #6]] DEBUG datanode.DataNode (DataXceiver.java:run(276)) - Cached NioInetPeer(Socket[addr=/127.0.0.1,port=56760,localport=44971]) closing after 5 ops.  This message is usually benign.
2020-04-02 05:08:17,892 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:56760 [Waiting for operation #6]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 4
2020-04-02 05:08:17,893 [IPC Server handler 0 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1041, newGS=1042, newLength=1476, newNodes=[127.0.0.1:44971, 127.0.0.1:45739, 127.0.0.1:43434], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:17,893 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1042 from 127.0.0.1:44971
2020-04-02 05:08:17,893 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-9396c1fd-c034-40b5-99a4-7728fe5d066f:NORMAL:127.0.0.1:44971|RBW] of blk_1073741839_1041
2020-04-02 05:08:17,893 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1042 from 127.0.0.1:45739
2020-04-02 05:08:17,893 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1041
2020-04-02 05:08:17,893 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1042 from 127.0.0.1:43434
2020-04-02 05:08:17,893 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1041
2020-04-02 05:08:17,893 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:17,894 [IPC Server handler 0 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1041 => blk_1073741839_1042) success
2020-04-02 05:08:17,898 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37840 [Waiting for operation #5]] DEBUG datanode.DataNode (DataXceiver.java:run(276)) - Cached NioInetPeer(Socket[addr=/127.0.0.1,port=37840,localport=43434]) closing after 4 ops.  This message is usually benign.
2020-04-02 05:08:17,907 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:37840 [Waiting for operation #5]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 6
2020-04-02 05:08:17,907 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:17,907 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689267285949128, ackStatus=SUCCESS)
2020-04-02 05:08:17,908 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:17,908 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689267286867961, ackStatus=SUCCESS)
2020-04-02 05:08:17,909 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:17,909 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689267287279321, ackStatus=SUCCESS)
2020-04-02 05:08:17,909 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:17,909 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689267287532564, ackStatus=SUCCESS)
2020-04-02 05:08:17,909 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,909 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,909 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:17,900 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042: PacketHeader with packetLen=68 header data: offsetInBlock: 1476
seqno: 0
lastPacketInBlock: false
dataLen: 60

2020-04-02 05:08:17,910 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1952812 flag: 0 flag: 0
2020-04-02 05:08:17,910 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1536, ackEnqueueNanoTime=689267288252912, ackStatus=SUCCESS)
2020-04-02 05:08:17,910 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689267288152857, ackStatus=SUCCESS)
2020-04-02 05:08:17,910 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:17,910 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042: PacketHeader with packetLen=68 header data: offsetInBlock: 1476
seqno: 0
lastPacketInBlock: false
dataLen: 60

2020-04-02 05:08:17,909 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,910 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1536, ackEnqueueNanoTime=689267288820814, ackStatus=SUCCESS)
2020-04-02 05:08:17,910 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689267288660984, ackStatus=SUCCESS)
2020-04-02 05:08:17,911 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042: previous write did not end at the chunk boundary. onDiskLen=1476
2020-04-02 05:08:17,910 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,911 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042: sizePartialChunk=452, block offset=1024, metafile offset=15
2020-04-02 05:08:17,911 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042: PacketHeader with packetLen=68 header data: offsetInBlock: 1476
seqno: 0
lastPacketInBlock: false
dataLen: 60

2020-04-02 05:08:17,910 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,911 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042: previous write did not end at the chunk boundary. onDiskLen=1476
2020-04-02 05:08:17,911 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1143996 flag: 0 flag: 0
2020-04-02 05:08:17,911 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,911 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,911 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042
2020-04-02 05:08:17,911 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042: sizePartialChunk=452, block offset=1024, metafile offset=15
2020-04-02 05:08:17,912 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1811585 flag: 0 flag: 0
2020-04-02 05:08:17,911 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,912 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042
2020-04-02 05:08:17,912 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 60, skip=0
2020-04-02 05:08:17,912 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 60, skip=0
2020-04-02 05:08:17,912 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1536, ackEnqueueNanoTime=689267290712393, ackStatus=SUCCESS)
2020-04-02 05:08:17,912 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,913 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,918 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,918 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689267296991560, ackStatus=SUCCESS)
2020-04-02 05:08:17,919 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043
2020-04-02 05:08:17,919 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,919 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043
2020-04-02 05:08:17,919 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689267297446053, ackStatus=SUCCESS)
2020-04-02 05:08:17,919 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38438, dest: /127.0.0.1:43434, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, duration(ns): 26964809
2020-04-02 05:08:17,920 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE, replyAck=seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,920 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,920 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:17,920 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:17,920 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38438 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 4
2020-04-02 05:08:17,920 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:35608, dest: /127.0.0.1:45580, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, duration(ns): 21814500
2020-04-02 05:08:17,920 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 3 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1358919 flag: 0 flag: 0
2020-04-02 05:08:17,920 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:17,920 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:17,921 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35608 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 3
2020-04-02 05:08:17,922 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,922 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741848_1043 on 127.0.0.1:43434 size 65536 replicaState = FINALIZED
2020-04-02 05:08:17,922 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,922 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741848_1043 (size=0)
2020-04-02 05:08:17,922 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741848_1043 is received from 127.0.0.1:43434
2020-04-02 05:08:17,922 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1042 on 127.0.0.1:43434 size 134217728 replicaState = RBW
2020-04-02 05:08:17,922 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,923 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVING_BLOCK: blk_1073741839_1042 is received from 127.0.0.1:43434
2020-04-02 05:08:17,923 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,923 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 1, received: 1, deleted: 0
2020-04-02 05:08:17,923 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741848_1043 on 127.0.0.1:45580 size 65536 replicaState = FINALIZED
2020-04-02 05:08:17,923 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:17,923 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741848_1043 (size=0)
2020-04-02 05:08:17,923 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741848_1043 is received from 127.0.0.1:45580
2020-04-02 05:08:17,923 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,923 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC7/foo0 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,923 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC7/foo0 with 2 blocks is persisted to the file system
2020-04-02 05:08:17,923 [IPC Server handler 3 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC7/foo0 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,926 [IPC Server handler 6 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/TC7/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:17,928 [IPC Server handler 8 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741847_1039, blk_1073741848_1043]
2020-04-02 05:08:17,928 [IPC Server handler 8 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC7/foo0	dst=null	perm=null	proto=rpc
2020-04-02 05:08:17,929 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(242)) - newInfo = LocatedBlocks{;  fileLength=98304;  underConstruction=false;  blocks=[LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039; getBlockSize()=32768; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:43230,DS-9e64160f-8239-40bc-b495-871e2ebb5a3a,DISK], DatanodeInfoWithStorage[127.0.0.1:45739,DS-6946cabd-2f8d-451f-81bc-4884ebba8665,DISK]]}, LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043; getBlockSize()=65536; corrupt=false; offset=32768; locs=[DatanodeInfoWithStorage[127.0.0.1:43434,DS-29df15fa-b2ca-4eca-89df-87135d5e3b76,DISK], DatanodeInfoWithStorage[127.0.0.1:45580,DS-089629a9-5898-4562-bd81-79a4f45c96c1,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043; getBlockSize()=65536; corrupt=false; offset=32768; locs=[DatanodeInfoWithStorage[127.0.0.1:45580,DS-089629a9-5898-4562-bd81-79a4f45c96c1,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-29df15fa-b2ca-4eca-89df-87135d5e3b76,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-04-02 05:08:17,930 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:43230
2020-04-02 05:08:17,931 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, replica=FinalizedReplica, blk_1073741847_1039, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741847
2020-04-02 05:08:17,931 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741847_1039, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741847
2020-04-02 05:08:17,931 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,931 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 20817031 flag: 0 flag: 0
2020-04-02 05:08:17,932 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042: previous write did not end at the chunk boundary. onDiskLen=1476
2020-04-02 05:08:17,932 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042: sizePartialChunk=452, block offset=1024, metafile offset=15
2020-04-02 05:08:17,932 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042
2020-04-02 05:08:17,933 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 60, skip=0
2020-04-02 05:08:17,933 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042: PacketHeader with packetLen=71 header data: offsetInBlock: 1536
seqno: 1
lastPacketInBlock: false
dataLen: 63

2020-04-02 05:08:17,933 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=1599, ackEnqueueNanoTime=689267311390729, ackStatus=SUCCESS)
2020-04-02 05:08:17,933 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042: PacketHeader with packetLen=71 header data: offsetInBlock: 1536
seqno: 1
lastPacketInBlock: false
dataLen: 63

2020-04-02 05:08:17,933 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=1599, ackEnqueueNanoTime=689267311971813, ackStatus=SUCCESS)
2020-04-02 05:08:17,934 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 20817031 flag: 0 flag: 0
2020-04-02 05:08:17,934 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042: PacketHeader with packetLen=71 header data: offsetInBlock: 1536
seqno: 1
lastPacketInBlock: false
dataLen: 63

2020-04-02 05:08:17,934 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 23879000 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,934 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=1599, ackEnqueueNanoTime=689267312433299, ackStatus=SUCCESS)
2020-04-02 05:08:17,934 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] ERROR datanode.DataNode (BlockSender.java:sendPacket(650)) - BlockSender.sendChunks() exception: 
java.io.EOFException: EOF Reached. file size is 0 and 32768 more bytes left to be transfered.
	at org.apache.hadoop.net.SocketOutputStream.transferToFully(SocketOutputStream.java:228)
	at org.apache.hadoop.hdfs.server.datanode.FileIoProvider.transferToSocketFully(FileIoProvider.java:280)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.sendPacket(BlockSender.java:619)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.doSendBlock(BlockSender.java:804)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.sendBlock(BlockSender.java:751)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.readBlock(DataXceiver.java:607)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.opReadBlock(Receiver.java:152)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.processOp(Receiver.java:104)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.run(DataXceiver.java:290)
	at java.lang.Thread.run(Thread.java:748)
2020-04-02 05:08:17,935 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:43230, dest: /127.0.0.1:57312, bytes: 0, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, duration(ns): 4151555
2020-04-02 05:08:17,936 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3)] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, replica=FinalizedReplica, blk_1073741847_1039, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741847
2020-04-02 05:08:17,936 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] WARN  datanode.DataNode (DataXceiver.java:readBlock(643)) - DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136):Got exception while serving BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039 to /127.0.0.1:57312
java.io.EOFException: EOF Reached. file size is 0 and 32768 more bytes left to be transfered.
	at org.apache.hadoop.net.SocketOutputStream.transferToFully(SocketOutputStream.java:228)
	at org.apache.hadoop.hdfs.server.datanode.FileIoProvider.transferToSocketFully(FileIoProvider.java:280)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.sendPacket(BlockSender.java:619)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.doSendBlock(BlockSender.java:804)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.sendBlock(BlockSender.java:751)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.readBlock(DataXceiver.java:607)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.opReadBlock(Receiver.java:152)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.processOp(Receiver.java:104)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.run(DataXceiver.java:290)
	at java.lang.Thread.run(Thread.java:748)
2020-04-02 05:08:17,937 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,955 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:17,955 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] ERROR datanode.DataNode (DataXceiver.java:run(321)) - 127.0.0.1:43230:DataXceiver error processing READ_BLOCK operation  src: /127.0.0.1:57312 dst: /127.0.0.1:43230
java.io.EOFException: EOF Reached. file size is 0 and 32768 more bytes left to be transfered.
	at org.apache.hadoop.net.SocketOutputStream.transferToFully(SocketOutputStream.java:228)
	at org.apache.hadoop.hdfs.server.datanode.FileIoProvider.transferToSocketFully(FileIoProvider.java:280)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.sendPacket(BlockSender.java:619)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.doSendBlock(BlockSender.java:804)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.sendBlock(BlockSender.java:751)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.readBlock(DataXceiver.java:607)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.opReadBlock(Receiver.java:152)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.processOp(Receiver.java:104)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.run(DataXceiver.java:290)
	at java.lang.Thread.run(Thread.java:748)
2020-04-02 05:08:17,955 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57312 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43230:Number of active connections is: 2
2020-04-02 05:08:17,937 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,936 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3)] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741847_1039, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741847
2020-04-02 05:08:17,963 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3759480 flag: 0 flag: 0
2020-04-02 05:08:17,963 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3759480 flag: 0 flag: 0
2020-04-02 05:08:17,963 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 30233820 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,964 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042: PacketHeader with packetLen=4 header data: offsetInBlock: 1599
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,964 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=1599, ackEnqueueNanoTime=689267342538421, ackStatus=SUCCESS)
2020-04-02 05:08:17,964 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042
2020-04-02 05:08:17,964 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042: PacketHeader with packetLen=4 header data: offsetInBlock: 1599
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,964 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=1599, ackEnqueueNanoTime=689267343054700, ackStatus=SUCCESS)
2020-04-02 05:08:17,965 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042
2020-04-02 05:08:17,965 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042: PacketHeader with packetLen=4 header data: offsetInBlock: 1599
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:17,965 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042
2020-04-02 05:08:17,965 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=1599, ackEnqueueNanoTime=689267343514253, ackStatus=SUCCESS)
2020-04-02 05:08:17,963 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3)] WARN  datanode.VolumeScanner (VolumeScanner.java:handle(292)) - Reporting bad BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039 on /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3
2020-04-02 05:08:17,965 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:43230
2020-04-02 05:08:17,966 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38436, dest: /127.0.0.1:43434, bytes: 1599, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, duration(ns): 73616763
2020-04-02 05:08:17,966 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,966 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:17,966 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:17,966 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38436 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:17,967 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:17,967 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3)] INFO  datanode.VolumeScanner (VolumeScanner.java:findNextUsableBlockIter(403)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3, DS-9e64160f-8239-40bc-b495-871e2ebb5a3a): no suitable block pools found to scan.  Waiting 1814392224 ms.
2020-04-02 05:08:17,967 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60836, dest: /127.0.0.1:45739, bytes: 1599, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, duration(ns): 68080928
2020-04-02 05:08:17,967 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2163324 flag: 0 flag: 0
2020-04-02 05:08:17,967 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:17,967 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:17,968 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2163324 flag: 0 flag: 0
2020-04-02 05:08:17,969 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57332, dest: /127.0.0.1:44971, bytes: 1599, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, duration(ns): 74706336
2020-04-02 05:08:17,969 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3805644 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:17,969 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] terminating
2020-04-02 05:08:17,970 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,970 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: closing
2020-04-02 05:08:17,970 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57332 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 2
2020-04-02 05:08:17,970 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,970 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:17,971 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:17,971 [IPC Server handler 4 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:checkBlocksComplete(2908)) - BLOCK* blk_1073741839_1042 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /testSmallAppendRace
2020-04-02 05:08:17,971 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1042 on 127.0.0.1:43434 size 1599 replicaState = FINALIZED
2020-04-02 05:08:17,972 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMMITTED
2020-04-02 05:08:17,972 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1042 (size=1599)
2020-04-02 05:08:17,972 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1042 is received from 127.0.0.1:43434
2020-04-02 05:08:17,972 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,972 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741839_1042
2020-04-02 05:08:17,972 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1042 on 127.0.0.1:44971 size 1599 replicaState = FINALIZED
2020-04-02 05:08:17,972 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:17,972 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741839_1042 (size=1599)
2020-04-02 05:08:17,972 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1042 is received from 127.0.0.1:44971
2020-04-02 05:08:17,972 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,972 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741839_1042
2020-04-02 05:08:17,972 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1042 on 127.0.0.1:45739 size 1599 replicaState = FINALIZED
2020-04-02 05:08:17,972 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:17,972 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1042 (size=1599)
2020-04-02 05:08:17,972 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1042 is received from 127.0.0.1:45739
2020-04-02 05:08:17,973 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:17,974 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@4a9f80d3] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:17,975 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57504 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, replica=FinalizedReplica, blk_1073741847_1039, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741847
2020-04-02 05:08:17,975 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57504 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741847_1039, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741847
2020-04-02 05:08:17,976 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57504 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] ERROR datanode.DataNode (BlockSender.java:sendPacket(650)) - BlockSender.sendChunks() exception: 
java.io.EOFException: EOF Reached. file size is 0 and 32768 more bytes left to be transfered.
	at org.apache.hadoop.net.SocketOutputStream.transferToFully(SocketOutputStream.java:228)
	at org.apache.hadoop.hdfs.server.datanode.FileIoProvider.transferToSocketFully(FileIoProvider.java:280)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.sendPacket(BlockSender.java:619)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.doSendBlock(BlockSender.java:804)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.sendBlock(BlockSender.java:751)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.readBlock(DataXceiver.java:607)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.opReadBlock(Receiver.java:152)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.processOp(Receiver.java:104)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.run(DataXceiver.java:290)
	at java.lang.Thread.run(Thread.java:748)
2020-04-02 05:08:17,976 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57504 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:43230, dest: /127.0.0.1:57504, bytes: 0, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, duration(ns): 638508
2020-04-02 05:08:17,976 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57504 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] WARN  datanode.DataNode (DataXceiver.java:readBlock(643)) - DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136):Got exception while serving BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039 to /127.0.0.1:57504
java.io.EOFException: EOF Reached. file size is 0 and 32768 more bytes left to be transfered.
	at org.apache.hadoop.net.SocketOutputStream.transferToFully(SocketOutputStream.java:228)
	at org.apache.hadoop.hdfs.server.datanode.FileIoProvider.transferToSocketFully(FileIoProvider.java:280)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.sendPacket(BlockSender.java:619)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.doSendBlock(BlockSender.java:804)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.sendBlock(BlockSender.java:751)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.readBlock(DataXceiver.java:607)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.opReadBlock(Receiver.java:152)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.processOp(Receiver.java:104)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.run(DataXceiver.java:290)
	at java.lang.Thread.run(Thread.java:748)
2020-04-02 05:08:17,978 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57504 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] ERROR datanode.DataNode (DataXceiver.java:run(321)) - 127.0.0.1:43230:DataXceiver error processing READ_BLOCK operation  src: /127.0.0.1:57504 dst: /127.0.0.1:43230
java.io.EOFException: EOF Reached. file size is 0 and 32768 more bytes left to be transfered.
	at org.apache.hadoop.net.SocketOutputStream.transferToFully(SocketOutputStream.java:228)
	at org.apache.hadoop.hdfs.server.datanode.FileIoProvider.transferToSocketFully(FileIoProvider.java:280)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.sendPacket(BlockSender.java:619)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.doSendBlock(BlockSender.java:804)
	at org.apache.hadoop.hdfs.server.datanode.BlockSender.sendBlock(BlockSender.java:751)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.readBlock(DataXceiver.java:607)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.opReadBlock(Receiver.java:152)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.processOp(Receiver.java:104)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.run(DataXceiver.java:290)
	at java.lang.Thread.run(Thread.java:748)
2020-04-02 05:08:17,978 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57504 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43230:Number of active connections is: 2
2020-04-02 05:08:17,979 [main] WARN  hdfs.DFSClient (DFSInputStream.java:readBuffer(715)) - Exception while reading from BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039 of /TC7/foo0 from DatanodeInfoWithStorage[127.0.0.1:43230,DS-9e64160f-8239-40bc-b495-871e2ebb5a3a,DISK]
java.io.IOException: Premature EOF reading from org.apache.hadoop.net.SocketInputStream@75201592
	at org.apache.hadoop.hdfs.protocol.datatransfer.PacketReceiver.readChannelFully(PacketReceiver.java:258)
	at org.apache.hadoop.hdfs.protocol.datatransfer.PacketReceiver.doReadFully(PacketReceiver.java:207)
	at org.apache.hadoop.hdfs.protocol.datatransfer.PacketReceiver.doRead(PacketReceiver.java:169)
	at org.apache.hadoop.hdfs.protocol.datatransfer.PacketReceiver.receiveNextPacket(PacketReceiver.java:102)
	at org.apache.hadoop.hdfs.client.impl.BlockReaderRemote.readNextPacket(BlockReaderRemote.java:183)
	at org.apache.hadoop.hdfs.client.impl.BlockReaderRemote.read(BlockReaderRemote.java:142)
	at org.apache.hadoop.hdfs.ByteArrayStrategy.readFromBlock(ReaderStrategy.java:118)
	at org.apache.hadoop.hdfs.DFSInputStream.readBuffer(DFSInputStream.java:704)
	at org.apache.hadoop.hdfs.DFSInputStream.readWithStrategy(DFSInputStream.java:765)
	at org.apache.hadoop.hdfs.DFSInputStream.read(DFSInputStream.java:825)
	at org.apache.hadoop.hdfs.DFSInputStream.read(DFSInputStream.java:680)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.hdfs.AppendTestUtil.check(AppendTestUtil.java:153)
	at org.apache.hadoop.hdfs.TestFileAppend3.testTC7(TestFileAppend3.java:330)
	at org.apache.hadoop.hdfs.TestFileAppend3.testTC7ForAppend2(TestFileAppend3.java:340)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:47)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:44)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:271)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:70)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:50)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:238)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:63)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:236)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:53)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:229)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:26)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:27)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:365)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:273)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:159)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
2020-04-02 05:08:17,980 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:17,981 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, replica=FinalizedReplica, blk_1073741847_1039, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741847
2020-04-02 05:08:17,986 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741847_1039, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741847
2020-04-02 05:08:17,987 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:45739, dest: /127.0.0.1:60328, bytes: 33024, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, duration(ns): 237492
2020-04-02 05:08:17,995 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60836 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1041]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:18,374 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:18,374 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:18,374 [IPC Server handler 0 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:18,378 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:18,378 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:18,378 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042 block size 1599
2020-04-02 05:08:18,380 [IPC Server handler 9 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:18,381 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=453, chunksPerPacket=1, packetSize=453
2020-04-02 05:08:18,382 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=453, chunksPerPacket=1, bytesCurBlock=1599, DFSOutputStream:blk_1073741839_1042
2020-04-02 05:08:18,386 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:18,394 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, newGs=1044, bytesRcvd=[1599, 1599]
  targets=[127.0.0.1:44971, 127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:18,394 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:18,394 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:18,395 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042 src: /127.0.0.1:38488 dest: /127.0.0.1:43434
2020-04-02 05:08:18,395 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042
 storageType=DISK, inAddr=/127.0.0.1:38488, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1044, minBytesRcvd=1599, maxBytesRcvd=1599
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:18,395 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1042, FINALIZED
  getNumBytes()     = 1599
  getBytesOnDisk()  = 1599
  getVisibleLength()= 1599
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:18,428 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1599
2020-04-02 05:08:18,428 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1044.meta of size 23
2020-04-02 05:08:18,429 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:18,434 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:18,436 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, newGs=1044, bytesRcvd=[1599, 1599]
  targets=[127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:18,436 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:18,436 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:18,436 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042 src: /127.0.0.1:57404 dest: /127.0.0.1:44971
2020-04-02 05:08:18,439 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042
 storageType=DISK, inAddr=/127.0.0.1:57404, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_APPEND, newGs=1044, minBytesRcvd=1599, maxBytesRcvd=1599
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:18,440 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1042, FINALIZED
  getNumBytes()     = 1599
  getBytesOnDisk()  = 1599
  getVisibleLength()= 1599
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:18,508 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1599
2020-04-02 05:08:18,508 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1044.meta of size 23
2020-04-02 05:08:18,508 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:18,529 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:18,535 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042, newGs=1044, bytesRcvd=[1599, 1599]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:18,535 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:18,535 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:18,535 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042 src: /127.0.0.1:60916 dest: /127.0.0.1:45739
2020-04-02 05:08:18,542 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042
 storageType=DISK, inAddr=/127.0.0.1:60916, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1044, minBytesRcvd=1599, maxBytesRcvd=1599
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:18,542 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1042, FINALIZED
  getNumBytes()     = 1599
  getBytesOnDisk()  = 1599
  getVisibleLength()= 1599
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:18,612 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1599
2020-04-02 05:08:18,612 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1044.meta of size 23
2020-04-02 05:08:18,613 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:18,623 [IPC Server handler 3 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1042, newGS=1044, newLength=1599, newNodes=[127.0.0.1:43434, 127.0.0.1:44971, 127.0.0.1:45739], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:18,623 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1044 from 127.0.0.1:43434
2020-04-02 05:08:18,624 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1042
2020-04-02 05:08:18,624 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1044 from 127.0.0.1:44971
2020-04-02 05:08:18,624 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-9396c1fd-c034-40b5-99a4-7728fe5d066f:NORMAL:127.0.0.1:44971|RBW] of blk_1073741839_1042
2020-04-02 05:08:18,624 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1044 from 127.0.0.1:45739
2020-04-02 05:08:18,624 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1042
2020-04-02 05:08:18,624 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:18,624 [IPC Server handler 3 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1042 => blk_1073741839_1044) success
2020-04-02 05:08:18,626 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044: PacketHeader with packetLen=131 header data: offsetInBlock: 1599
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:18,626 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1722, ackEnqueueNanoTime=689268004647676, ackStatus=SUCCESS)
2020-04-02 05:08:18,626 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044: previous write did not end at the chunk boundary. onDiskLen=1599
2020-04-02 05:08:18,626 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044: sizePartialChunk=63, block offset=1536, metafile offset=19
2020-04-02 05:08:18,627 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044
2020-04-02 05:08:18,627 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:18,638 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044: PacketHeader with packetLen=131 header data: offsetInBlock: 1599
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:18,646 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1722, ackEnqueueNanoTime=689268024258925, ackStatus=SUCCESS)
2020-04-02 05:08:18,646 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044: previous write did not end at the chunk boundary. onDiskLen=1599
2020-04-02 05:08:18,646 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044: sizePartialChunk=63, block offset=1536, metafile offset=19
2020-04-02 05:08:18,646 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044: PacketHeader with packetLen=131 header data: offsetInBlock: 1599
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:18,646 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044
2020-04-02 05:08:18,646 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044: previous write did not end at the chunk boundary. onDiskLen=1599
2020-04-02 05:08:18,651 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044: sizePartialChunk=63, block offset=1536, metafile offset=19
2020-04-02 05:08:18,654 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044
2020-04-02 05:08:18,654 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:18,654 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1722, ackEnqueueNanoTime=689268032797396, ackStatus=SUCCESS)
2020-04-02 05:08:18,646 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:18,660 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:18,660 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:18,663 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:18,663 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 16978337 flag: 0 flag: 0
2020-04-02 05:08:18,663 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 16978337 flag: 0 flag: 0
2020-04-02 05:08:18,664 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 37335434 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:18,670 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044: PacketHeader with packetLen=4 header data: offsetInBlock: 1722
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:18,670 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1722, ackEnqueueNanoTime=689268048791325, ackStatus=SUCCESS)
2020-04-02 05:08:18,670 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044
2020-04-02 05:08:18,673 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044: PacketHeader with packetLen=4 header data: offsetInBlock: 1722
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:18,676 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1722, ackEnqueueNanoTime=689268053942051, ackStatus=SUCCESS)
2020-04-02 05:08:18,679 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044
2020-04-02 05:08:18,679 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044: PacketHeader with packetLen=4 header data: offsetInBlock: 1722
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:18,679 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044
2020-04-02 05:08:18,679 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1722, ackEnqueueNanoTime=689268057711751, ackStatus=SUCCESS)
2020-04-02 05:08:18,680 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60916, dest: /127.0.0.1:45739, bytes: 1722, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, duration(ns): 66095866
2020-04-02 05:08:18,680 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:18,680 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:18,680 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:18,681 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57404, dest: /127.0.0.1:44971, bytes: 1722, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, duration(ns): 62279821
2020-04-02 05:08:18,681 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 4855879 flag: 0 flag: 0
2020-04-02 05:08:18,682 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] terminating
2020-04-02 05:08:18,682 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 4855879 flag: 0 flag: 0
2020-04-02 05:08:18,683 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38488, dest: /127.0.0.1:43434, bytes: 1722, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, duration(ns): 63438866
2020-04-02 05:08:18,683 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 11636508 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:18,683 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739] terminating
2020-04-02 05:08:18,684 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]: closing
2020-04-02 05:08:18,684 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38488 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:18,686 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:18,686 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:18,686 [IPC Server handler 4 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:checkBlocksComplete(2908)) - BLOCK* blk_1073741839_1044 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /testSmallAppendRace
2020-04-02 05:08:18,687 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1044 on 127.0.0.1:43434 size 1722 replicaState = FINALIZED
2020-04-02 05:08:18,687 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMMITTED
2020-04-02 05:08:18,687 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1044 (size=1722)
2020-04-02 05:08:18,688 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1044 is received from 127.0.0.1:43434
2020-04-02 05:08:18,688 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:18,680 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:18,686 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:18,686 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:18,689 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741839_1044
2020-04-02 05:08:18,689 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1044 on 127.0.0.1:44971 size 1722 replicaState = FINALIZED
2020-04-02 05:08:18,689 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:18,689 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741839_1044 (size=1722)
2020-04-02 05:08:18,689 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1044 is received from 127.0.0.1:44971
2020-04-02 05:08:18,689 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:18,689 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741839_1044
2020-04-02 05:08:18,689 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1044 on 127.0.0.1:45739 size 1722 replicaState = FINALIZED
2020-04-02 05:08:18,689 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:18,690 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1044 (size=1722)
2020-04-02 05:08:18,690 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1044 is received from 127.0.0.1:45739
2020-04-02 05:08:18,690 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:18,686 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: closing
2020-04-02 05:08:18,693 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57404 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 2
2020-04-02 05:08:18,694 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60916 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1042]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:19,090 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:19,091 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:19,091 [IPC Server handler 0 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:19,093 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:19,093 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:19,094 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044 block size 1722
2020-04-02 05:08:19,095 [IPC Server handler 9 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:19,097 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=330, chunksPerPacket=1, packetSize=330
2020-04-02 05:08:19,097 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=330, chunksPerPacket=1, bytesCurBlock=1722, DFSOutputStream:blk_1073741839_1044
2020-04-02 05:08:19,106 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:19,107 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, newGs=1045, bytesRcvd=[1722, 1722]
  targets=[127.0.0.1:44971, 127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:19,107 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:19,107 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:19,107 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044 src: /127.0.0.1:38564 dest: /127.0.0.1:43434
2020-04-02 05:08:19,107 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044
 storageType=DISK, inAddr=/127.0.0.1:38564, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1045, minBytesRcvd=1722, maxBytesRcvd=1722
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:19,107 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1044, FINALIZED
  getNumBytes()     = 1722
  getBytesOnDisk()  = 1722
  getVisibleLength()= 1722
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:19,151 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1722
2020-04-02 05:08:19,152 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1045.meta of size 23
2020-04-02 05:08:19,152 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:19,153 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:19,155 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, newGs=1045, bytesRcvd=[1722, 1722]
  targets=[127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:19,155 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:19,155 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:19,155 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044 src: /127.0.0.1:57476 dest: /127.0.0.1:44971
2020-04-02 05:08:19,155 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044
 storageType=DISK, inAddr=/127.0.0.1:57476, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_APPEND, newGs=1045, minBytesRcvd=1722, maxBytesRcvd=1722
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:19,156 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1044, FINALIZED
  getNumBytes()     = 1722
  getBytesOnDisk()  = 1722
  getVisibleLength()= 1722
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:19,194 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1722
2020-04-02 05:08:19,194 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1045.meta of size 23
2020-04-02 05:08:19,196 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:19,197 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:19,199 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044, newGs=1045, bytesRcvd=[1722, 1722]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:19,199 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:19,199 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:19,199 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044 src: /127.0.0.1:60982 dest: /127.0.0.1:45739
2020-04-02 05:08:19,200 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044
 storageType=DISK, inAddr=/127.0.0.1:60982, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1045, minBytesRcvd=1722, maxBytesRcvd=1722
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:19,200 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1044, FINALIZED
  getNumBytes()     = 1722
  getBytesOnDisk()  = 1722
  getVisibleLength()= 1722
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:19,221 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-04-02 05:08:19,239 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1722
2020-04-02 05:08:19,239 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1045.meta of size 23
2020-04-02 05:08:19,240 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:19,258 [IPC Server handler 3 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1044, newGS=1045, newLength=1722, newNodes=[127.0.0.1:43434, 127.0.0.1:44971, 127.0.0.1:45739], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:19,258 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1045 from 127.0.0.1:43434
2020-04-02 05:08:19,258 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1044
2020-04-02 05:08:19,258 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1045 from 127.0.0.1:44971
2020-04-02 05:08:19,258 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-9396c1fd-c034-40b5-99a4-7728fe5d066f:NORMAL:127.0.0.1:44971|RBW] of blk_1073741839_1044
2020-04-02 05:08:19,258 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1045 from 127.0.0.1:45739
2020-04-02 05:08:19,258 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1044
2020-04-02 05:08:19,259 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:19,259 [IPC Server handler 3 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1044 => blk_1073741839_1045) success
2020-04-02 05:08:19,264 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045: PacketHeader with packetLen=131 header data: offsetInBlock: 1722
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:19,264 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1845, ackEnqueueNanoTime=689268643032286, ackStatus=SUCCESS)
2020-04-02 05:08:19,265 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045: previous write did not end at the chunk boundary. onDiskLen=1722
2020-04-02 05:08:19,265 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045: sizePartialChunk=186, block offset=1536, metafile offset=19
2020-04-02 05:08:19,265 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045: PacketHeader with packetLen=131 header data: offsetInBlock: 1722
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:19,265 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1845, ackEnqueueNanoTime=689268643411856, ackStatus=SUCCESS)
2020-04-02 05:08:19,265 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045: previous write did not end at the chunk boundary. onDiskLen=1722
2020-04-02 05:08:19,265 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045: sizePartialChunk=186, block offset=1536, metafile offset=19
2020-04-02 05:08:19,265 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045
2020-04-02 05:08:19,265 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045: PacketHeader with packetLen=131 header data: offsetInBlock: 1722
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:19,265 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045
2020-04-02 05:08:19,265 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:19,265 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:19,265 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045: previous write did not end at the chunk boundary. onDiskLen=1722
2020-04-02 05:08:19,266 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045: sizePartialChunk=186, block offset=1536, metafile offset=19
2020-04-02 05:08:19,266 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045
2020-04-02 05:08:19,266 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:19,266 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1845, ackEnqueueNanoTime=689268644567335, ackStatus=SUCCESS)
2020-04-02 05:08:19,266 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,266 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:19,267 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,267 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2479076 flag: 0 flag: 0
2020-04-02 05:08:19,270 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2479076 flag: 0 flag: 0
2020-04-02 05:08:19,270 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 5223203 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:19,270 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045: PacketHeader with packetLen=4 header data: offsetInBlock: 1845
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:19,270 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1845, ackEnqueueNanoTime=689268649074674, ackStatus=SUCCESS)
2020-04-02 05:08:19,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045
2020-04-02 05:08:19,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045: PacketHeader with packetLen=4 header data: offsetInBlock: 1845
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:19,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1845, ackEnqueueNanoTime=689268649376097, ackStatus=SUCCESS)
2020-04-02 05:08:19,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045
2020-04-02 05:08:19,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045: PacketHeader with packetLen=4 header data: offsetInBlock: 1845
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:19,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045
2020-04-02 05:08:19,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1845, ackEnqueueNanoTime=689268649771698, ackStatus=SUCCESS)
2020-04-02 05:08:19,272 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60982, dest: /127.0.0.1:45739, bytes: 1845, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, duration(ns): 31511188
2020-04-02 05:08:19,272 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,272 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:19,272 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:19,272 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60982 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:19,272 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,273 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57476, dest: /127.0.0.1:44971, bytes: 1845, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, duration(ns): 32591740
2020-04-02 05:08:19,273 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1614908 flag: 0 flag: 0
2020-04-02 05:08:19,273 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1614908 flag: 0 flag: 0
2020-04-02 05:08:19,273 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: closing
2020-04-02 05:08:19,273 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] terminating
2020-04-02 05:08:19,273 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57476 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 2
2020-04-02 05:08:19,273 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38564, dest: /127.0.0.1:43434, bytes: 1845, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, duration(ns): 15548601
2020-04-02 05:08:19,274 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2580482 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:19,274 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739] terminating
2020-04-02 05:08:19,274 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]: closing
2020-04-02 05:08:19,274 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38564 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1044]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:19,274 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:19,275 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1045 on 127.0.0.1:43434 size 1845 replicaState = FINALIZED
2020-04-02 05:08:19,275 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:19,275 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1045 (size=1722)
2020-04-02 05:08:19,275 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1045 is received from 127.0.0.1:43434
2020-04-02 05:08:19,275 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:19,277 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:19,277 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1045 on 127.0.0.1:45739 size 1845 replicaState = FINALIZED
2020-04-02 05:08:19,278 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:19,278 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1045 (size=1722)
2020-04-02 05:08:19,278 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1045 is received from 127.0.0.1:45739
2020-04-02 05:08:19,278 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:19,277 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:19,282 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1045 on 127.0.0.1:44971 size 1845 replicaState = FINALIZED
2020-04-02 05:08:19,282 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:19,282 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741839_1045 (size=1722)
2020-04-02 05:08:19,282 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1045 is received from 127.0.0.1:44971
2020-04-02 05:08:19,282 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:19,283 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:19,283 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:19,283 [IPC Server handler 7 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:19,286 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:19,286 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:19,287 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045 block size 1845
2020-04-02 05:08:19,287 [IPC Server handler 2 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:19,289 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=207, chunksPerPacket=1, packetSize=207
2020-04-02 05:08:19,290 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=207, chunksPerPacket=1, bytesCurBlock=1845, DFSOutputStream:blk_1073741839_1045
2020-04-02 05:08:19,298 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:19,305 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:19,308 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, newGs=1046, bytesRcvd=[1845, 1845]
  targets=[127.0.0.1:45739, 127.0.0.1:44971]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:19,308 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:19,308 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:19,308 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045 src: /127.0.0.1:38580 dest: /127.0.0.1:43434
2020-04-02 05:08:19,308 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045
 storageType=DISK, inAddr=/127.0.0.1:38580, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1046, minBytesRcvd=1845, maxBytesRcvd=1845
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:19,308 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1045, FINALIZED
  getNumBytes()     = 1845
  getBytesOnDisk()  = 1845
  getVisibleLength()= 1845
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:19,323 [IPC Server handler 9 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:reportBadBlocks(5275)) - *DIR* reportBadBlocks for block: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039 on datanode: 127.0.0.1:43230
2020-04-02 05:08:19,324 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (CorruptReplicasMap.java:addToCorruptReplicasMap(88)) - BLOCK NameSystem.addToCorruptReplicasMap: blk_1073741847_1039 added as corrupt on 127.0.0.1:43230 by localhost/127.0.0.1  because client machine reported it
2020-04-02 05:08:19,324 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (LowRedundancyBlocks.java:update(453)) - LowRedundancyBlocks.update blk_1073741847_1039 curReplicas 1 curExpectedReplicas 2 oldReplicas 2 oldExpectedReplicas  2 curPri  0 oldPri  3
2020-04-02 05:08:19,324 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (LowRedundancyBlocks.java:update(466)) - BLOCK* NameSystem.LowRedundancyBlock.update: blk_1073741847_1039 has only 1 replicas and needs 2 replicas so is added to neededReconstructions at priority level 0
2020-04-02 05:08:19,325 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:19,326 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:19,326 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:19,340 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:19,372 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1845
2020-04-02 05:08:19,372 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1046.meta of size 23
2020-04-02 05:08:19,373 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:19,373 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:19,374 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, newGs=1046, bytesRcvd=[1845, 1845]
  targets=[127.0.0.1:44971]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:19,374 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:19,375 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:19,375 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045 src: /127.0.0.1:60994 dest: /127.0.0.1:45739
2020-04-02 05:08:19,375 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045
 storageType=DISK, inAddr=/127.0.0.1:60994, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1046, minBytesRcvd=1845, maxBytesRcvd=1845
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:19,375 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1045, FINALIZED
  getNumBytes()     = 1845
  getBytesOnDisk()  = 1845
  getVisibleLength()= 1845
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:19,422 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1845
2020-04-02 05:08:19,422 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1046.meta of size 23
2020-04-02 05:08:19,422 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:19,423 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:19,424 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045, newGs=1046, bytesRcvd=[1845, 1845]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:19,424 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:19,424 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:19,424 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045 src: /127.0.0.1:57498 dest: /127.0.0.1:44971
2020-04-02 05:08:19,424 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045
 storageType=DISK, inAddr=/127.0.0.1:57498, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_APPEND, newGs=1046, minBytesRcvd=1845, maxBytesRcvd=1845
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:19,425 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1045, FINALIZED
  getNumBytes()     = 1845
  getBytesOnDisk()  = 1845
  getVisibleLength()= 1845
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:19,468 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1845
2020-04-02 05:08:19,468 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1046.meta of size 23
2020-04-02 05:08:19,470 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:19,473 [IPC Server handler 6 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1045, newGS=1046, newLength=1845, newNodes=[127.0.0.1:43434, 127.0.0.1:45739, 127.0.0.1:44971], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:19,474 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1046 from 127.0.0.1:43434
2020-04-02 05:08:19,475 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1045
2020-04-02 05:08:19,476 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1046 from 127.0.0.1:45739
2020-04-02 05:08:19,476 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1045
2020-04-02 05:08:19,476 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1046 from 127.0.0.1:44971
2020-04-02 05:08:19,476 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-9396c1fd-c034-40b5-99a4-7728fe5d066f:NORMAL:127.0.0.1:44971|RBW] of blk_1073741839_1045
2020-04-02 05:08:19,476 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:19,476 [IPC Server handler 6 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1045 => blk_1073741839_1046) success
2020-04-02 05:08:19,490 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046: PacketHeader with packetLen=131 header data: offsetInBlock: 1845
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:19,490 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1968, ackEnqueueNanoTime=689268868664774, ackStatus=SUCCESS)
2020-04-02 05:08:19,490 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046: previous write did not end at the chunk boundary. onDiskLen=1845
2020-04-02 05:08:19,490 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046: sizePartialChunk=309, block offset=1536, metafile offset=19
2020-04-02 05:08:19,491 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046
2020-04-02 05:08:19,491 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:19,495 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046: PacketHeader with packetLen=131 header data: offsetInBlock: 1845
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:19,495 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1968, ackEnqueueNanoTime=689268873422278, ackStatus=SUCCESS)
2020-04-02 05:08:19,495 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046: previous write did not end at the chunk boundary. onDiskLen=1845
2020-04-02 05:08:19,495 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046: sizePartialChunk=309, block offset=1536, metafile offset=19
2020-04-02 05:08:19,495 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046
2020-04-02 05:08:19,496 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:19,496 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046: PacketHeader with packetLen=131 header data: offsetInBlock: 1845
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:19,496 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046: previous write did not end at the chunk boundary. onDiskLen=1845
2020-04-02 05:08:19,496 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046: sizePartialChunk=309, block offset=1536, metafile offset=19
2020-04-02 05:08:19,496 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046
2020-04-02 05:08:19,496 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:19,496 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=1968, ackEnqueueNanoTime=689268874966078, ackStatus=SUCCESS)
2020-04-02 05:08:19,497 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,497 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,497 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:19,497 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1944921 flag: 0 flag: 0
2020-04-02 05:08:19,497 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1944921 flag: 0 flag: 0
2020-04-02 05:08:19,497 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7131259 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:19,502 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046: PacketHeader with packetLen=4 header data: offsetInBlock: 1968
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:19,502 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1968, ackEnqueueNanoTime=689268880674429, ackStatus=SUCCESS)
2020-04-02 05:08:19,502 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046
2020-04-02 05:08:19,502 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046: PacketHeader with packetLen=4 header data: offsetInBlock: 1968
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:19,502 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1968, ackEnqueueNanoTime=689268881040307, ackStatus=SUCCESS)
2020-04-02 05:08:19,503 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046
2020-04-02 05:08:19,503 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046: PacketHeader with packetLen=4 header data: offsetInBlock: 1968
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:19,503 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046
2020-04-02 05:08:19,503 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=1968, ackEnqueueNanoTime=689268881398276, ackStatus=SUCCESS)
2020-04-02 05:08:19,504 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57498, dest: /127.0.0.1:44971, bytes: 1968, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, duration(ns): 33845407
2020-04-02 05:08:19,505 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,510 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:19,511 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1046 on 127.0.0.1:44971 size 1968 replicaState = FINALIZED
2020-04-02 05:08:19,511 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:19,511 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741839_1046 (size=1845)
2020-04-02 05:08:19,511 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1046 is received from 127.0.0.1:44971
2020-04-02 05:08:19,511 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:19,514 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:60994, dest: /127.0.0.1:45739, bytes: 1968, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, duration(ns): 29628085
2020-04-02 05:08:19,514 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2370107 flag: 0 flag: 0
2020-04-02 05:08:19,514 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] terminating
2020-04-02 05:08:19,514 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: closing
2020-04-02 05:08:19,514 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,514 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60994 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:19,517 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:19,518 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2370107 flag: 0 flag: 0
2020-04-02 05:08:19,515 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:19,518 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38580, dest: /127.0.0.1:43434, bytes: 1968, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, duration(ns): 45356731
2020-04-02 05:08:19,518 [IPC Server handler 2 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:19,519 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 15472436 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:19,519 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971] terminating
2020-04-02 05:08:19,519 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:44971]: closing
2020-04-02 05:08:19,519 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1046 on 127.0.0.1:45739 size 1968 replicaState = FINALIZED
2020-04-02 05:08:19,519 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38580 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:19,519 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:19,519 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1046 (size=1845)
2020-04-02 05:08:19,519 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1046 is received from 127.0.0.1:45739
2020-04-02 05:08:19,519 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:19,520 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57498 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1045]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 2
2020-04-02 05:08:19,521 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:19,521 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:19,521 [IPC Server handler 1 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:19,521 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:19,522 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741839_1046
2020-04-02 05:08:19,522 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1046 on 127.0.0.1:43434 size 1968 replicaState = FINALIZED
2020-04-02 05:08:19,522 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:19,522 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1046 (size=1968)
2020-04-02 05:08:19,522 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1046 is received from 127.0.0.1:43434
2020-04-02 05:08:19,522 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:19,523 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:19,523 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:19,524 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046 block size 1968
2020-04-02 05:08:19,524 [IPC Server handler 9 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:19,525 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=84, chunksPerPacket=1, packetSize=84
2020-04-02 05:08:19,536 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=84, chunksPerPacket=1, bytesCurBlock=1968, DFSOutputStream:blk_1073741839_1046
2020-04-02 05:08:19,537 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:19,537 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/testSmallAppendRace, packetSize=65016, chunksPerPacket=126, bytesCurBlock=2048, DFSOutputStream:blk_1073741839_1046
2020-04-02 05:08:19,547 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:19,558 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, newGs=1047, bytesRcvd=[1968, 1968]
  targets=[127.0.0.1:45739, 127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:19,558 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:19,558 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:19,558 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046 src: /127.0.0.1:57510 dest: /127.0.0.1:44971
2020-04-02 05:08:19,559 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046
 storageType=DISK, inAddr=/127.0.0.1:57510, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_APPEND, newGs=1047, minBytesRcvd=1968, maxBytesRcvd=1968
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:19,559 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1046, FINALIZED
  getNumBytes()     = 1968
  getBytesOnDisk()  = 1968
  getVisibleLength()= 1968
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:19,590 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1968
2020-04-02 05:08:19,590 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1047.meta of size 23
2020-04-02 05:08:19,590 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:19,590 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:19,591 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, newGs=1047, bytesRcvd=[1968, 1968]
  targets=[127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:19,591 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:19,591 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:19,591 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046 src: /127.0.0.1:32778 dest: /127.0.0.1:45739
2020-04-02 05:08:19,592 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046
 storageType=DISK, inAddr=/127.0.0.1:32778, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1047, minBytesRcvd=1968, maxBytesRcvd=1968
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:19,592 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1046, FINALIZED
  getNumBytes()     = 1968
  getBytesOnDisk()  = 1968
  getVisibleLength()= 1968
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:19,650 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1968
2020-04-02 05:08:19,651 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1047.meta of size 23
2020-04-02 05:08:19,651 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:19,654 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:19,654 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046, newGs=1047, bytesRcvd=[1968, 1968]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:19,655 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:19,655 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:19,655 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046 src: /127.0.0.1:38612 dest: /127.0.0.1:43434
2020-04-02 05:08:19,655 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046
 storageType=DISK, inAddr=/127.0.0.1:38612, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1047, minBytesRcvd=1968, maxBytesRcvd=1968
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:19,655 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1046, FINALIZED
  getNumBytes()     = 1968
  getBytesOnDisk()  = 1968
  getVisibleLength()= 1968
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:19,691 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 1968
2020-04-02 05:08:19,691 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1047.meta of size 23
2020-04-02 05:08:19,692 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:19,698 [IPC Server handler 3 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1046, newGS=1047, newLength=1968, newNodes=[127.0.0.1:44971, 127.0.0.1:45739, 127.0.0.1:43434], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:19,699 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1047 from 127.0.0.1:44971
2020-04-02 05:08:19,699 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-9396c1fd-c034-40b5-99a4-7728fe5d066f:NORMAL:127.0.0.1:44971|RBW] of blk_1073741839_1046
2020-04-02 05:08:19,699 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1047 from 127.0.0.1:45739
2020-04-02 05:08:19,699 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1046
2020-04-02 05:08:19,699 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1047 from 127.0.0.1:43434
2020-04-02 05:08:19,699 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1046
2020-04-02 05:08:19,699 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:19,699 [IPC Server handler 3 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1046 => blk_1073741839_1047) success
2020-04-02 05:08:19,703 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047: PacketHeader with packetLen=88 header data: offsetInBlock: 1968
seqno: 0
lastPacketInBlock: false
dataLen: 80

2020-04-02 05:08:19,704 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2048, ackEnqueueNanoTime=689269082073080, ackStatus=SUCCESS)
2020-04-02 05:08:19,704 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047: previous write did not end at the chunk boundary. onDiskLen=1968
2020-04-02 05:08:19,704 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047: sizePartialChunk=432, block offset=1536, metafile offset=19
2020-04-02 05:08:19,704 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047
2020-04-02 05:08:19,704 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 80, skip=0
2020-04-02 05:08:19,705 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047: PacketHeader with packetLen=51 header data: offsetInBlock: 2048
seqno: 1
lastPacketInBlock: false
dataLen: 43

2020-04-02 05:08:19,705 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=2091, ackEnqueueNanoTime=689269083374963, ackStatus=SUCCESS)
2020-04-02 05:08:19,711 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047: PacketHeader with packetLen=88 header data: offsetInBlock: 1968
seqno: 0
lastPacketInBlock: false
dataLen: 80

2020-04-02 05:08:19,711 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2048, ackEnqueueNanoTime=689269089594822, ackStatus=SUCCESS)
2020-04-02 05:08:19,711 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047: previous write did not end at the chunk boundary. onDiskLen=1968
2020-04-02 05:08:19,711 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047: sizePartialChunk=432, block offset=1536, metafile offset=19
2020-04-02 05:08:19,711 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047: PacketHeader with packetLen=88 header data: offsetInBlock: 1968
seqno: 0
lastPacketInBlock: false
dataLen: 80

2020-04-02 05:08:19,711 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047: previous write did not end at the chunk boundary. onDiskLen=1968
2020-04-02 05:08:19,711 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047: sizePartialChunk=432, block offset=1536, metafile offset=19
2020-04-02 05:08:19,712 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047
2020-04-02 05:08:19,712 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047
2020-04-02 05:08:19,712 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 80, skip=0
2020-04-02 05:08:19,712 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 80, skip=0
2020-04-02 05:08:19,712 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047: PacketHeader with packetLen=51 header data: offsetInBlock: 2048
seqno: 1
lastPacketInBlock: false
dataLen: 43

2020-04-02 05:08:19,712 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2048, ackEnqueueNanoTime=689269090392169, ackStatus=SUCCESS)
2020-04-02 05:08:19,712 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=2091, ackEnqueueNanoTime=689269090432995, ackStatus=SUCCESS)
2020-04-02 05:08:19,712 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047: PacketHeader with packetLen=51 header data: offsetInBlock: 2048
seqno: 1
lastPacketInBlock: false
dataLen: 43

2020-04-02 05:08:19,712 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=2091, ackEnqueueNanoTime=689269090701474, ackStatus=SUCCESS)
2020-04-02 05:08:19,714 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,714 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,714 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:19,714 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,714 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2939951 flag: 0 flag: 0
2020-04-02 05:08:19,714 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,714 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2297817 flag: 0 flag: 0
2020-04-02 05:08:19,718 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2939951 flag: 0 flag: 0
2020-04-02 05:08:19,718 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 14098908 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:19,718 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2297817 flag: 0 flag: 0
2020-04-02 05:08:19,718 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 13307180 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:19,722 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047: PacketHeader with packetLen=4 header data: offsetInBlock: 2091
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:19,723 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=2091, ackEnqueueNanoTime=689269101157508, ackStatus=SUCCESS)
2020-04-02 05:08:19,723 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047
2020-04-02 05:08:19,723 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047: PacketHeader with packetLen=4 header data: offsetInBlock: 2091
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:19,723 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=2091, ackEnqueueNanoTime=689269101497491, ackStatus=SUCCESS)
2020-04-02 05:08:19,723 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047
2020-04-02 05:08:19,724 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047: PacketHeader with packetLen=4 header data: offsetInBlock: 2091
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:19,724 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047
2020-04-02 05:08:19,724 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=2091, ackEnqueueNanoTime=689269103098019, ackStatus=SUCCESS)
2020-04-02 05:08:19,725 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38612, dest: /127.0.0.1:43434, bytes: 2091, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, duration(ns): 32921690
2020-04-02 05:08:19,726 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,726 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:19,726 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:19,726 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38612 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:19,726 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:19,727 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1047 on 127.0.0.1:43434 size 2091 replicaState = FINALIZED
2020-04-02 05:08:19,727 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:19,727 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1047 (size=1968)
2020-04-02 05:08:19,727 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1047 is received from 127.0.0.1:43434
2020-04-02 05:08:19,727 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:19,731 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,732 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:32778, dest: /127.0.0.1:45739, bytes: 2091, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, duration(ns): 36711020
2020-04-02 05:08:19,732 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8144936 flag: 0 flag: 0
2020-04-02 05:08:19,732 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:19,732 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] got seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8144936 flag: 0 flag: 0
2020-04-02 05:08:19,733 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57510, dest: /127.0.0.1:44971, bytes: 2091, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, duration(ns): 37603802
2020-04-02 05:08:19,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:19,733 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9513892 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:19,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]: closing
2020-04-02 05:08:19,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32778 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:19,733 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:19,733 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:45739, 127.0.0.1:43434] terminating
2020-04-02 05:08:19,734 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1047 on 127.0.0.1:44971 size 2091 replicaState = FINALIZED
2020-04-02 05:08:19,734 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:19,734 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741839_1047 (size=1968)
2020-04-02 05:08:19,734 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1047 is received from 127.0.0.1:44971
2020-04-02 05:08:19,734 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:19,734 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57510 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1046]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 2
2020-04-02 05:08:19,734 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:19,734 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:19,735 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:19,735 [IPC Server handler 7 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:19,735 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741839_1047
2020-04-02 05:08:19,735 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1047 on 127.0.0.1:45739 size 2091 replicaState = FINALIZED
2020-04-02 05:08:19,735 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:19,735 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1047 (size=2091)
2020-04-02 05:08:19,735 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1047 is received from 127.0.0.1:45739
2020-04-02 05:08:19,735 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:19,740 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:19,740 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:19,742 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047 block size 2091
2020-04-02 05:08:19,743 [IPC Server handler 2 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:19,746 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=473, chunksPerPacket=1, packetSize=473
2020-04-02 05:08:19,747 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=473, chunksPerPacket=1, bytesCurBlock=2091, DFSOutputStream:blk_1073741839_1047
2020-04-02 05:08:19,753 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:19,757 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, newGs=1048, bytesRcvd=[2091, 2091]
  targets=[127.0.0.1:44971, 127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:19,757 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:19,758 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:19,758 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047 src: /127.0.0.1:38622 dest: /127.0.0.1:43434
2020-04-02 05:08:19,758 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047
 storageType=DISK, inAddr=/127.0.0.1:38622, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1048, minBytesRcvd=2091, maxBytesRcvd=2091
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:19,758 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1047, FINALIZED
  getNumBytes()     = 2091
  getBytesOnDisk()  = 2091
  getVisibleLength()= 2091
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:19,792 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 2091
2020-04-02 05:08:19,792 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1048.meta of size 27
2020-04-02 05:08:19,792 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:19,792 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:19,793 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, newGs=1048, bytesRcvd=[2091, 2091]
  targets=[127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:19,793 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:19,794 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:19,794 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047 src: /127.0.0.1:57538 dest: /127.0.0.1:44971
2020-04-02 05:08:19,794 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047
 storageType=DISK, inAddr=/127.0.0.1:57538, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_APPEND, newGs=1048, minBytesRcvd=2091, maxBytesRcvd=2091
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:19,794 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1047, FINALIZED
  getNumBytes()     = 2091
  getBytesOnDisk()  = 2091
  getVisibleLength()= 2091
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:19,823 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 2091
2020-04-02 05:08:19,824 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1048.meta of size 27
2020-04-02 05:08:19,824 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:19,826 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:19,826 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047, newGs=1048, bytesRcvd=[2091, 2091]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:19,826 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:19,826 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:19,826 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047 src: /127.0.0.1:32806 dest: /127.0.0.1:45739
2020-04-02 05:08:19,827 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047
 storageType=DISK, inAddr=/127.0.0.1:32806, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1048, minBytesRcvd=2091, maxBytesRcvd=2091
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:19,827 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1047, FINALIZED
  getNumBytes()     = 2091
  getBytesOnDisk()  = 2091
  getVisibleLength()= 2091
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:19,861 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 2091
2020-04-02 05:08:19,861 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1048.meta of size 27
2020-04-02 05:08:19,862 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:19,866 [IPC Server handler 0 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1047, newGS=1048, newLength=2091, newNodes=[127.0.0.1:43434, 127.0.0.1:44971, 127.0.0.1:45739], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:19,867 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1048 from 127.0.0.1:43434
2020-04-02 05:08:19,867 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1047
2020-04-02 05:08:19,867 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1048 from 127.0.0.1:44971
2020-04-02 05:08:19,867 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-9396c1fd-c034-40b5-99a4-7728fe5d066f:NORMAL:127.0.0.1:44971|RBW] of blk_1073741839_1047
2020-04-02 05:08:19,867 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1048 from 127.0.0.1:45739
2020-04-02 05:08:19,867 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1047
2020-04-02 05:08:19,867 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:19,867 [IPC Server handler 0 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1047 => blk_1073741839_1048) success
2020-04-02 05:08:19,868 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048: PacketHeader with packetLen=131 header data: offsetInBlock: 2091
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:19,868 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2214, ackEnqueueNanoTime=689269246655445, ackStatus=SUCCESS)
2020-04-02 05:08:19,868 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048: previous write did not end at the chunk boundary. onDiskLen=2091
2020-04-02 05:08:19,868 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048: sizePartialChunk=43, block offset=2048, metafile offset=23
2020-04-02 05:08:19,868 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048: PacketHeader with packetLen=131 header data: offsetInBlock: 2091
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:19,868 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2214, ackEnqueueNanoTime=689269247026409, ackStatus=SUCCESS)
2020-04-02 05:08:19,869 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048
2020-04-02 05:08:19,869 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:19,869 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048: previous write did not end at the chunk boundary. onDiskLen=2091
2020-04-02 05:08:19,869 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048: sizePartialChunk=43, block offset=2048, metafile offset=23
2020-04-02 05:08:19,869 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048: PacketHeader with packetLen=131 header data: offsetInBlock: 2091
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:19,869 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048: previous write did not end at the chunk boundary. onDiskLen=2091
2020-04-02 05:08:19,869 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048: sizePartialChunk=43, block offset=2048, metafile offset=23
2020-04-02 05:08:19,869 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048
2020-04-02 05:08:19,869 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:19,869 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048
2020-04-02 05:08:19,869 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:19,869 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2214, ackEnqueueNanoTime=689269248078906, ackStatus=SUCCESS)
2020-04-02 05:08:19,870 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,870 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,870 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:19,870 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1422685 flag: 0 flag: 0
2020-04-02 05:08:19,870 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1422685 flag: 0 flag: 0
2020-04-02 05:08:19,870 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2179332 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:19,872 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048: PacketHeader with packetLen=4 header data: offsetInBlock: 2214
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:19,872 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=2214, ackEnqueueNanoTime=689269250430153, ackStatus=SUCCESS)
2020-04-02 05:08:19,872 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048
2020-04-02 05:08:19,872 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048: PacketHeader with packetLen=4 header data: offsetInBlock: 2214
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:19,872 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=2214, ackEnqueueNanoTime=689269250736124, ackStatus=SUCCESS)
2020-04-02 05:08:19,872 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048
2020-04-02 05:08:19,872 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048: PacketHeader with packetLen=4 header data: offsetInBlock: 2214
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:19,872 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048
2020-04-02 05:08:19,872 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=2214, ackEnqueueNanoTime=689269251006731, ackStatus=SUCCESS)
2020-04-02 05:08:19,873 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:32806, dest: /127.0.0.1:45739, bytes: 2214, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, duration(ns): 10798046
2020-04-02 05:08:19,873 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,873 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:19,874 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:19,874 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1048 on 127.0.0.1:45739 size 2214 replicaState = FINALIZED
2020-04-02 05:08:19,874 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:19,874 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1048 (size=2091)
2020-04-02 05:08:19,874 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1048 is received from 127.0.0.1:45739
2020-04-02 05:08:19,874 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:19,873 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:19,873 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:19,875 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32806 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:19,875 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57538, dest: /127.0.0.1:44971, bytes: 2214, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, duration(ns): 8882059
2020-04-02 05:08:19,875 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1228475 flag: 0 flag: 0
2020-04-02 05:08:19,876 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1228475 flag: 0 flag: 0
2020-04-02 05:08:19,876 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: closing
2020-04-02 05:08:19,876 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] terminating
2020-04-02 05:08:19,876 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57538 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 2
2020-04-02 05:08:19,876 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38622, dest: /127.0.0.1:43434, bytes: 2214, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, duration(ns): 9639404
2020-04-02 05:08:19,876 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:19,876 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3669078 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:19,877 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1048 on 127.0.0.1:44971 size 2214 replicaState = FINALIZED
2020-04-02 05:08:19,877 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:19,877 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741839_1048 (size=2091)
2020-04-02 05:08:19,877 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1048 is received from 127.0.0.1:44971
2020-04-02 05:08:19,877 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:19,877 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]: closing
2020-04-02 05:08:19,877 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:45739] terminating
2020-04-02 05:08:19,877 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:19,881 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:19,878 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38622 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1047]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:19,884 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:19,884 [IPC Server handler 4 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:19,884 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741839_1048
2020-04-02 05:08:19,884 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1048 on 127.0.0.1:43434 size 2214 replicaState = FINALIZED
2020-04-02 05:08:19,884 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:19,884 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1048 (size=2214)
2020-04-02 05:08:19,884 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1048 is received from 127.0.0.1:43434
2020-04-02 05:08:19,884 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:19,885 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:19,885 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:19,885 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048 block size 2214
2020-04-02 05:08:19,886 [IPC Server handler 8 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:19,887 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=350, chunksPerPacket=1, packetSize=350
2020-04-02 05:08:19,888 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=350, chunksPerPacket=1, bytesCurBlock=2214, DFSOutputStream:blk_1073741839_1048
2020-04-02 05:08:19,898 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:19,899 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, newGs=1049, bytesRcvd=[2214, 2214]
  targets=[127.0.0.1:44971, 127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:19,899 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:19,899 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:19,899 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048 src: /127.0.0.1:32814 dest: /127.0.0.1:45739
2020-04-02 05:08:19,899 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048
 storageType=DISK, inAddr=/127.0.0.1:32814, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1049, minBytesRcvd=2214, maxBytesRcvd=2214
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:19,899 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1048, FINALIZED
  getNumBytes()     = 2214
  getBytesOnDisk()  = 2214
  getVisibleLength()= 2214
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:19,926 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 2214
2020-04-02 05:08:19,926 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1049.meta of size 27
2020-04-02 05:08:19,926 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:19,927 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:19,933 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, newGs=1049, bytesRcvd=[2214, 2214]
  targets=[127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:19,933 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:19,933 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:19,933 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048 src: /127.0.0.1:57554 dest: /127.0.0.1:44971
2020-04-02 05:08:19,933 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048
 storageType=DISK, inAddr=/127.0.0.1:57554, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_APPEND, newGs=1049, minBytesRcvd=2214, maxBytesRcvd=2214
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:19,933 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1048, FINALIZED
  getNumBytes()     = 2214
  getBytesOnDisk()  = 2214
  getVisibleLength()= 2214
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:19,963 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 2214
2020-04-02 05:08:19,963 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1049.meta of size 27
2020-04-02 05:08:19,963 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:19,964 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:19,965 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048, newGs=1049, bytesRcvd=[2214, 2214]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:19,965 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:19,965 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:19,965 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048 src: /127.0.0.1:38646 dest: /127.0.0.1:43434
2020-04-02 05:08:19,965 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048
 storageType=DISK, inAddr=/127.0.0.1:38646, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1049, minBytesRcvd=2214, maxBytesRcvd=2214
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:19,965 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1048, FINALIZED
  getNumBytes()     = 2214
  getBytesOnDisk()  = 2214
  getVisibleLength()= 2214
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:19,993 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 2214
2020-04-02 05:08:19,993 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1049.meta of size 27
2020-04-02 05:08:19,999 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:20,002 [IPC Server handler 7 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1048, newGS=1049, newLength=2214, newNodes=[127.0.0.1:45739, 127.0.0.1:44971, 127.0.0.1:43434], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:20,002 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1049 from 127.0.0.1:45739
2020-04-02 05:08:20,003 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1048
2020-04-02 05:08:20,003 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1049 from 127.0.0.1:44971
2020-04-02 05:08:20,003 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-9396c1fd-c034-40b5-99a4-7728fe5d066f:NORMAL:127.0.0.1:44971|RBW] of blk_1073741839_1048
2020-04-02 05:08:20,003 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1049 from 127.0.0.1:43434
2020-04-02 05:08:20,003 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1048
2020-04-02 05:08:20,003 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:20,003 [IPC Server handler 7 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1048 => blk_1073741839_1049) success
2020-04-02 05:08:20,004 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049: PacketHeader with packetLen=131 header data: offsetInBlock: 2214
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:20,004 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2337, ackEnqueueNanoTime=689269382770461, ackStatus=SUCCESS)
2020-04-02 05:08:20,004 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049: previous write did not end at the chunk boundary. onDiskLen=2214
2020-04-02 05:08:20,004 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049: sizePartialChunk=166, block offset=2048, metafile offset=23
2020-04-02 05:08:20,004 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049: PacketHeader with packetLen=131 header data: offsetInBlock: 2214
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:20,005 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049
2020-04-02 05:08:20,005 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2337, ackEnqueueNanoTime=689269383213240, ackStatus=SUCCESS)
2020-04-02 05:08:20,005 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:20,005 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049: PacketHeader with packetLen=131 header data: offsetInBlock: 2214
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:20,005 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049: previous write did not end at the chunk boundary. onDiskLen=2214
2020-04-02 05:08:20,005 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049: sizePartialChunk=166, block offset=2048, metafile offset=23
2020-04-02 05:08:20,005 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049
2020-04-02 05:08:20,005 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:20,006 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2337, ackEnqueueNanoTime=689269384156256, ackStatus=SUCCESS)
2020-04-02 05:08:20,012 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:20,012 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:20,012 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7281438 flag: 0 flag: 0
2020-04-02 05:08:20,012 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7281438 flag: 0 flag: 0
2020-04-02 05:08:20,013 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 8269223 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:20,013 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049: PacketHeader with packetLen=4 header data: offsetInBlock: 2337
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:20,014 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=2337, ackEnqueueNanoTime=689269391937588, ackStatus=SUCCESS)
2020-04-02 05:08:20,014 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049
2020-04-02 05:08:20,012 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049: previous write did not end at the chunk boundary. onDiskLen=2214
2020-04-02 05:08:20,012 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:20,015 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049: sizePartialChunk=166, block offset=2048, metafile offset=23
2020-04-02 05:08:20,015 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049
2020-04-02 05:08:20,015 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:20,015 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049: PacketHeader with packetLen=4 header data: offsetInBlock: 2337
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:20,016 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=2337, ackEnqueueNanoTime=689269394141737, ackStatus=SUCCESS)
2020-04-02 05:08:20,016 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049
2020-04-02 05:08:20,017 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049: PacketHeader with packetLen=4 header data: offsetInBlock: 2337
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:20,017 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049
2020-04-02 05:08:20,017 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=2337, ackEnqueueNanoTime=689269395450296, ackStatus=SUCCESS)
2020-04-02 05:08:20,018 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38646, dest: /127.0.0.1:43434, bytes: 2337, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, duration(ns): 18292769
2020-04-02 05:08:20,018 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:20,018 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:20,018 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:20,019 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:20,019 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38646 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:20,020 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57554, dest: /127.0.0.1:44971, bytes: 2337, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, duration(ns): 21485262
2020-04-02 05:08:20,020 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2571989 flag: 0 flag: 0
2020-04-02 05:08:20,020 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:20,020 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:20,020 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2571989 flag: 0 flag: 0
2020-04-02 05:08:20,020 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57554 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 2
2020-04-02 05:08:20,021 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:32814, dest: /127.0.0.1:45739, bytes: 2337, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, duration(ns): 22495568
2020-04-02 05:08:20,021 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6951106 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:20,021 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]: closing
2020-04-02 05:08:20,021 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434] terminating
2020-04-02 05:08:20,022 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32814 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1048]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:20,022 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:20,022 [IPC Server handler 2 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:20,022 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:20,023 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:20,023 [IPC Server handler 0 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:checkBlocksComplete(2908)) - BLOCK* blk_1073741839_1049 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /testSmallAppendRace
2020-04-02 05:08:20,024 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1049 on 127.0.0.1:44971 size 2337 replicaState = FINALIZED
2020-04-02 05:08:20,024 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMMITTED
2020-04-02 05:08:20,024 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741839_1049 (size=2337)
2020-04-02 05:08:20,024 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1049 is received from 127.0.0.1:44971
2020-04-02 05:08:20,024 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:20,024 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741839_1049
2020-04-02 05:08:20,024 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1049 on 127.0.0.1:43434 size 2337 replicaState = FINALIZED
2020-04-02 05:08:20,024 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:20,024 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1049 (size=2337)
2020-04-02 05:08:20,024 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1049 is received from 127.0.0.1:43434
2020-04-02 05:08:20,024 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:20,024 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741839_1049
2020-04-02 05:08:20,024 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1049 on 127.0.0.1:45739 size 2337 replicaState = FINALIZED
2020-04-02 05:08:20,025 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:20,025 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1049 (size=2337)
2020-04-02 05:08:20,025 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1049 is received from 127.0.0.1:45739
2020-04-02 05:08:20,025 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:20,427 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:20,428 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:20,428 [IPC Server handler 5 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:20,430 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:20,430 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:20,431 [IPC Server handler 3 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049 block size 2337
2020-04-02 05:08:20,431 [IPC Server handler 3 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:20,432 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=227, chunksPerPacket=1, packetSize=227
2020-04-02 05:08:20,433 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=227, chunksPerPacket=1, bytesCurBlock=2337, DFSOutputStream:blk_1073741839_1049
2020-04-02 05:08:20,439 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:20,441 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, newGs=1050, bytesRcvd=[2337, 2337]
  targets=[127.0.0.1:43434, 127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:20,441 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:20,441 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:20,441 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049 src: /127.0.0.1:57610 dest: /127.0.0.1:44971
2020-04-02 05:08:20,441 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049
 storageType=DISK, inAddr=/127.0.0.1:57610, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_APPEND, newGs=1050, minBytesRcvd=2337, maxBytesRcvd=2337
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:20,441 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1049, FINALIZED
  getNumBytes()     = 2337
  getBytesOnDisk()  = 2337
  getVisibleLength()= 2337
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:20,470 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 2337
2020-04-02 05:08:20,470 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1050.meta of size 27
2020-04-02 05:08:20,471 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:20,472 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:20,474 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, newGs=1050, bytesRcvd=[2337, 2337]
  targets=[127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:20,474 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:20,474 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:20,474 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049 src: /127.0.0.1:38702 dest: /127.0.0.1:43434
2020-04-02 05:08:20,474 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049
 storageType=DISK, inAddr=/127.0.0.1:38702, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1050, minBytesRcvd=2337, maxBytesRcvd=2337
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:20,474 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1049, FINALIZED
  getNumBytes()     = 2337
  getBytesOnDisk()  = 2337
  getVisibleLength()= 2337
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:20,510 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 2337
2020-04-02 05:08:20,510 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1050.meta of size 27
2020-04-02 05:08:20,511 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:20,511 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:20,512 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049, newGs=1050, bytesRcvd=[2337, 2337]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:20,512 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:20,512 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:20,512 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049 src: /127.0.0.1:32880 dest: /127.0.0.1:45739
2020-04-02 05:08:20,512 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049
 storageType=DISK, inAddr=/127.0.0.1:32880, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1050, minBytesRcvd=2337, maxBytesRcvd=2337
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:20,512 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1049, FINALIZED
  getNumBytes()     = 2337
  getBytesOnDisk()  = 2337
  getVisibleLength()= 2337
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:20,540 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 2337
2020-04-02 05:08:20,540 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1050.meta of size 27
2020-04-02 05:08:20,541 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:20,550 [IPC Server handler 8 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1049, newGS=1050, newLength=2337, newNodes=[127.0.0.1:44971, 127.0.0.1:43434, 127.0.0.1:45739], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:20,551 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1050 from 127.0.0.1:44971
2020-04-02 05:08:20,551 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-9396c1fd-c034-40b5-99a4-7728fe5d066f:NORMAL:127.0.0.1:44971|RBW] of blk_1073741839_1049
2020-04-02 05:08:20,551 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1050 from 127.0.0.1:43434
2020-04-02 05:08:20,551 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1049
2020-04-02 05:08:20,551 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1050 from 127.0.0.1:45739
2020-04-02 05:08:20,551 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1049
2020-04-02 05:08:20,551 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:20,551 [IPC Server handler 8 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1049 => blk_1073741839_1050) success
2020-04-02 05:08:20,555 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050: PacketHeader with packetLen=131 header data: offsetInBlock: 2337
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:20,555 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2460, ackEnqueueNanoTime=689269933372551, ackStatus=SUCCESS)
2020-04-02 05:08:20,555 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050: PacketHeader with packetLen=131 header data: offsetInBlock: 2337
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:20,555 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2460, ackEnqueueNanoTime=689269933794823, ackStatus=SUCCESS)
2020-04-02 05:08:20,555 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050: previous write did not end at the chunk boundary. onDiskLen=2337
2020-04-02 05:08:20,555 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050: sizePartialChunk=289, block offset=2048, metafile offset=23
2020-04-02 05:08:20,555 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050: PacketHeader with packetLen=131 header data: offsetInBlock: 2337
seqno: 0
lastPacketInBlock: false
dataLen: 123

2020-04-02 05:08:20,556 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050: previous write did not end at the chunk boundary. onDiskLen=2337
2020-04-02 05:08:20,556 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050: sizePartialChunk=289, block offset=2048, metafile offset=23
2020-04-02 05:08:20,556 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050
2020-04-02 05:08:20,556 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:20,556 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050
2020-04-02 05:08:20,556 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:20,556 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2460, ackEnqueueNanoTime=689269934847363, ackStatus=SUCCESS)
2020-04-02 05:08:20,556 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050: previous write did not end at the chunk boundary. onDiskLen=2337
2020-04-02 05:08:20,556 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050: sizePartialChunk=289, block offset=2048, metafile offset=23
2020-04-02 05:08:20,557 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050
2020-04-02 05:08:20,557 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 123, skip=0
2020-04-02 05:08:20,558 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:20,558 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:20,558 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:20,559 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3157303 flag: 0 flag: 0
2020-04-02 05:08:20,566 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3157303 flag: 0 flag: 0
2020-04-02 05:08:20,566 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 10836709 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:20,570 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050: PacketHeader with packetLen=4 header data: offsetInBlock: 2460
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:20,570 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=2460, ackEnqueueNanoTime=689269948726276, ackStatus=SUCCESS)
2020-04-02 05:08:20,571 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050: PacketHeader with packetLen=4 header data: offsetInBlock: 2460
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:20,571 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=2460, ackEnqueueNanoTime=689269949674027, ackStatus=SUCCESS)
2020-04-02 05:08:20,571 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050
2020-04-02 05:08:20,571 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050
2020-04-02 05:08:20,571 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050: PacketHeader with packetLen=4 header data: offsetInBlock: 2460
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:20,571 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050
2020-04-02 05:08:20,572 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=2460, ackEnqueueNanoTime=689269950160400, ackStatus=SUCCESS)
2020-04-02 05:08:20,572 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:32880, dest: /127.0.0.1:45739, bytes: 2460, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, duration(ns): 30358703
2020-04-02 05:08:20,572 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:20,573 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:20,573 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:20,573 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:20,573 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32880 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:20,573 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:20,573 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1050 on 127.0.0.1:45739 size 2460 replicaState = FINALIZED
2020-04-02 05:08:20,574 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:20,574 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38702, dest: /127.0.0.1:43434, bytes: 2460, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, duration(ns): 26467035
2020-04-02 05:08:20,574 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1050 (size=2337)
2020-04-02 05:08:20,574 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1050 is received from 127.0.0.1:45739
2020-04-02 05:08:20,574 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:20,574 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1706348 flag: 0 flag: 0
2020-04-02 05:08:20,574 [IPC Server handler 7 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:20,574 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1050 on 127.0.0.1:43434 size 2460 replicaState = FINALIZED
2020-04-02 05:08:20,574 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:20,575 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1050 (size=2337)
2020-04-02 05:08:20,575 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1050 is received from 127.0.0.1:43434
2020-04-02 05:08:20,575 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:20,574 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1706348 flag: 0 flag: 0
2020-04-02 05:08:20,574 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] terminating
2020-04-02 05:08:20,575 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57610, dest: /127.0.0.1:44971, bytes: 2460, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, duration(ns): 20349507
2020-04-02 05:08:20,576 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3712104 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:20,576 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739] terminating
2020-04-02 05:08:20,576 [IPC Server handler 2 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:20,576 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1050 on 127.0.0.1:44971 size 2460 replicaState = FINALIZED
2020-04-02 05:08:20,576 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:20,576 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741839_1050 (size=2337)
2020-04-02 05:08:20,576 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1050 is received from 127.0.0.1:44971
2020-04-02 05:08:20,576 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:20,576 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:20,577 [IPC Server handler 9 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:20,577 [IPC Server handler 9 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:20,578 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:20,578 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/testSmallAppendRace, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:20,579 [IPC Server handler 1 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050 block size 2460
2020-04-02 05:08:20,579 [IPC Server handler 1 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/testSmallAppendRace	dst=null	perm=null	proto=rpc
2020-04-02 05:08:20,580 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=104, chunksPerPacket=1, packetSize=104
2020-04-02 05:08:20,581 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/testSmallAppendRace, packetSize=104, chunksPerPacket=1, bytesCurBlock=2460, DFSOutputStream:blk_1073741839_1050
2020-04-02 05:08:20,581 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/testSmallAppendRace, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:20,584 [Thread-395] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/testSmallAppendRace, packetSize=65016, chunksPerPacket=126, bytesCurBlock=2560, DFSOutputStream:blk_1073741839_1050
2020-04-02 05:08:20,581 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: closing
2020-04-02 05:08:20,584 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38702 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:20,581 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]: closing
2020-04-02 05:08:20,586 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:20,586 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57610 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1049]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 2
2020-04-02 05:08:20,591 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, newGs=1051, bytesRcvd=[2460, 2460]
  targets=[127.0.0.1:43434, 127.0.0.1:44971]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:20,591 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:20,591 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:20,591 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050 src: /127.0.0.1:32882 dest: /127.0.0.1:45739
2020-04-02 05:08:20,591 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050
 storageType=DISK, inAddr=/127.0.0.1:32882, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_APPEND, newGs=1051, minBytesRcvd=2460, maxBytesRcvd=2460
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-d49b8d06-4514-41da-af7b-faacf4f00b86
2020-04-02 05:08:20,591 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1050, FINALIZED
  getNumBytes()     = 2460
  getBytesOnDisk()  = 2460
  getVisibleLength()= 2460
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:20,618 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 2460
2020-04-02 05:08:20,618 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1051.meta of size 27
2020-04-02 05:08:20,619 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:20,620 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:20,620 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, newGs=1051, bytesRcvd=[2460, 2460]
  targets=[127.0.0.1:44971]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:20,620 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:20,621 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:20,621 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050 src: /127.0.0.1:38708 dest: /127.0.0.1:43434
2020-04-02 05:08:20,621 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050
 storageType=DISK, inAddr=/127.0.0.1:38708, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_APPEND, newGs=1051, minBytesRcvd=2460, maxBytesRcvd=2460
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-29df15fa-b2ca-4eca-89df-87135d5e3b76
2020-04-02 05:08:20,621 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1050, FINALIZED
  getNumBytes()     = 2460
  getBytesOnDisk()  = 2460
  getVisibleLength()= 2460
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:20,666 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 2460
2020-04-02 05:08:20,666 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1051.meta of size 27
2020-04-02 05:08:20,667 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:20,667 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:20,668 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_APPEND, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050, newGs=1051, bytesRcvd=[2460, 2460]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:20,668 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:20,668 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:20,668 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050 src: /127.0.0.1:57620 dest: /127.0.0.1:44971
2020-04-02 05:08:20,668 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050
 storageType=DISK, inAddr=/127.0.0.1:57620, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_APPEND, newGs=1051, minBytesRcvd=2460, maxBytesRcvd=2460
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:20,669 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:append(1187)) - Appending to FinalizedReplica, blk_1073741839_1050, FINALIZED
  getNumBytes()     = 2460
  getBytesOnDisk()  = 2460
  getVisibleLength()= 2460
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741839
2020-04-02 05:08:20,715 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839 of size 2460
2020-04-02 05:08:20,715 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741839_1051.meta of size 27
2020-04-02 05:08:20,716 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:20,722 [IPC Server handler 5 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5340)) - updatePipeline(blk_1073741839_1050, newGS=1051, newLength=2460, newNodes=[127.0.0.1:45739, 127.0.0.1:43434, 127.0.0.1:44971], client=DFSClient_NONMAPREDUCE_-96199515_1)
2020-04-02 05:08:20,722 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1051 from 127.0.0.1:45739
2020-04-02 05:08:20,722 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-d49b8d06-4514-41da-af7b-faacf4f00b86:NORMAL:127.0.0.1:45739|RBW] of blk_1073741839_1050
2020-04-02 05:08:20,722 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1051 from 127.0.0.1:43434
2020-04-02 05:08:20,723 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-29df15fa-b2ca-4eca-89df-87135d5e3b76:NORMAL:127.0.0.1:43434|RBW] of blk_1073741839_1050
2020-04-02 05:08:20,723 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741839_1051 from 127.0.0.1:44971
2020-04-02 05:08:20,723 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (BlockManager.java:removeStaleReplicas(3825)) - BLOCK* Removing stale replica ReplicaUC[[DISK]DS-9396c1fd-c034-40b5-99a4-7728fe5d066f:NORMAL:127.0.0.1:44971|RBW] of blk_1073741839_1050
2020-04-02 05:08:20,723 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistBlocks(112)) - persistBlocks: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:20,723 [IPC Server handler 5 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:updatePipeline(5358)) - updatePipeline(blk_1073741839_1050 => blk_1073741839_1051) success
2020-04-02 05:08:20,730 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051: PacketHeader with packetLen=108 header data: offsetInBlock: 2460
seqno: 0
lastPacketInBlock: false
dataLen: 100

2020-04-02 05:08:20,730 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2560, ackEnqueueNanoTime=689270108879276, ackStatus=SUCCESS)
2020-04-02 05:08:20,730 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051: previous write did not end at the chunk boundary. onDiskLen=2460
2020-04-02 05:08:20,731 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051: sizePartialChunk=412, block offset=2048, metafile offset=23
2020-04-02 05:08:20,731 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051
2020-04-02 05:08:20,731 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 100, skip=0
2020-04-02 05:08:20,731 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051: PacketHeader with packetLen=31 header data: offsetInBlock: 2560
seqno: 1
lastPacketInBlock: false
dataLen: 23

2020-04-02 05:08:20,731 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=2583, ackEnqueueNanoTime=689270109725479, ackStatus=SUCCESS)
2020-04-02 05:08:20,731 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051: PacketHeader with packetLen=108 header data: offsetInBlock: 2460
seqno: 0
lastPacketInBlock: false
dataLen: 100

2020-04-02 05:08:20,731 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2560, ackEnqueueNanoTime=689270110060256, ackStatus=SUCCESS)
2020-04-02 05:08:20,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051: previous write did not end at the chunk boundary. onDiskLen=2460
2020-04-02 05:08:20,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051: sizePartialChunk=412, block offset=2048, metafile offset=23
2020-04-02 05:08:20,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051
2020-04-02 05:08:20,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 100, skip=0
2020-04-02 05:08:20,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051: PacketHeader with packetLen=31 header data: offsetInBlock: 2560
seqno: 1
lastPacketInBlock: false
dataLen: 23

2020-04-02 05:08:20,732 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=2583, ackEnqueueNanoTime=689270110730019, ackStatus=SUCCESS)
2020-04-02 05:08:20,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051: PacketHeader with packetLen=108 header data: offsetInBlock: 2460
seqno: 0
lastPacketInBlock: false
dataLen: 100

2020-04-02 05:08:20,733 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(709)) - receivePacket for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051: previous write did not end at the chunk boundary. onDiskLen=2460
2020-04-02 05:08:20,734 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1157)) - computePartialChunkCrc for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051: sizePartialChunk=412, block offset=2048, metafile offset=23
2020-04-02 05:08:20,734 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:computePartialChunkCrc(1181)) - Read in partial CRC chunk from disk for BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051
2020-04-02 05:08:20,734 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(773)) - Writing out partial crc for data len 100, skip=0
2020-04-02 05:08:20,734 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=2560, ackEnqueueNanoTime=689270112605909, ackStatus=SUCCESS)
2020-04-02 05:08:20,734 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051: PacketHeader with packetLen=31 header data: offsetInBlock: 2560
seqno: 1
lastPacketInBlock: false
dataLen: 23

2020-04-02 05:08:20,734 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=2583, ackEnqueueNanoTime=689270112837742, ackStatus=SUCCESS)
2020-04-02 05:08:20,734 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:20,735 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:20,735 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:20,738 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:20,738 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6229450 flag: 0 flag: 0
2020-04-02 05:08:20,738 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:20,739 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6258354 flag: 0 flag: 0
2020-04-02 05:08:20,738 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6229450 flag: 0 flag: 0
2020-04-02 05:08:20,739 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7988775 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:20,739 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6258354 flag: 0 flag: 0
2020-04-02 05:08:20,739 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 7858919 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:20,740 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051: PacketHeader with packetLen=4 header data: offsetInBlock: 2583
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:20,740 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=2583, ackEnqueueNanoTime=689270118251638, ackStatus=SUCCESS)
2020-04-02 05:08:20,740 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051
2020-04-02 05:08:20,740 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051: PacketHeader with packetLen=4 header data: offsetInBlock: 2583
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:20,740 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=2583, ackEnqueueNanoTime=689270118566196, ackStatus=SUCCESS)
2020-04-02 05:08:20,740 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051
2020-04-02 05:08:20,740 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051: PacketHeader with packetLen=4 header data: offsetInBlock: 2583
seqno: 2
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:20,740 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051
2020-04-02 05:08:20,740 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=true, offsetInBlock=2583, ackEnqueueNanoTime=689270119012364, ackStatus=SUCCESS)
2020-04-02 05:08:20,741 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57620, dest: /127.0.0.1:44971, bytes: 2583, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, duration(ns): 24592582
2020-04-02 05:08:20,742 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:20,742 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] got seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:20,742 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:20,742 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1051 on 127.0.0.1:44971 size 2583 replicaState = FINALIZED
2020-04-02 05:08:20,742 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:20,742 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:20,742 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:20,742 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741839_1051 (size=2460)
2020-04-02 05:08:20,742 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:38708, dest: /127.0.0.1:43434, bytes: 2583, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, duration(ns): 24669600
2020-04-02 05:08:20,743 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57620 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 2
2020-04-02 05:08:20,743 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1051 is received from 127.0.0.1:44971
2020-04-02 05:08:20,743 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:20,743 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1810110 flag: 0 flag: 0
2020-04-02 05:08:20,743 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:20,743 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971] got seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1810110 flag: 0 flag: 0
2020-04-02 05:08:20,743 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1051 on 127.0.0.1:43434 size 2583 replicaState = FINALIZED
2020-04-02 05:08:20,743 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:20,744 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741839_1051 (size=2460)
2020-04-02 05:08:20,744 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1051 is received from 127.0.0.1:43434
2020-04-02 05:08:20,744 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:20,744 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:32882, dest: /127.0.0.1:45739, bytes: 2583, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, duration(ns): 25823497
2020-04-02 05:08:20,744 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]: closing
2020-04-02 05:08:20,744 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:44971] terminating
2020-04-02 05:08:20,744 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3518074 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:20,744 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971] terminating
2020-04-02 05:08:20,744 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1051, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:44971]: closing
2020-04-02 05:08:20,744 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38708 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:20,744 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:32882 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741839_1050]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 3
2020-04-02 05:08:20,744 [IPC Server handler 8 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:20,744 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741839_1051 on 127.0.0.1:45739 size 2583 replicaState = FINALIZED
2020-04-02 05:08:20,744 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:20,744 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741839_1051 (size=2460)
2020-04-02 05:08:20,745 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741839_1051 is received from 127.0.0.1:45739
2020-04-02 05:08:20,745 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:20,746 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /testSmallAppendRace for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:20,746 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /testSmallAppendRace with 1 blocks is persisted to the file system
2020-04-02 05:08:20,747 [IPC Server handler 6 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /testSmallAppendRace is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:20,893 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35502 [Waiting for operation #2]] DEBUG datanode.DataNode (DataXceiver.java:run(276)) - Cached NioInetPeer(Socket[addr=/127.0.0.1,port=35502,localport=45580]) closing after 1 ops.  This message is usually benign.
2020-04-02 05:08:20,893 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:35502 [Waiting for operation #2]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 2
2020-04-02 05:08:21,990 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:60328 [Waiting for operation #7]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 2
2020-04-02 05:08:22,011 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:22,013 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:22,015 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38766 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, replica=FinalizedReplica, blk_1073741848_1043, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741848
2020-04-02 05:08:22,015 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38766 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741848_1043, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741848
2020-04-02 05:08:22,016 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38766 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:43434, dest: /127.0.0.1:38766, bytes: 66048, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741848_1043, duration(ns): 227529
2020-04-02 05:08:22,221 [RedundancyMonitor] DEBUG blockmanagement.BlockManager (ReplicationWork.java:<init>(36)) - Creating a ReplicationWork to reconstruct blk_1073741847_1039
2020-04-02 05:08:22,222 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:validateReconstructionWork(2054)) - BLOCK* block blk_1073741847_1039 is moved from neededReconstruction to pendingReconstruction
2020-04-02 05:08:22,222 [RedundancyMonitor] DEBUG BlockStateChange (LowRedundancyBlocks.java:remove(376)) - BLOCK* NameSystem.LowRedundancyBlock.remove: Removing block blk_1073741847_1039 from priority queue 0
2020-04-02 05:08:22,222 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1895)) - BLOCK* ask [127.0.0.1:45739] to replicate blk_1073741847_1039 to datanode(s) 127.0.0.1:45580
2020-04-02 05:08:22,222 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 1
2020-04-02 05:08:22,298 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:22,326 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:22,326 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:22,328 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (DataNode.java:transferBlock(2353)) - DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) Starting thread to transfer BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039 to 127.0.0.1:45580 
2020-04-02 05:08:22,329 [org.apache.hadoop.hdfs.server.datanode.DataNode$DataTransfer@2aede297] DEBUG datanode.DataNode (DataNode.java:run(2522)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:22,330 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:22,330 [org.apache.hadoop.hdfs.server.datanode.DataNode$DataTransfer@2aede297] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, replica=FinalizedReplica, blk_1073741847_1039, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741847
2020-04-02 05:08:22,330 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:22,331 [org.apache.hadoop.hdfs.server.datanode.DataNode$DataTransfer@2aede297] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741847_1039, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741847
2020-04-02 05:08:22,334 [DataXceiver for client  at /127.0.0.1:35954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=0, srcDataNode=127.0.0.1:45739, pinning=false
2020-04-02 05:08:22,334 [DataXceiver for client  at /127.0.0.1:35954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=true, isClient=false, isTransfer=false
2020-04-02 05:08:22,334 [DataXceiver for client  at /127.0.0.1:35954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:22,334 [DataXceiver for client  at /127.0.0.1:35954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039 src: /127.0.0.1:35954 dest: /127.0.0.1:45580
2020-04-02 05:08:22,335 [DataXceiver for client  at /127.0.0.1:35954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039
 storageType=DISK, inAddr=/127.0.0.1:35954, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=, srcDataNode=127.0.0.1:45739, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=true, readahead=4194304)
 allowLazyPersist=false, pinning=false, isClient=false, isDatanode=true, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:22,335 [DataXceiver for client  at /127.0.0.1:35954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/tmp/blk_1073741847 of size 0
2020-04-02 05:08:22,335 [DataXceiver for client  at /127.0.0.1:35954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/tmp/blk_1073741847_1039.meta of size 0
2020-04-02 05:08:22,340 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:22,348 [DataXceiver for client  at /127.0.0.1:35954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039: PacketHeader with packetLen=33028 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 32768

2020-04-02 05:08:22,349 [org.apache.hadoop.hdfs.server.datanode.DataNode$DataTransfer@2aede297] INFO  datanode.DataNode (DataNode.java:run(2566)) - DataTransfer, at 127.0.0.1:45739: Transmitted BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039 (numBytes=32768) to /127.0.0.1:45580
2020-04-02 05:08:22,349 [DataXceiver for client  at /127.0.0.1:35954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:22,350 [DataXceiver for client  at /127.0.0.1:35954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039
2020-04-02 05:08:22,350 [DataXceiver for client  at /127.0.0.1:35954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(914)) - Received BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039 src: /127.0.0.1:35954 dest: /127.0.0.1:45580 of size 32768
2020-04-02 05:08:22,350 [DataXceiver for client  at /127.0.0.1:35954 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741847_1039]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 2
2020-04-02 05:08:22,351 [IPC Server handler 5 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:22,351 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741847_1039
2020-04-02 05:08:22,352 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741847_1039 on 127.0.0.1:45580 size 32768 replicaState = FINALIZED
2020-04-02 05:08:22,352 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:22,352 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741847_1039 (size=32768)
2020-04-02 05:08:22,352 [Block report processor] DEBUG BlockStateChange (BlockManager.java:invalidateBlock(1722)) - BLOCK* invalidateBlock: blk_1073741847_1039(stored=blk_1073741847_1039) on 127.0.0.1:43230
2020-04-02 05:08:22,352 [Block report processor] DEBUG BlockStateChange (InvalidateBlocks.java:add(190)) - BLOCK* InvalidateBlocks: add blk_1073741847_1039 to 127.0.0.1:43230
2020-04-02 05:08:22,352 [Block report processor] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741847_1039 from 127.0.0.1:43230
2020-04-02 05:08:22,352 [Block report processor] DEBUG BlockStateChange (BlockManager.java:invalidateBlock(1742)) - BLOCK* invalidateBlocks: blk_1073741847_1039(stored=blk_1073741847_1039) on 127.0.0.1:43230 listed for deletion.
2020-04-02 05:08:22,353 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741847_1039 is received from 127.0.0.1:45580
2020-04-02 05:08:22,353 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:25,223 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-04-02 05:08:25,223 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:invalidateWorkForOneNode(4375)) - BLOCK* BlockManager: ask 127.0.0.1:43230 to delete [blk_1073741847_1039]
2020-04-02 05:08:25,298 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:25,326 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:25,326 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:25,328 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:deleteAsync(225)) - Scheduling blk_1073741847_1039 replica FinalizedReplica, blk_1073741847_1039, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741847 for deletion
2020-04-02 05:08:25,330 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:25,330 [Async disk worker #0 for volume /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:run(333)) - Deleted BP-1786648874-172.17.0.4-1585804085136 blk_1073741847_1039 URI file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741847
2020-04-02 05:08:25,342 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:26,018 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38766 [Waiting for operation #2]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:28,223 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-04-02 05:08:28,299 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:28,326 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:28,327 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:28,330 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43230, datanodeUuid=9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4, infoPort=35250, infoSecurePort=0, ipcPort=42719, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:28,330 [Block report processor] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3781)) - BLOCK* removeStoredBlock: blk_1073741847_1039 from 127.0.0.1:43230
2020-04-02 05:08:28,330 [Block report processor] DEBUG BlockStateChange (BlockManager.java:removeStoredBlock(3785)) - BLOCK* removeStoredBlock: blk_1073741847_1039 has already been removed from node 127.0.0.1:43230
2020-04-02 05:08:28,330 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block DELETED_BLOCK: blk_1073741847_1039 is received from 127.0.0.1:43230
2020-04-02 05:08:28,330 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43230 receiving: 0, received: 0, deleted: 1
2020-04-02 05:08:28,331 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:28,342 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
[msx] test Finished org.apache.hadoop.hdfs.TestFileAppend3#testTC7ForAppend2
[msx] writeFile testName = org.apache.hadoop.hdfs.TestFileAppend3#testTC7ForAppend2
[msx] succeed
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
[msx] test Started org.apache.hadoop.hdfs.TestFileAppend3#testTC2ForAppend2
[msx] perform reset as unitTestCounterInClass 14 is larger than zero
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
2020-04-02 05:08:30,208 [main] DEBUG hdfs.DFSClient (DFSClient.java:create(1210)) - /TC2/foo2: masked={ masked: rw-r--r--, unmasked: rw-rw-rw- }
2020-04-02 05:08:30,210 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:create(757)) - *DIR* NameNode.create: file /TC2/foo2 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:30,211 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:startFileInt(2385)) - DIR* NameSystem.startFile: src=/TC2/foo2, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1, createParent=true, replication=3, createFlag=[CREATE], blockSize=65536, supportedVersions=[CryptoProtocolVersion{description='Encryption zones', version=2, unknownValue=null}]
2020-04-02 05:08:30,212 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addFile(585)) - DIR* addFile: foo2 is added
2020-04-02 05:08:30,212 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:startFile(416)) - DIR* NameSystem.startFile: added /TC2/foo2 inode 16407 DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:30,213 [IPC Server handler 7 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=create	src=/TC2/foo2	dst=null	perm=root:supergroup:rw-r--r--	proto=rpc
2020-04-02 05:08:30,214 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC2/foo2, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:30,218 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC2/foo2, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:30,227 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC2/foo2, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:30,227 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=1, src=/TC2/foo2, packetSize=516, chunksPerPacket=1, bytesCurBlock=64512, DFSOutputStream:block==null
2020-04-02 05:08:30,228 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC2/foo2, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:30,228 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=2, src=/TC2/foo2, packetSize=516, chunksPerPacket=1, bytesCurBlock=65024, DFSOutputStream:block==null
2020-04-02 05:08:30,228 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC2/foo2, chunkSize=516, chunksPerPacket=1, packetSize=516
2020-04-02 05:08:30,228 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=4, src=/TC2/foo2, packetSize=516, chunksPerPacket=1, bytesCurBlock=0, DFSOutputStream:block==null
2020-04-02 05:08:30,228 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC2/foo2, chunkSize=516, chunksPerPacket=125, packetSize=64500
2020-04-02 05:08:30,229 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=5, src=/TC2/foo2, packetSize=64500, chunksPerPacket=125, bytesCurBlock=512, DFSOutputStream:block==null
2020-04-02 05:08:30,230 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC2/foo2  inodeId 16407 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:30,231 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC2/foo2 with blk_1073741849_1052 block is added to the in-memory file system
2020-04-02 05:08:30,231 [IPC Server handler 2 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741849_1052, replicas=127.0.0.1:45580, 127.0.0.1:43434, 127.0.0.1:45739 for /TC2/foo2
2020-04-02 05:08:30,232 [IPC Server handler 2 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC2/foo2 with new block blk_1073741849_1052, current total block count is 1
2020-04-02 05:08:30,238 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:30,243 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43434, 127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:30,243 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:30,243 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:30,243 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052 src: /127.0.0.1:36246 dest: /127.0.0.1:45580
2020-04-02 05:08:30,243 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052
 storageType=DISK, inAddr=/127.0.0.1:36246, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:30,244 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741849 of size 0
2020-04-02 05:08:30,244 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741849_1052.meta of size 0
2020-04-02 05:08:30,244 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:30,246 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:30,247 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45739]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:30,247 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:30,247 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:30,247 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052 src: /127.0.0.1:39074 dest: /127.0.0.1:43434
2020-04-02 05:08:30,247 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052
 storageType=DISK, inAddr=/127.0.0.1:39074, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:30,247 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741849 of size 0
2020-04-02 05:08:30,247 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741849_1052.meta of size 0
2020-04-02 05:08:30,248 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:30,248 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:30,249 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:30,249 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:30,249 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:30,249 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052 src: /127.0.0.1:33252 dest: /127.0.0.1:45739
2020-04-02 05:08:30,249 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052
 storageType=DISK, inAddr=/127.0.0.1:33252, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:30,249 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741849 of size 0
2020-04-02 05:08:30,250 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741849_1052.meta of size 0
2020-04-02 05:08:30,264 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:30,269 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:30,270 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689279648274579, ackStatus=SUCCESS)
2020-04-02 05:08:30,270 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:30,270 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689279648777941, ackStatus=SUCCESS)
2020-04-02 05:08:30,270 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:30,270 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689279648970295, ackStatus=SUCCESS)
2020-04-02 05:08:30,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:30,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:30,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689279649302939, ackStatus=SUCCESS)
2020-04-02 05:08:30,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689279649218671, ackStatus=SUCCESS)
2020-04-02 05:08:30,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052: PacketHeader with packetLen=65020 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 64512

2020-04-02 05:08:30,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=64512, ackEnqueueNanoTime=689279649876412, ackStatus=SUCCESS)
2020-04-02 05:08:30,271 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052: PacketHeader with packetLen=520 header data: offsetInBlock: 64512
seqno: 1
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:30,272 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=false, offsetInBlock=65024, ackEnqueueNanoTime=689279650190748, ackStatus=SUCCESS)
2020-04-02 05:08:30,272 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:30,272 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689279650452113, ackStatus=SUCCESS)
2020-04-02 05:08:30,272 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:30,272 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052: PacketHeader with packetLen=520 header data: offsetInBlock: 65024
seqno: 2
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:30,272 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE: enqueue Packet(seqno=2, lastPacketInBlock=false, offsetInBlock=65536, ackEnqueueNanoTime=689279650868733, ackStatus=SUCCESS)
2020-04-02 05:08:30,272 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:30,272 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:30,272 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:30,273 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE, replyAck=seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:30,273 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2234085 flag: 0 flag: 0
2020-04-02 05:08:30,273 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:30,273 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:30,273 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2138825 flag: 0 flag: 0
2020-04-02 05:08:30,273 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 2 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:30,273 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1261288 flag: 0 flag: 0
2020-04-02 05:08:30,274 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2234085 flag: 0 flag: 0
2020-04-02 05:08:30,274 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3925388 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:30,274 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 2138825 flag: 0 flag: 0
2020-04-02 05:08:30,274 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3574224 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:30,274 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739] got seqno: 2 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1261288 flag: 0 flag: 0
2020-04-02 05:08:30,274 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739], replyAck=seqno: 2 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 3553340 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:30,275 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:30,275 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689279653800865, ackStatus=SUCCESS)
2020-04-02 05:08:30,275 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052
2020-04-02 05:08:30,275 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:30,275 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689279654090902, ackStatus=SUCCESS)
2020-04-02 05:08:30,276 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052
2020-04-02 05:08:30,276 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052: PacketHeader with packetLen=4 header data: offsetInBlock: 65536
seqno: 3
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:30,276 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052
2020-04-02 05:08:30,276 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE: enqueue Packet(seqno=3, lastPacketInBlock=true, offsetInBlock=65536, ackEnqueueNanoTime=689279654331592, ackStatus=SUCCESS)
2020-04-02 05:08:30,276 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:33252, dest: /127.0.0.1:45739, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, duration(ns): 11343648
2020-04-02 05:08:30,277 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE, replyAck=seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:30,277 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:30,277 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] got seqno: 3 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:30,277 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:30,277 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33252 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 2
2020-04-02 05:08:30,278 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:30,278 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:39074, dest: /127.0.0.1:43434, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, duration(ns): 8336346
2020-04-02 05:08:30,278 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739], replyAck=seqno: 3 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1178688 flag: 0 flag: 0
2020-04-02 05:08:30,278 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741849_1052 on 127.0.0.1:45739 size 65536 replicaState = FINALIZED
2020-04-02 05:08:30,278 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]: closing
2020-04-02 05:08:30,278 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45739] terminating
2020-04-02 05:08:30,278 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:30,278 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741849_1052 (size=0)
2020-04-02 05:08:30,278 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39074 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:30,279 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741849_1052 is received from 127.0.0.1:45739
2020-04-02 05:08:30,279 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:30,282 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739] got seqno: 3 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1178688 flag: 0 flag: 0
2020-04-02 05:08:30,282 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:36246, dest: /127.0.0.1:45580, bytes: 65536, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, duration(ns): 12680677
2020-04-02 05:08:30,282 [IPC Server handler 1 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:30,282 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739], replyAck=seqno: 3 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 6341863 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:30,283 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739] terminating
2020-04-02 05:08:30,283 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741849_1052 on 127.0.0.1:43434 size 65536 replicaState = FINALIZED
2020-04-02 05:08:30,283 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:30,283 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741849_1052 (size=0)
2020-04-02 05:08:30,283 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741849_1052 is received from 127.0.0.1:43434
2020-04-02 05:08:30,283 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:30,284 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45739]: closing
2020-04-02 05:08:30,285 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:36246 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 2
2020-04-02 05:08:30,290 [IPC Server handler 0 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:30,290 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741849_1052 on 127.0.0.1:45580 size 65536 replicaState = FINALIZED
2020-04-02 05:08:30,290 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:30,290 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC2/foo2  inodeId 16407 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:30,290 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741849_1052 (size=0)
2020-04-02 05:08:30,291 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741849_1052 is received from 127.0.0.1:45580
2020-04-02 05:08:30,291 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:30,292 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC2/foo2 with blk_1073741850_1053 block is added to the in-memory file system
2020-04-02 05:08:30,292 [IPC Server handler 0 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741850_1053, replicas=127.0.0.1:45739, 127.0.0.1:44971, 127.0.0.1:43434 for /TC2/foo2
2020-04-02 05:08:30,292 [IPC Server handler 0 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC2/foo2 with new block blk_1073741850_1053, current total block count is 2
2020-04-02 05:08:30,294 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:30,295 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:44971, 127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:30,295 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:30,295 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:30,295 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053 src: /127.0.0.1:33254 dest: /127.0.0.1:45739
2020-04-02 05:08:30,295 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053
 storageType=DISK, inAddr=/127.0.0.1:33254, myAddr=/127.0.0.1:45739
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45739
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-6946cabd-2f8d-451f-81bc-4884ebba8665
2020-04-02 05:08:30,296 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741850 of size 0
2020-04-02 05:08:30,296 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741850_1053.meta of size 0
2020-04-02 05:08:30,296 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:30,296 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:30,297 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43434]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:30,297 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:30,297 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:30,297 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053 src: /127.0.0.1:57990 dest: /127.0.0.1:44971
2020-04-02 05:08:30,297 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053
 storageType=DISK, inAddr=/127.0.0.1:57990, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:30,298 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741850 of size 0
2020-04-02 05:08:30,298 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741850_1053.meta of size 0
2020-04-02 05:08:30,298 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:30,298 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:30,299 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:30,299 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:30,299 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:30,299 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053 src: /127.0.0.1:39082 dest: /127.0.0.1:43434
2020-04-02 05:08:30,299 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053
 storageType=DISK, inAddr=/127.0.0.1:39082, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:30,300 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741850 of size 0
2020-04-02 05:08:30,300 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741850_1053.meta of size 0
2020-04-02 05:08:30,305 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:30,305 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 4
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:30,305 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]: enqueue Packet(seqno=4, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=689279684052947, ackStatus=SUCCESS)
2020-04-02 05:08:30,306 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053: PacketHeader with packetLen=32512 header data: offsetInBlock: 512
seqno: 5
lastPacketInBlock: false
dataLen: 32256

2020-04-02 05:08:30,306 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]: enqueue Packet(seqno=5, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689279684707656, ackStatus=SUCCESS)
2020-04-02 05:08:30,312 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 4
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:30,312 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=4, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=689279690701902, ackStatus=SUCCESS)
2020-04-02 05:08:30,312 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053: PacketHeader with packetLen=32512 header data: offsetInBlock: 512
seqno: 5
lastPacketInBlock: false
dataLen: 32256

2020-04-02 05:08:30,312 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=5, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689279691074345, ackStatus=SUCCESS)
2020-04-02 05:08:30,314 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053: PacketHeader with packetLen=520 header data: offsetInBlock: 0
seqno: 4
lastPacketInBlock: false
dataLen: 512

2020-04-02 05:08:30,314 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE: enqueue Packet(seqno=4, lastPacketInBlock=false, offsetInBlock=512, ackEnqueueNanoTime=689279692349762, ackStatus=SUCCESS)
2020-04-02 05:08:30,314 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053: PacketHeader with packetLen=32512 header data: offsetInBlock: 512
seqno: 5
lastPacketInBlock: false
dataLen: 32256

2020-04-02 05:08:30,314 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE: enqueue Packet(seqno=5, lastPacketInBlock=false, offsetInBlock=32768, ackEnqueueNanoTime=689279692681127, ackStatus=SUCCESS)
2020-04-02 05:08:30,314 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE, replyAck=seqno: 4 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:30,314 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE, replyAck=seqno: 5 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:30,315 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:30,322 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 4 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:30,322 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 4 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9475138 flag: 0 flag: 0
2020-04-02 05:08:30,322 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434] got seqno: 4 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9475138 flag: 0 flag: 0
2020-04-02 05:08:30,322 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 5 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:30,322 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 5 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9730284 flag: 0 flag: 0
2020-04-02 05:08:30,322 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434], replyAck=seqno: 4 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 16605532 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:30,322 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434] got seqno: 5 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 9730284 flag: 0 flag: 0
2020-04-02 05:08:30,323 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434], replyAck=seqno: 5 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 16392834 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:30,323 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 6
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:30,323 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]: enqueue Packet(seqno=6, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689279701690474, ackStatus=SUCCESS)
2020-04-02 05:08:30,323 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053
2020-04-02 05:08:30,323 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 6
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:30,323 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: enqueue Packet(seqno=6, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689279702053345, ackStatus=SUCCESS)
2020-04-02 05:08:30,324 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053
2020-04-02 05:08:30,324 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053: PacketHeader with packetLen=4 header data: offsetInBlock: 32768
seqno: 6
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:30,324 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053
2020-04-02 05:08:30,324 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE: enqueue Packet(seqno=6, lastPacketInBlock=true, offsetInBlock=32768, ackEnqueueNanoTime=689279702263024, ackStatus=SUCCESS)
2020-04-02 05:08:30,324 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:39082, dest: /127.0.0.1:43434, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, duration(ns): 19236644
2020-04-02 05:08:30,324 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE, replyAck=seqno: 6 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:30,324 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:30,324 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] got seqno: 6 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:30,324 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:30,325 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39082 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:30,325 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:57990, dest: /127.0.0.1:44971, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, duration(ns): 12528688
2020-04-02 05:08:30,325 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434], replyAck=seqno: 6 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 863503 flag: 0 flag: 0
2020-04-02 05:08:30,325 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434] got seqno: 6 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 863503 flag: 0 flag: 0
2020-04-02 05:08:30,325 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]: closing
2020-04-02 05:08:30,325 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:43434] terminating
2020-04-02 05:08:30,325 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:57990 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 2
2020-04-02 05:08:30,325 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:33254, dest: /127.0.0.1:45739, bytes: 32768, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, duration(ns): 19903417
2020-04-02 05:08:30,326 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434], replyAck=seqno: 6 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 1902849 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:30,326 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434] terminating
2020-04-02 05:08:30,326 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:44971, 127.0.0.1:43434]: closing
2020-04-02 05:08:30,326 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:33254 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 2
2020-04-02 05:08:30,326 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:30,326 [IPC Server handler 4 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45739, datanodeUuid=85182ebc-cd1c-4941-89fb-8d9b64eeaece, infoPort=46206, infoSecurePort=0, ipcPort=37669, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:30,326 [IPC Server handler 4 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC2/foo2 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:30,327 [IPC Server handler 4 on 35215] INFO  namenode.FSNamesystem (FSNamesystem.java:checkBlocksComplete(2908)) - BLOCK* blk_1073741850_1053 is COMMITTED but not COMPLETE(numNodes= 0 <  minimum = 1) in file /TC2/foo2
2020-04-02 05:08:30,328 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741850_1053 on 127.0.0.1:44971 size 32768 replicaState = FINALIZED
2020-04-02 05:08:30,328 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMMITTED
2020-04-02 05:08:30,328 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741850_1053 (size=32768)
2020-04-02 05:08:30,329 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741850_1053 is received from 127.0.0.1:44971
2020-04-02 05:08:30,329 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:30,329 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741850_1053
2020-04-02 05:08:30,329 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741850_1053 on 127.0.0.1:45739 size 32768 replicaState = FINALIZED
2020-04-02 05:08:30,329 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:30,329 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45739 is added to blk_1073741850_1053 (size=32768)
2020-04-02 05:08:30,329 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741850_1053 is received from 127.0.0.1:45739
2020-04-02 05:08:30,329 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45739 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:30,330 [IPC Server handler 6 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:30,330 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741850_1053
2020-04-02 05:08:30,330 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741850_1053 on 127.0.0.1:43434 size 32768 replicaState = FINALIZED
2020-04-02 05:08:30,330 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:30,330 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741850_1053 (size=32768)
2020-04-02 05:08:30,330 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741850_1053 is received from 127.0.0.1:43434
2020-04-02 05:08:30,330 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:30,730 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC2/foo2 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:30,730 [IPC Server handler 7 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC2/foo2 with 2 blocks is persisted to the file system
2020-04-02 05:08:30,730 [IPC Server handler 7 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC2/foo2 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:30,749 [IPC Server handler 2 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/TC2/foo2	dst=null	perm=null	proto=rpc
2020-04-02 05:08:30,751 [IPC Server handler 9 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741849_1052, blk_1073741850_1053]
2020-04-02 05:08:30,752 [IPC Server handler 9 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC2/foo2	dst=null	perm=null	proto=rpc
2020-04-02 05:08:30,754 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(242)) - newInfo = LocatedBlocks{;  fileLength=98304;  underConstruction=false;  blocks=[LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052; getBlockSize()=65536; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK], DatanodeInfoWithStorage[127.0.0.1:45580,DS-089629a9-5898-4562-bd81-79a4f45c96c1,DISK], DatanodeInfoWithStorage[127.0.0.1:45739,DS-d49b8d06-4514-41da-af7b-faacf4f00b86,DISK]]}, LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053; getBlockSize()=32768; corrupt=false; offset=65536; locs=[DatanodeInfoWithStorage[127.0.0.1:43434,DS-29df15fa-b2ca-4eca-89df-87135d5e3b76,DISK], DatanodeInfoWithStorage[127.0.0.1:45739,DS-6946cabd-2f8d-451f-81bc-4884ebba8665,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053; getBlockSize()=32768; corrupt=false; offset=65536; locs=[DatanodeInfoWithStorage[127.0.0.1:45739,DS-6946cabd-2f8d-451f-81bc-4884ebba8665,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-29df15fa-b2ca-4eca-89df-87135d5e3b76,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-04-02 05:08:30,754 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:30,756 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:30,758 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39110 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, replica=FinalizedReplica, blk_1073741849_1052, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741849
2020-04-02 05:08:30,758 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39110 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741849_1052, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741849
2020-04-02 05:08:30,759 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39110 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:43434, dest: /127.0.0.1:39110, bytes: 66048, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, duration(ns): 319583
2020-04-02 05:08:31,224 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-04-02 05:08:31,299 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:31,326 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:31,327 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:31,330 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:31,343 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:34,336 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:34,343 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:34,343 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:34,350 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:34,343 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:34,354 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-04-02 05:08:34,762 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:39110 [Waiting for operation #2]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:37,337 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:37,343 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:37,343 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:37,343 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:37,351 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:37,354 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-04-02 05:08:37,823 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:37,825 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:37,826 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:42398 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, replica=FinalizedReplica, blk_1073741850_1053, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741850
2020-04-02 05:08:37,826 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:42398 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741850_1053, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741850
2020-04-02 05:08:37,827 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:42398 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:43434, dest: /127.0.0.1:42398, bytes: 33024, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, duration(ns): 294043
2020-04-02 05:08:40,336 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:40,343 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:40,343 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:40,344 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:40,352 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:40,354 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-04-02 05:08:41,381 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (NameNodeRpcServer.java:append(792)) - *DIR* NameNode.append: file /TC2/foo2 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1
2020-04-02 05:08:41,381 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:appendFile(2623)) - DIR* NameSystem.appendFile: src=/TC2/foo2, holder=DFSClient_NONMAPREDUCE_-96199515_1, clientMachine=127.0.0.1
2020-04-02 05:08:41,382 [IPC Server handler 6 on 35215] DEBUG hdfs.StateChange (FSDirAppendOp.java:appendFile(154)) - DIR* NameSystem.appendFile: file /TC2/foo2 for DFSClient_NONMAPREDUCE_-96199515_1 at 127.0.0.1 block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053 block size 32768
2020-04-02 05:08:41,382 [IPC Server handler 6 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=append	src=/TC2/foo2	dst=null	perm=null	proto=rpc
2020-04-02 05:08:41,383 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:computePacketChunkSize(410)) - computePacketChunkSize: src=/TC2/foo2, chunkSize=516, chunksPerPacket=126, packetSize=65016
2020-04-02 05:08:41,385 [main] DEBUG hdfs.DFSClient (DFSOutputStream.java:writeChunkPrepare(475)) - WriteChunk allocating new packet seqno=0, src=/TC2/foo2, packetSize=65016, chunksPerPacket=126, bytesCurBlock=0, DFSOutputStream:blk_1073741850_1053
2020-04-02 05:08:41,394 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:getAdditionalBlock(2680)) - BLOCK* getAdditionalBlock: /TC2/foo2  inodeId 16407 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:41,395 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:addBlock(525)) - DIR* FSDirectory.addBlock: /TC2/foo2 with blk_1073741851_1054 block is added to the in-memory file system
2020-04-02 05:08:41,395 [IPC Server handler 5 on 35215] INFO  hdfs.StateChange (FSDirWriteFileOp.java:logAllocatedBlock(804)) - BLOCK* allocate blk_1073741851_1054, replicas=127.0.0.1:44971, 127.0.0.1:43434, 127.0.0.1:45580 for /TC2/foo2
2020-04-02 05:08:41,395 [IPC Server handler 5 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:persistNewBlock(764)) - persistNewBlock: /TC2/foo2 with new block blk_1073741851_1054, current total block count is 3
2020-04-02 05:08:41,397 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:41,403 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:43434, 127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:41,403 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:41,403 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:41,403 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054 src: /127.0.0.1:34812 dest: /127.0.0.1:44971
2020-04-02 05:08:41,403 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054
 storageType=DISK, inAddr=/127.0.0.1:34812, myAddr=/127.0.0.1:44971
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:44971
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-9396c1fd-c034-40b5-99a4-7728fe5d066f
2020-04-02 05:08:41,404 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741851 of size 0
2020-04-02 05:08:41,404 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741851_1054.meta of size 0
2020-04-02 05:08:41,404 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:41,404 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 2
2020-04-02 05:08:41,411 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:44138 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, newGs=0, bytesRcvd=[0, 0]
  targets=[127.0.0.1:45580]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:41,411 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:44138 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:41,411 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:44138 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:41,411 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:44138 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054 src: /127.0.0.1:44138 dest: /127.0.0.1:43434
2020-04-02 05:08:41,411 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:44138 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054
 storageType=DISK, inAddr=/127.0.0.1:44138, myAddr=/127.0.0.1:43434
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:43434
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e
2020-04-02 05:08:41,412 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:44138 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741851 of size 0
2020-04-02 05:08:41,412 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:44138 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741851_1054.meta of size 0
2020-04-02 05:08:41,412 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:44138 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(775)) - Connecting to datanode 127.0.0.1:45580
2020-04-02 05:08:41,414 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:41,415 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:41316 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(719)) - opWriteBlock: stage=PIPELINE_SETUP_CREATE, clientname=DFSClient_NONMAPREDUCE_-96199515_1
  block  =BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, newGs=0, bytesRcvd=[0, 0]
  targets=[]; pipelineSize=3, srcDataNode=:0, pinning=false
2020-04-02 05:08:41,415 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:41316 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(725)) - isDatanode=false, isClient=true, isTransfer=false
2020-04-02 05:08:41,415 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:41316 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (DataXceiver.java:writeBlock(727)) - writeBlock receive buf size 531000 tcp no delay true
2020-04-02 05:08:41,415 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:41316 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] INFO  datanode.DataNode (DataXceiver.java:writeBlock(738)) - Receiving BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054 src: /127.0.0.1:41316 dest: /127.0.0.1:45580
2020-04-02 05:08:41,416 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:41316 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:<init>(191)) - BlockReceiver: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054
 storageType=DISK, inAddr=/127.0.0.1:41316, myAddr=/127.0.0.1:45580
 stage=PIPELINE_SETUP_CREATE, newGs=0, minBytesRcvd=0, maxBytesRcvd=0
 clientname=DFSClient_NONMAPREDUCE_-96199515_1, srcDataNode=:0, datanode=127.0.0.1:45580
 requestedChecksum=DataChecksum(type=CRC32C, chunkSize=512)
 cachingStrategy=CachingStrategy(dropBehind=null, readahead=null)
 allowLazyPersist=false, pinning=false, isClient=true, isDatanode=false, responseInterval=30000, storageID=DS-089629a9-5898-4562-bd81-79a4f45c96c1
2020-04-02 05:08:41,416 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:41316 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(252)) - writeTo blockfile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741851 of size 0
2020-04-02 05:08:41,416 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:41316 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (LocalReplicaInPipeline.java:createStreams(254)) - writeTo metafile is /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136/current/rbw/blk_1073741851_1054.meta of size 0
2020-04-02 05:08:41,417 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:41,455 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054: PacketHeader with packetLen=16516 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 16384

2020-04-02 05:08:41,455 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=16384, ackEnqueueNanoTime=689290833524690, ackStatus=SUCCESS)
2020-04-02 05:08:41,455 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:44138 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054: PacketHeader with packetLen=16516 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 16384

2020-04-02 05:08:41,455 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:44138 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=16384, ackEnqueueNanoTime=689290834067539, ackStatus=SUCCESS)
2020-04-02 05:08:41,456 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:41316 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054: PacketHeader with packetLen=16516 header data: offsetInBlock: 0
seqno: 0
lastPacketInBlock: false
dataLen: 16384

2020-04-02 05:08:41,456 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:41316 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=LAST_IN_PIPELINE: enqueue Packet(seqno=0, lastPacketInBlock=false, offsetInBlock=16384, ackEnqueueNanoTime=689290834789517, ackStatus=SUCCESS)
2020-04-02 05:08:41,457 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=LAST_IN_PIPELINE, replyAck=seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:41,457 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:waitForAckHead(1327)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=LAST_IN_PIPELINE: seqno=-2 waiting for local datanode to finish write.
2020-04-02 05:08:41,460 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 0 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:41,460 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 4122242 flag: 0 flag: 0
2020-04-02 05:08:41,460 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580] got seqno: 0 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 4122242 flag: 0 flag: 0
2020-04-02 05:08:41,463 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580], replyAck=seqno: 0 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 5185687 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:41,466 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054: PacketHeader with packetLen=4 header data: offsetInBlock: 16384
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:41,467 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=16384, ackEnqueueNanoTime=689290845137959, ackStatus=SUCCESS)
2020-04-02 05:08:41,467 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054
2020-04-02 05:08:41,467 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:44138 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054: PacketHeader with packetLen=4 header data: offsetInBlock: 16384
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:41,467 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:44138 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=16384, ackEnqueueNanoTime=689290845702779, ackStatus=SUCCESS)
2020-04-02 05:08:41,467 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:44138 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054
2020-04-02 05:08:41,467 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:41316 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(532)) - Receiving one packet for block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054: PacketHeader with packetLen=4 header data: offsetInBlock: 16384
seqno: 1
lastPacketInBlock: true
dataLen: 0

2020-04-02 05:08:41,468 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:41316 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:receivePacket(613)) - Receiving an empty packet or the end of the block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054
2020-04-02 05:08:41,468 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:41316 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:enqueue(1268)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=LAST_IN_PIPELINE: enqueue Packet(seqno=1, lastPacketInBlock=true, offsetInBlock=16384, ackEnqueueNanoTime=689290846191827, ackStatus=SUCCESS)
2020-04-02 05:08:41,469 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=LAST_IN_PIPELINE] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:41316, dest: /127.0.0.1:45580, bytes: 16384, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: fa2f4855-186d-4810-9249-db4686eb92b3, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, duration(ns): 50972653
2020-04-02 05:08:41,469 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=LAST_IN_PIPELINE] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=LAST_IN_PIPELINE, replyAck=seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:41,469 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:41316 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=LAST_IN_PIPELINE: closing
2020-04-02 05:08:41,469 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=LAST_IN_PIPELINE] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=LAST_IN_PIPELINE terminating
2020-04-02 05:08:41,470 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:41316 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45580:Number of active connections is: 2
2020-04-02 05:08:41,473 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] got seqno: 1 reply: SUCCESS downstreamAckTimeNanos: 0 flag: 0
2020-04-02 05:08:41,474 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:44138, dest: /127.0.0.1:43434, bytes: 16384, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, duration(ns): 55797316
2020-04-02 05:08:41,474 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 5824997 flag: 0 flag: 0
2020-04-02 05:08:41,474 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580] terminating
2020-04-02 05:08:41,475 [IPC Server handler 3 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:43434, datanodeUuid=5207c5c0-37c7-443f-94c4-771a605480e4, infoPort=42817, infoSecurePort=0, ipcPort=46021, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:41,474 [IPC Server handler 9 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:45580, datanodeUuid=fa2f4855-186d-4810-9249-db4686eb92b3, infoPort=45148, infoSecurePort=0, ipcPort=43422, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:41,475 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741851_1054 on 127.0.0.1:43434 size 16384 replicaState = FINALIZED
2020-04-02 05:08:41,476 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:41,476 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:43434 is added to blk_1073741851_1054 (size=0)
2020-04-02 05:08:41,476 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741851_1054 is received from 127.0.0.1:43434
2020-04-02 05:08:41,476 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:43434 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:41,476 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741851_1054 on 127.0.0.1:45580 size 16384 replicaState = FINALIZED
2020-04-02 05:08:41,476 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = UNDER_CONSTRUCTION
2020-04-02 05:08:41,476 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:45580 is added to blk_1073741851_1054 (size=0)
2020-04-02 05:08:41,476 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741851_1054 is received from 127.0.0.1:45580
2020-04-02 05:08:41,476 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:45580 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:41,478 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:run(1387)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580] got seqno: 1 reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 5824997 flag: 0 flag: 0
2020-04-02 05:08:41,478 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] INFO  DataNode.clienttrace (BlockReceiver.java:finalizeBlock(1533)) - src: /127.0.0.1:34812, dest: /127.0.0.1:44971, bytes: 16384, op: HDFS_WRITE, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, duration(ns): 36875215
2020-04-02 05:08:41,479 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] DEBUG datanode.DataNode (BlockReceiver.java:sendAckUpstreamUnprotected(1645)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580], replyAck=seqno: 1 reply: SUCCESS reply: SUCCESS reply: SUCCESS downstreamAckTimeNanos: 11121516 flag: 0 flag: 0 flag: 0
2020-04-02 05:08:41,479 [PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]] INFO  datanode.DataNode (BlockReceiver.java:run(1506)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580] terminating
2020-04-02 05:08:41,479 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=2:[127.0.0.1:43434, 127.0.0.1:45580]: closing
2020-04-02 05:08:41,479 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:34812 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 2
2020-04-02 05:08:41,480 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSDirWriteFileOp.java:completeFile(680)) - DIR* NameSystem.completeFile: /TC2/foo2 for DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:41,480 [IPC Server handler 8 on 35215] DEBUG hdfs.StateChange (FSNamesystem.java:closeFile(3947)) - closeFile: /TC2/foo2 with 3 blocks is persisted to the file system
2020-04-02 05:08:41,480 [IPC Server handler 8 on 35215] INFO  hdfs.StateChange (FSNamesystem.java:completeFile(2861)) - DIR* completeFile: /TC2/foo2 is closed by DFSClient_NONMAPREDUCE_-96199515_1
2020-04-02 05:08:41,481 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:44138 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockReceiver.java:close(1351)) - PacketResponder: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, type=HAS_DOWNSTREAM_IN_PIPELINE, downstreams=1:[127.0.0.1:45580]: closing
2020-04-02 05:08:41,502 [IPC Server handler 2 on 35215] DEBUG BlockStateChange (NameNodeRpcServer.java:blockReceivedAndDeleted(1574)) - *BLOCK* NameNode.blockReceivedAndDeleted: from DatanodeRegistration(127.0.0.1:44971, datanodeUuid=519e1267-21af-4106-9b82-32175ae0f5c5, infoPort=43364, infoSecurePort=0, ipcPort=32993, storageInfo=lv=-57;cid=testClusterID;nsid=1820228250;c=1585804085136) 1 blocks.
2020-04-02 05:08:41,518 [Block report processor] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:decrement(108)) - Removing pending reconstruction for blk_1073741851_1054
2020-04-02 05:08:41,518 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3911)) - Reported block blk_1073741851_1054 on 127.0.0.1:44971 size 16384 replicaState = FINALIZED
2020-04-02 05:08:41,519 [Block report processor] DEBUG blockmanagement.BlockManager (BlockManager.java:processAndHandleReportedBlock(3934)) - In memory blockUCState = COMPLETE
2020-04-02 05:08:41,519 [Block report processor] DEBUG BlockStateChange (BlockManager.java:addStoredBlock(3243)) - BLOCK* addStoredBlock: 127.0.0.1:44971 is added to blk_1073741851_1054 (size=16384)
2020-04-02 05:08:41,519 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4044)) - BLOCK* block RECEIVED_BLOCK: blk_1073741851_1054 is received from 127.0.0.1:44971
2020-04-02 05:08:41,519 [Block report processor] DEBUG BlockStateChange (BlockManager.java:processIncrementalBlockReport(4047)) - *BLOCK* NameNode.processIncrementalBlockReport: from 127.0.0.1:44971 receiving: 0, received: 1, deleted: 0
2020-04-02 05:08:41,519 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:44138 [Receiving block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 3
2020-04-02 05:08:41,522 [IPC Server handler 0 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=getfileinfo	src=/TC2/foo2	dst=null	perm=null	proto=rpc
2020-04-02 05:08:41,525 [IPC Server handler 4 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741849_1052, blk_1073741850_1053, blk_1073741851_1054]
2020-04-02 05:08:41,525 [IPC Server handler 4 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC2/foo2	dst=null	perm=null	proto=rpc
2020-04-02 05:08:41,530 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:fetchLocatedBlocksAndGetLastBlockLength(242)) - newInfo = LocatedBlocks{;  fileLength=114688;  underConstruction=false;  blocks=[LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052; getBlockSize()=65536; corrupt=false; offset=0; locs=[DatanodeInfoWithStorage[127.0.0.1:45739,DS-d49b8d06-4514-41da-af7b-faacf4f00b86,DISK], DatanodeInfoWithStorage[127.0.0.1:45580,DS-089629a9-5898-4562-bd81-79a4f45c96c1,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK]]}, LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053; getBlockSize()=32768; corrupt=false; offset=65536; locs=[DatanodeInfoWithStorage[127.0.0.1:43434,DS-29df15fa-b2ca-4eca-89df-87135d5e3b76,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3,DISK], DatanodeInfoWithStorage[127.0.0.1:45739,DS-6946cabd-2f8d-451f-81bc-4884ebba8665,DISK]]}, LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054; getBlockSize()=16384; corrupt=false; offset=98304; locs=[DatanodeInfoWithStorage[127.0.0.1:44971,DS-9396c1fd-c034-40b5-99a4-7728fe5d066f,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK], DatanodeInfoWithStorage[127.0.0.1:45580,DS-2d1f4083-d7c8-4136-8351-6f589a4451bd,DISK]]}];  lastLocatedBlock=LocatedBlock{BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054; getBlockSize()=16384; corrupt=false; offset=98304; locs=[DatanodeInfoWithStorage[127.0.0.1:45580,DS-2d1f4083-d7c8-4136-8351-6f589a4451bd,DISK], DatanodeInfoWithStorage[127.0.0.1:43434,DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e,DISK], DatanodeInfoWithStorage[127.0.0.1:44971,DS-9396c1fd-c034-40b5-99a4-7728fe5d066f,DISK]]};  isLastBlockComplete=true;  ecPolicy=null}
2020-04-02 05:08:41,531 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:45739
2020-04-02 05:08:41,532 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:41,538 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38344 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, replica=FinalizedReplica, blk_1073741849_1052, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741849
2020-04-02 05:08:41,538 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38344 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741849_1052, FINALIZED
  getNumBytes()     = 65536
  getBytesOnDisk()  = 65536
  getVisibleLength()= 65536
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741849
2020-04-02 05:08:41,539 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38344 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:45739, dest: /127.0.0.1:38344, bytes: 66048, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 85182ebc-cd1c-4941-89fb-8d9b64eeaece, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741849_1052, duration(ns): 297880
2020-04-02 05:08:41,830 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:42398 [Waiting for operation #2]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:43,336 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:43,343 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:43,343 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:43,344 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:43,352 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:43,355 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-04-02 05:08:45,550 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:38344 [Waiting for operation #2]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:45739:Number of active connections is: 2
2020-04-02 05:08:46,337 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:46,344 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:46,346 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:46,346 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:46,354 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:46,356 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-04-02 05:08:49,336 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:49,344 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:49,347 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:49,348 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:49,355 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:49,356 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-04-02 05:08:49,497 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:43434
2020-04-02 05:08:49,499 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:49,501 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:47414 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, replica=FinalizedReplica, blk_1073741850_1053, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741850
2020-04-02 05:08:49,501 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:47414 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741850_1053, FINALIZED
  getNumBytes()     = 32768
  getBytesOnDisk()  = 32768
  getVisibleLength()= 32768
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741850
2020-04-02 05:08:49,502 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:47414 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:43434, dest: /127.0.0.1:47414, bytes: 33024, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 5207c5c0-37c7-443f-94c4-771a605480e4, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741850_1053, duration(ns): 436417
2020-04-02 05:08:52,337 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:52,348 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:52,349 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:52,350 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:52,356 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:52,358 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-04-02 05:08:54,078 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:47414 [Waiting for operation #2]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:43434:Number of active connections is: 2
2020-04-02 05:08:54,352 [main] DEBUG hdfs.DFSClient (DFSInputStream.java:getBestNodeDNAddrPair(948)) - Connecting to datanode 127.0.0.1:44971
2020-04-02 05:08:54,354 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] DEBUG datanode.DataNode (DataXceiver.java:<init>(152)) - Number of active connections is: 1
2020-04-02 05:08:54,368 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:40616 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockSender.java:<init>(285)) - block=BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, replica=FinalizedReplica, blk_1073741851_1054, FINALIZED
  getNumBytes()     = 16384
  getBytesOnDisk()  = 16384
  getVisibleLength()= 16384
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741851
2020-04-02 05:08:54,368 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:40616 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG datanode.DataNode (BlockSender.java:<init>(416)) - replica=FinalizedReplica, blk_1073741851_1054, FINALIZED
  getNumBytes()     = 16384
  getBytesOnDisk()  = 16384
  getVisibleLength()= 16384
  getVolume()       = /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6
  getBlockURI()     = file:/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136/current/finalized/subdir0/subdir0/blk_1073741851
2020-04-02 05:08:54,370 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:40616 [Sending block BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054]] DEBUG DataNode.clienttrace (BlockSender.java:doSendBlock(826)) - src: /127.0.0.1:44971, dest: /127.0.0.1:40616, bytes: 16512, op: HDFS_READ, cliID: DFSClient_NONMAPREDUCE_-96199515_1, offset: 0, srvID: 519e1267-21af-4106-9b82-32175ae0f5c5, blockid: BP-1786648874-172.17.0.4-1585804085136:blk_1073741851_1054, duration(ns): 532735
2020-04-02 05:08:55,338 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:55,348 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:55,349 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:55,350 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:55,355 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] DEBUG datanode.DataNode (BPServiceActor.java:sendHeartBeat(495)) - Sending heartbeat with 2 storage reports from service actor: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:55,359 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-04-02 05:08:56,187 [IPC Server handler 1 on 35215] DEBUG blockmanagement.BlockManager (BlockManager.java:createLocatedBlocks(1339)) - blocks = [blk_1073741849_1052, blk_1073741850_1053, blk_1073741851_1054]
2020-04-02 05:08:56,188 [IPC Server handler 1 on 35215] INFO  FSNamesystem.audit (FSNamesystem.java:logAuditMessage(7947)) - allowed=true	ugi=root (auth:SIMPLE)	ip=/127.0.0.1	cmd=open	src=/TC2/foo2	dst=null	perm=null	proto=rpc
[msx] test Finished org.apache.hadoop.hdfs.TestFileAppend3#testTC2ForAppend2
[msx] writeFile testName = org.apache.hadoop.hdfs.TestFileAppend3#testTC2ForAppend2
[msx] succeed
[msx] reset reconf_instanceWithV2Alive to false
[msx] reset reconf_instanceWithV2HC to -1
[msx] reset reconf_init_point_index to 0
2020-04-02 05:08:56,193 [main] INFO  hdfs.AppendTestUtil (TestFileAppend3.java:tearDown(87)) - tearDown()
2020-04-02 05:08:56,195 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdown(1998)) - Shutting down the Mini HDFS Cluster
2020-04-02 05:08:56,195 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNode(2046)) - Shutting down DataNode 4
2020-04-02 05:08:56,196 [main] INFO  datanode.DataNode (DataNode.java:shutdown(1991)) - [msx-restart] DataNode 37669 stop, double check before stop, dfs.namenode.fs-limits.max-directory-items = 1048576
2020-04-02 05:08:56,197 [main] WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(342)) - DirectoryScanner: shutdown has been called
2020-04-02 05:08:56,197 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@11acdc30] INFO  datanode.DataNode (DataXceiverServer.java:closeAllPeers(281)) - Closing all peers.
2020-04-02 05:08:56,206 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9)] INFO  datanode.VolumeScanner (VolumeScanner.java:run(642)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9, DS-6946cabd-2f8d-451f-81bc-4884ebba8665) exiting.
2020-04-02 05:08:56,208 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10)] INFO  datanode.VolumeScanner (VolumeScanner.java:run(642)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10, DS-d49b8d06-4514-41da-af7b-faacf4f00b86) exiting.
2020-04-02 05:08:56,455 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@4cc76301{/,null,UNAVAILABLE}{/datanode}
2020-04-02 05:08:56,466 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@2f08c4b{HTTP/1.1,[http/1.1]}{localhost:0}
2020-04-02 05:08:56,468 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@611f8234{/static,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,UNAVAILABLE}
2020-04-02 05:08:56,469 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@644c78d4{/logs,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,UNAVAILABLE}
2020-04-02 05:08:56,486 [main] INFO  ipc.Server (Server.java:stop(3077)) - Stopping server on 37669
2020-04-02 05:08:56,509 [IPC Server listener on 37669] INFO  ipc.Server (Server.java:run(1181)) - Stopping IPC Server listener on 37669
2020-04-02 05:08:56,522 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1315)) - Stopping IPC Server Responder
2020-04-02 05:08:56,526 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] WARN  datanode.IncrementalBlockReportManager (IncrementalBlockReportManager.java:waitTillNextIBR(160)) - IncrementalBlockReportManager interrupted
2020-04-02 05:08:56,526 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] WARN  datanode.DataNode (BPServiceActor.java:run(853)) - Ending block pool service for: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece) service to localhost/127.0.0.1:35215
2020-04-02 05:08:56,526 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BlockPoolManager.java:remove(102)) - Removed Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 85182ebc-cd1c-4941-89fb-8d9b64eeaece)
2020-04-02 05:08:56,526 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2802)) - Removing block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:56,562 [refreshUsed-/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data9/current/BP-1786648874-172.17.0.4-1585804085136] WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2020-04-02 05:08:56,578 [refreshUsed-/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data10/current/BP-1786648874-172.17.0.4-1585804085136] WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2020-04-02 05:08:56,582 [main] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(192)) - Shutting down all async disk service threads
2020-04-02 05:08:56,582 [main] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(200)) - All async disk service threads have been shut down
2020-04-02 05:08:56,583 [main] INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(176)) - Shutting down all async lazy persist service threads
2020-04-02 05:08:56,584 [main] INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(183)) - All async lazy persist service threads have been shut down
2020-04-02 05:08:56,602 [main] INFO  datanode.DataNode (DataNode.java:shutdown(2159)) - Shutdown complete.
2020-04-02 05:08:56,602 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNode(2046)) - Shutting down DataNode 3
2020-04-02 05:08:56,603 [main] INFO  datanode.DataNode (DataNode.java:shutdown(1991)) - [msx-restart] DataNode 46021 stop, double check before stop, dfs.namenode.fs-limits.max-directory-items = 1048576
2020-04-02 05:08:56,603 [main] WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(342)) - DirectoryScanner: shutdown has been called
2020-04-02 05:08:56,603 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2cab9998] INFO  datanode.DataNode (DataXceiverServer.java:closeAllPeers(281)) - Closing all peers.
2020-04-02 05:08:56,607 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8)] INFO  datanode.VolumeScanner (VolumeScanner.java:run(642)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8, DS-29df15fa-b2ca-4eca-89df-87135d5e3b76) exiting.
2020-04-02 05:08:56,609 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7)] INFO  datanode.VolumeScanner (VolumeScanner.java:run(642)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7, DS-5c89c444-bfe7-419f-ac0f-9469edc2d98e) exiting.
2020-04-02 05:08:56,769 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@1fc0053e{/,null,UNAVAILABLE}{/datanode}
2020-04-02 05:08:56,770 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@290b1b2e{HTTP/1.1,[http/1.1]}{localhost:0}
2020-04-02 05:08:56,771 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@664a9613{/static,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,UNAVAILABLE}
2020-04-02 05:08:56,771 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@285d851a{/logs,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,UNAVAILABLE}
2020-04-02 05:08:56,774 [main] INFO  ipc.Server (Server.java:stop(3077)) - Stopping server on 46021
2020-04-02 05:08:56,775 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1315)) - Stopping IPC Server Responder
2020-04-02 05:08:56,775 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] WARN  datanode.IncrementalBlockReportManager (IncrementalBlockReportManager.java:waitTillNextIBR(160)) - IncrementalBlockReportManager interrupted
2020-04-02 05:08:56,806 [IPC Server listener on 46021] INFO  ipc.Server (Server.java:run(1181)) - Stopping IPC Server listener on 46021
2020-04-02 05:08:56,806 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] WARN  datanode.DataNode (BPServiceActor.java:run(853)) - Ending block pool service for: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:56,807 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BlockPoolManager.java:remove(102)) - Removed Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 5207c5c0-37c7-443f-94c4-771a605480e4)
2020-04-02 05:08:56,807 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2802)) - Removing block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:56,819 [refreshUsed-/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data7/current/BP-1786648874-172.17.0.4-1585804085136] WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2020-04-02 05:08:56,866 [refreshUsed-/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data8/current/BP-1786648874-172.17.0.4-1585804085136] WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2020-04-02 05:08:56,866 [main] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(192)) - Shutting down all async disk service threads
2020-04-02 05:08:56,866 [main] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(200)) - All async disk service threads have been shut down
2020-04-02 05:08:56,871 [main] INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(176)) - Shutting down all async lazy persist service threads
2020-04-02 05:08:56,871 [main] INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(183)) - All async lazy persist service threads have been shut down
2020-04-02 05:08:56,875 [main] INFO  datanode.DataNode (DataNode.java:shutdown(2159)) - Shutdown complete.
2020-04-02 05:08:56,875 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNode(2046)) - Shutting down DataNode 2
2020-04-02 05:08:56,875 [main] INFO  datanode.DataNode (DataNode.java:shutdown(1991)) - [msx-restart] DataNode 32993 stop, double check before stop, dfs.namenode.fs-limits.max-directory-items = 1048576
2020-04-02 05:08:56,876 [main] WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(342)) - DirectoryScanner: shutdown has been called
2020-04-02 05:08:56,876 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@5fd62371] INFO  datanode.DataNode (DataXceiverServer.java:closeAllPeers(281)) - Closing all peers.
2020-04-02 05:08:56,880 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6)] INFO  datanode.VolumeScanner (VolumeScanner.java:run(642)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6, DS-9396c1fd-c034-40b5-99a4-7728fe5d066f) exiting.
2020-04-02 05:08:56,882 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5)] INFO  datanode.VolumeScanner (VolumeScanner.java:run(642)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5, DS-d7ddb67d-f628-4ac8-b6b5-d065734157f3) exiting.
2020-04-02 05:08:56,968 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@31024624{/,null,UNAVAILABLE}{/datanode}
2020-04-02 05:08:56,970 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@25bcd0c7{HTTP/1.1,[http/1.1]}{localhost:0}
2020-04-02 05:08:56,970 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@1568159{/static,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,UNAVAILABLE}
2020-04-02 05:08:56,971 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@6b5966e1{/logs,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,UNAVAILABLE}
2020-04-02 05:08:56,973 [main] INFO  ipc.Server (Server.java:stop(3077)) - Stopping server on 32993
2020-04-02 05:08:56,974 [DataXceiver for client DFSClient_NONMAPREDUCE_-96199515_1 at /127.0.0.1:40616 [Waiting for operation #2]] DEBUG datanode.DataNode (DataXceiver.java:run(325)) - 127.0.0.1:44971:Number of active connections is: 0
2020-04-02 05:08:56,999 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1315)) - Stopping IPC Server Responder
2020-04-02 05:08:57,002 [IPC Server listener on 32993] INFO  ipc.Server (Server.java:run(1181)) - Stopping IPC Server listener on 32993
2020-04-02 05:08:57,005 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] WARN  datanode.IncrementalBlockReportManager (IncrementalBlockReportManager.java:waitTillNextIBR(160)) - IncrementalBlockReportManager interrupted
2020-04-02 05:08:57,006 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] WARN  datanode.DataNode (BPServiceActor.java:run(853)) - Ending block pool service for: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5) service to localhost/127.0.0.1:35215
2020-04-02 05:08:57,006 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BlockPoolManager.java:remove(102)) - Removed Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 519e1267-21af-4106-9b82-32175ae0f5c5)
2020-04-02 05:08:57,006 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2802)) - Removing block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:57,023 [refreshUsed-/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data5/current/BP-1786648874-172.17.0.4-1585804085136] WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2020-04-02 05:08:57,037 [refreshUsed-/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data6/current/BP-1786648874-172.17.0.4-1585804085136] WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2020-04-02 05:08:57,039 [main] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(192)) - Shutting down all async disk service threads
2020-04-02 05:08:57,039 [main] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(200)) - All async disk service threads have been shut down
2020-04-02 05:08:57,042 [main] INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(176)) - Shutting down all async lazy persist service threads
2020-04-02 05:08:57,042 [main] INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(183)) - All async lazy persist service threads have been shut down
2020-04-02 05:08:57,054 [main] INFO  datanode.DataNode (DataNode.java:shutdown(2159)) - Shutdown complete.
2020-04-02 05:08:57,054 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNode(2046)) - Shutting down DataNode 1
2020-04-02 05:08:57,054 [main] INFO  datanode.DataNode (DataNode.java:shutdown(1991)) - [msx-restart] DataNode 42719 stop, double check before stop, dfs.namenode.fs-limits.max-directory-items = 1048576
2020-04-02 05:08:57,054 [main] WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(342)) - DirectoryScanner: shutdown has been called
2020-04-02 05:08:57,055 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4)] INFO  datanode.VolumeScanner (VolumeScanner.java:run(642)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4, DS-5ce71111-7ef9-40e4-bd53-df33411df409) exiting.
2020-04-02 05:08:57,056 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3)] INFO  datanode.VolumeScanner (VolumeScanner.java:run(642)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3, DS-9e64160f-8239-40bc-b495-871e2ebb5a3a) exiting.
2020-04-02 05:08:57,058 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@4a9f80d3] INFO  datanode.DataNode (DataXceiverServer.java:closeAllPeers(281)) - Closing all peers.
2020-04-02 05:08:57,194 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@6d1d4d7{/,null,UNAVAILABLE}{/datanode}
2020-04-02 05:08:57,199 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@89ff02e{HTTP/1.1,[http/1.1]}{localhost:0}
2020-04-02 05:08:57,208 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@63c5efee{/static,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,UNAVAILABLE}
2020-04-02 05:08:57,208 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@9635fa{/logs,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,UNAVAILABLE}
2020-04-02 05:08:57,283 [main] INFO  ipc.Server (Server.java:stop(3077)) - Stopping server on 42719
2020-04-02 05:08:57,287 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] WARN  datanode.IncrementalBlockReportManager (IncrementalBlockReportManager.java:waitTillNextIBR(160)) - IncrementalBlockReportManager interrupted
2020-04-02 05:08:57,287 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] WARN  datanode.DataNode (BPServiceActor.java:run(853)) - Ending block pool service for: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4) service to localhost/127.0.0.1:35215
2020-04-02 05:08:57,287 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BlockPoolManager.java:remove(102)) - Removed Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid 9f995bb1-2fd4-4f14-8b46-5bf9da7a61a4)
2020-04-02 05:08:57,288 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2802)) - Removing block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:57,298 [IPC Server listener on 42719] INFO  ipc.Server (Server.java:run(1181)) - Stopping IPC Server listener on 42719
2020-04-02 05:08:57,306 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1315)) - Stopping IPC Server Responder
2020-04-02 05:08:57,333 [refreshUsed-/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data3/current/BP-1786648874-172.17.0.4-1585804085136] WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2020-04-02 05:08:57,346 [refreshUsed-/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data4/current/BP-1786648874-172.17.0.4-1585804085136] WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2020-04-02 05:08:57,346 [main] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(192)) - Shutting down all async disk service threads
2020-04-02 05:08:57,354 [main] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(200)) - All async disk service threads have been shut down
2020-04-02 05:08:57,357 [main] INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(176)) - Shutting down all async lazy persist service threads
2020-04-02 05:08:57,365 [main] INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(183)) - All async lazy persist service threads have been shut down
2020-04-02 05:08:57,386 [main] INFO  datanode.DataNode (DataNode.java:shutdown(2159)) - Shutdown complete.
2020-04-02 05:08:57,387 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:shutdownDataNode(2046)) - Shutting down DataNode 0
2020-04-02 05:08:57,387 [main] INFO  datanode.DataNode (DataNode.java:shutdown(1991)) - [msx-restart] DataNode 43422 stop, double check before stop, dfs.namenode.fs-limits.max-directory-items = 1048576
2020-04-02 05:08:57,387 [main] WARN  datanode.DirectoryScanner (DirectoryScanner.java:shutdown(342)) - DirectoryScanner: shutdown has been called
2020-04-02 05:08:57,387 [org.apache.hadoop.hdfs.server.datanode.DataXceiverServer@2a2c13a8] INFO  datanode.DataNode (DataXceiverServer.java:closeAllPeers(281)) - Closing all peers.
2020-04-02 05:08:57,394 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1)] INFO  datanode.VolumeScanner (VolumeScanner.java:run(642)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1, DS-2d1f4083-d7c8-4136-8351-6f589a4451bd) exiting.
2020-04-02 05:08:57,395 [VolumeScannerThread(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2)] INFO  datanode.VolumeScanner (VolumeScanner.java:run(642)) - VolumeScanner(/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2, DS-089629a9-5898-4562-bd81-79a4f45c96c1) exiting.
2020-04-02 05:08:57,504 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@7b8233cd{/,null,UNAVAILABLE}{/datanode}
2020-04-02 05:08:58,286 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@4b20ca2b{HTTP/1.1,[http/1.1]}{localhost:0}
2020-04-02 05:08:58,287 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@488eb7f2{/static,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,UNAVAILABLE}
2020-04-02 05:08:58,288 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@1021f6c9{/logs,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,UNAVAILABLE}
2020-04-02 05:08:58,299 [main] INFO  ipc.Server (Server.java:stop(3077)) - Stopping server on 43422
2020-04-02 05:08:58,316 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1315)) - Stopping IPC Server Responder
2020-04-02 05:08:58,316 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] WARN  datanode.IncrementalBlockReportManager (IncrementalBlockReportManager.java:waitTillNextIBR(160)) - IncrementalBlockReportManager interrupted
2020-04-02 05:08:58,316 [IPC Server listener on 43422] INFO  ipc.Server (Server.java:run(1181)) - Stopping IPC Server listener on 43422
2020-04-02 05:08:58,317 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] WARN  datanode.DataNode (BPServiceActor.java:run(853)) - Ending block pool service for: Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3) service to localhost/127.0.0.1:35215
2020-04-02 05:08:58,317 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  datanode.DataNode (BlockPoolManager.java:remove(102)) - Removed Block pool BP-1786648874-172.17.0.4-1585804085136 (Datanode Uuid fa2f4855-186d-4810-9249-db4686eb92b3)
2020-04-02 05:08:58,317 [BP-1786648874-172.17.0.4-1585804085136 heartbeating to localhost/127.0.0.1:35215] INFO  impl.FsDatasetImpl (FsDatasetImpl.java:shutdownBlockPool(2802)) - Removing block pool BP-1786648874-172.17.0.4-1585804085136
2020-04-02 05:08:58,329 [refreshUsed-/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data1/current/BP-1786648874-172.17.0.4-1585804085136] WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2020-04-02 05:08:58,357 [refreshUsed-/root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/data/data2/current/BP-1786648874-172.17.0.4-1585804085136] WARN  fs.CachingGetSpaceUsed (CachingGetSpaceUsed.java:run(183)) - Thread Interrupted waiting to refresh disk information: sleep interrupted
2020-04-02 05:08:58,362 [RedundancyMonitor] DEBUG BlockStateChange (BlockManager.java:computeReconstructionWorkForBlocks(1900)) - BLOCK* neededReconstruction = 0 pendingReconstruction = 0
2020-04-02 05:08:58,366 [main] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(192)) - Shutting down all async disk service threads
2020-04-02 05:08:58,366 [main] INFO  impl.FsDatasetAsyncDiskService (FsDatasetAsyncDiskService.java:shutdown(200)) - All async disk service threads have been shut down
2020-04-02 05:08:58,369 [main] INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(176)) - Shutting down all async lazy persist service threads
2020-04-02 05:08:58,369 [main] INFO  impl.RamDiskAsyncLazyPersistService (RamDiskAsyncLazyPersistService.java:shutdown(183)) - All async lazy persist service threads have been shut down
2020-04-02 05:08:58,378 [main] INFO  datanode.DataNode (DataNode.java:shutdown(2159)) - Shutdown complete.
2020-04-02 05:08:58,378 [main] INFO  hdfs.MiniDFSCluster (MiniDFSCluster.java:stopAndJoinNameNode(2079)) - Shutting down the namenode
2020-04-02 05:08:58,378 [main] INFO  namenode.NameNode (NameNode.java:stop(1011)) - [msx-restart] NameNode 35215 stop, double check before stop, dfs.namenode.fs-limits.max-directory-items = 1048576
2020-04-02 05:08:58,378 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1323)) - Stopping services started for active state
2020-04-02 05:08:58,379 [org.apache.hadoop.hdfs.server.namenode.LeaseManager$Monitor@2cc3ad05] DEBUG namenode.LeaseManager (LeaseManager.java:run(536)) - Monitor is interrupted
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at org.apache.hadoop.hdfs.server.namenode.LeaseManager$Monitor.run(LeaseManager.java:534)
	at java.lang.Thread.run(Thread.java:748)
2020-04-02 05:08:58,380 [main] INFO  namenode.FSEditLog (FSEditLog.java:endCurrentLogSegment(1406)) - Ending log segment 1, 252
2020-04-02 05:08:58,380 [org.apache.hadoop.hdfs.server.namenode.FSNamesystem$NameNodeEditLogRoller@119020fb] INFO  namenode.FSNamesystem (FSNamesystem.java:run(4018)) - NameNodeEditLogRoller was interrupted, exiting
2020-04-02 05:08:58,380 [org.apache.hadoop.hdfs.server.namenode.FSNamesystem$LazyPersistFileScrubber@3d9f6567] INFO  namenode.FSNamesystem (FSNamesystem.java:run(4109)) - LazyPersistFileScrubber was interrupted, exiting
2020-04-02 05:08:58,381 [main] INFO  namenode.FSEditLog (FSEditLog.java:printStatistics(774)) - Number of transactions: 253 Total time for transactions(ms): 47 Number of transactions batched in Syncs: 40 Number of syncs: 214 SyncTimes(ms): 13 5 
2020-04-02 05:08:58,383 [main] INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(143)) - Finalizing edits file /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/edits_inprogress_0000000000000000001 -> /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-1/current/edits_0000000000000000001-0000000000000000253
2020-04-02 05:08:58,384 [main] INFO  namenode.FileJournalManager (FileJournalManager.java:finalizeLogSegment(143)) - Finalizing edits file /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/current/edits_inprogress_0000000000000000001 -> /root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/test/data/dfs/name-0-2/current/edits_0000000000000000001-0000000000000000253
2020-04-02 05:08:58,384 [FSEditLogAsync] INFO  namenode.FSEditLog (FSEditLogAsync.java:run(253)) - FSEditLogAsync was interrupted, exiting
2020-04-02 05:08:58,385 [CacheReplicationMonitor(84970957)] INFO  blockmanagement.CacheReplicationMonitor (CacheReplicationMonitor.java:run(169)) - Shutting down CacheReplicationMonitor
2020-04-02 05:08:58,386 [main] INFO  ipc.Server (Server.java:stop(3077)) - Stopping server on 35215
2020-04-02 05:08:58,386 [IPC Server listener on 35215] INFO  ipc.Server (Server.java:run(1181)) - Stopping IPC Server listener on 35215
2020-04-02 05:08:58,399 [StorageInfoMonitor] INFO  blockmanagement.BlockManager (BlockManager.java:run(4592)) - Stopping thread.
2020-04-02 05:08:58,399 [RedundancyMonitor] INFO  blockmanagement.BlockManager (BlockManager.java:run(4557)) - Stopping RedundancyMonitor.
2020-04-02 05:08:58,402 [org.apache.hadoop.hdfs.server.blockmanagement.PendingReconstructionBlocks$PendingReconstructionMonitor@6b53bcc2] DEBUG blockmanagement.BlockManager (PendingReconstructionBlocks.java:run(248)) - PendingReconstructionMonitor thread is interrupted.
java.lang.InterruptedException: sleep interrupted
	at java.lang.Thread.sleep(Native Method)
	at org.apache.hadoop.hdfs.server.blockmanagement.PendingReconstructionBlocks$PendingReconstructionMonitor.run(PendingReconstructionBlocks.java:246)
	at java.lang.Thread.run(Thread.java:748)
2020-04-02 05:08:58,406 [IPC Server Responder] INFO  ipc.Server (Server.java:run(1315)) - Stopping IPC Server Responder
2020-04-02 05:08:58,461 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:stopActiveServices(1323)) - Stopping services started for active state
2020-04-02 05:08:58,462 [main] INFO  namenode.FSNamesystem (FSNamesystem.java:stopStandbyServices(1419)) - Stopping services started for standby state
2020-04-02 05:08:58,464 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.w.WebAppContext@766653e6{/,null,UNAVAILABLE}{/hdfs}
2020-04-02 05:08:58,483 [main] INFO  server.AbstractConnector (AbstractConnector.java:doStop(318)) - Stopped ServerConnector@5a37d3ed{HTTP/1.1,[http/1.1]}{localhost:0}
2020-04-02 05:08:58,544 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@13d73f29{/static,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/src/main/webapps/static/,UNAVAILABLE}
2020-04-02 05:08:58,544 [main] INFO  handler.ContextHandler (ContextHandler.java:doStop(910)) - Stopped o.e.j.s.ServletContextHandler@9816741{/logs,file:///root/hadoop-3.1.2-src/hadoop-hdfs-project/hadoop-hdfs/target/log/,UNAVAILABLE}
2020-04-02 05:08:58,553 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(210)) - Stopping DataNode metrics system...
2020-04-02 05:08:58,590 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:stop(216)) - DataNode metrics system stopped.
2020-04-02 05:08:58,591 [main] INFO  impl.MetricsSystemImpl (MetricsSystemImpl.java:shutdown(607)) - DataNode metrics system shutdown complete.
[msx] all testRunFinished
