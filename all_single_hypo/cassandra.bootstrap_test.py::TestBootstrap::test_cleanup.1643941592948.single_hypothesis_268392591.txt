my_type=hypothesis
proj=cassandra
u_test=bootstrap_test.py::TestBootstrap::test_cleanup
h_list[1]=periodic_commitlog_sync_lag_block_in_ms@@@CassandraDaemon@@@-1@@@null@@@5000
proj: cassandra
u_test: bootstrap_test.py::TestBootstrap::test_cleanup
h_list: periodic_commitlog_sync_lag_block_in_ms@@@CassandraDaemon@@@-1@@@null@@@5000
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup 
-------------------------------- live log call ---------------------------------
02:54:46,149 bootstrap_test ERROR ---
02:54:46,153 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-16-big-Data.db
02:54:46,153 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-22-big-Data.db
02:54:46,154 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-10-big-Data.db
02:54:46,155 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-25-big-Data.db
02:54:46,155 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-28-big-Data.db
02:54:46,156 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-4-big-Data.db
02:54:46,157 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-7-big-Data.db
02:54:46,158 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-13-big-Data.db
02:54:46,159 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-19-big-Data.db
02:54:46,161 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-1-big-Data.db
02:54:46,162 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-23-big-Data.db
02:54:46,162 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-32-big-Data.db
02:54:46,163 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-29-big-Data.db
02:54:46,164 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-11-big-Data.db
02:54:46,164 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-26-big-Data.db
02:54:46,165 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-20-big-Data.db
02:54:46,165 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-2-big-Data.db
02:54:46,166 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-14-big-Data.db
02:54:46,167 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-31-big-Data.db
02:54:46,167 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-5-big-Data.db
02:54:46,168 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-17-big-Data.db
02:54:46,168 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-8-big-Data.db
02:54:46,169 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-9-big-Data.db
02:54:46,170 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-18-big-Data.db
02:54:46,170 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-6-big-Data.db
02:54:46,171 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-24-big-Data.db
02:54:46,172 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-12-big-Data.db
02:54:46,172 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-30-big-Data.db
02:54:46,173 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-3-big-Data.db
02:54:46,173 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-15-big-Data.db
02:54:46,173 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-21-big-Data.db
02:54:46,174 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-27-big-Data.db
02:54:46,174 bootstrap_test ERROR Current count is 32, basecount was 30
FAILED                                                                   [100%]

=================================== FAILURES ===================================
__________________________ TestBootstrap.test_cleanup __________________________

self = <bootstrap_test.TestBootstrap object at 0x7f2aac37be10>

    def test_cleanup(self):
        """
            @jira_ticket CASSANDRA-11179
            Make sure we remove processed files during cleanup
            """
        cluster = self.cluster
        cluster.set_environment_variable('CASSANDRA_TOKEN_PREGENERATION_DISABLED', 'True')
        cluster.set_configuration_options(values={'concurrent_compactors': 4})
        cluster.populate(1)
        cluster.start()
        node1, = cluster.nodelist()
        for x in range(0, 5):
            node1.stress(['write', 'n=100k', 'no-warmup', '-schema', 'compaction(strategy=SizeTieredCompactionStrategy,enabled=false)', 'replication(factor=1)', '-rate', 'threads=10'])
            node1.flush()
        node2 = new_node(cluster)
        node2.start(wait_for_binary_proto=True)
        event = threading.Event()
        failed = threading.Event()
        jobs = 1
        thread = threading.Thread(target=self._monitor_datadir, args=(node1, event, len(node1.get_sstables("keyspace1", "standard1")), jobs, failed))
        thread.setDaemon(True)
        thread.start()
        node1.nodetool("cleanup -j {} keyspace1 standard1".format(jobs))
        event.set()
        thread.join()
>       assert not failed.is_set()
E       assert not True
E        +  where True = <bound method Event.is_set of <threading.Event object at 0x7f2aac355630>>()
E        +    where <bound method Event.is_set of <threading.Event object at 0x7f2aac355630>> = <threading.Event object at 0x7f2aac355630>.is_set

bootstrap_test.py:915: AssertionError
---------------------------- Captured stdout setup -----------------------------
2:51:27,893 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
02:51:27,629 conftest INFO Starting execution of test_cleanup at 2022-02-04 02:51:27.629593
02:51:27,794 dtest_setup INFO cluster ccm directory: /tmp/dtest-_lnqid7h
------------------------------ Captured log call -------------------------------
02:51:28,737 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_lnqid7h/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_lnqid7h/test/node1/conf'}
02:51:28,738 ccm INFO node1: using Java 8 for the current invocation
02:51:28,972 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_lnqid7h/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_lnqid7h/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'CASSANDRA_TOKEN_PREGENERATION_DISABLED': 'True', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
02:51:28,973 ccm INFO node1: using Java 8 for the current invocation
02:51:29,139 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
02:52:04,808 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_lnqid7h/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_lnqid7h/test/node1/conf'}
02:52:04,809 ccm INFO node1: using Java 8 for the current invocation
02:52:21,257 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_lnqid7h/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_lnqid7h/test/node1/conf'}
02:52:21,258 ccm INFO node1: using Java 8 for the current invocation
02:52:41,592 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_lnqid7h/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_lnqid7h/test/node1/conf'}
02:52:41,593 ccm INFO node1: using Java 8 for the current invocation
02:53:01,444 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_lnqid7h/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_lnqid7h/test/node1/conf'}
02:53:01,445 ccm INFO node1: using Java 8 for the current invocation
02:53:15,850 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_lnqid7h/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_lnqid7h/test/node1/conf'}
02:53:15,851 ccm INFO node1: using Java 8 for the current invocation
02:53:18,726 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_lnqid7h/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_lnqid7h/test/node2/conf'}
02:53:18,727 ccm INFO node2: using Java 8 for the current invocation
02:53:18,911 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_lnqid7h/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_lnqid7h/test/node2/conf', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=4'}
02:53:18,912 ccm INFO node2: using Java 8 for the current invocation
02:53:18,992 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
02:54:43,880 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_lnqid7h/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_lnqid7h/test/node1/conf'}
02:54:43,882 ccm INFO node1: using Java 8 for the current invocation
02:54:46,149 bootstrap_test ERROR ---
02:54:46,153 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-16-big-Data.db
02:54:46,153 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-22-big-Data.db
02:54:46,154 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-10-big-Data.db
02:54:46,155 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-25-big-Data.db
02:54:46,155 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-28-big-Data.db
02:54:46,156 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-4-big-Data.db
02:54:46,157 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-7-big-Data.db
02:54:46,158 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-13-big-Data.db
02:54:46,159 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-19-big-Data.db
02:54:46,161 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data0/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-1-big-Data.db
02:54:46,162 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-23-big-Data.db
02:54:46,162 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-32-big-Data.db
02:54:46,163 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-29-big-Data.db
02:54:46,164 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-11-big-Data.db
02:54:46,164 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-26-big-Data.db
02:54:46,165 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-20-big-Data.db
02:54:46,165 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-2-big-Data.db
02:54:46,166 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-14-big-Data.db
02:54:46,167 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-31-big-Data.db
02:54:46,167 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-5-big-Data.db
02:54:46,168 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-17-big-Data.db
02:54:46,168 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data1/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-8-big-Data.db
02:54:46,169 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-9-big-Data.db
02:54:46,170 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-18-big-Data.db
02:54:46,170 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-6-big-Data.db
02:54:46,171 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-24-big-Data.db
02:54:46,172 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-12-big-Data.db
02:54:46,172 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-30-big-Data.db
02:54:46,173 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-3-big-Data.db
02:54:46,173 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-15-big-Data.db
02:54:46,173 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-21-big-Data.db
02:54:46,174 bootstrap_test ERROR /tmp/dtest-_lnqid7h/test/node1/data2/keyspace1/standard1-636fdfb0856511ec9714ebff6af54ead/nb-27-big-Data.db
02:54:46,174 bootstrap_test ERROR Current count is 32, basecount was 30
--------------------------- Captured stdout teardown ---------------------------
02:54:49,580 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_cleanup failed and was not selected for rerun.
	<class 'AssertionError'>
	assert not True
 +  where True = <bound method Event.is_set of <threading.Event object at 0x7f2aac355630>>()
 +    where <bound method Event.is_set of <threading.Event object at 0x7f2aac355630>> = <threading.Event object at 0x7f2aac355630>.is_set
	[<TracebackEntry /root/cassandra-dtest/bootstrap_test.py:915>]

===End Flaky Test Report===
========================== 1 failed in 202.79 seconds ==========================
[msx] rc = 1
v1v2 running time = 224702704779
---> v1v2 test failed.
proj: cassandra
u_test: bootstrap_test.py::TestBootstrap::test_cleanup
h_list: periodic_commitlog_sync_lag_block_in_ms@@@CassandraDaemon@@@-1@@@null@@@5000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 175.85 seconds ==========================
[msx] rc = 0
v1v1 running time = 197636140563
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 206.21 seconds ==========================
[msx] rc = 0
v2v2 running time = 227961073861
---> v1v1 and v2v2 test test suceeded.
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup 
-------------------------------- live log call ---------------------------------
03:05:36,373 bootstrap_test ERROR ---
03:05:36,376 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-16-big-Data.db
03:05:36,376 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-22-big-Data.db
03:05:36,377 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-10-big-Data.db
03:05:36,377 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-25-big-Data.db
03:05:36,378 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-28-big-Data.db
03:05:36,378 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-4-big-Data.db
03:05:36,379 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-7-big-Data.db
03:05:36,379 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-13-big-Data.db
03:05:36,379 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-19-big-Data.db
03:05:36,380 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-1-big-Data.db
03:05:36,380 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-23-big-Data.db
03:05:36,381 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-32-big-Data.db
03:05:36,381 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-29-big-Data.db
03:05:36,382 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-11-big-Data.db
03:05:36,382 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-26-big-Data.db
03:05:36,384 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-20-big-Data.db
03:05:36,385 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-2-big-Data.db
03:05:36,385 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-14-big-Data.db
03:05:36,386 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-31-big-Data.db
03:05:36,387 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-5-big-Data.db
03:05:36,388 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-17-big-Data.db
03:05:36,389 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-8-big-Data.db
03:05:36,389 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-9-big-Data.db
03:05:36,390 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-18-big-Data.db
03:05:36,391 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-6-big-Data.db
03:05:36,391 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-24-big-Data.db
03:05:36,392 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-12-big-Data.db
03:05:36,392 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-30-big-Data.db
03:05:36,392 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-3-big-Data.db
03:05:36,392 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-15-big-Data.db
03:05:36,393 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-21-big-Data.db
03:05:36,394 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-27-big-Data.db
03:05:36,395 bootstrap_test ERROR Current count is 32, basecount was 30
FAILED                                                                   [100%]

=================================== FAILURES ===================================
__________________________ TestBootstrap.test_cleanup __________________________

self = <bootstrap_test.TestBootstrap object at 0x7fd5eb680f98>

    def test_cleanup(self):
        """
            @jira_ticket CASSANDRA-11179
            Make sure we remove processed files during cleanup
            """
        cluster = self.cluster
        cluster.set_environment_variable('CASSANDRA_TOKEN_PREGENERATION_DISABLED', 'True')
        cluster.set_configuration_options(values={'concurrent_compactors': 4})
        cluster.populate(1)
        cluster.start()
        node1, = cluster.nodelist()
        for x in range(0, 5):
            node1.stress(['write', 'n=100k', 'no-warmup', '-schema', 'compaction(strategy=SizeTieredCompactionStrategy,enabled=false)', 'replication(factor=1)', '-rate', 'threads=10'])
            node1.flush()
        node2 = new_node(cluster)
        node2.start(wait_for_binary_proto=True)
        event = threading.Event()
        failed = threading.Event()
        jobs = 1
        thread = threading.Thread(target=self._monitor_datadir, args=(node1, event, len(node1.get_sstables("keyspace1", "standard1")), jobs, failed))
        thread.setDaemon(True)
        thread.start()
        node1.nodetool("cleanup -j {} keyspace1 standard1".format(jobs))
        event.set()
        thread.join()
>       assert not failed.is_set()
E       assert not True
E        +  where True = <bound method Event.is_set of <threading.Event object at 0x7fd5eb66d668>>()
E        +    where <bound method Event.is_set of <threading.Event object at 0x7fd5eb66d668>> = <threading.Event object at 0x7fd5eb66d668>.is_set

bootstrap_test.py:915: AssertionError
---------------------------- Captured stdout setup -----------------------------
03:02:18,100 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
03:02:17,791 conftest INFO Starting execution of test_cleanup at 2022-02-04 03:02:17.791562
03:02:17,954 dtest_setup INFO cluster ccm directory: /tmp/dtest-8kqsm75d
------------------------------ Captured log call -------------------------------
03:02:18,987 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8kqsm75d/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8kqsm75d/test/node1/conf'}
03:02:18,988 ccm INFO node1: using Java 8 for the current invocation
03:02:19,211 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8kqsm75d/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8kqsm75d/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'CASSANDRA_TOKEN_PREGENERATION_DISABLED': 'True', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
03:02:19,212 ccm INFO node1: using Java 8 for the current invocation
03:02:19,339 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
03:02:48,821 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8kqsm75d/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8kqsm75d/test/node1/conf'}
03:02:48,822 ccm INFO node1: using Java 8 for the current invocation
03:03:09,829 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8kqsm75d/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8kqsm75d/test/node1/conf'}
03:03:09,830 ccm INFO node1: using Java 8 for the current invocation
03:03:30,326 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8kqsm75d/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8kqsm75d/test/node1/conf'}
03:03:30,327 ccm INFO node1: using Java 8 for the current invocation
03:03:50,314 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8kqsm75d/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8kqsm75d/test/node1/conf'}
03:03:50,315 ccm INFO node1: using Java 8 for the current invocation
03:04:10,402 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8kqsm75d/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8kqsm75d/test/node1/conf'}
03:04:10,404 ccm INFO node1: using Java 8 for the current invocation
03:04:13,78 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8kqsm75d/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8kqsm75d/test/node2/conf'}
03:04:13,80 ccm INFO node2: using Java 8 for the current invocation
03:04:13,298 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8kqsm75d/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8kqsm75d/test/node2/conf', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=4'}
03:04:13,299 ccm INFO node2: using Java 8 for the current invocation
03:04:13,412 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
03:05:34,282 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8kqsm75d/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8kqsm75d/test/node1/conf'}
03:05:34,283 ccm INFO node1: using Java 8 for the current invocation
03:05:36,373 bootstrap_test ERROR ---
03:05:36,376 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-16-big-Data.db
03:05:36,376 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-22-big-Data.db
03:05:36,377 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-10-big-Data.db
03:05:36,377 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-25-big-Data.db
03:05:36,378 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-28-big-Data.db
03:05:36,378 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-4-big-Data.db
03:05:36,379 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-7-big-Data.db
03:05:36,379 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-13-big-Data.db
03:05:36,379 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-19-big-Data.db
03:05:36,380 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data0/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-1-big-Data.db
03:05:36,380 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-23-big-Data.db
03:05:36,381 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-32-big-Data.db
03:05:36,381 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-29-big-Data.db
03:05:36,382 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-11-big-Data.db
03:05:36,382 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-26-big-Data.db
03:05:36,384 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-20-big-Data.db
03:05:36,385 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-2-big-Data.db
03:05:36,385 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-14-big-Data.db
03:05:36,386 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-31-big-Data.db
03:05:36,387 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-5-big-Data.db
03:05:36,388 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-17-big-Data.db
03:05:36,389 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data1/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-8-big-Data.db
03:05:36,389 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-9-big-Data.db
03:05:36,390 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-18-big-Data.db
03:05:36,391 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-6-big-Data.db
03:05:36,391 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-24-big-Data.db
03:05:36,392 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-12-big-Data.db
03:05:36,392 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-30-big-Data.db
03:05:36,392 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-3-big-Data.db
03:05:36,392 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-15-big-Data.db
03:05:36,393 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-21-big-Data.db
03:05:36,394 bootstrap_test ERROR /tmp/dtest-8kqsm75d/test/node1/data2/keyspace1/standard1-e542a030856611ec99ac53bdcc4b6417/nb-27-big-Data.db
03:05:36,395 bootstrap_test ERROR Current count is 32, basecount was 30
--------------------------- Captured stdout teardown ---------------------------
03:05:38,722 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_cleanup failed and was not selected for rerun.
	<class 'AssertionError'>
	assert not True
 +  where True = <bound method Event.is_set of <threading.Event object at 0x7fd5eb66d668>>()
 +    where <bound method Event.is_set of <threading.Event object at 0x7fd5eb66d668>> = <threading.Event object at 0x7fd5eb66d668>.is_set
	[<TracebackEntry /root/cassandra-dtest/bootstrap_test.py:915>]

===End Flaky Test Report===
========================== 1 failed in 201.73 seconds ==========================
[msx] rc = 1
v1v2 running time = 223532217305
---> v1v2 test failed.
proj: cassandra
u_test: bootstrap_test.py::TestBootstrap::test_cleanup
h_list: periodic_commitlog_sync_lag_block_in_ms@@@CassandraDaemon@@@-1@@@null@@@5000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 174.07 seconds ==========================
[msx] rc = 0
v1v1 running time = 195842154718
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup 
-------------------------------- live log call ---------------------------------
03:12:45,917 bootstrap_test ERROR ---
03:12:45,920 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-16-big-Data.db
03:12:45,920 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-22-big-Data.db
03:12:45,921 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-10-big-Data.db
03:12:45,922 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-25-big-Data.db
03:12:45,922 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-28-big-Data.db
03:12:45,923 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-4-big-Data.db
03:12:45,924 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-7-big-Data.db
03:12:45,924 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-13-big-Data.db
03:12:45,925 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-19-big-Data.db
03:12:45,926 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-1-big-Data.db
03:12:45,926 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-23-big-Data.db
03:12:45,927 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-32-big-Data.db
03:12:45,928 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-29-big-Data.db
03:12:45,928 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-11-big-Data.db
03:12:45,929 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-26-big-Data.db
03:12:45,930 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-20-big-Data.db
03:12:45,931 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-2-big-Data.db
03:12:45,931 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-14-big-Data.db
03:12:45,932 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-31-big-Data.db
03:12:45,933 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-5-big-Data.db
03:12:45,934 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-17-big-Data.db
03:12:45,935 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-8-big-Data.db
03:12:45,936 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-9-big-Data.db
03:12:45,936 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-18-big-Data.db
03:12:45,937 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-6-big-Data.db
03:12:45,938 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-24-big-Data.db
03:12:45,938 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-12-big-Data.db
03:12:45,939 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-30-big-Data.db
03:12:45,939 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-3-big-Data.db
03:12:45,940 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-15-big-Data.db
03:12:45,941 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-21-big-Data.db
03:12:45,941 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-27-big-Data.db
03:12:45,942 bootstrap_test ERROR Current count is 32, basecount was 30
FAILED                                                                   [100%]

=================================== FAILURES ===================================
__________________________ TestBootstrap.test_cleanup __________________________

self = <bootstrap_test.TestBootstrap object at 0x7f1dc5c71fd0>

    def test_cleanup(self):
        """
            @jira_ticket CASSANDRA-11179
            Make sure we remove processed files during cleanup
            """
        cluster = self.cluster
        cluster.set_environment_variable('CASSANDRA_TOKEN_PREGENERATION_DISABLED', 'True')
        cluster.set_configuration_options(values={'concurrent_compactors': 4})
        cluster.populate(1)
        cluster.start()
        node1, = cluster.nodelist()
        for x in range(0, 5):
            node1.stress(['write', 'n=100k', 'no-warmup', '-schema', 'compaction(strategy=SizeTieredCompactionStrategy,enabled=false)', 'replication(factor=1)', '-rate', 'threads=10'])
            node1.flush()
        node2 = new_node(cluster)
        node2.start(wait_for_binary_proto=True)
        event = threading.Event()
        failed = threading.Event()
        jobs = 1
        thread = threading.Thread(target=self._monitor_datadir, args=(node1, event, len(node1.get_sstables("keyspace1", "standard1")), jobs, failed))
        thread.setDaemon(True)
        thread.start()
        node1.nodetool("cleanup -j {} keyspace1 standard1".format(jobs))
        event.set()
        thread.join()
>       assert not failed.is_set()
E       assert not True
E        +  where True = <bound method Event.is_set of <threading.Event object at 0x7f1dc5c5d630>>()
E        +    where <bound method Event.is_set of <threading.Event object at 0x7f1dc5c5d630>> = <threading.Event object at 0x7f1dc5c5d630>.is_set

bootstrap_test.py:915: AssertionError
---------------------------- Captured stdout setup -----------------------------
3:09:17,516 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
03:09:17,283 conftest INFO Starting execution of test_cleanup at 2022-02-04 03:09:17.283783
03:09:17,395 dtest_setup INFO cluster ccm directory: /tmp/dtest-dft0ecvm
------------------------------ Captured log call -------------------------------
03:09:18,345 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dft0ecvm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dft0ecvm/test/node1/conf'}
03:09:18,346 ccm INFO node1: using Java 8 for the current invocation
03:09:18,590 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dft0ecvm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dft0ecvm/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'CASSANDRA_TOKEN_PREGENERATION_DISABLED': 'True', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
03:09:18,591 ccm INFO node1: using Java 8 for the current invocation
03:09:18,701 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
03:09:48,493 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dft0ecvm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dft0ecvm/test/node1/conf'}
03:09:48,493 ccm INFO node1: using Java 8 for the current invocation
03:10:08,763 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dft0ecvm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dft0ecvm/test/node1/conf'}
03:10:08,763 ccm INFO node1: using Java 8 for the current invocation
03:10:28,592 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dft0ecvm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dft0ecvm/test/node1/conf'}
03:10:28,593 ccm INFO node1: using Java 8 for the current invocation
03:10:48,564 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dft0ecvm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dft0ecvm/test/node1/conf'}
03:10:48,565 ccm INFO node1: using Java 8 for the current invocation
03:11:08,883 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dft0ecvm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dft0ecvm/test/node1/conf'}
03:11:08,884 ccm INFO node1: using Java 8 for the current invocation
03:11:11,603 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dft0ecvm/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dft0ecvm/test/node2/conf'}
03:11:11,605 ccm INFO node2: using Java 8 for the current invocation
03:11:11,832 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dft0ecvm/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dft0ecvm/test/node2/conf', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=4'}
03:11:11,833 ccm INFO node2: using Java 8 for the current invocation
03:11:11,947 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
03:12:43,844 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dft0ecvm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dft0ecvm/test/node1/conf'}
03:12:43,846 ccm INFO node1: using Java 8 for the current invocation
03:12:45,917 bootstrap_test ERROR ---
03:12:45,920 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-16-big-Data.db
03:12:45,920 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-22-big-Data.db
03:12:45,921 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-10-big-Data.db
03:12:45,922 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-25-big-Data.db
03:12:45,922 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-28-big-Data.db
03:12:45,923 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-4-big-Data.db
03:12:45,924 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-7-big-Data.db
03:12:45,924 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-13-big-Data.db
03:12:45,925 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-19-big-Data.db
03:12:45,926 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data0/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-1-big-Data.db
03:12:45,926 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-23-big-Data.db
03:12:45,927 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-32-big-Data.db
03:12:45,928 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-29-big-Data.db
03:12:45,928 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-11-big-Data.db
03:12:45,929 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-26-big-Data.db
03:12:45,930 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-20-big-Data.db
03:12:45,931 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-2-big-Data.db
03:12:45,931 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-14-big-Data.db
03:12:45,932 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-31-big-Data.db
03:12:45,933 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-5-big-Data.db
03:12:45,934 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-17-big-Data.db
03:12:45,935 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data1/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-8-big-Data.db
03:12:45,936 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-9-big-Data.db
03:12:45,936 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-18-big-Data.db
03:12:45,937 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-6-big-Data.db
03:12:45,938 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-24-big-Data.db
03:12:45,938 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-12-big-Data.db
03:12:45,939 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-30-big-Data.db
03:12:45,939 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-3-big-Data.db
03:12:45,940 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-15-big-Data.db
03:12:45,941 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-21-big-Data.db
03:12:45,941 bootstrap_test ERROR /tmp/dtest-dft0ecvm/test/node1/data2/keyspace1/standard1-df02ef80856711eca4015dff1e6c23ad/nb-27-big-Data.db
03:12:45,942 bootstrap_test ERROR Current count is 32, basecount was 30
--------------------------- Captured stdout teardown ---------------------------
03:12:48,446 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_cleanup failed and was not selected for rerun.
	<class 'AssertionError'>
	assert not True
 +  where True = <bound method Event.is_set of <threading.Event object at 0x7f1dc5c5d630>>()
 +    where <bound method Event.is_set of <threading.Event object at 0x7f1dc5c5d630>> = <threading.Event object at 0x7f1dc5c5d630>.is_set
	[<TracebackEntry /root/cassandra-dtest/bootstrap_test.py:915>]

===End Flaky Test Report===
========================== 1 failed in 211.93 seconds ==========================
[msx] rc = 1
v2v2 running time = 233665827393
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: bootstrap_test.py::TestBootstrap::test_cleanup
h_list: periodic_commitlog_sync_lag_block_in_ms@@@CassandraDaemon@@@-1@@@null@@@5000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 197.71 seconds ==========================
[msx] rc = 0
v1v2 running time = 219534123477
---> v1v2 test suceeded.
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 177.54 seconds ==========================
[msx] rc = 0
v1v1 running time = 199383502843
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 214.01 seconds ==========================
[msx] rc = 0
v2v2 running time = 235706805508
---> v1v1 and v2v2 test test suceeded.
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 203.43 seconds ==========================
[msx] rc = 0
v1v2 running time = 225091789681
---> v1v2 test suceeded.
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 174.61 seconds ==========================
[msx] rc = 0
v1v1 running time = 196422767904
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 207.74 seconds ==========================
[msx] rc = 0
v2v2 running time = 229513332161
---> v1v1 and v2v2 test test suceeded.
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 203.38 seconds ==========================
[msx] rc = 0
v1v2 running time = 225056564363
---> v1v2 test suceeded.
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 173.60 seconds ==========================
[msx] rc = 0
v1v1 running time = 195372849879
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup 
-------------------------------- live log call ---------------------------------
03:45:24,391 bootstrap_test ERROR ---
03:45:24,392 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-16-big-Data.db
03:45:24,393 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-22-big-Data.db
03:45:24,393 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-10-big-Data.db
03:45:24,394 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-25-big-Data.db
03:45:24,394 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-28-big-Data.db
03:45:24,394 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-4-big-Data.db
03:45:24,395 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-7-big-Data.db
03:45:24,395 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-13-big-Data.db
03:45:24,396 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-19-big-Data.db
03:45:24,396 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-1-big-Data.db
03:45:24,396 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-23-big-Data.db
03:45:24,397 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-32-big-Data.db
03:45:24,397 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-29-big-Data.db
03:45:24,397 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-11-big-Data.db
03:45:24,398 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-26-big-Data.db
03:45:24,398 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-20-big-Data.db
03:45:24,398 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-2-big-Data.db
03:45:24,399 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-14-big-Data.db
03:45:24,400 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-31-big-Data.db
03:45:24,400 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-5-big-Data.db
03:45:24,401 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-17-big-Data.db
03:45:24,402 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-8-big-Data.db
03:45:24,403 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-9-big-Data.db
03:45:24,403 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-18-big-Data.db
03:45:24,404 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-6-big-Data.db
03:45:24,405 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-24-big-Data.db
03:45:24,406 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-12-big-Data.db
03:45:24,406 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-30-big-Data.db
03:45:24,407 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-3-big-Data.db
03:45:24,409 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-15-big-Data.db
03:45:24,410 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-21-big-Data.db
03:45:24,410 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-27-big-Data.db
03:45:24,411 bootstrap_test ERROR Current count is 32, basecount was 30
FAILED                                                                   [100%]

=================================== FAILURES ===================================
__________________________ TestBootstrap.test_cleanup __________________________

self = <bootstrap_test.TestBootstrap object at 0x7f06a8481f98>

    def test_cleanup(self):
        """
            @jira_ticket CASSANDRA-11179
            Make sure we remove processed files during cleanup
            """
        cluster = self.cluster
        cluster.set_environment_variable('CASSANDRA_TOKEN_PREGENERATION_DISABLED', 'True')
        cluster.set_configuration_options(values={'concurrent_compactors': 4})
        cluster.populate(1)
        cluster.start()
        node1, = cluster.nodelist()
        for x in range(0, 5):
            node1.stress(['write', 'n=100k', 'no-warmup', '-schema', 'compaction(strategy=SizeTieredCompactionStrategy,enabled=false)', 'replication(factor=1)', '-rate', 'threads=10'])
            node1.flush()
        node2 = new_node(cluster)
        node2.start(wait_for_binary_proto=True)
        event = threading.Event()
        failed = threading.Event()
        jobs = 1
        thread = threading.Thread(target=self._monitor_datadir, args=(node1, event, len(node1.get_sstables("keyspace1", "standard1")), jobs, failed))
        thread.setDaemon(True)
        thread.start()
        node1.nodetool("cleanup -j {} keyspace1 standard1".format(jobs))
        event.set()
        thread.join()
>       assert not failed.is_set()
E       assert not True
E        +  where True = <bound method Event.is_set of <threading.Event object at 0x7f06a846ca90>>()
E        +    where <bound method Event.is_set of <threading.Event object at 0x7f06a846ca90>> = <threading.Event object at 0x7f06a846ca90>.is_set

bootstrap_test.py:915: AssertionError
---------------------------- Captured stdout setup -----------------------------
3:41:57,440 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
03:41:57,107 conftest INFO Starting execution of test_cleanup at 2022-02-04 03:41:57.107230
03:41:57,265 dtest_setup INFO cluster ccm directory: /tmp/dtest-ujwn2g00
------------------------------ Captured log call -------------------------------
03:41:58,273 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ujwn2g00/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ujwn2g00/test/node1/conf'}
03:41:58,274 ccm INFO node1: using Java 8 for the current invocation
03:41:58,492 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ujwn2g00/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ujwn2g00/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'CASSANDRA_TOKEN_PREGENERATION_DISABLED': 'True', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
03:41:58,492 ccm INFO node1: using Java 8 for the current invocation
03:41:58,597 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
03:42:28,407 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ujwn2g00/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ujwn2g00/test/node1/conf'}
03:42:28,408 ccm INFO node1: using Java 8 for the current invocation
03:42:48,762 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ujwn2g00/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ujwn2g00/test/node1/conf'}
03:42:48,763 ccm INFO node1: using Java 8 for the current invocation
03:43:08,971 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ujwn2g00/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ujwn2g00/test/node1/conf'}
03:43:08,972 ccm INFO node1: using Java 8 for the current invocation
03:43:28,143 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ujwn2g00/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ujwn2g00/test/node1/conf'}
03:43:28,144 ccm INFO node1: using Java 8 for the current invocation
03:43:48,602 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ujwn2g00/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ujwn2g00/test/node1/conf'}
03:43:48,602 ccm INFO node1: using Java 8 for the current invocation
03:43:51,250 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ujwn2g00/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ujwn2g00/test/node2/conf'}
03:43:51,250 ccm INFO node2: using Java 8 for the current invocation
03:43:51,436 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ujwn2g00/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ujwn2g00/test/node2/conf', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=4'}
03:43:51,437 ccm INFO node2: using Java 8 for the current invocation
03:43:51,531 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
03:45:22,433 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ujwn2g00/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ujwn2g00/test/node1/conf'}
03:45:22,434 ccm INFO node1: using Java 8 for the current invocation
03:45:24,391 bootstrap_test ERROR ---
03:45:24,392 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-16-big-Data.db
03:45:24,393 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-22-big-Data.db
03:45:24,393 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-10-big-Data.db
03:45:24,394 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-25-big-Data.db
03:45:24,394 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-28-big-Data.db
03:45:24,394 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-4-big-Data.db
03:45:24,395 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-7-big-Data.db
03:45:24,395 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-13-big-Data.db
03:45:24,396 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-19-big-Data.db
03:45:24,396 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data0/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-1-big-Data.db
03:45:24,396 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-23-big-Data.db
03:45:24,397 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-32-big-Data.db
03:45:24,397 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-29-big-Data.db
03:45:24,397 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-11-big-Data.db
03:45:24,398 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-26-big-Data.db
03:45:24,398 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-20-big-Data.db
03:45:24,398 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-2-big-Data.db
03:45:24,399 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-14-big-Data.db
03:45:24,400 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-31-big-Data.db
03:45:24,400 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-5-big-Data.db
03:45:24,401 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-17-big-Data.db
03:45:24,402 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data1/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-8-big-Data.db
03:45:24,403 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-9-big-Data.db
03:45:24,403 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-18-big-Data.db
03:45:24,404 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-6-big-Data.db
03:45:24,405 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-24-big-Data.db
03:45:24,406 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-12-big-Data.db
03:45:24,406 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-30-big-Data.db
03:45:24,407 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-3-big-Data.db
03:45:24,409 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-15-big-Data.db
03:45:24,410 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-21-big-Data.db
03:45:24,410 bootstrap_test ERROR /tmp/dtest-ujwn2g00/test/node1/data2/keyspace1/standard1-6f3fd820856c11ec8d6db34bbb19d7cd/nb-27-big-Data.db
03:45:24,411 bootstrap_test ERROR Current count is 32, basecount was 30
--------------------------- Captured stdout teardown ---------------------------
03:45:27,140 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_cleanup failed and was not selected for rerun.
	<class 'AssertionError'>
	assert not True
 +  where True = <bound method Event.is_set of <threading.Event object at 0x7f06a846ca90>>()
 +    where <bound method Event.is_set of <threading.Event object at 0x7f06a846ca90>> = <threading.Event object at 0x7f06a846ca90>.is_set
	[<TracebackEntry /root/cassandra-dtest/bootstrap_test.py:915>]

===End Flaky Test Report===
========================== 1 failed in 210.78 seconds ==========================
[msx] rc = 1
v2v2 running time = 232653667854
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: bootstrap_test.py::TestBootstrap::test_cleanup
h_list: periodic_commitlog_sync_lag_block_in_ms@@@CassandraDaemon@@@-1@@@null@@@5000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup 
-------------------------------- live log call ---------------------------------
03:49:09,890 bootstrap_test ERROR ---
03:49:09,892 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-16-big-Data.db
03:49:09,892 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-22-big-Data.db
03:49:09,893 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-10-big-Data.db
03:49:09,893 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-25-big-Data.db
03:49:09,893 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-28-big-Data.db
03:49:09,894 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-4-big-Data.db
03:49:09,894 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-7-big-Data.db
03:49:09,894 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-13-big-Data.db
03:49:09,895 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-19-big-Data.db
03:49:09,895 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-1-big-Data.db
03:49:09,896 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-23-big-Data.db
03:49:09,896 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-32-big-Data.db
03:49:09,896 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-29-big-Data.db
03:49:09,897 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-11-big-Data.db
03:49:09,897 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-26-big-Data.db
03:49:09,897 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-20-big-Data.db
03:49:09,898 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-2-big-Data.db
03:49:09,899 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-14-big-Data.db
03:49:09,899 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-31-big-Data.db
03:49:09,899 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-5-big-Data.db
03:49:09,900 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-17-big-Data.db
03:49:09,900 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-8-big-Data.db
03:49:09,900 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-9-big-Data.db
03:49:09,901 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-18-big-Data.db
03:49:09,901 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-6-big-Data.db
03:49:09,901 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-24-big-Data.db
03:49:09,901 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-12-big-Data.db
03:49:09,902 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-30-big-Data.db
03:49:09,902 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-3-big-Data.db
03:49:09,902 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-15-big-Data.db
03:49:09,903 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-21-big-Data.db
03:49:09,903 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-27-big-Data.db
03:49:09,903 bootstrap_test ERROR Current count is 32, basecount was 30
FAILED                                                                   [100%]

=================================== FAILURES ===================================
__________________________ TestBootstrap.test_cleanup __________________________

self = <bootstrap_test.TestBootstrap object at 0x7fccceda5eb8>

    def test_cleanup(self):
        """
            @jira_ticket CASSANDRA-11179
            Make sure we remove processed files during cleanup
            """
        cluster = self.cluster
        cluster.set_environment_variable('CASSANDRA_TOKEN_PREGENERATION_DISABLED', 'True')
        cluster.set_configuration_options(values={'concurrent_compactors': 4})
        cluster.populate(1)
        cluster.start()
        node1, = cluster.nodelist()
        for x in range(0, 5):
            node1.stress(['write', 'n=100k', 'no-warmup', '-schema', 'compaction(strategy=SizeTieredCompactionStrategy,enabled=false)', 'replication(factor=1)', '-rate', 'threads=10'])
            node1.flush()
        node2 = new_node(cluster)
        node2.start(wait_for_binary_proto=True)
        event = threading.Event()
        failed = threading.Event()
        jobs = 1
        thread = threading.Thread(target=self._monitor_datadir, args=(node1, event, len(node1.get_sstables("keyspace1", "standard1")), jobs, failed))
        thread.setDaemon(True)
        thread.start()
        node1.nodetool("cleanup -j {} keyspace1 standard1".format(jobs))
        event.set()
        thread.join()
>       assert not failed.is_set()
E       assert not True
E        +  where True = <bound method Event.is_set of <threading.Event object at 0x7fccceb52208>>()
E        +    where <bound method Event.is_set of <threading.Event object at 0x7fccceb52208>> = <threading.Event object at 0x7fccceb52208>.is_set

bootstrap_test.py:915: AssertionError
---------------------------- Captured stdout setup -----------------------------
03:45:49,872 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
03:45:49,612 conftest INFO Starting execution of test_cleanup at 2022-02-04 03:45:49.612479
03:45:49,772 dtest_setup INFO cluster ccm directory: /tmp/dtest-kkgpcd7f
------------------------------ Captured log call -------------------------------
03:45:50,538 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kkgpcd7f/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kkgpcd7f/test/node1/conf'}
03:45:50,539 ccm INFO node1: using Java 8 for the current invocation
03:45:50,752 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kkgpcd7f/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kkgpcd7f/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'CASSANDRA_TOKEN_PREGENERATION_DISABLED': 'True', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
03:45:50,753 ccm INFO node1: using Java 8 for the current invocation
03:45:50,861 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
03:46:26,623 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kkgpcd7f/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kkgpcd7f/test/node1/conf'}
03:46:26,624 ccm INFO node1: using Java 8 for the current invocation
03:46:42,911 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kkgpcd7f/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kkgpcd7f/test/node1/conf'}
03:46:42,912 ccm INFO node1: using Java 8 for the current invocation
03:47:02,583 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kkgpcd7f/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kkgpcd7f/test/node1/conf'}
03:47:02,584 ccm INFO node1: using Java 8 for the current invocation
03:47:22,749 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kkgpcd7f/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kkgpcd7f/test/node1/conf'}
03:47:22,750 ccm INFO node1: using Java 8 for the current invocation
03:47:43,105 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kkgpcd7f/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kkgpcd7f/test/node1/conf'}
03:47:43,107 ccm INFO node1: using Java 8 for the current invocation
03:47:45,550 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kkgpcd7f/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kkgpcd7f/test/node2/conf'}
03:47:45,552 ccm INFO node2: using Java 8 for the current invocation
03:47:45,769 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kkgpcd7f/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kkgpcd7f/test/node2/conf', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=4'}
03:47:45,770 ccm INFO node2: using Java 8 for the current invocation
03:47:45,873 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
03:49:07,745 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kkgpcd7f/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kkgpcd7f/test/node1/conf'}
03:49:07,746 ccm INFO node1: using Java 8 for the current invocation
03:49:09,890 bootstrap_test ERROR ---
03:49:09,892 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-16-big-Data.db
03:49:09,892 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-22-big-Data.db
03:49:09,893 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-10-big-Data.db
03:49:09,893 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-25-big-Data.db
03:49:09,893 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-28-big-Data.db
03:49:09,894 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-4-big-Data.db
03:49:09,894 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-7-big-Data.db
03:49:09,894 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-13-big-Data.db
03:49:09,895 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-19-big-Data.db
03:49:09,895 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data0/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-1-big-Data.db
03:49:09,896 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-23-big-Data.db
03:49:09,896 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-32-big-Data.db
03:49:09,896 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-29-big-Data.db
03:49:09,897 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-11-big-Data.db
03:49:09,897 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-26-big-Data.db
03:49:09,897 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-20-big-Data.db
03:49:09,898 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-2-big-Data.db
03:49:09,899 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-14-big-Data.db
03:49:09,899 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-31-big-Data.db
03:49:09,899 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-5-big-Data.db
03:49:09,900 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-17-big-Data.db
03:49:09,900 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data1/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-8-big-Data.db
03:49:09,900 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-9-big-Data.db
03:49:09,901 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-18-big-Data.db
03:49:09,901 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-6-big-Data.db
03:49:09,901 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-24-big-Data.db
03:49:09,901 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-12-big-Data.db
03:49:09,902 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-30-big-Data.db
03:49:09,902 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-3-big-Data.db
03:49:09,902 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-15-big-Data.db
03:49:09,903 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-21-big-Data.db
03:49:09,903 bootstrap_test ERROR /tmp/dtest-kkgpcd7f/test/node1/data2/keyspace1/standard1-fb91eed0856c11ec9a565fe42edcd604/nb-27-big-Data.db
03:49:09,903 bootstrap_test ERROR Current count is 32, basecount was 30
--------------------------- Captured stdout teardown ---------------------------
03:49:12,529 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_cleanup failed and was not selected for rerun.
	<class 'AssertionError'>
	assert not True
 +  where True = <bound method Event.is_set of <threading.Event object at 0x7fccceb52208>>()
 +    where <bound method Event.is_set of <threading.Event object at 0x7fccceb52208>> = <threading.Event object at 0x7fccceb52208>.is_set
	[<TracebackEntry /root/cassandra-dtest/bootstrap_test.py:915>]

===End Flaky Test Report===
========================== 1 failed in 203.67 seconds ==========================
[msx] rc = 1
v1v2 running time = 225334987802
---> v1v2 test failed.
proj: cassandra
u_test: bootstrap_test.py::TestBootstrap::test_cleanup
h_list: periodic_commitlog_sync_lag_block_in_ms@@@CassandraDaemon@@@-1@@@null@@@5000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 175.83 seconds ==========================
[msx] rc = 0
v1v1 running time = 197478142754
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup 
-------------------------------- live log call ---------------------------------
03:56:23,645 bootstrap_test ERROR ---
03:56:23,649 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-16-big-Data.db
03:56:23,650 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-22-big-Data.db
03:56:23,650 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-10-big-Data.db
03:56:23,651 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-25-big-Data.db
03:56:23,652 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-28-big-Data.db
03:56:23,652 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-4-big-Data.db
03:56:23,653 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-7-big-Data.db
03:56:23,653 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-13-big-Data.db
03:56:23,654 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-19-big-Data.db
03:56:23,654 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-1-big-Data.db
03:56:23,655 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-23-big-Data.db
03:56:23,656 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-32-big-Data.db
03:56:23,657 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-29-big-Data.db
03:56:23,658 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-11-big-Data.db
03:56:23,658 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-26-big-Data.db
03:56:23,659 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-20-big-Data.db
03:56:23,660 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-2-big-Data.db
03:56:23,660 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-14-big-Data.db
03:56:23,661 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-31-big-Data.db
03:56:23,662 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-5-big-Data.db
03:56:23,662 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-17-big-Data.db
03:56:23,663 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-8-big-Data.db
03:56:23,664 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-9-big-Data.db
03:56:23,665 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-18-big-Data.db
03:56:23,665 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-6-big-Data.db
03:56:23,666 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-24-big-Data.db
03:56:23,667 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-12-big-Data.db
03:56:23,668 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-30-big-Data.db
03:56:23,668 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-3-big-Data.db
03:56:23,669 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-15-big-Data.db
03:56:23,670 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-21-big-Data.db
03:56:23,670 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-27-big-Data.db
03:56:23,671 bootstrap_test ERROR Current count is 32, basecount was 30
FAILED                                                                   [100%]

=================================== FAILURES ===================================
__________________________ TestBootstrap.test_cleanup __________________________

self = <bootstrap_test.TestBootstrap object at 0x7f394ba7cf60>

    def test_cleanup(self):
        """
            @jira_ticket CASSANDRA-11179
            Make sure we remove processed files during cleanup
            """
        cluster = self.cluster
        cluster.set_environment_variable('CASSANDRA_TOKEN_PREGENERATION_DISABLED', 'True')
        cluster.set_configuration_options(values={'concurrent_compactors': 4})
        cluster.populate(1)
        cluster.start()
        node1, = cluster.nodelist()
        for x in range(0, 5):
            node1.stress(['write', 'n=100k', 'no-warmup', '-schema', 'compaction(strategy=SizeTieredCompactionStrategy,enabled=false)', 'replication(factor=1)', '-rate', 'threads=10'])
            node1.flush()
        node2 = new_node(cluster)
        node2.start(wait_for_binary_proto=True)
        event = threading.Event()
        failed = threading.Event()
        jobs = 1
        thread = threading.Thread(target=self._monitor_datadir, args=(node1, event, len(node1.get_sstables("keyspace1", "standard1")), jobs, failed))
        thread.setDaemon(True)
        thread.start()
        node1.nodetool("cleanup -j {} keyspace1 standard1".format(jobs))
        event.set()
        thread.join()
>       assert not failed.is_set()
E       assert not True
E        +  where True = <bound method Event.is_set of <threading.Event object at 0x7f394ba670b8>>()
E        +    where <bound method Event.is_set of <threading.Event object at 0x7f394ba670b8>> = <threading.Event object at 0x7f394ba670b8>.is_set

bootstrap_test.py:915: AssertionError
---------------------------- Captured stdout setup -----------------------------
03:52:52,621 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
03:52:52,405 conftest INFO Starting execution of test_cleanup at 2022-02-04 03:52:52.405668
03:52:52,519 dtest_setup INFO cluster ccm directory: /tmp/dtest-rrqgy3yq
------------------------------ Captured log call -------------------------------
03:52:53,364 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-rrqgy3yq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-rrqgy3yq/test/node1/conf'}
03:52:53,366 ccm INFO node1: using Java 8 for the current invocation
03:52:53,562 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-rrqgy3yq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-rrqgy3yq/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'CASSANDRA_TOKEN_PREGENERATION_DISABLED': 'True', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
03:52:53,563 ccm INFO node1: using Java 8 for the current invocation
03:52:53,649 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
03:53:29,769 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-rrqgy3yq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-rrqgy3yq/test/node1/conf'}
03:53:29,770 ccm INFO node1: using Java 8 for the current invocation
03:53:46,260 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-rrqgy3yq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-rrqgy3yq/test/node1/conf'}
03:53:46,261 ccm INFO node1: using Java 8 for the current invocation
03:54:06,235 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-rrqgy3yq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-rrqgy3yq/test/node1/conf'}
03:54:06,236 ccm INFO node1: using Java 8 for the current invocation
03:54:26,576 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-rrqgy3yq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-rrqgy3yq/test/node1/conf'}
03:54:26,577 ccm INFO node1: using Java 8 for the current invocation
03:54:46,694 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-rrqgy3yq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-rrqgy3yq/test/node1/conf'}
03:54:46,695 ccm INFO node1: using Java 8 for the current invocation
03:54:49,308 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-rrqgy3yq/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-rrqgy3yq/test/node2/conf'}
03:54:49,310 ccm INFO node2: using Java 8 for the current invocation
03:54:49,539 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-rrqgy3yq/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-rrqgy3yq/test/node2/conf', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=4'}
03:54:49,540 ccm INFO node2: using Java 8 for the current invocation
03:54:49,654 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
03:56:21,548 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-rrqgy3yq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-rrqgy3yq/test/node1/conf'}
03:56:21,549 ccm INFO node1: using Java 8 for the current invocation
03:56:23,645 bootstrap_test ERROR ---
03:56:23,649 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-16-big-Data.db
03:56:23,650 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-22-big-Data.db
03:56:23,650 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-10-big-Data.db
03:56:23,651 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-25-big-Data.db
03:56:23,652 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-28-big-Data.db
03:56:23,652 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-4-big-Data.db
03:56:23,653 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-7-big-Data.db
03:56:23,653 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-13-big-Data.db
03:56:23,654 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-19-big-Data.db
03:56:23,654 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data0/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-1-big-Data.db
03:56:23,655 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-23-big-Data.db
03:56:23,656 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-32-big-Data.db
03:56:23,657 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-29-big-Data.db
03:56:23,658 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-11-big-Data.db
03:56:23,658 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-26-big-Data.db
03:56:23,659 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-20-big-Data.db
03:56:23,660 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-2-big-Data.db
03:56:23,660 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-14-big-Data.db
03:56:23,661 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-31-big-Data.db
03:56:23,662 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-5-big-Data.db
03:56:23,662 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-17-big-Data.db
03:56:23,663 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data1/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-8-big-Data.db
03:56:23,664 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-9-big-Data.db
03:56:23,665 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-18-big-Data.db
03:56:23,665 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-6-big-Data.db
03:56:23,666 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-24-big-Data.db
03:56:23,667 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-12-big-Data.db
03:56:23,668 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-30-big-Data.db
03:56:23,668 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-3-big-Data.db
03:56:23,669 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-15-big-Data.db
03:56:23,670 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-21-big-Data.db
03:56:23,670 bootstrap_test ERROR /tmp/dtest-rrqgy3yq/test/node1/data2/keyspace1/standard1-f798f9d0856d11ec8760fd51987f9df2/nb-27-big-Data.db
03:56:23,671 bootstrap_test ERROR Current count is 32, basecount was 30
--------------------------- Captured stdout teardown ---------------------------
03:56:26,98 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_cleanup failed and was not selected for rerun.
	<class 'AssertionError'>
	assert not True
 +  where True = <bound method Event.is_set of <threading.Event object at 0x7f394ba670b8>>()
 +    where <bound method Event.is_set of <threading.Event object at 0x7f394ba670b8>> = <threading.Event object at 0x7f394ba670b8>.is_set
	[<TracebackEntry /root/cassandra-dtest/bootstrap_test.py:915>]

===End Flaky Test Report===
========================== 1 failed in 214.42 seconds ==========================
[msx] rc = 1
v2v2 running time = 236079128657
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: bootstrap_test.py::TestBootstrap::test_cleanup
h_list: periodic_commitlog_sync_lag_block_in_ms@@@CassandraDaemon@@@-1@@@null@@@5000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 193.21 seconds ==========================
[msx] rc = 0
v1v2 running time = 214890151037
---> v1v2 test suceeded.
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 174.62 seconds ==========================
[msx] rc = 0
v1v1 running time = 196349172818
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup 
-------------------------------- live log call ---------------------------------
04:07:07,746 bootstrap_test ERROR ---
04:07:07,747 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-16-big-Data.db
04:07:07,748 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-22-big-Data.db
04:07:07,748 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-10-big-Data.db
04:07:07,749 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-25-big-Data.db
04:07:07,749 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-28-big-Data.db
04:07:07,749 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-4-big-Data.db
04:07:07,750 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-7-big-Data.db
04:07:07,750 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-13-big-Data.db
04:07:07,750 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-19-big-Data.db
04:07:07,751 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-1-big-Data.db
04:07:07,751 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-23-big-Data.db
04:07:07,751 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-32-big-Data.db
04:07:07,752 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-29-big-Data.db
04:07:07,752 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-11-big-Data.db
04:07:07,752 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-26-big-Data.db
04:07:07,753 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-20-big-Data.db
04:07:07,753 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-2-big-Data.db
04:07:07,753 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-14-big-Data.db
04:07:07,754 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-31-big-Data.db
04:07:07,755 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-5-big-Data.db
04:07:07,756 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-17-big-Data.db
04:07:07,757 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-8-big-Data.db
04:07:07,757 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-9-big-Data.db
04:07:07,758 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-18-big-Data.db
04:07:07,759 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-6-big-Data.db
04:07:07,759 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-24-big-Data.db
04:07:07,760 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-12-big-Data.db
04:07:07,761 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-30-big-Data.db
04:07:07,761 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-3-big-Data.db
04:07:07,763 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-15-big-Data.db
04:07:07,763 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-21-big-Data.db
04:07:07,764 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-27-big-Data.db
04:07:07,765 bootstrap_test ERROR Current count is 32, basecount was 30
FAILED                                                                   [100%]

=================================== FAILURES ===================================
__________________________ TestBootstrap.test_cleanup __________________________

self = <bootstrap_test.TestBootstrap object at 0x7f1d67ecbf98>

    def test_cleanup(self):
        """
            @jira_ticket CASSANDRA-11179
            Make sure we remove processed files during cleanup
            """
        cluster = self.cluster
        cluster.set_environment_variable('CASSANDRA_TOKEN_PREGENERATION_DISABLED', 'True')
        cluster.set_configuration_options(values={'concurrent_compactors': 4})
        cluster.populate(1)
        cluster.start()
        node1, = cluster.nodelist()
        for x in range(0, 5):
            node1.stress(['write', 'n=100k', 'no-warmup', '-schema', 'compaction(strategy=SizeTieredCompactionStrategy,enabled=false)', 'replication(factor=1)', '-rate', 'threads=10'])
            node1.flush()
        node2 = new_node(cluster)
        node2.start(wait_for_binary_proto=True)
        event = threading.Event()
        failed = threading.Event()
        jobs = 1
        thread = threading.Thread(target=self._monitor_datadir, args=(node1, event, len(node1.get_sstables("keyspace1", "standard1")), jobs, failed))
        thread.setDaemon(True)
        thread.start()
        node1.nodetool("cleanup -j {} keyspace1 standard1".format(jobs))
        event.set()
        thread.join()
>       assert not failed.is_set()
E       assert not True
E        +  where True = <bound method Event.is_set of <threading.Event object at 0x7f1d67ed8eb8>>()
E        +    where <bound method Event.is_set of <threading.Event object at 0x7f1d67ed8eb8>> = <threading.Event object at 0x7f1d67ed8eb8>.is_set

bootstrap_test.py:915: AssertionError
---------------------------- Captured stdout setup -----------------------------
04:03:39,976 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
04:03:39,694 conftest INFO Starting execution of test_cleanup at 2022-02-04 04:03:39.694724
04:03:39,870 dtest_setup INFO cluster ccm directory: /tmp/dtest-k3kh9atu
------------------------------ Captured log call -------------------------------
04:03:40,704 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3kh9atu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3kh9atu/test/node1/conf'}
04:03:40,705 ccm INFO node1: using Java 8 for the current invocation
04:03:40,920 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3kh9atu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3kh9atu/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'CASSANDRA_TOKEN_PREGENERATION_DISABLED': 'True', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
04:03:40,921 ccm INFO node1: using Java 8 for the current invocation
04:03:41,31 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
04:04:10,624 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3kh9atu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3kh9atu/test/node1/conf'}
04:04:10,625 ccm INFO node1: using Java 8 for the current invocation
04:04:31,397 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3kh9atu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3kh9atu/test/node1/conf'}
04:04:31,398 ccm INFO node1: using Java 8 for the current invocation
04:04:51,473 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3kh9atu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3kh9atu/test/node1/conf'}
04:04:51,474 ccm INFO node1: using Java 8 for the current invocation
04:05:11,391 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3kh9atu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3kh9atu/test/node1/conf'}
04:05:11,391 ccm INFO node1: using Java 8 for the current invocation
04:05:31,686 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3kh9atu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3kh9atu/test/node1/conf'}
04:05:31,688 ccm INFO node1: using Java 8 for the current invocation
04:05:34,239 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3kh9atu/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3kh9atu/test/node2/conf'}
04:05:34,241 ccm INFO node2: using Java 8 for the current invocation
04:05:34,463 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3kh9atu/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3kh9atu/test/node2/conf', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=4'}
04:05:34,464 ccm INFO node2: using Java 8 for the current invocation
04:05:34,573 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
04:07:05,488 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3kh9atu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3kh9atu/test/node1/conf'}
04:07:05,490 ccm INFO node1: using Java 8 for the current invocation
04:07:07,746 bootstrap_test ERROR ---
04:07:07,747 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-16-big-Data.db
04:07:07,748 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-22-big-Data.db
04:07:07,748 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-10-big-Data.db
04:07:07,749 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-25-big-Data.db
04:07:07,749 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-28-big-Data.db
04:07:07,749 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-4-big-Data.db
04:07:07,750 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-7-big-Data.db
04:07:07,750 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-13-big-Data.db
04:07:07,750 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-19-big-Data.db
04:07:07,751 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data0/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-1-big-Data.db
04:07:07,751 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-23-big-Data.db
04:07:07,751 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-32-big-Data.db
04:07:07,752 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-29-big-Data.db
04:07:07,752 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-11-big-Data.db
04:07:07,752 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-26-big-Data.db
04:07:07,753 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-20-big-Data.db
04:07:07,753 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-2-big-Data.db
04:07:07,753 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-14-big-Data.db
04:07:07,754 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-31-big-Data.db
04:07:07,755 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-5-big-Data.db
04:07:07,756 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-17-big-Data.db
04:07:07,757 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data1/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-8-big-Data.db
04:07:07,757 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-9-big-Data.db
04:07:07,758 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-18-big-Data.db
04:07:07,759 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-6-big-Data.db
04:07:07,759 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-24-big-Data.db
04:07:07,760 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-12-big-Data.db
04:07:07,761 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-30-big-Data.db
04:07:07,761 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-3-big-Data.db
04:07:07,763 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-15-big-Data.db
04:07:07,763 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-21-big-Data.db
04:07:07,764 bootstrap_test ERROR /tmp/dtest-k3kh9atu/test/node1/data2/keyspace1/standard1-779377e0856f11ec85d55166c0c9a19d/nb-27-big-Data.db
04:07:07,765 bootstrap_test ERROR Current count is 32, basecount was 30
--------------------------- Captured stdout teardown ---------------------------
04:07:10,151 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_cleanup failed and was not selected for rerun.
	<class 'AssertionError'>
	assert not True
 +  where True = <bound method Event.is_set of <threading.Event object at 0x7f1d67ed8eb8>>()
 +    where <bound method Event.is_set of <threading.Event object at 0x7f1d67ed8eb8>> = <threading.Event object at 0x7f1d67ed8eb8>.is_set
	[<TracebackEntry /root/cassandra-dtest/bootstrap_test.py:915>]

===End Flaky Test Report===
========================== 1 failed in 211.18 seconds ==========================
[msx] rc = 1
v2v2 running time = 232840743374
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: bootstrap_test.py::TestBootstrap::test_cleanup
h_list: periodic_commitlog_sync_lag_block_in_ms@@@CassandraDaemon@@@-1@@@null@@@5000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup 
-------------------------------- live log call ---------------------------------
04:10:50,234 bootstrap_test ERROR ---
04:10:50,237 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-16-big-Data.db
04:10:50,238 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-22-big-Data.db
04:10:50,239 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-10-big-Data.db
04:10:50,240 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-25-big-Data.db
04:10:50,240 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-28-big-Data.db
04:10:50,241 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-4-big-Data.db
04:10:50,242 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-7-big-Data.db
04:10:50,242 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-13-big-Data.db
04:10:50,243 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-19-big-Data.db
04:10:50,244 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-1-big-Data.db
04:10:50,244 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-23-big-Data.db
04:10:50,245 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-32-big-Data.db
04:10:50,245 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-29-big-Data.db
04:10:50,246 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-11-big-Data.db
04:10:50,246 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-26-big-Data.db
04:10:50,246 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-20-big-Data.db
04:10:50,247 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-2-big-Data.db
04:10:50,247 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-14-big-Data.db
04:10:50,248 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-31-big-Data.db
04:10:50,248 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-5-big-Data.db
04:10:50,248 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-17-big-Data.db
04:10:50,249 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-8-big-Data.db
04:10:50,249 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-9-big-Data.db
04:10:50,250 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-18-big-Data.db
04:10:50,250 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-6-big-Data.db
04:10:50,251 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-24-big-Data.db
04:10:50,251 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-12-big-Data.db
04:10:50,251 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-30-big-Data.db
04:10:50,252 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-3-big-Data.db
04:10:50,252 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-15-big-Data.db
04:10:50,253 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-21-big-Data.db
04:10:50,253 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-27-big-Data.db
04:10:50,253 bootstrap_test ERROR Current count is 32, basecount was 30
FAILED                                                                   [100%]

=================================== FAILURES ===================================
__________________________ TestBootstrap.test_cleanup __________________________

self = <bootstrap_test.TestBootstrap object at 0x7f5db09bfe10>

    def test_cleanup(self):
        """
            @jira_ticket CASSANDRA-11179
            Make sure we remove processed files during cleanup
            """
        cluster = self.cluster
        cluster.set_environment_variable('CASSANDRA_TOKEN_PREGENERATION_DISABLED', 'True')
        cluster.set_configuration_options(values={'concurrent_compactors': 4})
        cluster.populate(1)
        cluster.start()
        node1, = cluster.nodelist()
        for x in range(0, 5):
            node1.stress(['write', 'n=100k', 'no-warmup', '-schema', 'compaction(strategy=SizeTieredCompactionStrategy,enabled=false)', 'replication(factor=1)', '-rate', 'threads=10'])
            node1.flush()
        node2 = new_node(cluster)
        node2.start(wait_for_binary_proto=True)
        event = threading.Event()
        failed = threading.Event()
        jobs = 1
        thread = threading.Thread(target=self._monitor_datadir, args=(node1, event, len(node1.get_sstables("keyspace1", "standard1")), jobs, failed))
        thread.setDaemon(True)
        thread.start()
        node1.nodetool("cleanup -j {} keyspace1 standard1".format(jobs))
        event.set()
        thread.join()
>       assert not failed.is_set()
E       assert not True
E        +  where True = <bound method Event.is_set of <threading.Event object at 0x7f5db0c122e8>>()
E        +    where <bound method Event.is_set of <threading.Event object at 0x7f5db0c122e8>> = <threading.Event object at 0x7f5db0c122e8>.is_set

bootstrap_test.py:915: AssertionError
---------------------------- Captured stdout setup -----------------------------
04:07:32,981 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
04:07:32,686 conftest INFO Starting execution of test_cleanup at 2022-02-04 04:07:32.686072
04:07:32,849 dtest_setup INFO cluster ccm directory: /tmp/dtest-lrv83a2j
------------------------------ Captured log call -------------------------------
04:07:33,746 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lrv83a2j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lrv83a2j/test/node1/conf'}
04:07:33,747 ccm INFO node1: using Java 8 for the current invocation
04:07:33,969 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lrv83a2j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lrv83a2j/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'CASSANDRA_TOKEN_PREGENERATION_DISABLED': 'True', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
04:07:33,970 ccm INFO node1: using Java 8 for the current invocation
04:07:34,75 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
04:08:03,377 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lrv83a2j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lrv83a2j/test/node1/conf'}
04:08:03,378 ccm INFO node1: using Java 8 for the current invocation
04:08:24,193 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lrv83a2j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lrv83a2j/test/node1/conf'}
04:08:24,194 ccm INFO node1: using Java 8 for the current invocation
04:08:44,222 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lrv83a2j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lrv83a2j/test/node1/conf'}
04:08:44,223 ccm INFO node1: using Java 8 for the current invocation
04:09:04,350 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lrv83a2j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lrv83a2j/test/node1/conf'}
04:09:04,351 ccm INFO node1: using Java 8 for the current invocation
04:09:24,392 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lrv83a2j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lrv83a2j/test/node1/conf'}
04:09:24,393 ccm INFO node1: using Java 8 for the current invocation
04:09:27,28 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lrv83a2j/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lrv83a2j/test/node2/conf'}
04:09:27,30 ccm INFO node2: using Java 8 for the current invocation
04:09:27,253 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lrv83a2j/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lrv83a2j/test/node2/conf', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=4'}
04:09:27,254 ccm INFO node2: using Java 8 for the current invocation
04:09:27,367 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
04:10:48,243 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lrv83a2j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lrv83a2j/test/node1/conf'}
04:10:48,244 ccm INFO node1: using Java 8 for the current invocation
04:10:50,234 bootstrap_test ERROR ---
04:10:50,237 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-16-big-Data.db
04:10:50,238 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-22-big-Data.db
04:10:50,239 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-10-big-Data.db
04:10:50,240 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-25-big-Data.db
04:10:50,240 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-28-big-Data.db
04:10:50,241 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-4-big-Data.db
04:10:50,242 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-7-big-Data.db
04:10:50,242 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-13-big-Data.db
04:10:50,243 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-19-big-Data.db
04:10:50,244 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data0/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-1-big-Data.db
04:10:50,244 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-23-big-Data.db
04:10:50,245 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-32-big-Data.db
04:10:50,245 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-29-big-Data.db
04:10:50,246 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-11-big-Data.db
04:10:50,246 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-26-big-Data.db
04:10:50,246 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-20-big-Data.db
04:10:50,247 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-2-big-Data.db
04:10:50,247 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-14-big-Data.db
04:10:50,248 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-31-big-Data.db
04:10:50,248 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-5-big-Data.db
04:10:50,248 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-17-big-Data.db
04:10:50,249 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data1/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-8-big-Data.db
04:10:50,249 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-9-big-Data.db
04:10:50,250 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-18-big-Data.db
04:10:50,250 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-6-big-Data.db
04:10:50,251 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-24-big-Data.db
04:10:50,251 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-12-big-Data.db
04:10:50,251 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-30-big-Data.db
04:10:50,252 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-3-big-Data.db
04:10:50,252 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-15-big-Data.db
04:10:50,253 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-21-big-Data.db
04:10:50,253 bootstrap_test ERROR /tmp/dtest-lrv83a2j/test/node1/data2/keyspace1/standard1-0271da50857011ec8b807dd70757676f/nb-27-big-Data.db
04:10:50,253 bootstrap_test ERROR Current count is 32, basecount was 30
--------------------------- Captured stdout teardown ---------------------------
04:10:52,892 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_cleanup failed and was not selected for rerun.
	<class 'AssertionError'>
	assert not True
 +  where True = <bound method Event.is_set of <threading.Event object at 0x7f5db0c122e8>>()
 +    where <bound method Event.is_set of <threading.Event object at 0x7f5db0c122e8>> = <threading.Event object at 0x7f5db0c122e8>.is_set
	[<TracebackEntry /root/cassandra-dtest/bootstrap_test.py:915>]

===End Flaky Test Report===
========================== 1 failed in 201.02 seconds ==========================
[msx] rc = 1
v1v2 running time = 222721608203
---> v1v2 test failed.
proj: cassandra
u_test: bootstrap_test.py::TestBootstrap::test_cleanup
h_list: periodic_commitlog_sync_lag_block_in_ms@@@CassandraDaemon@@@-1@@@null@@@5000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 177.04 seconds ==========================
[msx] rc = 0
v1v1 running time = 198767407918
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 212.25 seconds ==========================
[msx] rc = 0
v2v2 running time = 233952681960
---> v1v1 and v2v2 test test suceeded.
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 202.41 seconds ==========================
[msx] rc = 0
v1v2 running time = 224072446964
---> v1v2 test suceeded.
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 173.55 seconds ==========================
[msx] rc = 0
v1v1 running time = 195292937998
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup 
-------------------------------- live log call ---------------------------------
04:28:58,124 bootstrap_test ERROR ---
04:28:58,127 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-16-big-Data.db
04:28:58,128 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-22-big-Data.db
04:28:58,129 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-10-big-Data.db
04:28:58,129 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-25-big-Data.db
04:28:58,130 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-28-big-Data.db
04:28:58,131 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-4-big-Data.db
04:28:58,132 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-7-big-Data.db
04:28:58,132 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-13-big-Data.db
04:28:58,133 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-19-big-Data.db
04:28:58,133 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-1-big-Data.db
04:28:58,134 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-23-big-Data.db
04:28:58,134 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-32-big-Data.db
04:28:58,135 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-29-big-Data.db
04:28:58,135 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-11-big-Data.db
04:28:58,135 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-26-big-Data.db
04:28:58,136 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-20-big-Data.db
04:28:58,136 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-2-big-Data.db
04:28:58,137 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-14-big-Data.db
04:28:58,137 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-31-big-Data.db
04:28:58,138 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-5-big-Data.db
04:28:58,138 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-17-big-Data.db
04:28:58,139 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-8-big-Data.db
04:28:58,140 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-9-big-Data.db
04:28:58,141 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-18-big-Data.db
04:28:58,141 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-6-big-Data.db
04:28:58,142 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-24-big-Data.db
04:28:58,143 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-12-big-Data.db
04:28:58,143 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-30-big-Data.db
04:28:58,144 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-3-big-Data.db
04:28:58,145 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-15-big-Data.db
04:28:58,146 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-21-big-Data.db
04:28:58,146 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-27-big-Data.db
04:28:58,147 bootstrap_test ERROR Current count is 32, basecount was 30
FAILED                                                                   [100%]

=================================== FAILURES ===================================
__________________________ TestBootstrap.test_cleanup __________________________

self = <bootstrap_test.TestBootstrap object at 0x7f09f7839e10>

    def test_cleanup(self):
        """
            @jira_ticket CASSANDRA-11179
            Make sure we remove processed files during cleanup
            """
        cluster = self.cluster
        cluster.set_environment_variable('CASSANDRA_TOKEN_PREGENERATION_DISABLED', 'True')
        cluster.set_configuration_options(values={'concurrent_compactors': 4})
        cluster.populate(1)
        cluster.start()
        node1, = cluster.nodelist()
        for x in range(0, 5):
            node1.stress(['write', 'n=100k', 'no-warmup', '-schema', 'compaction(strategy=SizeTieredCompactionStrategy,enabled=false)', 'replication(factor=1)', '-rate', 'threads=10'])
            node1.flush()
        node2 = new_node(cluster)
        node2.start(wait_for_binary_proto=True)
        event = threading.Event()
        failed = threading.Event()
        jobs = 1
        thread = threading.Thread(target=self._monitor_datadir, args=(node1, event, len(node1.get_sstables("keyspace1", "standard1")), jobs, failed))
        thread.setDaemon(True)
        thread.start()
        node1.nodetool("cleanup -j {} keyspace1 standard1".format(jobs))
        event.set()
        thread.join()
>       assert not failed.is_set()
E       assert not True
E        +  where True = <bound method Event.is_set of <threading.Event object at 0x7f09f782a828>>()
E        +    where <bound method Event.is_set of <threading.Event object at 0x7f09f782a828>> = <threading.Event object at 0x7f09f782a828>.is_set

bootstrap_test.py:915: AssertionError
---------------------------- Captured stdout setup -----------------------------
04:25:27,695 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
04:25:27,438 conftest INFO Starting execution of test_cleanup at 2022-02-04 04:25:27.438385
04:25:27,599 dtest_setup INFO cluster ccm directory: /tmp/dtest-gvyhep5w
------------------------------ Captured log call -------------------------------
04:25:28,348 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvyhep5w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvyhep5w/test/node1/conf'}
04:25:28,349 ccm INFO node1: using Java 8 for the current invocation
04:25:28,568 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvyhep5w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvyhep5w/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'CASSANDRA_TOKEN_PREGENERATION_DISABLED': 'True', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
04:25:28,569 ccm INFO node1: using Java 8 for the current invocation
04:25:28,679 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
04:26:03,802 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvyhep5w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvyhep5w/test/node1/conf'}
04:26:03,803 ccm INFO node1: using Java 8 for the current invocation
04:26:20,228 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvyhep5w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvyhep5w/test/node1/conf'}
04:26:20,229 ccm INFO node1: using Java 8 for the current invocation
04:26:40,553 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvyhep5w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvyhep5w/test/node1/conf'}
04:26:40,555 ccm INFO node1: using Java 8 for the current invocation
04:27:00,904 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvyhep5w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvyhep5w/test/node1/conf'}
04:27:00,905 ccm INFO node1: using Java 8 for the current invocation
04:27:21,254 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvyhep5w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvyhep5w/test/node1/conf'}
04:27:21,255 ccm INFO node1: using Java 8 for the current invocation
04:27:23,715 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvyhep5w/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvyhep5w/test/node2/conf'}
04:27:23,717 ccm INFO node2: using Java 8 for the current invocation
04:27:23,948 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvyhep5w/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvyhep5w/test/node2/conf', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=4'}
04:27:23,949 ccm INFO node2: using Java 8 for the current invocation
04:27:24,54 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
04:28:55,962 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvyhep5w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvyhep5w/test/node1/conf'}
04:28:55,964 ccm INFO node1: using Java 8 for the current invocation
04:28:58,124 bootstrap_test ERROR ---
04:28:58,127 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-16-big-Data.db
04:28:58,128 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-22-big-Data.db
04:28:58,129 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-10-big-Data.db
04:28:58,129 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-25-big-Data.db
04:28:58,130 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-28-big-Data.db
04:28:58,131 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-4-big-Data.db
04:28:58,132 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-7-big-Data.db
04:28:58,132 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-13-big-Data.db
04:28:58,133 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-19-big-Data.db
04:28:58,133 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data0/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-1-big-Data.db
04:28:58,134 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-23-big-Data.db
04:28:58,134 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-32-big-Data.db
04:28:58,135 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-29-big-Data.db
04:28:58,135 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-11-big-Data.db
04:28:58,135 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-26-big-Data.db
04:28:58,136 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-20-big-Data.db
04:28:58,136 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-2-big-Data.db
04:28:58,137 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-14-big-Data.db
04:28:58,137 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-31-big-Data.db
04:28:58,138 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-5-big-Data.db
04:28:58,138 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-17-big-Data.db
04:28:58,139 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data1/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-8-big-Data.db
04:28:58,140 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-9-big-Data.db
04:28:58,141 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-18-big-Data.db
04:28:58,141 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-6-big-Data.db
04:28:58,142 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-24-big-Data.db
04:28:58,143 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-12-big-Data.db
04:28:58,143 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-30-big-Data.db
04:28:58,144 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-3-big-Data.db
04:28:58,145 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-15-big-Data.db
04:28:58,146 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-21-big-Data.db
04:28:58,146 bootstrap_test ERROR /tmp/dtest-gvyhep5w/test/node1/data2/keyspace1/standard1-82fb3570857211ec9a180de088744528/nb-27-big-Data.db
04:28:58,147 bootstrap_test ERROR Current count is 32, basecount was 30
--------------------------- Captured stdout teardown ---------------------------
04:29:00,632 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_cleanup failed and was not selected for rerun.
	<class 'AssertionError'>
	assert not True
 +  where True = <bound method Event.is_set of <threading.Event object at 0x7f09f782a828>>()
 +    where <bound method Event.is_set of <threading.Event object at 0x7f09f782a828>> = <threading.Event object at 0x7f09f782a828>.is_set
	[<TracebackEntry /root/cassandra-dtest/bootstrap_test.py:915>]

===End Flaky Test Report===
========================== 1 failed in 213.92 seconds ==========================
[msx] rc = 1
v2v2 running time = 235607488756
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: bootstrap_test.py::TestBootstrap::test_cleanup
h_list: periodic_commitlog_sync_lag_block_in_ms@@@CassandraDaemon@@@-1@@@null@@@5000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 205.24 seconds ==========================
[msx] rc = 0
v1v2 running time = 226912670723
---> v1v2 test suceeded.
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 172.56 seconds ==========================
[msx] rc = 0
v1v1 running time = 194242471593
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup 
-------------------------------- live log call ---------------------------------
04:39:53,319 bootstrap_test ERROR ---
04:39:53,322 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-16-big-Data.db
04:39:53,323 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-22-big-Data.db
04:39:53,323 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-10-big-Data.db
04:39:53,324 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-25-big-Data.db
04:39:53,324 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-28-big-Data.db
04:39:53,325 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-4-big-Data.db
04:39:53,326 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-7-big-Data.db
04:39:53,326 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-13-big-Data.db
04:39:53,327 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-19-big-Data.db
04:39:53,327 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-1-big-Data.db
04:39:53,328 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-23-big-Data.db
04:39:53,329 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-32-big-Data.db
04:39:53,329 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-29-big-Data.db
04:39:53,330 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-11-big-Data.db
04:39:53,330 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-26-big-Data.db
04:39:53,331 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-20-big-Data.db
04:39:53,332 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-2-big-Data.db
04:39:53,333 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-14-big-Data.db
04:39:53,333 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-31-big-Data.db
04:39:53,334 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-5-big-Data.db
04:39:53,334 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-17-big-Data.db
04:39:53,335 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-8-big-Data.db
04:39:53,335 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-9-big-Data.db
04:39:53,336 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-18-big-Data.db
04:39:53,337 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-6-big-Data.db
04:39:53,337 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-24-big-Data.db
04:39:53,338 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-12-big-Data.db
04:39:53,338 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-30-big-Data.db
04:39:53,339 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-3-big-Data.db
04:39:53,339 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-15-big-Data.db
04:39:53,340 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-21-big-Data.db
04:39:53,341 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-27-big-Data.db
04:39:53,342 bootstrap_test ERROR Current count is 32, basecount was 30
FAILED                                                                   [100%]

=================================== FAILURES ===================================
__________________________ TestBootstrap.test_cleanup __________________________

self = <bootstrap_test.TestBootstrap object at 0x7f80e0e5ce10>

    def test_cleanup(self):
        """
            @jira_ticket CASSANDRA-11179
            Make sure we remove processed files during cleanup
            """
        cluster = self.cluster
        cluster.set_environment_variable('CASSANDRA_TOKEN_PREGENERATION_DISABLED', 'True')
        cluster.set_configuration_options(values={'concurrent_compactors': 4})
        cluster.populate(1)
        cluster.start()
        node1, = cluster.nodelist()
        for x in range(0, 5):
            node1.stress(['write', 'n=100k', 'no-warmup', '-schema', 'compaction(strategy=SizeTieredCompactionStrategy,enabled=false)', 'replication(factor=1)', '-rate', 'threads=10'])
            node1.flush()
        node2 = new_node(cluster)
        node2.start(wait_for_binary_proto=True)
        event = threading.Event()
        failed = threading.Event()
        jobs = 1
        thread = threading.Thread(target=self._monitor_datadir, args=(node1, event, len(node1.get_sstables("keyspace1", "standard1")), jobs, failed))
        thread.setDaemon(True)
        thread.start()
        node1.nodetool("cleanup -j {} keyspace1 standard1".format(jobs))
        event.set()
        thread.join()
>       assert not failed.is_set()
E       assert not True
E        +  where True = <bound method Event.is_set of <threading.Event object at 0x7f80e0e4e278>>()
E        +    where <bound method Event.is_set of <threading.Event object at 0x7f80e0e4e278>> = <threading.Event object at 0x7f80e0e4e278>.is_set

bootstrap_test.py:915: AssertionError
---------------------------- Captured stdout setup -----------------------------
04:36:24,462 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
04:36:24,185 conftest INFO Starting execution of test_cleanup at 2022-02-04 04:36:24.185391
04:36:24,364 dtest_setup INFO cluster ccm directory: /tmp/dtest-u8kk3hw9
------------------------------ Captured log call -------------------------------
04:36:25,140 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u8kk3hw9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u8kk3hw9/test/node1/conf'}
04:36:25,142 ccm INFO node1: using Java 8 for the current invocation
04:36:25,362 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u8kk3hw9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u8kk3hw9/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'CASSANDRA_TOKEN_PREGENERATION_DISABLED': 'True', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
04:36:25,364 ccm INFO node1: using Java 8 for the current invocation
04:36:25,470 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
04:37:00,419 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u8kk3hw9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u8kk3hw9/test/node1/conf'}
04:37:00,420 ccm INFO node1: using Java 8 for the current invocation
04:37:16,503 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u8kk3hw9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u8kk3hw9/test/node1/conf'}
04:37:16,504 ccm INFO node1: using Java 8 for the current invocation
04:37:36,745 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u8kk3hw9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u8kk3hw9/test/node1/conf'}
04:37:36,746 ccm INFO node1: using Java 8 for the current invocation
04:37:56,37 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u8kk3hw9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u8kk3hw9/test/node1/conf'}
04:37:56,38 ccm INFO node1: using Java 8 for the current invocation
04:38:16,418 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u8kk3hw9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u8kk3hw9/test/node1/conf'}
04:38:16,419 ccm INFO node1: using Java 8 for the current invocation
04:38:18,922 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u8kk3hw9/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u8kk3hw9/test/node2/conf'}
04:38:18,923 ccm INFO node2: using Java 8 for the current invocation
04:38:19,146 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u8kk3hw9/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u8kk3hw9/test/node2/conf', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=4'}
04:38:19,148 ccm INFO node2: using Java 8 for the current invocation
04:38:19,253 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
04:39:51,138 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u8kk3hw9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u8kk3hw9/test/node1/conf'}
04:39:51,139 ccm INFO node1: using Java 8 for the current invocation
04:39:53,319 bootstrap_test ERROR ---
04:39:53,322 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-16-big-Data.db
04:39:53,323 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-22-big-Data.db
04:39:53,323 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-10-big-Data.db
04:39:53,324 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-25-big-Data.db
04:39:53,324 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-28-big-Data.db
04:39:53,325 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-4-big-Data.db
04:39:53,326 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-7-big-Data.db
04:39:53,326 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-13-big-Data.db
04:39:53,327 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-19-big-Data.db
04:39:53,327 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data0/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-1-big-Data.db
04:39:53,328 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-23-big-Data.db
04:39:53,329 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-32-big-Data.db
04:39:53,329 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-29-big-Data.db
04:39:53,330 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-11-big-Data.db
04:39:53,330 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-26-big-Data.db
04:39:53,331 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-20-big-Data.db
04:39:53,332 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-2-big-Data.db
04:39:53,333 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-14-big-Data.db
04:39:53,333 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-31-big-Data.db
04:39:53,334 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-5-big-Data.db
04:39:53,334 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-17-big-Data.db
04:39:53,335 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data1/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-8-big-Data.db
04:39:53,335 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-9-big-Data.db
04:39:53,336 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-18-big-Data.db
04:39:53,337 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-6-big-Data.db
04:39:53,337 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-24-big-Data.db
04:39:53,338 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-12-big-Data.db
04:39:53,338 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-30-big-Data.db
04:39:53,339 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-3-big-Data.db
04:39:53,339 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-15-big-Data.db
04:39:53,340 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-21-big-Data.db
04:39:53,341 bootstrap_test ERROR /tmp/dtest-u8kk3hw9/test/node1/data2/keyspace1/standard1-0a69f720857411ecbcd7a511549703fa/nb-27-big-Data.db
04:39:53,342 bootstrap_test ERROR Current count is 32, basecount was 30
--------------------------- Captured stdout teardown ---------------------------
04:39:55,959 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_cleanup failed and was not selected for rerun.
	<class 'AssertionError'>
	assert not True
 +  where True = <bound method Event.is_set of <threading.Event object at 0x7f80e0e4e278>>()
 +    where <bound method Event.is_set of <threading.Event object at 0x7f80e0e4e278>> = <threading.Event object at 0x7f80e0e4e278>.is_set
	[<TracebackEntry /root/cassandra-dtest/bootstrap_test.py:915>]

===End Flaky Test Report===
========================== 1 failed in 212.52 seconds ==========================
[msx] rc = 1
v2v2 running time = 234200511638
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: bootstrap_test.py::TestBootstrap::test_cleanup
h_list: periodic_commitlog_sync_lag_block_in_ms@@@CassandraDaemon@@@-1@@@null@@@5000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup 
-------------------------------- live log call ---------------------------------
04:43:37,925 bootstrap_test ERROR ---
04:43:37,928 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-16-big-Data.db
04:43:37,929 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-22-big-Data.db
04:43:37,930 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-10-big-Data.db
04:43:37,931 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-25-big-Data.db
04:43:37,931 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-28-big-Data.db
04:43:37,932 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-4-big-Data.db
04:43:37,933 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-7-big-Data.db
04:43:37,933 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-13-big-Data.db
04:43:37,934 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-19-big-Data.db
04:43:37,935 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-1-big-Data.db
04:43:37,935 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-23-big-Data.db
04:43:37,936 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-32-big-Data.db
04:43:37,936 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-29-big-Data.db
04:43:37,937 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-11-big-Data.db
04:43:37,938 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-26-big-Data.db
04:43:37,939 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-20-big-Data.db
04:43:37,939 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-2-big-Data.db
04:43:37,940 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-14-big-Data.db
04:43:37,940 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-31-big-Data.db
04:43:37,941 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-5-big-Data.db
04:43:37,942 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-17-big-Data.db
04:43:37,942 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-8-big-Data.db
04:43:37,943 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-9-big-Data.db
04:43:37,943 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-18-big-Data.db
04:43:37,944 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-6-big-Data.db
04:43:37,944 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-24-big-Data.db
04:43:37,945 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-12-big-Data.db
04:43:37,946 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-30-big-Data.db
04:43:37,947 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-3-big-Data.db
04:43:37,948 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-15-big-Data.db
04:43:37,948 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-21-big-Data.db
04:43:37,949 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-27-big-Data.db
04:43:37,950 bootstrap_test ERROR Current count is 32, basecount was 30
FAILED                                                                   [100%]

=================================== FAILURES ===================================
__________________________ TestBootstrap.test_cleanup __________________________

self = <bootstrap_test.TestBootstrap object at 0x7f8f8c02fe10>

    def test_cleanup(self):
        """
            @jira_ticket CASSANDRA-11179
            Make sure we remove processed files during cleanup
            """
        cluster = self.cluster
        cluster.set_environment_variable('CASSANDRA_TOKEN_PREGENERATION_DISABLED', 'True')
        cluster.set_configuration_options(values={'concurrent_compactors': 4})
        cluster.populate(1)
        cluster.start()
        node1, = cluster.nodelist()
        for x in range(0, 5):
            node1.stress(['write', 'n=100k', 'no-warmup', '-schema', 'compaction(strategy=SizeTieredCompactionStrategy,enabled=false)', 'replication(factor=1)', '-rate', 'threads=10'])
            node1.flush()
        node2 = new_node(cluster)
        node2.start(wait_for_binary_proto=True)
        event = threading.Event()
        failed = threading.Event()
        jobs = 1
        thread = threading.Thread(target=self._monitor_datadir, args=(node1, event, len(node1.get_sstables("keyspace1", "standard1")), jobs, failed))
        thread.setDaemon(True)
        thread.start()
        node1.nodetool("cleanup -j {} keyspace1 standard1".format(jobs))
        event.set()
        thread.join()
>       assert not failed.is_set()
E       assert not True
E        +  where True = <bound method Event.is_set of <threading.Event object at 0x7f8f8c023588>>()
E        +    where <bound method Event.is_set of <threading.Event object at 0x7f8f8c023588>> = <threading.Event object at 0x7f8f8c023588>.is_set

bootstrap_test.py:915: AssertionError
---------------------------- Captured stdout setup -----------------------------
04:40:18,624 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
04:40:18,412 conftest INFO Starting execution of test_cleanup at 2022-02-04 04:40:18.412309
04:40:18,526 dtest_setup INFO cluster ccm directory: /tmp/dtest-4lvrq1rs
------------------------------ Captured log call -------------------------------
04:40:19,293 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4lvrq1rs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4lvrq1rs/test/node1/conf'}
04:40:19,294 ccm INFO node1: using Java 8 for the current invocation
04:40:19,518 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4lvrq1rs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4lvrq1rs/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'CASSANDRA_TOKEN_PREGENERATION_DISABLED': 'True', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
04:40:19,520 ccm INFO node1: using Java 8 for the current invocation
04:40:19,633 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
04:40:49,536 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4lvrq1rs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4lvrq1rs/test/node1/conf'}
04:40:49,537 ccm INFO node1: using Java 8 for the current invocation
04:41:09,851 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4lvrq1rs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4lvrq1rs/test/node1/conf'}
04:41:09,852 ccm INFO node1: using Java 8 for the current invocation
04:41:29,914 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4lvrq1rs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4lvrq1rs/test/node1/conf'}
04:41:29,915 ccm INFO node1: using Java 8 for the current invocation
04:41:50,644 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4lvrq1rs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4lvrq1rs/test/node1/conf'}
04:41:50,646 ccm INFO node1: using Java 8 for the current invocation
04:42:10,925 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4lvrq1rs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4lvrq1rs/test/node1/conf'}
04:42:10,926 ccm INFO node1: using Java 8 for the current invocation
04:42:13,517 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4lvrq1rs/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4lvrq1rs/test/node2/conf'}
04:42:13,519 ccm INFO node2: using Java 8 for the current invocation
04:42:13,740 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4lvrq1rs/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4lvrq1rs/test/node2/conf', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=4'}
04:42:13,742 ccm INFO node2: using Java 8 for the current invocation
04:42:13,852 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
04:43:35,745 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4lvrq1rs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4lvrq1rs/test/node1/conf'}
04:43:35,746 ccm INFO node1: using Java 8 for the current invocation
04:43:37,925 bootstrap_test ERROR ---
04:43:37,928 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-16-big-Data.db
04:43:37,929 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-22-big-Data.db
04:43:37,930 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-10-big-Data.db
04:43:37,931 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-25-big-Data.db
04:43:37,931 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-28-big-Data.db
04:43:37,932 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-4-big-Data.db
04:43:37,933 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-7-big-Data.db
04:43:37,933 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-13-big-Data.db
04:43:37,934 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-19-big-Data.db
04:43:37,935 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data0/keyspace1/standard1-96204300857411ecb33025e846905420/nb-1-big-Data.db
04:43:37,935 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-23-big-Data.db
04:43:37,936 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-32-big-Data.db
04:43:37,936 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-29-big-Data.db
04:43:37,937 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-11-big-Data.db
04:43:37,938 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-26-big-Data.db
04:43:37,939 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-20-big-Data.db
04:43:37,939 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-2-big-Data.db
04:43:37,940 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-14-big-Data.db
04:43:37,940 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-31-big-Data.db
04:43:37,941 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-5-big-Data.db
04:43:37,942 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-17-big-Data.db
04:43:37,942 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data1/keyspace1/standard1-96204300857411ecb33025e846905420/nb-8-big-Data.db
04:43:37,943 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-9-big-Data.db
04:43:37,943 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-18-big-Data.db
04:43:37,944 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-6-big-Data.db
04:43:37,944 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-24-big-Data.db
04:43:37,945 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-12-big-Data.db
04:43:37,946 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-30-big-Data.db
04:43:37,947 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-3-big-Data.db
04:43:37,948 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-15-big-Data.db
04:43:37,948 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-21-big-Data.db
04:43:37,949 bootstrap_test ERROR /tmp/dtest-4lvrq1rs/test/node1/data2/keyspace1/standard1-96204300857411ecb33025e846905420/nb-27-big-Data.db
04:43:37,950 bootstrap_test ERROR Current count is 32, basecount was 30
--------------------------- Captured stdout teardown ---------------------------
04:43:40,336 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_cleanup failed and was not selected for rerun.
	<class 'AssertionError'>
	assert not True
 +  where True = <bound method Event.is_set of <threading.Event object at 0x7f8f8c023588>>()
 +    where <bound method Event.is_set of <threading.Event object at 0x7f8f8c023588>> = <threading.Event object at 0x7f8f8c023588>.is_set
	[<TracebackEntry /root/cassandra-dtest/bootstrap_test.py:915>]

===End Flaky Test Report===
========================== 1 failed in 202.67 seconds ==========================
[msx] rc = 1
v1v2 running time = 224383481529
---> v1v2 test failed.
proj: cassandra
u_test: bootstrap_test.py::TestBootstrap::test_cleanup
h_list: periodic_commitlog_sync_lag_block_in_ms@@@CassandraDaemon@@@-1@@@null@@@5000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup PASSED                    [100%]
===Flaky Test Report===

test_cleanup passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 176.02 seconds ==========================
[msx] rc = 0
v1v1 running time = 197786829325
cassandra bootstrap_test.py::TestBootstrap::test_cleanup false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is bootstrap_test.py::TestBootstrap::test_cleanup
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

bootstrap_test.py::TestBootstrap::test_cleanup 
-------------------------------- live log call ---------------------------------
04:50:50,606 bootstrap_test ERROR ---
04:50:50,610 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-16-big-Data.db
04:50:50,610 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-22-big-Data.db
04:50:50,611 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-10-big-Data.db
04:50:50,612 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-25-big-Data.db
04:50:50,613 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-28-big-Data.db
04:50:50,614 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-4-big-Data.db
04:50:50,614 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-7-big-Data.db
04:50:50,615 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-13-big-Data.db
04:50:50,615 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-19-big-Data.db
04:50:50,616 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-1-big-Data.db
04:50:50,616 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-23-big-Data.db
04:50:50,617 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-32-big-Data.db
04:50:50,617 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-29-big-Data.db
04:50:50,617 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-11-big-Data.db
04:50:50,618 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-26-big-Data.db
04:50:50,618 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-20-big-Data.db
04:50:50,619 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-2-big-Data.db
04:50:50,619 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-14-big-Data.db
04:50:50,620 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-31-big-Data.db
04:50:50,620 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-5-big-Data.db
04:50:50,621 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-17-big-Data.db
04:50:50,621 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-8-big-Data.db
04:50:50,622 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-9-big-Data.db
04:50:50,622 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-18-big-Data.db
04:50:50,623 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-6-big-Data.db
04:50:50,623 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-24-big-Data.db
04:50:50,624 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-12-big-Data.db
04:50:50,624 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-30-big-Data.db
04:50:50,625 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-3-big-Data.db
04:50:50,625 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-15-big-Data.db
04:50:50,625 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-21-big-Data.db
04:50:50,625 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-27-big-Data.db
04:50:50,626 bootstrap_test ERROR Current count is 32, basecount was 30
FAILED                                                                   [100%]

=================================== FAILURES ===================================
__________________________ TestBootstrap.test_cleanup __________________________

self = <bootstrap_test.TestBootstrap object at 0x7f80ac255fd0>

    def test_cleanup(self):
        """
            @jira_ticket CASSANDRA-11179
            Make sure we remove processed files during cleanup
            """
        cluster = self.cluster
        cluster.set_environment_variable('CASSANDRA_TOKEN_PREGENERATION_DISABLED', 'True')
        cluster.set_configuration_options(values={'concurrent_compactors': 4})
        cluster.populate(1)
        cluster.start()
        node1, = cluster.nodelist()
        for x in range(0, 5):
            node1.stress(['write', 'n=100k', 'no-warmup', '-schema', 'compaction(strategy=SizeTieredCompactionStrategy,enabled=false)', 'replication(factor=1)', '-rate', 'threads=10'])
            node1.flush()
        node2 = new_node(cluster)
        node2.start(wait_for_binary_proto=True)
        event = threading.Event()
        failed = threading.Event()
        jobs = 1
        thread = threading.Thread(target=self._monitor_datadir, args=(node1, event, len(node1.get_sstables("keyspace1", "standard1")), jobs, failed))
        thread.setDaemon(True)
        thread.start()
        node1.nodetool("cleanup -j {} keyspace1 standard1".format(jobs))
        event.set()
        thread.join()
>       assert not failed.is_set()
E       assert not True
E        +  where True = <bound method Event.is_set of <threading.Event object at 0x7f80ac245ba8>>()
E        +    where <bound method Event.is_set of <threading.Event object at 0x7f80ac245ba8>> = <threading.Event object at 0x7f80ac245ba8>.is_set

bootstrap_test.py:915: AssertionError
---------------------------- Captured stdout setup -----------------------------
04:47:20,856 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
04:47:20,623 conftest INFO Starting execution of test_cleanup at 2022-02-04 04:47:20.623091
04:47:20,753 dtest_setup INFO cluster ccm directory: /tmp/dtest-e0f_zum9
------------------------------ Captured log call -------------------------------
04:47:21,559 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e0f_zum9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e0f_zum9/test/node1/conf'}
04:47:21,560 ccm INFO node1: using Java 8 for the current invocation
04:47:21,793 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e0f_zum9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e0f_zum9/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'CASSANDRA_TOKEN_PREGENERATION_DISABLED': 'True', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
04:47:21,794 ccm INFO node1: using Java 8 for the current invocation
04:47:21,909 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
04:47:57,247 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e0f_zum9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e0f_zum9/test/node1/conf'}
04:47:57,248 ccm INFO node1: using Java 8 for the current invocation
04:48:13,80 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e0f_zum9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e0f_zum9/test/node1/conf'}
04:48:13,81 ccm INFO node1: using Java 8 for the current invocation
04:48:33,547 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e0f_zum9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e0f_zum9/test/node1/conf'}
04:48:33,548 ccm INFO node1: using Java 8 for the current invocation
04:48:53,531 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e0f_zum9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e0f_zum9/test/node1/conf'}
04:48:53,532 ccm INFO node1: using Java 8 for the current invocation
04:49:13,572 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e0f_zum9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e0f_zum9/test/node1/conf'}
04:49:13,573 ccm INFO node1: using Java 8 for the current invocation
04:49:16,281 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e0f_zum9/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e0f_zum9/test/node2/conf'}
04:49:16,284 ccm INFO node2: using Java 8 for the current invocation
04:49:16,513 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e0f_zum9/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e0f_zum9/test/node2/conf', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=4'}
04:49:16,514 ccm INFO node2: using Java 8 for the current invocation
04:49:16,627 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
04:50:48,518 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'de23ec94dff2', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'bootstrap_test.py::TestBootstrap::()::test_cleanup (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e0f_zum9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e0f_zum9/test/node1/conf'}
04:50:48,519 ccm INFO node1: using Java 8 for the current invocation
04:50:50,606 bootstrap_test ERROR ---
04:50:50,610 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-16-big-Data.db
04:50:50,610 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-22-big-Data.db
04:50:50,611 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-10-big-Data.db
04:50:50,612 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-25-big-Data.db
04:50:50,613 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-28-big-Data.db
04:50:50,614 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-4-big-Data.db
04:50:50,614 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-7-big-Data.db
04:50:50,615 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-13-big-Data.db
04:50:50,615 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-19-big-Data.db
04:50:50,616 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data0/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-1-big-Data.db
04:50:50,616 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-23-big-Data.db
04:50:50,617 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-32-big-Data.db
04:50:50,617 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-29-big-Data.db
04:50:50,617 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-11-big-Data.db
04:50:50,618 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-26-big-Data.db
04:50:50,618 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-20-big-Data.db
04:50:50,619 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-2-big-Data.db
04:50:50,619 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-14-big-Data.db
04:50:50,620 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-31-big-Data.db
04:50:50,620 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-5-big-Data.db
04:50:50,621 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-17-big-Data.db
04:50:50,621 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data1/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-8-big-Data.db
04:50:50,622 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-9-big-Data.db
04:50:50,622 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-18-big-Data.db
04:50:50,623 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-6-big-Data.db
04:50:50,623 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-24-big-Data.db
04:50:50,624 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-12-big-Data.db
04:50:50,624 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-30-big-Data.db
04:50:50,625 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-3-big-Data.db
04:50:50,625 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-15-big-Data.db
04:50:50,625 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-21-big-Data.db
04:50:50,625 bootstrap_test ERROR /tmp/dtest-e0f_zum9/test/node1/data2/keyspace1/standard1-91a2b4b0857511ecb7be2d5ccc4bd36d/nb-27-big-Data.db
04:50:50,626 bootstrap_test ERROR Current count is 32, basecount was 30
--------------------------- Captured stdout teardown ---------------------------
04:50:53,82 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_cleanup failed and was not selected for rerun.
	<class 'AssertionError'>
	assert not True
 +  where True = <bound method Event.is_set of <threading.Event object at 0x7f80ac245ba8>>()
 +    where <bound method Event.is_set of <threading.Event object at 0x7f80ac245ba8>> = <threading.Event object at 0x7f80ac245ba8>.is_set
	[<TracebackEntry /root/cassandra-dtest/bootstrap_test.py:915>]

===End Flaky Test Report===
========================== 1 failed in 213.21 seconds ==========================
[msx] rc = 1
v2v2 running time = 234984143161
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: bootstrap_test.py::TestBootstrap::test_cleanup
h_list: periodic_commitlog_sync_lag_block_in_ms@@@CassandraDaemon@@@-1@@@null@@@5000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

early stop after 7 is satisfied
v1v2 failed with probability 5 out of 11
v1v1v2v2 failed with probability 7 out of 11
Total execution time in seconds : 7188
0
