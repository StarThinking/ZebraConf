my_type=hypothesis
proj=cassandra
u_test=paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list[1]=native_transport_flush_in_batches_legacy@@@CassandraDaemon@@@-3@@@true@@@false
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: native_transport_flush_in_batches_legacy@@@CassandraDaemon@@@-3@@@true@@@false
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
09:44:13,701 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
09:44:13,703 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 58.72 seconds ===========================
[msx] rc = 0
v1v2 running time = 80195097732
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
09:45:36,699 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
09:45:36,700 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 60.80 seconds ===========================
[msx] rc = 0
v1v1 running time = 82807739990
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
09:46:59,570 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
09:46:59,572 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
09:47:03,894 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
09:47:03,895 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 61.74 seconds ===========================
[msx] rc = 0
v2v2 running time = 83324813311
---> v1v1 and v2v2 test test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
09:48:20,157 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
09:48:20,159 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
09:48:24,460 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 58.23 seconds ===========================
[msx] rc = 0
v1v2 running time = 79700210009
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
09:49:46,467 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
09:49:47,579 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.16 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
09:49:49,786 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.28 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
09:49:54,97 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 8.72 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
09:49:58,846 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
09:49:58,848 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
09:50:02,917 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 14.4 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 77.23 seconds ===========================
[msx] rc = 0
v1v1 running time = 98766677070
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
09:51:19,75 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
09:51:19,77 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
09:51:22,842 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 58.92 seconds ===========================
[msx] rc = 0
v2v2 running time = 80644153888
---> v1v1 and v2v2 test test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
09:52:43,934 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
09:52:43,936 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 63.12 seconds ===========================
[msx] rc = 0
v1v2 running time = 84579754165
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
09:54:09,133 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
09:54:10,138 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.06 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
09:54:12,244 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.56 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
09:54:16,856 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 9.04 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
09:54:19,650 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
09:54:19,652 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 74.05 seconds ===========================
[msx] rc = 0
v1v1 running time = 95580148705
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
09:55:45,705 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
09:55:46,753 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.14 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
09:56:45,252 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 9

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f11c8a7b438>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f11c0a2db38>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
09:54:48,267 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
09:54:46,962 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 09:54:46.962293
09:54:48,171 dtest_setup INFO cluster ccm directory: /tmp/dtest-_i60f3gv
----------------------------- Captured stdout call -----------------------------
09:54:48,272 ccm DEBUG using balanced tokens for non-vnode cluster
09:54:49,812 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_i60f3gv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_i60f3gv/test/node1/conf'}
09:54:49,813 ccm INFO node1: using Java 8 for the current invocation
09:54:49,980 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_i60f3gv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_i60f3gv/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
09:54:49,981 ccm INFO node1: using Java 8 for the current invocation
09:54:50,61 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
09:54:50,323 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_i60f3gv/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_i60f3gv/test/node2/conf'}
09:54:50,324 ccm INFO node2: using Java 8 for the current invocation
09:54:50,491 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_i60f3gv/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_i60f3gv/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
09:54:50,492 ccm INFO node2: using Java 8 for the current invocation
09:54:50,570 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
09:54:50,825 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_i60f3gv/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_i60f3gv/test/node3/conf'}
09:54:50,826 ccm INFO node3: using Java 8 for the current invocation
09:54:50,987 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_i60f3gv/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_i60f3gv/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
09:54:50,988 ccm INFO node3: using Java 8 for the current invocation
09:54:51,62 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
09:54:49,812 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_i60f3gv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_i60f3gv/test/node1/conf'}
09:54:49,813 ccm INFO node1: using Java 8 for the current invocation
09:54:49,980 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_i60f3gv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_i60f3gv/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
09:54:49,981 ccm INFO node1: using Java 8 for the current invocation
09:54:50,61 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
09:54:50,323 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_i60f3gv/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_i60f3gv/test/node2/conf'}
09:54:50,324 ccm INFO node2: using Java 8 for the current invocation
09:54:50,491 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_i60f3gv/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_i60f3gv/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
09:54:50,492 ccm INFO node2: using Java 8 for the current invocation
09:54:50,570 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
09:54:50,825 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_i60f3gv/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_i60f3gv/test/node3/conf'}
09:54:50,826 ccm INFO node3: using Java 8 for the current invocation
09:54:50,987 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_i60f3gv/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_i60f3gv/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
09:54:50,988 ccm INFO node3: using Java 8 for the current invocation
09:54:51,62 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
09:55:20,835 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
09:55:20,837 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
09:55:49,185 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stderr teardown ---------------------------
swapoff: Not superuser.
---------------------------- Captured stdout setup -----------------------------
09:55:52,979 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
09:55:52,245 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 09:55:52.245186
09:55:52,863 dtest_setup INFO cluster ccm directory: /tmp/dtest-bne435vs
----------------------------- Captured stdout call -----------------------------

09:55:52,982 ccm DEBUG using balanced tokens for non-vnode cluster
09:55:54,794 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bne435vs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bne435vs/test/node1/conf'}
09:55:54,795 ccm INFO node1: using Java 8 for the current invocation
09:55:54,981 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bne435vs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bne435vs/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
09:55:54,982 ccm INFO node1: using Java 8 for the current invocation
09:55:55,78 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
09:55:55,364 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bne435vs/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bne435vs/test/node2/conf'}
09:55:55,365 ccm INFO node2: using Java 8 for the current invocation
09:55:55,541 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bne435vs/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bne435vs/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
09:55:55,541 ccm INFO node2: using Java 8 for the current invocation
09:55:55,634 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
09:55:55,914 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bne435vs/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bne435vs/test/node3/conf'}
09:55:55,915 ccm INFO node3: using Java 8 for the current invocation
09:55:56,83 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bne435vs/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bne435vs/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
09:55:56,83 ccm INFO node3: using Java 8 for the current invocation
09:55:56,174 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
09:55:54,794 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bne435vs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bne435vs/test/node1/conf'}
09:55:54,795 ccm INFO node1: using Java 8 for the current invocation
09:55:54,981 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bne435vs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bne435vs/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
09:55:54,982 ccm INFO node1: using Java 8 for the current invocation
09:55:55,78 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
09:55:55,364 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bne435vs/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bne435vs/test/node2/conf'}
09:55:55,365 ccm INFO node2: using Java 8 for the current invocation
09:55:55,541 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bne435vs/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bne435vs/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
09:55:55,541 ccm INFO node2: using Java 8 for the current invocation
09:55:55,634 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
09:55:55,914 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bne435vs/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bne435vs/test/node3/conf'}
09:55:55,915 ccm INFO node3: using Java 8 for the current invocation
09:55:56,83 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bne435vs/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bne435vs/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
09:55:56,83 ccm INFO node3: using Java 8 for the current invocation
09:55:56,174 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
09:56:19,972 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
09:56:19,973 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
09:55:49,185 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stderr teardown ---------------------------
swapoff: Not superuser.
--------------------------- Captured stdout teardown ---------------------------
09:55:49,185 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stderr teardown ---------------------------
swapoff: Not superuser.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]09:56:45,710 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 119.49 seconds ==========================
[msx] rc = 1
v2v2 running time = 141180201651
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: native_transport_flush_in_batches_legacy@@@CassandraDaemon@@@-3@@@true@@@false
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
09:58:04,838 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
09:58:04,840 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
09:58:08,680 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 62.47 seconds ===========================
[msx] rc = 0
v1v2 running time = 83939092421
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
09:59:34,407 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
09:59:34,409 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 68.08 seconds ===========================
[msx] rc = 0
v1v1 running time = 89669469968
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:00:59,31 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:01:00,37 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.24 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:01:02,344 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.04 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:01:06,455 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 7.28 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:01:09,613 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:01:09,614 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:01:13,773 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 18.08 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 73.77 seconds ===========================
[msx] rc = 0
v2v2 running time = 95272071998
---> v1v1 and v2v2 test test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:02:28,988 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:02:30,99 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.1 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
10:03:33,642 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 70

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f3cc5e6e208>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f3cb6355470>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
10:01:37,589 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:01:36,887 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:01:36.887589
10:01:37,495 dtest_setup INFO cluster ccm directory: /tmp/dtest-d37u2key
----------------------------- Captured stdout call -----------------------------

10:01:37,592 ccm DEBUG using balanced tokens for non-vnode cluster
10:01:38,923 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d37u2key/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d37u2key/test/node1/conf'}
10:01:38,924 ccm INFO node1: using Java 8 for the current invocation
10:01:39,99 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d37u2key/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d37u2key/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:01:39,100 ccm INFO node1: using Java 8 for the current invocation
10:01:39,189 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:01:39,459 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d37u2key/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d37u2key/test/node2/conf'}
10:01:39,459 ccm INFO node2: using Java 8 for the current invocation
10:01:39,640 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d37u2key/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d37u2key/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:01:39,640 ccm INFO node2: using Java 8 for the current invocation
10:01:39,720 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:01:39,966 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d37u2key/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d37u2key/test/node3/conf'}
10:01:39,967 ccm INFO node3: using Java 8 for the current invocation
10:01:40,134 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d37u2key/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d37u2key/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:01:40,134 ccm INFO node3: using Java 8 for the current invocation
10:01:40,215 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
10:01:38,923 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d37u2key/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d37u2key/test/node1/conf'}
10:01:38,924 ccm INFO node1: using Java 8 for the current invocation
10:01:39,99 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d37u2key/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d37u2key/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:01:39,100 ccm INFO node1: using Java 8 for the current invocation
10:01:39,189 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:01:39,459 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d37u2key/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d37u2key/test/node2/conf'}
10:01:39,459 ccm INFO node2: using Java 8 for the current invocation
10:01:39,640 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d37u2key/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d37u2key/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:01:39,640 ccm INFO node2: using Java 8 for the current invocation
10:01:39,720 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:01:39,966 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d37u2key/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d37u2key/test/node3/conf'}
10:01:39,967 ccm INFO node3: using Java 8 for the current invocation
10:01:40,134 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d37u2key/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d37u2key/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:01:40,134 ccm INFO node3: using Java 8 for the current invocation
10:01:40,215 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:02:05,13 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:02:05,15 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:02:32,460 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stderr teardown ---------------------------
swapoff: Not superuser.
---------------------------- Captured stdout setup -----------------------------
10:02:36,123 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:02:35,463 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:02:35.463857
10:02:36,31 dtest_setup INFO cluster ccm directory: /tmp/dtest-i6luf3yq
----------------------------- Captured stdout call -----------------------------

10:02:36,125 ccm DEBUG using balanced tokens for non-vnode cluster
10:02:37,516 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i6luf3yq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i6luf3yq/test/node1/conf'}
10:02:37,517 ccm INFO node1: using Java 8 for the current invocation
10:02:37,695 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i6luf3yq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i6luf3yq/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:02:37,696 ccm INFO node1: using Java 8 for the current invocation
10:02:37,782 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:02:38,56 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i6luf3yq/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i6luf3yq/test/node2/conf'}
10:02:38,57 ccm INFO node2: using Java 8 for the current invocation
10:02:38,235 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i6luf3yq/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i6luf3yq/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:02:38,236 ccm INFO node2: using Java 8 for the current invocation
10:02:38,332 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:02:38,595 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i6luf3yq/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i6luf3yq/test/node3/conf'}
10:02:38,596 ccm INFO node3: using Java 8 for the current invocation
10:02:38,771 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i6luf3yq/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i6luf3yq/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:02:38,772 ccm INFO node3: using Java 8 for the current invocation
10:02:38,860 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
10:02:37,516 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i6luf3yq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i6luf3yq/test/node1/conf'}
10:02:37,517 ccm INFO node1: using Java 8 for the current invocation
10:02:37,695 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i6luf3yq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i6luf3yq/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:02:37,696 ccm INFO node1: using Java 8 for the current invocation
10:02:37,782 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:02:38,56 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i6luf3yq/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i6luf3yq/test/node2/conf'}
10:02:38,57 ccm INFO node2: using Java 8 for the current invocation
10:02:38,235 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i6luf3yq/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i6luf3yq/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:02:38,236 ccm INFO node2: using Java 8 for the current invocation
10:02:38,332 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:02:38,595 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i6luf3yq/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i6luf3yq/test/node3/conf'}
10:02:38,596 ccm INFO node3: using Java 8 for the current invocation
10:02:38,771 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i6luf3yq/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i6luf3yq/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:02:38,772 ccm INFO node3: using Java 8 for the current invocation
10:02:38,860 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:03:06,665 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:03:06,666 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:02:32,460 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stderr teardown ---------------------------
swapoff: Not superuser.
--------------------------- Captured stdout teardown ---------------------------
10:02:32,460 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stderr teardown ---------------------------
swapoff: Not superuser.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]10:03:34,48 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 117.84 seconds ==========================
[msx] rc = 1
v1v2 running time = 139301964652
---> v1v2 test failed.
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: native_transport_flush_in_batches_legacy@@@CassandraDaemon@@@-3@@@true@@@false
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:04:49,713 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:04:49,715 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 59.15 seconds ===========================
[msx] rc = 0
v1v1 running time = 80714450613
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:05:57,387 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:05:58,392 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.9 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:06:00,298 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.56 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:06:04,910 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 7.12 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:06:12,128 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 15.2 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:06:12,744 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:06:12,746 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 61.51 seconds ===========================
[msx] rc = 0
v2v2 running time = 83021666930
---> v1v1 and v2v2 test test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:07:36,357 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:07:37,395 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.84 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:07:39,301 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.16 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
10:08:36,59 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 58

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7fe688b3a358>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7fe68074d128>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
10:06:41,364 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:06:39,998 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:06:39.998053
10:06:41,259 dtest_setup INFO cluster ccm directory: /tmp/dtest-6mqulphd
----------------------------- Captured stdout call -----------------------------
10:06:41,367 ccm DEBUG using balanced tokens for non-vnode cluster
10:06:42,868 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mqulphd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mqulphd/test/node1/conf'}
10:06:42,869 ccm INFO node1: using Java 8 for the current invocation
10:06:43,31 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mqulphd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mqulphd/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:06:43,31 ccm INFO node1: using Java 8 for the current invocation
10:06:43,106 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:06:43,360 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mqulphd/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mqulphd/test/node2/conf'}
10:06:43,361 ccm INFO node2: using Java 8 for the current invocation
10:06:43,536 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mqulphd/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mqulphd/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:06:43,536 ccm INFO node2: using Java 8 for the current invocation
10:06:43,618 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:06:43,931 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mqulphd/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mqulphd/test/node3/conf'}
10:06:43,932 ccm INFO node3: using Java 8 for the current invocation
10:06:44,91 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mqulphd/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mqulphd/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:06:44,92 ccm INFO node3: using Java 8 for the current invocation
10:06:44,179 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
10:06:42,868 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mqulphd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mqulphd/test/node1/conf'}
10:06:42,869 ccm INFO node1: using Java 8 for the current invocation
10:06:43,31 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mqulphd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mqulphd/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:06:43,31 ccm INFO node1: using Java 8 for the current invocation
10:06:43,106 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:06:43,360 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mqulphd/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mqulphd/test/node2/conf'}
10:06:43,361 ccm INFO node2: using Java 8 for the current invocation
10:06:43,536 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mqulphd/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mqulphd/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:06:43,536 ccm INFO node2: using Java 8 for the current invocation
10:06:43,618 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:06:43,931 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mqulphd/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mqulphd/test/node3/conf'}
10:06:43,932 ccm INFO node3: using Java 8 for the current invocation
10:06:44,91 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mqulphd/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mqulphd/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:06:44,92 ccm INFO node3: using Java 8 for the current invocation
10:06:44,179 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:07:11,964 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:07:11,966 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:07:39,630 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
0:07:43,239 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:07:42,576 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:07:42.576282
10:07:43,145 dtest_setup INFO cluster ccm directory: /tmp/dtest-ptb2avqr
----------------------------- Captured stdout call -----------------------------
10:07:43,241 ccm DEBUG using balanced tokens for non-vnode cluster
10:07:44,694 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ptb2avqr/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ptb2avqr/test/node1/conf'}
10:07:44,695 ccm INFO node1: using Java 8 for the current invocation
10:07:44,871 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ptb2avqr/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ptb2avqr/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:07:44,872 ccm INFO node1: using Java 8 for the current invocation
10:07:44,964 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:07:45,251 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ptb2avqr/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ptb2avqr/test/node2/conf'}
10:07:45,252 ccm INFO node2: using Java 8 for the current invocation
10:07:45,421 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ptb2avqr/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ptb2avqr/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:07:45,421 ccm INFO node2: using Java 8 for the current invocation
10:07:45,501 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:07:45,762 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ptb2avqr/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ptb2avqr/test/node3/conf'}
10:07:45,763 ccm INFO node3: using Java 8 for the current invocation
10:07:45,928 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ptb2avqr/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ptb2avqr/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:07:45,929 ccm INFO node3: using Java 8 for the current invocation
10:07:46,30 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
1
------------------------------ Captured log call -------------------------------
10:07:44,694 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ptb2avqr/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ptb2avqr/test/node1/conf'}
10:07:44,695 ccm INFO node1: using Java 8 for the current invocation
10:07:44,871 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ptb2avqr/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ptb2avqr/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:07:44,872 ccm INFO node1: using Java 8 for the current invocation
10:07:44,964 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:07:45,251 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ptb2avqr/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ptb2avqr/test/node2/conf'}
10:07:45,252 ccm INFO node2: using Java 8 for the current invocation
10:07:45,421 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ptb2avqr/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ptb2avqr/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:07:45,421 ccm INFO node2: using Java 8 for the current invocation
10:07:45,501 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:07:45,762 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ptb2avqr/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ptb2avqr/test/node3/conf'}
10:07:45,763 ccm INFO node3: using Java 8 for the current invocation
10:07:45,928 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ptb2avqr/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ptb2avqr/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:07:45,929 ccm INFO node3: using Java 8 for the current invocation
10:07:46,30 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:08:11,835 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:08:11,836 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:07:39,630 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:07:39,630 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]10:08:36,466 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 117.21 seconds ==========================
[msx] rc = 1
v1v2 running time = 138682932336
---> v1v2 test failed.
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: native_transport_flush_in_batches_legacy@@@CassandraDaemon@@@-3@@@true@@@false
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:09:51,493 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:09:51,495 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 58.42 seconds ===========================
[msx] rc = 0
v1v1 running time = 79893743568
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:11:17,601 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:11:17,604 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:11:21,994 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:11:21,995 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 65.17 seconds ===========================
[msx] rc = 0
v2v2 running time = 86746579374
---> v1v1 and v2v2 test test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:12:40,321 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:12:40,323 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:12:42,655 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:12:43,760 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.9 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 60.59 seconds ===========================
[msx] rc = 0
v1v2 running time = 82152591518
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:14:04,430 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:14:04,432 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 62.34 seconds ===========================
[msx] rc = 0
v1v1 running time = 83877668724
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:15:23,270 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:15:23,272 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 57.50 seconds ===========================
[msx] rc = 0
v2v2 running time = 78959467136
---> v1v1 and v2v2 test test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:16:44,18 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:16:44,20 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 59.25 seconds ===========================
[msx] rc = 0
v1v2 running time = 80708142058
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:18:08,715 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:18:08,717 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:18:12,501 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 63.35 seconds ===========================
[msx] rc = 0
v1v1 running time = 84804594048
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:19:27,145 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:19:28,167 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.02 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:19:30,275 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.64 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
10:20:27,642 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 24

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7ff0f54589e8>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7ff0ecfdd5f8>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
10:18:36,759 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:18:35,765 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:18:35.765471
10:18:36,674 dtest_setup INFO cluster ccm directory: /tmp/dtest-gvtuvt0c
----------------------------- Captured stdout call -----------------------------

10:18:36,761 ccm DEBUG using balanced tokens for non-vnode cluster
10:18:38,341 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvtuvt0c/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvtuvt0c/test/node1/conf'}
10:18:38,341 ccm INFO node1: using Java 8 for the current invocation
10:18:38,511 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvtuvt0c/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvtuvt0c/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:18:38,511 ccm INFO node1: using Java 8 for the current invocation
10:18:38,616 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:18:38,900 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvtuvt0c/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvtuvt0c/test/node2/conf'}
10:18:38,900 ccm INFO node2: using Java 8 for the current invocation
10:18:39,82 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvtuvt0c/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvtuvt0c/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:18:39,82 ccm INFO node2: using Java 8 for the current invocation
10:18:39,173 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:18:39,442 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvtuvt0c/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvtuvt0c/test/node3/conf'}
10:18:39,443 ccm INFO node3: using Java 8 for the current invocation
10:18:39,630 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvtuvt0c/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvtuvt0c/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:18:39,631 ccm INFO node3: using Java 8 for the current invocation
10:18:39,722 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
10:18:38,341 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvtuvt0c/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvtuvt0c/test/node1/conf'}
10:18:38,341 ccm INFO node1: using Java 8 for the current invocation
10:18:38,511 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvtuvt0c/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvtuvt0c/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:18:38,511 ccm INFO node1: using Java 8 for the current invocation
10:18:38,616 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:18:38,900 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvtuvt0c/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvtuvt0c/test/node2/conf'}
10:18:38,900 ccm INFO node2: using Java 8 for the current invocation
10:18:39,82 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvtuvt0c/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvtuvt0c/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:18:39,82 ccm INFO node2: using Java 8 for the current invocation
10:18:39,173 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:18:39,442 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvtuvt0c/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvtuvt0c/test/node3/conf'}
10:18:39,443 ccm INFO node3: using Java 8 for the current invocation
10:18:39,630 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gvtuvt0c/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gvtuvt0c/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:18:39,631 ccm INFO node3: using Java 8 for the current invocation
10:18:39,722 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:19:03,506 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:19:03,509 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:19:31,146 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
10:19:35,644 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:19:34,513 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:19:34.513518
10:19:35,534 dtest_setup INFO cluster ccm directory: /tmp/dtest-3exuhqkb
------------------------------ Captured log call -------------------------------
10:19:37,92 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3exuhqkb/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3exuhqkb/test/node1/conf'}
10:19:37,93 ccm INFO node1: using Java 8 for the current invocation
10:19:37,268 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3exuhqkb/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3exuhqkb/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:19:37,269 ccm INFO node1: using Java 8 for the current invocation
10:19:37,356 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:19:37,656 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3exuhqkb/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3exuhqkb/test/node2/conf'}
10:19:37,657 ccm INFO node2: using Java 8 for the current invocation
10:19:37,831 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3exuhqkb/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3exuhqkb/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:19:37,832 ccm INFO node2: using Java 8 for the current invocation
10:19:37,917 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:19:38,193 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3exuhqkb/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3exuhqkb/test/node3/conf'}
10:19:38,194 ccm INFO node3: using Java 8 for the current invocation
10:19:38,351 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3exuhqkb/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3exuhqkb/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:19:38,352 ccm INFO node3: using Java 8 for the current invocation
10:19:38,440 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:20:02,251 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:20:02,252 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:19:31,146 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:19:31,146 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]10:20:28,52 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 115.00 seconds ==========================
[msx] rc = 1
v2v2 running time = 136424197945
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: native_transport_flush_in_batches_legacy@@@CassandraDaemon@@@-3@@@true@@@false
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:21:51,89 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:21:52,108 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.9 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:21:54,15 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.08 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
10:22:53,570 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 18

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f0d369d8630>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f0d1de643c8>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
10:20:53,97 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:20:52,250 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:20:52.250651
10:20:53,6 dtest_setup INFO cluster ccm directory: /tmp/dtest-7qtkb2ls
----------------------------- Captured stdout call -----------------------------
10:20:53,99 ccm DEBUG using balanced tokens for non-vnode cluster
10:20:54,557 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node1/conf'}
10:20:54,557 ccm INFO node1: using Java 8 for the current invocation
10:20:54,717 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:20:54,718 ccm INFO node1: using Java 8 for the current invocation
10:20:54,843 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:20:55,575 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node2/conf'}
10:20:55,575 ccm INFO node2: using Java 8 for the current invocation
10:20:56,127 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:20:56,128 ccm INFO node2: using Java 8 for the current invocation
10:20:56,384 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:20:56,795 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node3/conf'}
10:20:56,795 ccm INFO node3: using Java 8 for the current invocation
10:20:56,973 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:20:56,974 ccm INFO node3: using Java 8 for the current invocation
10:20:57,66 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:20:53,99 ccm DEBUG using balanced tokens for non-vnode cluster
10:20:54,557 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node1/conf'}
10:20:54,557 ccm INFO node1: using Java 8 for the current invocation
10:20:54,717 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:20:54,718 ccm INFO node1: using Java 8 for the current invocation
10:20:54,843 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:20:55,575 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node2/conf'}
10:20:55,575 ccm INFO node2: using Java 8 for the current invocation
10:20:56,127 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:20:56,128 ccm INFO node2: using Java 8 for the current invocation
10:20:56,384 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:20:56,795 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node3/conf'}
10:20:56,795 ccm INFO node3: using Java 8 for the current invocation
10:20:56,973 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:20:56,974 ccm INFO node3: using Java 8 for the current invocation
10:20:57,66 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
10:20:54,557 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node1/conf'}
10:20:54,557 ccm INFO node1: using Java 8 for the current invocation
10:20:54,717 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:20:54,718 ccm INFO node1: using Java 8 for the current invocation
10:20:54,843 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:20:55,575 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node2/conf'}
10:20:55,575 ccm INFO node2: using Java 8 for the current invocation
10:20:56,127 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:20:56,128 ccm INFO node2: using Java 8 for the current invocation
10:20:56,384 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:20:56,795 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node3/conf'}
10:20:56,795 ccm INFO node3: using Java 8 for the current invocation
10:20:56,973 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7qtkb2ls/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7qtkb2ls/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:20:56,974 ccm INFO node3: using Java 8 for the current invocation
10:20:57,66 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:21:25,32 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:21:25,35 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:21:55,82 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
10:21:59,880 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:21:58,655 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:21:58.655836
10:21:59,773 dtest_setup INFO cluster ccm directory: /tmp/dtest-nspqjlcn
----------------------------- Captured stdout call -----------------------------

10:21:59,882 ccm DEBUG using balanced tokens for non-vnode cluster
10:22:01,488 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nspqjlcn/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nspqjlcn/test/node1/conf'}
10:22:01,488 ccm INFO node1: using Java 8 for the current invocation
10:22:01,665 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nspqjlcn/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nspqjlcn/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:22:01,666 ccm INFO node1: using Java 8 for the current invocation
10:22:01,746 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:22:02,32 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nspqjlcn/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nspqjlcn/test/node2/conf'}
10:22:02,33 ccm INFO node2: using Java 8 for the current invocation
10:22:02,218 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nspqjlcn/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nspqjlcn/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:22:02,219 ccm INFO node2: using Java 8 for the current invocation
10:22:02,304 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:22:02,562 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nspqjlcn/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nspqjlcn/test/node3/conf'}
10:22:02,563 ccm INFO node3: using Java 8 for the current invocation
10:22:02,741 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nspqjlcn/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nspqjlcn/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:22:02,742 ccm INFO node3: using Java 8 for the current invocation
10:22:02,827 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
10:22:01,488 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nspqjlcn/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nspqjlcn/test/node1/conf'}
10:22:01,488 ccm INFO node1: using Java 8 for the current invocation
10:22:01,665 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nspqjlcn/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nspqjlcn/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:22:01,666 ccm INFO node1: using Java 8 for the current invocation
10:22:01,746 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:22:02,32 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nspqjlcn/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nspqjlcn/test/node2/conf'}
10:22:02,33 ccm INFO node2: using Java 8 for the current invocation
10:22:02,218 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nspqjlcn/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nspqjlcn/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:22:02,219 ccm INFO node2: using Java 8 for the current invocation
10:22:02,304 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:22:02,562 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nspqjlcn/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nspqjlcn/test/node3/conf'}
10:22:02,563 ccm INFO node3: using Java 8 for the current invocation
10:22:02,741 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nspqjlcn/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nspqjlcn/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:22:02,742 ccm INFO node3: using Java 8 for the current invocation
10:22:02,827 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:22:28,585 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:22:28,585 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:21:55,82 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:21:55,82 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]10:22:53,996 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 122.44 seconds ==========================
[msx] rc = 1
v1v2 running time = 144116561666
---> v1v2 test failed.
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: native_transport_flush_in_batches_legacy@@@CassandraDaemon@@@-3@@@true@@@false
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:24:10,260 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:24:10,344 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:24:14,810 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:24:14,812 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 59.48 seconds ===========================
[msx] rc = 0
v1v1 running time = 80975726619
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:25:37,240 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:25:38,307 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.08 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:25:40,414 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.96 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
10:26:45,477 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 25

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7faee29ab668>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7faee1083f60>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
10:24:38,974 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:24:37,345 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:24:37.344958
10:24:38,857 dtest_setup INFO cluster ccm directory: /tmp/dtest-ri6lq80x
------------------------------ Captured log call -------------------------------
10:24:40,494 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ri6lq80x/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ri6lq80x/test/node1/conf'}
10:24:40,495 ccm INFO node1: using Java 8 for the current invocation
10:24:40,680 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ri6lq80x/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ri6lq80x/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:24:40,681 ccm INFO node1: using Java 8 for the current invocation
10:24:40,766 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:24:41,57 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ri6lq80x/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ri6lq80x/test/node2/conf'}
10:24:41,58 ccm INFO node2: using Java 8 for the current invocation
10:24:41,235 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ri6lq80x/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ri6lq80x/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:24:41,236 ccm INFO node2: using Java 8 for the current invocation
10:24:41,326 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:24:41,605 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ri6lq80x/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ri6lq80x/test/node3/conf'}
10:24:41,605 ccm INFO node3: using Java 8 for the current invocation
10:24:41,770 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ri6lq80x/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ri6lq80x/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:24:41,770 ccm INFO node3: using Java 8 for the current invocation
10:24:41,848 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:25:12,631 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:25:12,633 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:25:41,755 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
10:25:47,115 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:25:45,361 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:25:45.361889
10:25:46,972 dtest_setup INFO cluster ccm directory: /tmp/dtest-tdpdrlhz
----------------------------- Captured stdout call -----------------------------
10:25:47,118 ccm DEBUG using balanced tokens for non-vnode cluster
10:25:49,709 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tdpdrlhz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tdpdrlhz/test/node1/conf'}
10:25:49,710 ccm INFO node1: using Java 8 for the current invocation
10:25:50,368 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tdpdrlhz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tdpdrlhz/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:25:50,368 ccm INFO node1: using Java 8 for the current invocation
10:25:50,565 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:25:51,99 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tdpdrlhz/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tdpdrlhz/test/node2/conf'}
10:25:51,100 ccm INFO node2: using Java 8 for the current invocation
10:25:51,284 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tdpdrlhz/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tdpdrlhz/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:25:51,284 ccm INFO node2: using Java 8 for the current invocation
10:25:51,373 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:25:51,627 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tdpdrlhz/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tdpdrlhz/test/node3/conf'}
10:25:51,628 ccm INFO node3: using Java 8 for the current invocation
10:25:51,788 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tdpdrlhz/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tdpdrlhz/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:25:51,788 ccm INFO node3: using Java 8 for the current invocation
10:25:51,870 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
10:25:49,709 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tdpdrlhz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tdpdrlhz/test/node1/conf'}
10:25:49,710 ccm INFO node1: using Java 8 for the current invocation
10:25:50,368 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tdpdrlhz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tdpdrlhz/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:25:50,368 ccm INFO node1: using Java 8 for the current invocation
10:25:50,565 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:25:51,99 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tdpdrlhz/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tdpdrlhz/test/node2/conf'}
10:25:51,100 ccm INFO node2: using Java 8 for the current invocation
10:25:51,284 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tdpdrlhz/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tdpdrlhz/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:25:51,284 ccm INFO node2: using Java 8 for the current invocation
10:25:51,373 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:25:51,627 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tdpdrlhz/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tdpdrlhz/test/node3/conf'}
10:25:51,628 ccm INFO node3: using Java 8 for the current invocation
10:25:51,788 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tdpdrlhz/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tdpdrlhz/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:25:51,788 ccm INFO node3: using Java 8 for the current invocation
10:25:51,870 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:26:19,652 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:26:19,653 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:25:41,755 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:25:41,755 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]10:26:45,712 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 129.08 seconds ==========================
[msx] rc = 1
v2v2 running time = 150573233218
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: native_transport_flush_in_batches_legacy@@@CassandraDaemon@@@-3@@@true@@@false
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:28:03,8 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:28:03,10 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:28:06,58 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:28:06,59 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:28:07,176 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.24 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 60.77 seconds ===========================
[msx] rc = 0
v1v2 running time = 82241118656
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:29:30,823 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:29:30,825 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:29:34,535 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:29:34,537 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 66.25 seconds ===========================
[msx] rc = 0
v1v1 running time = 87736570241
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:30:51,98 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:30:51,100 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 58.81 seconds ===========================
[msx] rc = 0
v2v2 running time = 80315851422
---> v1v1 and v2v2 test test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:32:11,400 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:32:11,403 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 58.67 seconds ===========================
[msx] rc = 0
v1v2 running time = 80348827745
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:33:36,633 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:33:36,635 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:33:39,954 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:33:39,955 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:33:40,960 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.08 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 63.69 seconds ===========================
[msx] rc = 0
v1v1 running time = 85178987456
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:35:05,204 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:35:06,443 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.7 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:35:08,151 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.08 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
10:36:04,777 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 57

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7fc855640cf8>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7fc84520bfd0>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
10:34:04,738 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:34:03,766 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:34:03.766648
10:34:04,624 dtest_setup INFO cluster ccm directory: /tmp/dtest-fz9fap_h
----------------------------- Captured stdout call -----------------------------
 10:34:04,740 ccm DEBUG using balanced tokens for non-vnode cluster
10:34:06,323 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fz9fap_h/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fz9fap_h/test/node1/conf'}
10:34:06,324 ccm INFO node1: using Java 8 for the current invocation
10:34:06,491 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fz9fap_h/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fz9fap_h/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:34:06,492 ccm INFO node1: using Java 8 for the current invocation
10:34:06,578 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:34:06,825 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fz9fap_h/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fz9fap_h/test/node2/conf'}
10:34:06,826 ccm INFO node2: using Java 8 for the current invocation
10:34:06,996 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fz9fap_h/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fz9fap_h/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:34:06,997 ccm INFO node2: using Java 8 for the current invocation
10:34:07,75 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:34:07,346 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fz9fap_h/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fz9fap_h/test/node3/conf'}
10:34:07,347 ccm INFO node3: using Java 8 for the current invocation
10:34:07,523 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fz9fap_h/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fz9fap_h/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:34:07,524 ccm INFO node3: using Java 8 for the current invocation
10:34:07,599 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
10:34:06,323 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fz9fap_h/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fz9fap_h/test/node1/conf'}
10:34:06,324 ccm INFO node1: using Java 8 for the current invocation
10:34:06,491 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fz9fap_h/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fz9fap_h/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:34:06,492 ccm INFO node1: using Java 8 for the current invocation
10:34:06,578 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:34:06,825 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fz9fap_h/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fz9fap_h/test/node2/conf'}
10:34:06,826 ccm INFO node2: using Java 8 for the current invocation
10:34:06,996 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fz9fap_h/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fz9fap_h/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:34:06,997 ccm INFO node2: using Java 8 for the current invocation
10:34:07,75 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:34:07,346 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fz9fap_h/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fz9fap_h/test/node3/conf'}
10:34:07,347 ccm INFO node3: using Java 8 for the current invocation
10:34:07,523 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fz9fap_h/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fz9fap_h/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:34:07,524 ccm INFO node3: using Java 8 for the current invocation
10:34:07,599 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:34:39,385 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:34:39,388 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:35:08,927 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
10:35:12,931 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:35:12,65 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:35:12.063855
10:35:12,832 dtest_setup INFO cluster ccm directory: /tmp/dtest-1n97wny5
----------------------------- Captured stdout call -----------------------------

10:35:12,934 ccm DEBUG using balanced tokens for non-vnode cluster
10:35:14,612 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1n97wny5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1n97wny5/test/node1/conf'}
10:35:14,613 ccm INFO node1: using Java 8 for the current invocation
10:35:14,804 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1n97wny5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1n97wny5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:35:14,805 ccm INFO node1: using Java 8 for the current invocation
10:35:14,895 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:35:15,193 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1n97wny5/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1n97wny5/test/node2/conf'}
10:35:15,194 ccm INFO node2: using Java 8 for the current invocation
10:35:15,384 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1n97wny5/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1n97wny5/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:35:15,385 ccm INFO node2: using Java 8 for the current invocation
10:35:15,468 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:35:15,748 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1n97wny5/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1n97wny5/test/node3/conf'}
10:35:15,749 ccm INFO node3: using Java 8 for the current invocation
10:35:15,913 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1n97wny5/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1n97wny5/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:35:15,914 ccm INFO node3: using Java 8 for the current invocation
10:35:15,998 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
10:35:14,612 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1n97wny5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1n97wny5/test/node1/conf'}
10:35:14,613 ccm INFO node1: using Java 8 for the current invocation
10:35:14,804 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1n97wny5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1n97wny5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:35:14,805 ccm INFO node1: using Java 8 for the current invocation
10:35:14,895 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:35:15,193 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1n97wny5/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1n97wny5/test/node2/conf'}
10:35:15,194 ccm INFO node2: using Java 8 for the current invocation
10:35:15,384 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1n97wny5/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1n97wny5/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:35:15,385 ccm INFO node2: using Java 8 for the current invocation
10:35:15,468 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:35:15,748 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1n97wny5/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1n97wny5/test/node3/conf'}
10:35:15,749 ccm INFO node3: using Java 8 for the current invocation
10:35:15,913 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1n97wny5/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1n97wny5/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:35:15,914 ccm INFO node3: using Java 8 for the current invocation
10:35:15,998 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:35:39,787 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:35:39,788 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:35:08,927 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:35:08,927 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]10:36:05,180 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 122.13 seconds ==========================
[msx] rc = 1
v2v2 running time = 143624672378
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: native_transport_flush_in_batches_legacy@@@CassandraDaemon@@@-3@@@true@@@false
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:37:23,706 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:37:23,708 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:37:26,454 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:37:26,456 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:37:27,459 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.0 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 61.70 seconds ===========================
[msx] rc = 0
v1v2 running time = 83353763626
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:38:44,967 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:38:46,199 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.7 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:38:47,904 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.48 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
10:39:46,497 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 55

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f1e3e117978>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f1e2e50b198>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
10:37:52,365 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:37:51,213 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:37:51.213169
10:37:52,272 dtest_setup INFO cluster ccm directory: /tmp/dtest-yn0qqxtv
----------------------------- Captured stdout call -----------------------------

10:37:52,367 ccm DEBUG using balanced tokens for non-vnode cluster
10:37:53,810 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yn0qqxtv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yn0qqxtv/test/node1/conf'}
10:37:53,811 ccm INFO node1: using Java 8 for the current invocation
10:37:53,990 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yn0qqxtv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yn0qqxtv/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:37:53,990 ccm INFO node1: using Java 8 for the current invocation
10:37:54,82 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:37:54,336 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yn0qqxtv/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yn0qqxtv/test/node2/conf'}
10:37:54,337 ccm INFO node2: using Java 8 for the current invocation
10:37:54,506 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yn0qqxtv/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yn0qqxtv/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:37:54,507 ccm INFO node2: using Java 8 for the current invocation
10:37:54,599 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:37:54,862 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yn0qqxtv/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yn0qqxtv/test/node3/conf'}
10:37:54,862 ccm INFO node3: using Java 8 for the current invocation
10:37:55,34 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yn0qqxtv/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yn0qqxtv/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:37:55,34 ccm INFO node3: using Java 8 for the current invocation
10:37:55,117 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
10:37:53,810 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yn0qqxtv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yn0qqxtv/test/node1/conf'}
10:37:53,811 ccm INFO node1: using Java 8 for the current invocation
10:37:53,990 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yn0qqxtv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yn0qqxtv/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:37:53,990 ccm INFO node1: using Java 8 for the current invocation
10:37:54,82 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:37:54,336 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yn0qqxtv/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yn0qqxtv/test/node2/conf'}
10:37:54,337 ccm INFO node2: using Java 8 for the current invocation
10:37:54,506 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yn0qqxtv/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yn0qqxtv/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:37:54,507 ccm INFO node2: using Java 8 for the current invocation
10:37:54,599 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:37:54,862 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yn0qqxtv/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yn0qqxtv/test/node3/conf'}
10:37:54,862 ccm INFO node3: using Java 8 for the current invocation
10:37:55,34 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yn0qqxtv/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yn0qqxtv/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:37:55,34 ccm INFO node3: using Java 8 for the current invocation
10:37:55,117 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:38:19,958 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:38:19,960 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:38:48,437 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
10:38:53,412 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:38:52,203 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:38:52.203864
10:38:53,321 dtest_setup INFO cluster ccm directory: /tmp/dtest-4kw1o4zx
----------------------------- Captured stdout call -----------------------------

10:38:53,414 ccm DEBUG using balanced tokens for non-vnode cluster
10:38:54,980 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4kw1o4zx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4kw1o4zx/test/node1/conf'}
10:38:54,981 ccm INFO node1: using Java 8 for the current invocation
10:38:55,152 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4kw1o4zx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4kw1o4zx/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:38:55,153 ccm INFO node1: using Java 8 for the current invocation
10:38:55,249 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:38:55,542 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4kw1o4zx/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4kw1o4zx/test/node2/conf'}
10:38:55,543 ccm INFO node2: using Java 8 for the current invocation
10:38:55,726 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4kw1o4zx/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4kw1o4zx/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:38:55,727 ccm INFO node2: using Java 8 for the current invocation
10:38:55,816 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:38:56,138 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4kw1o4zx/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4kw1o4zx/test/node3/conf'}
10:38:56,139 ccm INFO node3: using Java 8 for the current invocation
10:38:56,327 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4kw1o4zx/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4kw1o4zx/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:38:56,328 ccm INFO node3: using Java 8 for the current invocation
10:38:56,424 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra

------------------------------ Captured log call -------------------------------
10:38:54,980 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4kw1o4zx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4kw1o4zx/test/node1/conf'}
10:38:54,981 ccm INFO node1: using Java 8 for the current invocation
10:38:55,152 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4kw1o4zx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4kw1o4zx/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:38:55,153 ccm INFO node1: using Java 8 for the current invocation
10:38:55,249 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:38:55,542 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4kw1o4zx/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4kw1o4zx/test/node2/conf'}
10:38:55,543 ccm INFO node2: using Java 8 for the current invocation
10:38:55,726 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4kw1o4zx/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4kw1o4zx/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:38:55,727 ccm INFO node2: using Java 8 for the current invocation
10:38:55,816 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:38:56,138 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4kw1o4zx/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4kw1o4zx/test/node3/conf'}
10:38:56,139 ccm INFO node3: using Java 8 for the current invocation
10:38:56,327 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4kw1o4zx/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4kw1o4zx/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:38:56,328 ccm INFO node3: using Java 8 for the current invocation
10:38:56,424 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:39:22,216 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:39:22,217 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:38:48,437 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:38:48,437 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]10:39:46,909 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 116.42 seconds ==========================
[msx] rc = 1
v1v1 running time = 138357233424
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:41:08,663 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:41:08,665 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 65.20 seconds ===========================
[msx] rc = 0
v2v2 running time = 86696350332
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: native_transport_flush_in_batches_legacy@@@CassandraDaemon@@@-3@@@true@@@false
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:42:29,734 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:42:29,736 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 59.35 seconds ===========================
[msx] rc = 0
v1v2 running time = 80980546528
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:43:49,630 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:43:50,745 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.04 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:43:52,852 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.08 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
10:44:52,139 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 25

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7fc45c1d0f98>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7fc43faed128>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
10:42:58,338 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:42:57,126 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:42:57.126291
10:42:58,238 dtest_setup INFO cluster ccm directory: /tmp/dtest-0fwshkql
----------------------------- Captured stdout call -----------------------------

10:42:58,342 ccm DEBUG using balanced tokens for non-vnode cluster
10:42:59,764 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0fwshkql/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0fwshkql/test/node1/conf'}
10:42:59,765 ccm INFO node1: using Java 8 for the current invocation
10:42:59,939 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0fwshkql/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0fwshkql/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:42:59,939 ccm INFO node1: using Java 8 for the current invocation
10:43:00,26 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:43:00,281 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0fwshkql/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0fwshkql/test/node2/conf'}
10:43:00,282 ccm INFO node2: using Java 8 for the current invocation
10:43:00,447 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0fwshkql/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0fwshkql/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:43:00,448 ccm INFO node2: using Java 8 for the current invocation
10:43:00,535 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:43:00,801 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0fwshkql/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0fwshkql/test/node3/conf'}
10:43:00,802 ccm INFO node3: using Java 8 for the current invocation
10:43:00,957 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0fwshkql/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0fwshkql/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:43:00,958 ccm INFO node3: using Java 8 for the current invocation
10:43:01,49 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
10:42:59,764 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0fwshkql/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0fwshkql/test/node1/conf'}
10:42:59,765 ccm INFO node1: using Java 8 for the current invocation
10:42:59,939 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0fwshkql/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0fwshkql/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:42:59,939 ccm INFO node1: using Java 8 for the current invocation
10:43:00,26 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:43:00,281 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0fwshkql/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0fwshkql/test/node2/conf'}
10:43:00,282 ccm INFO node2: using Java 8 for the current invocation
10:43:00,447 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0fwshkql/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0fwshkql/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:43:00,448 ccm INFO node2: using Java 8 for the current invocation
10:43:00,535 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:43:00,801 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0fwshkql/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0fwshkql/test/node3/conf'}
10:43:00,802 ccm INFO node3: using Java 8 for the current invocation
10:43:00,957 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0fwshkql/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0fwshkql/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:43:00,958 ccm INFO node3: using Java 8 for the current invocation
10:43:01,49 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:43:23,832 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:43:23,835 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:43:53,63 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
10:43:57,527 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:43:56,273 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:43:56.273185
10:43:57,394 dtest_setup INFO cluster ccm directory: /tmp/dtest-247mgkd4
----------------------------- Captured stdout call -----------------------------

10:43:57,530 ccm DEBUG using balanced tokens for non-vnode cluster
10:43:59,129 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-247mgkd4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-247mgkd4/test/node1/conf'}
10:43:59,130 ccm INFO node1: using Java 8 for the current invocation
10:43:59,312 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-247mgkd4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-247mgkd4/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:43:59,312 ccm INFO node1: using Java 8 for the current invocation
10:43:59,397 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:43:59,689 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-247mgkd4/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-247mgkd4/test/node2/conf'}
10:43:59,690 ccm INFO node2: using Java 8 for the current invocation
10:43:59,872 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-247mgkd4/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-247mgkd4/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:43:59,872 ccm INFO node2: using Java 8 for the current invocation
10:43:59,958 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:44:00,233 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-247mgkd4/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-247mgkd4/test/node3/conf'}
10:44:00,234 ccm INFO node3: using Java 8 for the current invocation
10:44:00,413 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-247mgkd4/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-247mgkd4/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:44:00,414 ccm INFO node3: using Java 8 for the current invocation
10:44:00,500 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
10:43:59,129 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-247mgkd4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-247mgkd4/test/node1/conf'}
10:43:59,130 ccm INFO node1: using Java 8 for the current invocation
10:43:59,312 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-247mgkd4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-247mgkd4/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:43:59,312 ccm INFO node1: using Java 8 for the current invocation
10:43:59,397 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:43:59,689 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-247mgkd4/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-247mgkd4/test/node2/conf'}
10:43:59,690 ccm INFO node2: using Java 8 for the current invocation
10:43:59,872 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-247mgkd4/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-247mgkd4/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:43:59,872 ccm INFO node2: using Java 8 for the current invocation
10:43:59,958 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:44:00,233 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-247mgkd4/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-247mgkd4/test/node3/conf'}
10:44:00,234 ccm INFO node3: using Java 8 for the current invocation
10:44:00,413 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-247mgkd4/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-247mgkd4/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:44:00,414 ccm INFO node3: using Java 8 for the current invocation
10:44:00,500 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:44:26,327 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:44:26,328 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:43:53,63 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:43:53,63 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]10:44:52,531 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 116.29 seconds ==========================
[msx] rc = 1
v1v1 running time = 137902229554
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:46:11,653 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:46:11,655 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 62.61 seconds ===========================
[msx] rc = 0
v2v2 running time = 84098444958
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: native_transport_flush_in_batches_legacy@@@CassandraDaemon@@@-3@@@true@@@false
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:47:33,253 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:47:33,255 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:47:35,953 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:47:35,954 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:47:36,958 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.16 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 60.15 seconds ===========================
[msx] rc = 0
v1v2 running time = 81727382604
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:48:54,586 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:48:54,588 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:48:57,145 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:48:57,146 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:48:58,250 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.8 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 59.65 seconds ===========================
[msx] rc = 0
v1v1 running time = 81112076762
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:50:17,425 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:50:17,427 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:50:20,899 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:50:22,4 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.82 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 61.32 seconds ===========================
[msx] rc = 0
v2v2 running time = 83190287111
---> v1v1 and v2v2 test test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:51:36,784 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:51:36,787 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:51:41,156 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 57.57 seconds ===========================
[msx] rc = 0
v1v2 running time = 79030086297
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:52:57,356 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:52:57,357 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:53:01,992 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 59.09 seconds ===========================
[msx] rc = 0
v1v1 running time = 80626296237
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:54:20,717 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:54:20,718 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 61.78 seconds ===========================
[msx] rc = 0
v2v2 running time = 83254133051
---> v1v1 and v2v2 test test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:55:41,146 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:55:41,148 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 59.00 seconds ===========================
[msx] rc = 0
v1v2 running time = 80437886920
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:57:01,252 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:57:01,254 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 58.67 seconds ===========================
[msx] rc = 0
v1v1 running time = 80145583351
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:58:25,847 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:58:25,850 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
10:58:30,65 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:58:30,66 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 63.17 seconds ===========================
[msx] rc = 0
v2v2 running time = 84665622791
---> v1v1 and v2v2 test test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
10:59:49,194 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
10:59:50,203 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.92 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
10:59:52,218 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.44 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
11:00:49,454 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 17

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7fa99a89dc18>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7fa983771080>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
10:58:54,693 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:58:53,325 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:58:53.325866
10:58:54,586 dtest_setup INFO cluster ccm directory: /tmp/dtest-d6n6iqug
----------------------------- Captured stdout call -----------------------------

10:58:54,696 ccm DEBUG using balanced tokens for non-vnode cluster
10:58:56,288 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d6n6iqug/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d6n6iqug/test/node1/conf'}
10:58:56,289 ccm INFO node1: using Java 8 for the current invocation
10:58:56,446 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d6n6iqug/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d6n6iqug/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:58:56,446 ccm INFO node1: using Java 8 for the current invocation
10:58:56,524 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:58:56,800 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d6n6iqug/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d6n6iqug/test/node2/conf'}
10:58:56,801 ccm INFO node2: using Java 8 for the current invocation
10:58:56,970 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d6n6iqug/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d6n6iqug/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:58:56,970 ccm INFO node2: using Java 8 for the current invocation
10:58:57,47 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:58:57,313 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d6n6iqug/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d6n6iqug/test/node3/conf'}
10:58:57,314 ccm INFO node3: using Java 8 for the current invocation
10:58:57,503 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d6n6iqug/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d6n6iqug/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:58:57,504 ccm INFO node3: using Java 8 for the current invocation
10:58:57,587 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
10:58:56,288 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d6n6iqug/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d6n6iqug/test/node1/conf'}
10:58:56,289 ccm INFO node1: using Java 8 for the current invocation
10:58:56,446 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d6n6iqug/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d6n6iqug/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:58:56,446 ccm INFO node1: using Java 8 for the current invocation
10:58:56,524 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:58:56,800 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d6n6iqug/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d6n6iqug/test/node2/conf'}
10:58:56,801 ccm INFO node2: using Java 8 for the current invocation
10:58:56,970 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d6n6iqug/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d6n6iqug/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:58:56,970 ccm INFO node2: using Java 8 for the current invocation
10:58:57,47 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:58:57,313 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d6n6iqug/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d6n6iqug/test/node3/conf'}
10:58:57,314 ccm INFO node3: using Java 8 for the current invocation
10:58:57,503 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d6n6iqug/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d6n6iqug/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
10:58:57,504 ccm INFO node3: using Java 8 for the current invocation
10:58:57,587 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:59:24,399 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
10:59:24,400 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:59:52,887 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
10:59:57,883 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:59:56,484 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 10:59:56.483980
10:59:57,756 dtest_setup INFO cluster ccm directory: /tmp/dtest-xut7rrg_
----------------------------- Captured stdout call -----------------------------
10:59:57,885 ccm DEBUG using balanced tokens for non-vnode cluster
10:59:59,356 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-xut7rrg_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-xut7rrg_/test/node1/conf'}
10:59:59,358 ccm INFO node1: using Java 8 for the current invocation
10:59:59,535 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-xut7rrg_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-xut7rrg_/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:59:59,535 ccm INFO node1: using Java 8 for the current invocation
10:59:59,627 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:59:59,915 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-xut7rrg_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-xut7rrg_/test/node2/conf'}
10:59:59,916 ccm INFO node2: using Java 8 for the current invocation
11:00:00,96 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-xut7rrg_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-xut7rrg_/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:00:00,97 ccm INFO node2: using Java 8 for the current invocation
11:00:00,178 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:00:00,430 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-xut7rrg_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-xut7rrg_/test/node3/conf'}
11:00:00,431 ccm INFO node3: using Java 8 for the current invocation
11:00:00,624 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-xut7rrg_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-xut7rrg_/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:00:00,625 ccm INFO node3: using Java 8 for the current invocation
11:00:00,715 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
10:59:59,356 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-xut7rrg_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-xut7rrg_/test/node1/conf'}
10:59:59,358 ccm INFO node1: using Java 8 for the current invocation
10:59:59,535 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-xut7rrg_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-xut7rrg_/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
10:59:59,535 ccm INFO node1: using Java 8 for the current invocation
10:59:59,627 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:59:59,915 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-xut7rrg_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-xut7rrg_/test/node2/conf'}
10:59:59,916 ccm INFO node2: using Java 8 for the current invocation
11:00:00,96 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-xut7rrg_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-xut7rrg_/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:00:00,97 ccm INFO node2: using Java 8 for the current invocation
11:00:00,178 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:00:00,430 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-xut7rrg_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-xut7rrg_/test/node3/conf'}
11:00:00,431 ccm INFO node3: using Java 8 for the current invocation
11:00:00,624 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-xut7rrg_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-xut7rrg_/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:00:00,625 ccm INFO node3: using Java 8 for the current invocation
11:00:00,715 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:00:24,499 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
11:00:24,499 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
10:59:52,887 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:59:52,887 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]11:00:49,855 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 117.39 seconds ==========================
[msx] rc = 1
v1v2 running time = 139025920536
---> v1v2 test failed.
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: native_transport_flush_in_batches_legacy@@@CassandraDaemon@@@-3@@@true@@@false
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
11:02:04,429 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
11:02:04,431 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
11:02:09,53 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 58.00 seconds ===========================
[msx] rc = 0
v1v1 running time = 79547519647
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
11:03:24,659 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:03:25,681 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.26 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:03:27,989 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.56 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
11:04:23,646 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 48

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7feca29bfda0>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7fec8b05a160>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
11:02:32,687 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:02:31,628 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 11:02:31.628145
11:02:32,578 dtest_setup INFO cluster ccm directory: /tmp/dtest-k35zz4op
----------------------------- Captured stdout call -----------------------------

11:02:32,690 ccm DEBUG using balanced tokens for non-vnode cluster
11:02:34,78 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node1/conf'}
11:02:34,79 ccm INFO node1: using Java 8 for the current invocation
11:02:34,258 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:02:34,259 ccm INFO node1: using Java 8 for the current invocation
11:02:34,348 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:02:34,677 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node2/conf'}
11:02:34,678 ccm INFO node2: using Java 8 for the current invocation
11:02:34,853 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:02:34,854 ccm INFO node2: using Java 8 for the current invocation
11:02:34,942 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:02:35,197 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node3/conf'}
11:02:35,197 ccm INFO node3: using Java 8 for the current invocation
11:02:35,373 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:02:35,374 ccm INFO node3: using Java 8 for the current invocation
11:02:35,449 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra

11:02:32,690 ccm DEBUG using balanced tokens for non-vnode cluster
11:02:34,78 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node1/conf'}
11:02:34,79 ccm INFO node1: using Java 8 for the current invocation
11:02:34,258 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:02:34,259 ccm INFO node1: using Java 8 for the current invocation
11:02:34,348 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:02:34,677 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node2/conf'}
11:02:34,678 ccm INFO node2: using Java 8 for the current invocation
11:02:34,853 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:02:34,854 ccm INFO node2: using Java 8 for the current invocation
11:02:34,942 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:02:35,197 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node3/conf'}
11:02:35,197 ccm INFO node3: using Java 8 for the current invocation
11:02:35,373 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:02:35,374 ccm INFO node3: using Java 8 for the current invocation
11:02:35,449 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:02:34,78 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node1/conf'}
11:02:34,79 ccm INFO node1: using Java 8 for the current invocation
11:02:34,258 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:02:34,259 ccm INFO node1: using Java 8 for the current invocation
11:02:34,348 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:02:34,677 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node2/conf'}
11:02:34,678 ccm INFO node2: using Java 8 for the current invocation
11:02:34,853 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:02:34,854 ccm INFO node2: using Java 8 for the current invocation
11:02:34,942 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:02:35,197 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node3/conf'}
11:02:35,197 ccm INFO node3: using Java 8 for the current invocation
11:02:35,373 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k35zz4op/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k35zz4op/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:02:35,374 ccm INFO node3: using Java 8 for the current invocation
11:02:35,449 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:02:59,216 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
11:02:59,217 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
11:03:28,401 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:03:32,969 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:03:31,752 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-01-31 11:03:31.752409
11:03:32,871 dtest_setup INFO cluster ccm directory: /tmp/dtest-fhgptei6
----------------------------- Captured stdout call -----------------------------

11:03:32,971 ccm DEBUG using balanced tokens for non-vnode cluster
11:03:34,461 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node1/conf'}
11:03:34,462 ccm INFO node1: using Java 8 for the current invocation
11:03:34,632 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:03:34,632 ccm INFO node1: using Java 8 for the current invocation
11:03:34,717 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:03:34,995 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node2/conf'}
11:03:34,996 ccm INFO node2: using Java 8 for the current invocation
11:03:35,149 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:03:35,150 ccm INFO node2: using Java 8 for the current invocation
11:03:35,232 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:03:35,508 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node3/conf'}
11:03:35,508 ccm INFO node3: using Java 8 for the current invocation
11:03:35,682 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:03:35,683 ccm INFO node3: using Java 8 for the current invocation
11:03:35,769 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra

11:03:32,971 ccm DEBUG using balanced tokens for non-vnode cluster
11:03:34,461 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node1/conf'}
11:03:34,462 ccm INFO node1: using Java 8 for the current invocation
11:03:34,632 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:03:34,632 ccm INFO node1: using Java 8 for the current invocation
11:03:34,717 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:03:34,995 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node2/conf'}
11:03:34,996 ccm INFO node2: using Java 8 for the current invocation
11:03:35,149 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:03:35,150 ccm INFO node2: using Java 8 for the current invocation
11:03:35,232 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:03:35,508 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node3/conf'}
11:03:35,508 ccm INFO node3: using Java 8 for the current invocation
11:03:35,682 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:03:35,683 ccm INFO node3: using Java 8 for the current invocation
11:03:35,769 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:03:34,461 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node1/conf'}
11:03:34,462 ccm INFO node1: using Java 8 for the current invocation
11:03:34,632 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:03:34,632 ccm INFO node1: using Java 8 for the current invocation
11:03:34,717 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:03:34,995 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node2/conf'}
11:03:34,996 ccm INFO node2: using Java 8 for the current invocation
11:03:35,149 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:03:35,150 ccm INFO node2: using Java 8 for the current invocation
11:03:35,232 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:03:35,508 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node3/conf'}
11:03:35,508 ccm INFO node3: using Java 8 for the current invocation
11:03:35,682 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'd1939801cf0d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fhgptei6/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fhgptei6/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:03:35,683 ccm INFO node3: using Java 8 for the current invocation
11:03:35,769 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:03:58,564 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
11:03:58,565 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
11:03:28,401 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:03:28,401 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]11:04:24,36 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 113.11 seconds ==========================
[msx] rc = 1
v2v2 running time = 134596299859
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: native_transport_flush_in_batches_legacy@@@CassandraDaemon@@@-3@@@true@@@false
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

early stop after 7 is satisfied
v1v2 failed with probability 4 out of 17
v1v1v2v2 failed with probability 7 out of 17
Total execution time in seconds : 4885
0
