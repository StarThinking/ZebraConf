my_type=hypothesis
proj=cassandra
u_test=paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list[1]=truncate_request_timeout_in_ms@@@CassandraDaemon@@@-2@@@6000@@@15000
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: truncate_request_timeout_in_ms@@@CassandraDaemon@@@-2@@@6000@@@15000
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
07:38:52,562 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
07:38:52,564 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 58.41 seconds ===========================
[msx] rc = 0
v1v2 running time = 80132735865
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
07:40:10,575 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
07:40:11,611 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.78 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
07:40:13,417 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.48 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
07:41:12,168 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 15

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f4ef2effe80>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f4edb3b7f28>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
07:39:21,116 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
07:39:19,860 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 07:39:19.860180
07:39:21,19 dtest_setup INFO cluster ccm directory: /tmp/dtest-x4hlqwq0
----------------------------- Captured stdout call -----------------------------
07:39:21,119 ccm DEBUG using balanced tokens for non-vnode cluster
07:39:22,697 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x4hlqwq0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x4hlqwq0/test/node1/conf'}
07:39:22,698 ccm INFO node1: using Java 8 for the current invocation
07:39:22,878 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x4hlqwq0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x4hlqwq0/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:39:22,879 ccm INFO node1: using Java 8 for the current invocation
07:39:22,958 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:39:23,216 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x4hlqwq0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x4hlqwq0/test/node2/conf'}
07:39:23,217 ccm INFO node2: using Java 8 for the current invocation
07:39:23,380 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x4hlqwq0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x4hlqwq0/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:39:23,380 ccm INFO node2: using Java 8 for the current invocation
07:39:23,475 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:39:23,743 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x4hlqwq0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x4hlqwq0/test/node3/conf'}
07:39:23,744 ccm INFO node3: using Java 8 for the current invocation
07:39:23,913 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x4hlqwq0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x4hlqwq0/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:39:23,914 ccm INFO node3: using Java 8 for the current invocation
07:39:23,998 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
07:39:22,697 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x4hlqwq0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x4hlqwq0/test/node1/conf'}
07:39:22,698 ccm INFO node1: using Java 8 for the current invocation
07:39:22,878 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x4hlqwq0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x4hlqwq0/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:39:22,879 ccm INFO node1: using Java 8 for the current invocation
07:39:22,958 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:39:23,216 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x4hlqwq0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x4hlqwq0/test/node2/conf'}
07:39:23,217 ccm INFO node2: using Java 8 for the current invocation
07:39:23,380 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x4hlqwq0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x4hlqwq0/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:39:23,380 ccm INFO node2: using Java 8 for the current invocation
07:39:23,475 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:39:23,743 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x4hlqwq0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x4hlqwq0/test/node3/conf'}
07:39:23,744 ccm INFO node3: using Java 8 for the current invocation
07:39:23,913 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x4hlqwq0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x4hlqwq0/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:39:23,914 ccm INFO node3: using Java 8 for the current invocation
07:39:23,998 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:39:47,763 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
07:39:47,766 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
07:40:14,533 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
07:40:19,805 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
07:40:18,532 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 07:40:18.532185
07:40:19,700 dtest_setup INFO cluster ccm directory: /tmp/dtest-0nm4r2l7
----------------------------- Captured stdout call -----------------------------

07:40:19,808 ccm DEBUG using balanced tokens for non-vnode cluster
07:40:21,335 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0nm4r2l7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0nm4r2l7/test/node1/conf'}
07:40:21,336 ccm INFO node1: using Java 8 for the current invocation
07:40:21,480 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0nm4r2l7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0nm4r2l7/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:40:21,481 ccm INFO node1: using Java 8 for the current invocation
07:40:21,562 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:40:21,825 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0nm4r2l7/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0nm4r2l7/test/node2/conf'}
07:40:21,825 ccm INFO node2: using Java 8 for the current invocation
07:40:21,997 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0nm4r2l7/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0nm4r2l7/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:40:21,998 ccm INFO node2: using Java 8 for the current invocation
07:40:22,86 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:40:22,373 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0nm4r2l7/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0nm4r2l7/test/node3/conf'}
07:40:22,373 ccm INFO node3: using Java 8 for the current invocation
07:40:22,532 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0nm4r2l7/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0nm4r2l7/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:40:22,533 ccm INFO node3: using Java 8 for the current invocation
07:40:22,618 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
07:40:21,335 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0nm4r2l7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0nm4r2l7/test/node1/conf'}
07:40:21,336 ccm INFO node1: using Java 8 for the current invocation
07:40:21,480 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0nm4r2l7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0nm4r2l7/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:40:21,481 ccm INFO node1: using Java 8 for the current invocation
07:40:21,562 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:40:21,825 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0nm4r2l7/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0nm4r2l7/test/node2/conf'}
07:40:21,825 ccm INFO node2: using Java 8 for the current invocation
07:40:21,997 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0nm4r2l7/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0nm4r2l7/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:40:21,998 ccm INFO node2: using Java 8 for the current invocation
07:40:22,86 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:40:22,373 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0nm4r2l7/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0nm4r2l7/test/node3/conf'}
07:40:22,373 ccm INFO node3: using Java 8 for the current invocation
07:40:22,532 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0nm4r2l7/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0nm4r2l7/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:40:22,533 ccm INFO node3: using Java 8 for the current invocation
07:40:22,618 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:40:47,388 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
07:40:47,388 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
07:41:12,168 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
--------------------------- Captured stdout teardown ---------------------------
07:40:14,533 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
07:40:14,533 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]07:41:12,596 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 113.44 seconds ==========================
[msx] rc = 1
v1v1 running time = 135052776859
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
07:42:26,466 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
07:42:27,500 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.1 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
07:42:29,608 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.32 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
07:43:23,370 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 21

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7faf097b03c8>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7faf0874a6a0>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
07:41:35,770 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
07:41:34,914 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 07:41:34.914407
07:41:35,673 dtest_setup INFO cluster ccm directory: /tmp/dtest-gq991d52
----------------------------- Captured stdout call -----------------------------
07:41:35,773 ccm DEBUG using balanced tokens for non-vnode cluster
07:41:37,59 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gq991d52/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gq991d52/test/node1/conf'}
07:41:37,60 ccm INFO node1: using Java 8 for the current invocation
07:41:37,231 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gq991d52/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gq991d52/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:41:37,232 ccm INFO node1: using Java 8 for the current invocation
07:41:37,320 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:41:37,581 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gq991d52/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gq991d52/test/node2/conf'}
07:41:37,582 ccm INFO node2: using Java 8 for the current invocation
07:41:37,752 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gq991d52/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gq991d52/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:41:37,753 ccm INFO node2: using Java 8 for the current invocation
07:41:37,835 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:41:38,88 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gq991d52/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gq991d52/test/node3/conf'}
07:41:38,88 ccm INFO node3: using Java 8 for the current invocation
07:41:38,253 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gq991d52/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gq991d52/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:41:38,254 ccm INFO node3: using Java 8 for the current invocation
07:41:38,338 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
07:41:37,59 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gq991d52/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gq991d52/test/node1/conf'}
07:41:37,60 ccm INFO node1: using Java 8 for the current invocation
07:41:37,231 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gq991d52/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gq991d52/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:41:37,232 ccm INFO node1: using Java 8 for the current invocation
07:41:37,320 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:41:37,581 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gq991d52/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gq991d52/test/node2/conf'}
07:41:37,582 ccm INFO node2: using Java 8 for the current invocation
07:41:37,752 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gq991d52/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gq991d52/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:41:37,753 ccm INFO node2: using Java 8 for the current invocation
07:41:37,835 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:41:38,88 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gq991d52/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gq991d52/test/node3/conf'}
07:41:38,88 ccm INFO node3: using Java 8 for the current invocation
07:41:38,253 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-gq991d52/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-gq991d52/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:41:38,254 ccm INFO node3: using Java 8 for the current invocation
07:41:38,338 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:42:02,94 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
07:42:02,97 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
07:42:30,259 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
07:42:33,917 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
07:42:33,353 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 07:42:33.353921
07:42:33,818 dtest_setup INFO cluster ccm directory: /tmp/dtest-k3c1hf56
----------------------------- Captured stdout call -----------------------------
07:42:33,920 ccm DEBUG using balanced tokens for non-vnode cluster
07:42:35,305 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3c1hf56/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3c1hf56/test/node1/conf'}
07:42:35,307 ccm INFO node1: using Java 8 for the current invocation
07:42:35,465 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3c1hf56/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3c1hf56/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:42:35,466 ccm INFO node1: using Java 8 for the current invocation
07:42:35,549 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:42:35,817 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3c1hf56/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3c1hf56/test/node2/conf'}
07:42:35,818 ccm INFO node2: using Java 8 for the current invocation
07:42:35,990 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3c1hf56/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3c1hf56/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:42:35,990 ccm INFO node2: using Java 8 for the current invocation
07:42:36,67 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:42:36,320 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3c1hf56/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3c1hf56/test/node3/conf'}
07:42:36,321 ccm INFO node3: using Java 8 for the current invocation
07:42:36,490 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3c1hf56/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3c1hf56/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:42:36,491 ccm INFO node3: using Java 8 for the current invocation
07:42:36,574 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
0
------------------------------ Captured log call -------------------------------
07:42:35,305 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3c1hf56/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3c1hf56/test/node1/conf'}
07:42:35,307 ccm INFO node1: using Java 8 for the current invocation
07:42:35,465 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3c1hf56/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3c1hf56/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:42:35,466 ccm INFO node1: using Java 8 for the current invocation
07:42:35,549 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:42:35,817 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3c1hf56/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3c1hf56/test/node2/conf'}
07:42:35,818 ccm INFO node2: using Java 8 for the current invocation
07:42:35,990 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3c1hf56/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3c1hf56/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:42:35,990 ccm INFO node2: using Java 8 for the current invocation
07:42:36,67 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:42:36,320 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3c1hf56/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3c1hf56/test/node3/conf'}
07:42:36,321 ccm INFO node3: using Java 8 for the current invocation
07:42:36,490 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k3c1hf56/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k3c1hf56/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:42:36,491 ccm INFO node3: using Java 8 for the current invocation
07:42:36,574 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:43:00,336 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
07:43:00,337 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
07:42:30,259 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
07:42:30,259 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]07:43:23,847 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 109.65 seconds ==========================
[msx] rc = 1
v2v2 running time = 131353989673
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: truncate_request_timeout_in_ms@@@CassandraDaemon@@@-2@@@6000@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

v2v2 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: truncate_request_timeout_in_ms@@@CassandraDaemon@@@-2@@@6000@@@15000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
07:44:41,661 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
07:44:41,663 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
07:44:46,256 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 61.02 seconds ===========================
[msx] rc = 0
v1v2 running time = 82775107852
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
07:46:03,396 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
07:46:03,398 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
07:46:07,678 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 59.79 seconds ===========================
[msx] rc = 0
v1v1 running time = 81538813957
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
07:47:25,517 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
07:47:25,518 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 60.63 seconds ===========================
[msx] rc = 0
v2v2 running time = 82255899255
---> v1v1 and v2v2 test test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
07:48:46,855 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
07:48:48,30 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.94 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
07:48:50,38 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.36 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
07:49:47,546 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 76

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f90326cb128>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f901ab21780>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
07:47:55,888 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
07:47:52,876 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 07:47:52.875887
07:47:55,792 dtest_setup INFO cluster ccm directory: /tmp/dtest-eyxa4m5_
----------------------------- Captured stdout call -----------------------------
07:47:55,890 ccm DEBUG using balanced tokens for non-vnode cluster
07:47:57,182 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-eyxa4m5_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-eyxa4m5_/test/node1/conf'}
07:47:57,183 ccm INFO node1: using Java 8 for the current invocation
07:47:57,361 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-eyxa4m5_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-eyxa4m5_/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:47:57,361 ccm INFO node1: using Java 8 for the current invocation
07:47:57,449 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:47:57,725 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-eyxa4m5_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-eyxa4m5_/test/node2/conf'}
07:47:57,726 ccm INFO node2: using Java 8 for the current invocation
07:47:57,889 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-eyxa4m5_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-eyxa4m5_/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:47:57,890 ccm INFO node2: using Java 8 for the current invocation
07:47:57,974 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:47:58,238 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-eyxa4m5_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-eyxa4m5_/test/node3/conf'}
07:47:58,238 ccm INFO node3: using Java 8 for the current invocation
07:47:58,408 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-eyxa4m5_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-eyxa4m5_/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:47:58,408 ccm INFO node3: using Java 8 for the current invocation
07:47:58,487 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
07:47:57,182 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-eyxa4m5_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-eyxa4m5_/test/node1/conf'}
07:47:57,183 ccm INFO node1: using Java 8 for the current invocation
07:47:57,361 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-eyxa4m5_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-eyxa4m5_/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:47:57,361 ccm INFO node1: using Java 8 for the current invocation
07:47:57,449 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:47:57,725 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-eyxa4m5_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-eyxa4m5_/test/node2/conf'}
07:47:57,726 ccm INFO node2: using Java 8 for the current invocation
07:47:57,889 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-eyxa4m5_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-eyxa4m5_/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:47:57,890 ccm INFO node2: using Java 8 for the current invocation
07:47:57,974 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:47:58,238 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-eyxa4m5_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-eyxa4m5_/test/node3/conf'}
07:47:58,238 ccm INFO node3: using Java 8 for the current invocation
07:47:58,408 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-eyxa4m5_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-eyxa4m5_/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:47:58,408 ccm INFO node3: using Java 8 for the current invocation
07:47:58,487 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:48:22,262 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
07:48:22,264 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
07:48:50,557 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
07:48:54,754 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
07:48:53,820 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 07:48:53.820640
07:48:54,639 dtest_setup INFO cluster ccm directory: /tmp/dtest-bthsntwf
----------------------------- Captured stdout call -----------------------------

07:48:54,756 ccm DEBUG using balanced tokens for non-vnode cluster
07:48:56,400 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bthsntwf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bthsntwf/test/node1/conf'}
07:48:56,401 ccm INFO node1: using Java 8 for the current invocation
07:48:56,623 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bthsntwf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bthsntwf/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:48:56,624 ccm INFO node1: using Java 8 for the current invocation
07:48:56,788 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:48:57,204 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bthsntwf/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bthsntwf/test/node2/conf'}
07:48:57,204 ccm INFO node2: using Java 8 for the current invocation
07:48:57,381 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bthsntwf/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bthsntwf/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:48:57,382 ccm INFO node2: using Java 8 for the current invocation
07:48:57,468 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:48:57,788 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bthsntwf/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bthsntwf/test/node3/conf'}
07:48:57,789 ccm INFO node3: using Java 8 for the current invocation
07:48:57,958 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bthsntwf/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bthsntwf/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:48:57,958 ccm INFO node3: using Java 8 for the current invocation
07:48:58,38 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
07:48:56,400 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bthsntwf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bthsntwf/test/node1/conf'}
07:48:56,401 ccm INFO node1: using Java 8 for the current invocation
07:48:56,623 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bthsntwf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bthsntwf/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:48:56,624 ccm INFO node1: using Java 8 for the current invocation
07:48:56,788 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:48:57,204 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bthsntwf/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bthsntwf/test/node2/conf'}
07:48:57,204 ccm INFO node2: using Java 8 for the current invocation
07:48:57,381 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bthsntwf/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bthsntwf/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:48:57,382 ccm INFO node2: using Java 8 for the current invocation
07:48:57,468 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:48:57,788 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bthsntwf/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bthsntwf/test/node3/conf'}
07:48:57,789 ccm INFO node3: using Java 8 for the current invocation
07:48:57,958 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bthsntwf/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bthsntwf/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:48:57,958 ccm INFO node3: using Java 8 for the current invocation
07:48:58,38 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:49:22,788 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
07:49:22,789 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
07:48:50,557 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
07:48:50,557 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]07:49:47,778 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 115.63 seconds ==========================
[msx] rc = 1
v1v2 running time = 137291949753
---> v1v2 test failed.
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: truncate_request_timeout_in_ms@@@CassandraDaemon@@@-2@@@6000@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
07:51:01,850 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
07:51:01,852 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 57.25 seconds ===========================
[msx] rc = 0
v1v1 running time = 79219668588
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
07:52:23,701 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
07:52:23,703 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
07:52:26,649 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
07:52:27,655 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.1 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 59.92 seconds ===========================
[msx] rc = 0
v2v2 running time = 81628995837
---> v1v1 and v2v2 test test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
07:53:43,98 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
07:53:44,130 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.1 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
07:53:46,238 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.56 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
07:54:45,652 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 40

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f2284c4a860>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f227c6e0710>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
07:52:52,575 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
07:52:51,102 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 07:52:51.102407
07:52:52,451 dtest_setup INFO cluster ccm directory: /tmp/dtest-2sjgscu9
----------------------------- Captured stdout call -----------------------------
07:52:52,578 ccm DEBUG using balanced tokens for non-vnode cluster
07:52:54,316 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2sjgscu9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2sjgscu9/test/node1/conf'}
07:52:54,317 ccm INFO node1: using Java 8 for the current invocation
07:52:54,485 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2sjgscu9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2sjgscu9/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:52:54,486 ccm INFO node1: using Java 8 for the current invocation
07:52:54,560 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:52:54,816 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2sjgscu9/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2sjgscu9/test/node2/conf'}
07:52:54,817 ccm INFO node2: using Java 8 for the current invocation
07:52:54,992 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2sjgscu9/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2sjgscu9/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:52:54,993 ccm INFO node2: using Java 8 for the current invocation
07:52:55,72 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:52:55,316 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2sjgscu9/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2sjgscu9/test/node3/conf'}
07:52:55,316 ccm INFO node3: using Java 8 for the current invocation
07:52:55,474 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2sjgscu9/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2sjgscu9/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:52:55,475 ccm INFO node3: using Java 8 for the current invocation
07:52:55,557 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
0
------------------------------ Captured log call -------------------------------
07:52:54,316 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2sjgscu9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2sjgscu9/test/node1/conf'}
07:52:54,317 ccm INFO node1: using Java 8 for the current invocation
07:52:54,485 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2sjgscu9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2sjgscu9/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:52:54,486 ccm INFO node1: using Java 8 for the current invocation
07:52:54,560 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:52:54,816 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2sjgscu9/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2sjgscu9/test/node2/conf'}
07:52:54,817 ccm INFO node2: using Java 8 for the current invocation
07:52:54,992 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2sjgscu9/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2sjgscu9/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:52:54,993 ccm INFO node2: using Java 8 for the current invocation
07:52:55,72 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:52:55,316 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2sjgscu9/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2sjgscu9/test/node3/conf'}
07:52:55,316 ccm INFO node3: using Java 8 for the current invocation
07:52:55,474 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2sjgscu9/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2sjgscu9/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:52:55,475 ccm INFO node3: using Java 8 for the current invocation
07:52:55,557 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:53:19,312 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
07:53:19,314 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
07:53:47,73 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
07:53:50,215 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
07:53:49,751 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 07:53:49.751822
07:53:50,119 dtest_setup INFO cluster ccm directory: /tmp/dtest-_msatyyx
----------------------------- Captured stdout call -----------------------------
07:53:50,218 ccm DEBUG using balanced tokens for non-vnode cluster
07:53:51,637 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_msatyyx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_msatyyx/test/node1/conf'}
07:53:51,638 ccm INFO node1: using Java 8 for the current invocation
07:53:51,799 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_msatyyx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_msatyyx/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:53:51,800 ccm INFO node1: using Java 8 for the current invocation
07:53:51,894 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:53:52,180 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_msatyyx/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_msatyyx/test/node2/conf'}
07:53:52,181 ccm INFO node2: using Java 8 for the current invocation
07:53:52,351 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_msatyyx/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_msatyyx/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:53:52,352 ccm INFO node2: using Java 8 for the current invocation
07:53:52,436 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:53:52,679 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_msatyyx/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_msatyyx/test/node3/conf'}
07:53:52,680 ccm INFO node3: using Java 8 for the current invocation
07:53:52,856 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_msatyyx/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_msatyyx/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:53:52,857 ccm INFO node3: using Java 8 for the current invocation
07:53:52,947 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
07:53:51,637 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_msatyyx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_msatyyx/test/node1/conf'}
07:53:51,638 ccm INFO node1: using Java 8 for the current invocation
07:53:51,799 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_msatyyx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_msatyyx/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:53:51,800 ccm INFO node1: using Java 8 for the current invocation
07:53:51,894 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:53:52,180 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_msatyyx/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_msatyyx/test/node2/conf'}
07:53:52,181 ccm INFO node2: using Java 8 for the current invocation
07:53:52,351 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_msatyyx/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_msatyyx/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:53:52,352 ccm INFO node2: using Java 8 for the current invocation
07:53:52,436 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:53:52,679 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_msatyyx/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_msatyyx/test/node3/conf'}
07:53:52,680 ccm INFO node3: using Java 8 for the current invocation
07:53:52,856 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_msatyyx/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_msatyyx/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:53:52,857 ccm INFO node3: using Java 8 for the current invocation
07:53:52,947 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:54:18,695 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
07:54:18,696 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
07:53:47,73 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
07:53:47,73 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]07:54:46,28 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 115.67 seconds ==========================
[msx] rc = 1
v1v2 running time = 137401002841
---> v1v2 test failed.
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: truncate_request_timeout_in_ms@@@CassandraDaemon@@@-2@@@6000@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
07:56:02,256 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
07:56:02,258 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 59.32 seconds ===========================
[msx] rc = 0
v1v1 running time = 80994385264
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
07:57:21,886 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
07:57:22,996 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.94 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
07:58:25,427 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 35

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f55b2101cf8>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f55b0222518>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
07:56:30,560 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
07:56:29,428 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 07:56:29.428296
07:56:30,437 dtest_setup INFO cluster ccm directory: /tmp/dtest-inakd00x
----------------------------- Captured stdout call -----------------------------

07:56:30,563 ccm DEBUG using balanced tokens for non-vnode cluster
07:56:31,963 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-inakd00x/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-inakd00x/test/node1/conf'}
07:56:31,964 ccm INFO node1: using Java 8 for the current invocation
07:56:32,139 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-inakd00x/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-inakd00x/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:56:32,140 ccm INFO node1: using Java 8 for the current invocation
07:56:32,224 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:56:32,482 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-inakd00x/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-inakd00x/test/node2/conf'}
07:56:32,482 ccm INFO node2: using Java 8 for the current invocation
07:56:32,649 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-inakd00x/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-inakd00x/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:56:32,650 ccm INFO node2: using Java 8 for the current invocation
07:56:32,734 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:56:32,982 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-inakd00x/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-inakd00x/test/node3/conf'}
07:56:32,983 ccm INFO node3: using Java 8 for the current invocation
07:56:33,154 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-inakd00x/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-inakd00x/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:56:33,155 ccm INFO node3: using Java 8 for the current invocation
07:56:33,230 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
07:56:31,963 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-inakd00x/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-inakd00x/test/node1/conf'}
07:56:31,964 ccm INFO node1: using Java 8 for the current invocation
07:56:32,139 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-inakd00x/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-inakd00x/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:56:32,140 ccm INFO node1: using Java 8 for the current invocation
07:56:32,224 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:56:32,482 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-inakd00x/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-inakd00x/test/node2/conf'}
07:56:32,482 ccm INFO node2: using Java 8 for the current invocation
07:56:32,649 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-inakd00x/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-inakd00x/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:56:32,650 ccm INFO node2: using Java 8 for the current invocation
07:56:32,734 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:56:32,982 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-inakd00x/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-inakd00x/test/node3/conf'}
07:56:32,983 ccm INFO node3: using Java 8 for the current invocation
07:56:33,154 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-inakd00x/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-inakd00x/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:56:33,155 ccm INFO node3: using Java 8 for the current invocation
07:56:33,230 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:56:55,997 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
07:56:55,999 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
07:57:25,83 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
07:57:29,999 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
07:57:28,632 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 07:57:28.631952
07:57:29,890 dtest_setup INFO cluster ccm directory: /tmp/dtest-r5rxs5yl
----------------------------- Captured stdout call -----------------------------
 07:57:30,2 ccm DEBUG using balanced tokens for non-vnode cluster
07:57:31,672 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r5rxs5yl/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r5rxs5yl/test/node1/conf'}
07:57:31,673 ccm INFO node1: using Java 8 for the current invocation
07:57:31,839 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r5rxs5yl/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r5rxs5yl/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:57:31,840 ccm INFO node1: using Java 8 for the current invocation
07:57:31,921 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:57:32,193 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r5rxs5yl/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r5rxs5yl/test/node2/conf'}
07:57:32,194 ccm INFO node2: using Java 8 for the current invocation
07:57:32,376 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r5rxs5yl/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r5rxs5yl/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:57:32,377 ccm INFO node2: using Java 8 for the current invocation
07:57:32,476 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:57:32,743 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r5rxs5yl/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r5rxs5yl/test/node3/conf'}
07:57:32,744 ccm INFO node3: using Java 8 for the current invocation
07:57:32,917 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r5rxs5yl/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r5rxs5yl/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:57:32,918 ccm INFO node3: using Java 8 for the current invocation
07:57:33,1 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
07:57:31,672 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r5rxs5yl/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r5rxs5yl/test/node1/conf'}
07:57:31,673 ccm INFO node1: using Java 8 for the current invocation
07:57:31,839 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r5rxs5yl/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r5rxs5yl/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:57:31,840 ccm INFO node1: using Java 8 for the current invocation
07:57:31,921 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:57:32,193 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r5rxs5yl/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r5rxs5yl/test/node2/conf'}
07:57:32,194 ccm INFO node2: using Java 8 for the current invocation
07:57:32,376 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r5rxs5yl/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r5rxs5yl/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:57:32,377 ccm INFO node2: using Java 8 for the current invocation
07:57:32,476 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:57:32,743 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r5rxs5yl/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r5rxs5yl/test/node3/conf'}
07:57:32,744 ccm INFO node3: using Java 8 for the current invocation
07:57:32,917 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r5rxs5yl/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r5rxs5yl/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:57:32,918 ccm INFO node3: using Java 8 for the current invocation
07:57:33,1 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:57:59,786 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
07:57:59,786 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
07:57:25,83 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
07:57:25,83 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]07:58:25,653 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 116.92 seconds ==========================
[msx] rc = 1
v2v2 running time = 138533950518
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: truncate_request_timeout_in_ms@@@CassandraDaemon@@@-2@@@6000@@@15000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
07:59:42,241 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
07:59:43,377 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.86 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
07:59:45,283 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.92 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
08:00:40,824 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 64

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f4b227dbe80>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f4b0abe27f0>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
07:58:49,934 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
07:58:48,571 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 07:58:48.571058
07:58:49,832 dtest_setup INFO cluster ccm directory: /tmp/dtest-9f8_i_pn
----------------------------- Captured stdout call -----------------------------
07:58:49,937 ccm DEBUG using balanced tokens for non-vnode cluster
07:58:51,448 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9f8_i_pn/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9f8_i_pn/test/node1/conf'}
07:58:51,448 ccm INFO node1: using Java 8 for the current invocation
07:58:51,625 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9f8_i_pn/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9f8_i_pn/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:58:51,626 ccm INFO node1: using Java 8 for the current invocation
07:58:51,708 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:58:51,956 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9f8_i_pn/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9f8_i_pn/test/node2/conf'}
07:58:51,956 ccm INFO node2: using Java 8 for the current invocation
07:58:52,102 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9f8_i_pn/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9f8_i_pn/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:58:52,102 ccm INFO node2: using Java 8 for the current invocation
07:58:52,178 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:58:52,455 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9f8_i_pn/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9f8_i_pn/test/node3/conf'}
07:58:52,455 ccm INFO node3: using Java 8 for the current invocation
07:58:52,613 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9f8_i_pn/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9f8_i_pn/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:58:52,614 ccm INFO node3: using Java 8 for the current invocation
07:58:52,701 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
07:58:51,448 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9f8_i_pn/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9f8_i_pn/test/node1/conf'}
07:58:51,448 ccm INFO node1: using Java 8 for the current invocation
07:58:51,625 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9f8_i_pn/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9f8_i_pn/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:58:51,626 ccm INFO node1: using Java 8 for the current invocation
07:58:51,708 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:58:51,956 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9f8_i_pn/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9f8_i_pn/test/node2/conf'}
07:58:51,956 ccm INFO node2: using Java 8 for the current invocation
07:58:52,102 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9f8_i_pn/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9f8_i_pn/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:58:52,102 ccm INFO node2: using Java 8 for the current invocation
07:58:52,178 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:58:52,455 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9f8_i_pn/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9f8_i_pn/test/node3/conf'}
07:58:52,455 ccm INFO node3: using Java 8 for the current invocation
07:58:52,613 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9f8_i_pn/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9f8_i_pn/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:58:52,614 ccm INFO node3: using Java 8 for the current invocation
07:58:52,701 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:59:16,476 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
07:59:16,478 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
07:59:45,707 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
07:59:50,242 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
07:59:49,116 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 07:59:49.116087
07:59:50,133 dtest_setup INFO cluster ccm directory: /tmp/dtest-h0zrts6j
----------------------------- Captured stdout call -----------------------------

07:59:50,244 ccm DEBUG using balanced tokens for non-vnode cluster
07:59:51,737 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h0zrts6j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h0zrts6j/test/node1/conf'}
07:59:51,738 ccm INFO node1: using Java 8 for the current invocation
07:59:51,919 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h0zrts6j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h0zrts6j/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:59:51,919 ccm INFO node1: using Java 8 for the current invocation
07:59:52,14 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:59:52,298 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h0zrts6j/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h0zrts6j/test/node2/conf'}
07:59:52,298 ccm INFO node2: using Java 8 for the current invocation
07:59:52,494 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h0zrts6j/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h0zrts6j/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:59:52,495 ccm INFO node2: using Java 8 for the current invocation
07:59:52,583 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:59:52,872 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h0zrts6j/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h0zrts6j/test/node3/conf'}
07:59:52,873 ccm INFO node3: using Java 8 for the current invocation
07:59:53,52 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h0zrts6j/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h0zrts6j/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:59:53,53 ccm INFO node3: using Java 8 for the current invocation
07:59:53,132 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
07:59:51,737 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h0zrts6j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h0zrts6j/test/node1/conf'}
07:59:51,738 ccm INFO node1: using Java 8 for the current invocation
07:59:51,919 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h0zrts6j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h0zrts6j/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
07:59:51,919 ccm INFO node1: using Java 8 for the current invocation
07:59:52,14 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:59:52,298 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h0zrts6j/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h0zrts6j/test/node2/conf'}
07:59:52,298 ccm INFO node2: using Java 8 for the current invocation
07:59:52,494 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h0zrts6j/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h0zrts6j/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:59:52,495 ccm INFO node2: using Java 8 for the current invocation
07:59:52,583 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
07:59:52,872 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h0zrts6j/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h0zrts6j/test/node3/conf'}
07:59:52,873 ccm INFO node3: using Java 8 for the current invocation
07:59:53,52 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h0zrts6j/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h0zrts6j/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
07:59:53,53 ccm INFO node3: using Java 8 for the current invocation
07:59:53,132 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:00:16,891 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
08:00:16,891 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
07:59:45,707 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
07:59:45,707 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]08:00:41,221 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 113.87 seconds ==========================
[msx] rc = 1
v1v2 running time = 135595356789
---> v1v2 test failed.
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: truncate_request_timeout_in_ms@@@CassandraDaemon@@@-2@@@6000@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:01:56,381 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
08:01:57,397 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.24 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
08:02:56,5 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 80

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f5401457f60>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f53f0ce4630>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
08:01:04,892 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
08:01:03,621 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 08:01:03.621764
08:01:04,782 dtest_setup INFO cluster ccm directory: /tmp/dtest-dru5z3py
----------------------------- Captured stdout call -----------------------------

08:01:04,894 ccm DEBUG using balanced tokens for non-vnode cluster
08:01:06,469 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dru5z3py/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dru5z3py/test/node1/conf'}
08:01:06,470 ccm INFO node1: using Java 8 for the current invocation
08:01:06,646 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dru5z3py/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dru5z3py/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:01:06,647 ccm INFO node1: using Java 8 for the current invocation
08:01:06,731 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:01:07,3 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dru5z3py/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dru5z3py/test/node2/conf'}
08:01:07,4 ccm INFO node2: using Java 8 for the current invocation
08:01:07,173 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dru5z3py/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dru5z3py/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:01:07,173 ccm INFO node2: using Java 8 for the current invocation
08:01:07,259 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:01:07,524 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dru5z3py/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dru5z3py/test/node3/conf'}
08:01:07,525 ccm INFO node3: using Java 8 for the current invocation
08:01:07,694 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dru5z3py/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dru5z3py/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:01:07,695 ccm INFO node3: using Java 8 for the current invocation
08:01:07,781 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
08:01:06,469 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dru5z3py/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dru5z3py/test/node1/conf'}
08:01:06,470 ccm INFO node1: using Java 8 for the current invocation
08:01:06,646 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dru5z3py/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dru5z3py/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:01:06,647 ccm INFO node1: using Java 8 for the current invocation
08:01:06,731 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:01:07,3 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dru5z3py/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dru5z3py/test/node2/conf'}
08:01:07,4 ccm INFO node2: using Java 8 for the current invocation
08:01:07,173 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dru5z3py/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dru5z3py/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:01:07,173 ccm INFO node2: using Java 8 for the current invocation
08:01:07,259 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:01:07,524 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dru5z3py/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dru5z3py/test/node3/conf'}
08:01:07,525 ccm INFO node3: using Java 8 for the current invocation
08:01:07,694 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-dru5z3py/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-dru5z3py/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:01:07,695 ccm INFO node3: using Java 8 for the current invocation
08:01:07,781 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:01:32,553 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
08:01:32,555 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
08:01:59,678 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stderr teardown ---------------------------
swapoff: Not superuser.
---------------------------- Captured stdout setup -----------------------------
08:02:03,894 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
08:02:03,38 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 08:02:03.038248
08:02:03,806 dtest_setup INFO cluster ccm directory: /tmp/dtest-tci54gm8
----------------------------- Captured stdout call -----------------------------

08:02:03,896 ccm DEBUG using balanced tokens for non-vnode cluster
08:02:05,367 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tci54gm8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tci54gm8/test/node1/conf'}
08:02:05,367 ccm INFO node1: using Java 8 for the current invocation
08:02:05,535 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tci54gm8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tci54gm8/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:02:05,535 ccm INFO node1: using Java 8 for the current invocation
08:02:05,634 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:02:05,895 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tci54gm8/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tci54gm8/test/node2/conf'}
08:02:05,895 ccm INFO node2: using Java 8 for the current invocation
08:02:06,89 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tci54gm8/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tci54gm8/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:02:06,90 ccm INFO node2: using Java 8 for the current invocation
08:02:06,172 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:02:06,424 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tci54gm8/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tci54gm8/test/node3/conf'}
08:02:06,425 ccm INFO node3: using Java 8 for the current invocation
08:02:06,606 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tci54gm8/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tci54gm8/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:02:06,607 ccm INFO node3: using Java 8 for the current invocation
08:02:06,693 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra

------------------------------ Captured log call -------------------------------
08:02:05,367 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tci54gm8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tci54gm8/test/node1/conf'}
08:02:05,367 ccm INFO node1: using Java 8 for the current invocation
08:02:05,535 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tci54gm8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tci54gm8/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:02:05,535 ccm INFO node1: using Java 8 for the current invocation
08:02:05,634 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:02:05,895 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tci54gm8/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tci54gm8/test/node2/conf'}
08:02:05,895 ccm INFO node2: using Java 8 for the current invocation
08:02:06,89 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tci54gm8/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tci54gm8/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:02:06,90 ccm INFO node2: using Java 8 for the current invocation
08:02:06,172 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:02:06,424 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tci54gm8/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tci54gm8/test/node3/conf'}
08:02:06,425 ccm INFO node3: using Java 8 for the current invocation
08:02:06,606 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tci54gm8/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tci54gm8/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:02:06,607 ccm INFO node3: using Java 8 for the current invocation
08:02:06,693 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:02:32,443 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
08:02:32,443 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
08:01:59,678 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stderr teardown ---------------------------
swapoff: Not superuser.
--------------------------- Captured stdout teardown ---------------------------
08:01:59,678 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stderr teardown ---------------------------
swapoff: Not superuser.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]08:02:56,233 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 113.33 seconds ==========================
[msx] rc = 1
v1v1 running time = 135027256726
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:04:10,26 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:04:10,29 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 57.10 seconds ===========================
[msx] rc = 0
v2v2 running time = 78747292792
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: truncate_request_timeout_in_ms@@@CassandraDaemon@@@-2@@@6000@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:05:29,997 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:05:29,999 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 58.30 seconds ===========================
[msx] rc = 0
v1v2 running time = 79865371706
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:06:51,170 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:06:51,171 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 59.51 seconds ===========================
[msx] rc = 0
v1v1 running time = 81171342004
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:08:08,928 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:08:08,930 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 55.99 seconds ===========================
[msx] rc = 0
v2v2 running time = 77607810162
---> v1v1 and v2v2 test test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:09:28,48 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:09:28,50 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 57.50 seconds ===========================
[msx] rc = 0
v1v2 running time = 79113215128
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:10:46,586 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:10:46,589 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 57.14 seconds ===========================
[msx] rc = 0
v1v1 running time = 78753373888
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:12:06,43 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:12:06,45 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 57.88 seconds ===========================
[msx] rc = 0
v2v2 running time = 79473291920
---> v1v1 and v2v2 test test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:13:25,189 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:13:25,193 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 57.59 seconds ===========================
[msx] rc = 0
v1v2 running time = 79170874162
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:14:44,817 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
08:14:45,842 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.98 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
08:15:49,949 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 57

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f6dc5ebceb8>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f6dc44a03c8>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
08:13:53,632 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
08:13:52,525 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 08:13:52.525711
08:13:53,533 dtest_setup INFO cluster ccm directory: /tmp/dtest-p18wnc1g
----------------------------- Captured stdout call -----------------------------

08:13:53,634 ccm DEBUG using balanced tokens for non-vnode cluster
08:13:55,77 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p18wnc1g/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p18wnc1g/test/node1/conf'}
08:13:55,78 ccm INFO node1: using Java 8 for the current invocation
08:13:55,270 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p18wnc1g/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p18wnc1g/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:13:55,271 ccm INFO node1: using Java 8 for the current invocation
08:13:55,356 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:13:55,634 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p18wnc1g/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p18wnc1g/test/node2/conf'}
08:13:55,635 ccm INFO node2: using Java 8 for the current invocation
08:13:55,829 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p18wnc1g/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p18wnc1g/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:13:55,829 ccm INFO node2: using Java 8 for the current invocation
08:13:55,980 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:13:56,470 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p18wnc1g/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p18wnc1g/test/node3/conf'}
08:13:56,471 ccm INFO node3: using Java 8 for the current invocation
08:13:56,797 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p18wnc1g/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p18wnc1g/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:13:56,797 ccm INFO node3: using Java 8 for the current invocation
08:13:56,908 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
08:13:55,77 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p18wnc1g/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p18wnc1g/test/node1/conf'}
08:13:55,78 ccm INFO node1: using Java 8 for the current invocation
08:13:55,270 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p18wnc1g/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p18wnc1g/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:13:55,271 ccm INFO node1: using Java 8 for the current invocation
08:13:55,356 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:13:55,634 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p18wnc1g/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p18wnc1g/test/node2/conf'}
08:13:55,635 ccm INFO node2: using Java 8 for the current invocation
08:13:55,829 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p18wnc1g/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p18wnc1g/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:13:55,829 ccm INFO node2: using Java 8 for the current invocation
08:13:55,980 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:13:56,470 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p18wnc1g/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p18wnc1g/test/node3/conf'}
08:13:56,471 ccm INFO node3: using Java 8 for the current invocation
08:13:56,797 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p18wnc1g/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p18wnc1g/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:13:56,797 ccm INFO node3: using Java 8 for the current invocation
08:13:56,908 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:14:19,676 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
08:14:19,679 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
08:14:48,32 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
08:14:51,817 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
08:14:50,899 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 08:14:50.899416
08:14:51,716 dtest_setup INFO cluster ccm directory: /tmp/dtest-z_clnys0
----------------------------- Captured stdout call -----------------------------

08:14:51,819 ccm DEBUG using balanced tokens for non-vnode cluster
08:14:53,259 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z_clnys0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z_clnys0/test/node1/conf'}
08:14:53,260 ccm INFO node1: using Java 8 for the current invocation
08:14:53,442 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z_clnys0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z_clnys0/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:14:53,443 ccm INFO node1: using Java 8 for the current invocation
08:14:53,531 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:14:53,794 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z_clnys0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z_clnys0/test/node2/conf'}
08:14:53,795 ccm INFO node2: using Java 8 for the current invocation
08:14:53,970 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z_clnys0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z_clnys0/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:14:53,971 ccm INFO node2: using Java 8 for the current invocation
08:14:54,50 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:14:54,303 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z_clnys0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z_clnys0/test/node3/conf'}
08:14:54,304 ccm INFO node3: using Java 8 for the current invocation
08:14:54,477 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z_clnys0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z_clnys0/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:14:54,478 ccm INFO node3: using Java 8 for the current invocation
08:14:54,568 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
08:14:53,259 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z_clnys0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z_clnys0/test/node1/conf'}
08:14:53,260 ccm INFO node1: using Java 8 for the current invocation
08:14:53,442 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z_clnys0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z_clnys0/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:14:53,443 ccm INFO node1: using Java 8 for the current invocation
08:14:53,531 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:14:53,794 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z_clnys0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z_clnys0/test/node2/conf'}
08:14:53,795 ccm INFO node2: using Java 8 for the current invocation
08:14:53,970 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z_clnys0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z_clnys0/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:14:53,971 ccm INFO node2: using Java 8 for the current invocation
08:14:54,50 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:14:54,303 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z_clnys0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z_clnys0/test/node3/conf'}
08:14:54,304 ccm INFO node3: using Java 8 for the current invocation
08:14:54,477 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z_clnys0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z_clnys0/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:14:54,478 ccm INFO node3: using Java 8 for the current invocation
08:14:54,568 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:15:24,359 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
08:15:24,360 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
08:14:48,32 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
08:14:48,32 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]08:15:50,329 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 118.54 seconds ==========================
[msx] rc = 1
v1v1 running time = 140160680863
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:17:05,185 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:17:05,188 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:17:09,894 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 58.13 seconds ===========================
[msx] rc = 0
v2v2 running time = 79768531887
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: truncate_request_timeout_in_ms@@@CassandraDaemon@@@-2@@@6000@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:18:26,607 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:18:26,609 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 59.59 seconds ===========================
[msx] rc = 0
v1v2 running time = 81256067295
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:19:43,684 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
08:19:44,918 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.3 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
08:20:41,721 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 33

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f12567690f0>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f123dbeac88>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
08:18:54,740 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
08:18:53,743 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 08:18:53.742973
08:18:54,651 dtest_setup INFO cluster ccm directory: /tmp/dtest-t7lznynr
----------------------------- Captured stdout call -----------------------------

08:18:54,742 ccm DEBUG using balanced tokens for non-vnode cluster
08:18:56,242 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-t7lznynr/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-t7lznynr/test/node1/conf'}
08:18:56,244 ccm INFO node1: using Java 8 for the current invocation
08:18:56,412 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-t7lznynr/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-t7lznynr/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:18:56,413 ccm INFO node1: using Java 8 for the current invocation
08:18:56,501 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:18:56,767 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-t7lznynr/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-t7lznynr/test/node2/conf'}
08:18:56,768 ccm INFO node2: using Java 8 for the current invocation
08:18:56,943 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-t7lznynr/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-t7lznynr/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:18:56,944 ccm INFO node2: using Java 8 for the current invocation
08:18:57,30 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:18:57,283 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-t7lznynr/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-t7lznynr/test/node3/conf'}
08:18:57,284 ccm INFO node3: using Java 8 for the current invocation
08:18:57,449 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-t7lznynr/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-t7lznynr/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:18:57,450 ccm INFO node3: using Java 8 for the current invocation
08:18:57,538 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
08:18:56,242 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-t7lznynr/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-t7lznynr/test/node1/conf'}
08:18:56,244 ccm INFO node1: using Java 8 for the current invocation
08:18:56,412 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-t7lznynr/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-t7lznynr/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:18:56,413 ccm INFO node1: using Java 8 for the current invocation
08:18:56,501 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:18:56,767 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-t7lznynr/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-t7lznynr/test/node2/conf'}
08:18:56,768 ccm INFO node2: using Java 8 for the current invocation
08:18:56,943 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-t7lznynr/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-t7lznynr/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:18:56,944 ccm INFO node2: using Java 8 for the current invocation
08:18:57,30 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:18:57,283 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-t7lznynr/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-t7lznynr/test/node3/conf'}
08:18:57,284 ccm INFO node3: using Java 8 for the current invocation
08:18:57,449 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-t7lznynr/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-t7lznynr/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:18:57,450 ccm INFO node3: using Java 8 for the current invocation
08:18:57,538 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:19:20,317 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
08:19:20,320 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
08:19:46,939 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
08:19:50,474 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
08:19:49,715 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 08:19:49.715751
08:19:50,378 dtest_setup INFO cluster ccm directory: /tmp/dtest-x095d1v_
----------------------------- Captured stdout call -----------------------------

08:19:50,476 ccm DEBUG using balanced tokens for non-vnode cluster
08:19:51,962 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node1/conf'}
08:19:51,963 ccm INFO node1: using Java 8 for the current invocation
08:19:52,128 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:19:52,129 ccm INFO node1: using Java 8 for the current invocation
08:19:52,215 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:19:52,471 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node2/conf'}
08:19:52,472 ccm INFO node2: using Java 8 for the current invocation
08:19:52,636 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:19:52,636 ccm INFO node2: using Java 8 for the current invocation
08:19:52,720 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:19:53,7 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node3/conf'}
08:19:53,8 ccm INFO node3: using Java 8 for the current invocation
08:19:53,173 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:19:53,174 ccm INFO node3: using Java 8 for the current invocation
08:19:53,260 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra

08:19:50,476 ccm DEBUG using balanced tokens for non-vnode cluster
08:19:51,962 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node1/conf'}
08:19:51,963 ccm INFO node1: using Java 8 for the current invocation
08:19:52,128 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:19:52,129 ccm INFO node1: using Java 8 for the current invocation
08:19:52,215 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:19:52,471 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node2/conf'}
08:19:52,472 ccm INFO node2: using Java 8 for the current invocation
08:19:52,636 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:19:52,636 ccm INFO node2: using Java 8 for the current invocation
08:19:52,720 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:19:53,7 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node3/conf'}
08:19:53,8 ccm INFO node3: using Java 8 for the current invocation
08:19:53,173 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:19:53,174 ccm INFO node3: using Java 8 for the current invocation
08:19:53,260 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
08:19:51,962 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node1/conf'}
08:19:51,963 ccm INFO node1: using Java 8 for the current invocation
08:19:52,128 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:19:52,129 ccm INFO node1: using Java 8 for the current invocation
08:19:52,215 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:19:52,471 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node2/conf'}
08:19:52,472 ccm INFO node2: using Java 8 for the current invocation
08:19:52,636 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:19:52,636 ccm INFO node2: using Java 8 for the current invocation
08:19:52,720 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:19:53,7 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node3/conf'}
08:19:53,8 ccm INFO node3: using Java 8 for the current invocation
08:19:53,173 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-x095d1v_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-x095d1v_/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:19:53,174 ccm INFO node3: using Java 8 for the current invocation
08:19:53,260 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:20:17,182 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
08:20:17,182 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
08:19:46,939 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
08:19:46,939 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]08:20:42,111 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 109.25 seconds ==========================
[msx] rc = 1
v1v1 running time = 131006823125
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:21:55,449 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
08:21:56,561 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.72 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
08:21:58,368 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.56 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
08:22:53,316 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 5

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f882a2b1ba8>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f88125fe208>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
08:21:05,516 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
08:21:04,755 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 08:21:04.755765
08:21:05,413 dtest_setup INFO cluster ccm directory: /tmp/dtest-g9gsqcna
----------------------------- Captured stdout call -----------------------------
08:21:05,519 ccm DEBUG using balanced tokens for non-vnode cluster
08:21:07,15 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-g9gsqcna/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-g9gsqcna/test/node1/conf'}
08:21:07,16 ccm INFO node1: using Java 8 for the current invocation
08:21:07,196 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-g9gsqcna/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-g9gsqcna/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:21:07,197 ccm INFO node1: using Java 8 for the current invocation
08:21:07,294 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:21:07,575 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-g9gsqcna/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-g9gsqcna/test/node2/conf'}
08:21:07,576 ccm INFO node2: using Java 8 for the current invocation
08:21:07,743 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-g9gsqcna/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-g9gsqcna/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:21:07,744 ccm INFO node2: using Java 8 for the current invocation
08:21:07,828 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:21:08,102 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-g9gsqcna/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-g9gsqcna/test/node3/conf'}
08:21:08,103 ccm INFO node3: using Java 8 for the current invocation
08:21:08,262 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-g9gsqcna/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-g9gsqcna/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:21:08,262 ccm INFO node3: using Java 8 for the current invocation
08:21:08,348 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
08:21:07,15 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-g9gsqcna/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-g9gsqcna/test/node1/conf'}
08:21:07,16 ccm INFO node1: using Java 8 for the current invocation
08:21:07,196 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-g9gsqcna/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-g9gsqcna/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:21:07,197 ccm INFO node1: using Java 8 for the current invocation
08:21:07,294 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:21:07,575 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-g9gsqcna/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-g9gsqcna/test/node2/conf'}
08:21:07,576 ccm INFO node2: using Java 8 for the current invocation
08:21:07,743 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-g9gsqcna/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-g9gsqcna/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:21:07,744 ccm INFO node2: using Java 8 for the current invocation
08:21:07,828 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:21:08,102 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-g9gsqcna/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-g9gsqcna/test/node3/conf'}
08:21:08,103 ccm INFO node3: using Java 8 for the current invocation
08:21:08,262 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-g9gsqcna/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-g9gsqcna/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:21:08,262 ccm INFO node3: using Java 8 for the current invocation
08:21:08,348 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:21:32,121 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
08:21:32,124 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
08:21:58,667 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
08:22:02,798 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
08:22:01,741 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 08:22:01.740969
08:22:02,706 dtest_setup INFO cluster ccm directory: /tmp/dtest-3yu1sp0j
----------------------------- Captured stdout call -----------------------------

08:22:02,800 ccm DEBUG using balanced tokens for non-vnode cluster
08:22:04,237 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3yu1sp0j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3yu1sp0j/test/node1/conf'}
08:22:04,238 ccm INFO node1: using Java 8 for the current invocation
08:22:04,419 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3yu1sp0j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3yu1sp0j/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:22:04,420 ccm INFO node1: using Java 8 for the current invocation
08:22:04,498 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:22:04,772 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3yu1sp0j/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3yu1sp0j/test/node2/conf'}
08:22:04,773 ccm INFO node2: using Java 8 for the current invocation
08:22:04,942 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3yu1sp0j/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3yu1sp0j/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:22:04,943 ccm INFO node2: using Java 8 for the current invocation
08:22:05,27 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:22:05,282 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3yu1sp0j/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3yu1sp0j/test/node3/conf'}
08:22:05,283 ccm INFO node3: using Java 8 for the current invocation
08:22:05,459 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3yu1sp0j/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3yu1sp0j/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:22:05,459 ccm INFO node3: using Java 8 for the current invocation
08:22:05,556 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
08:22:04,237 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3yu1sp0j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3yu1sp0j/test/node1/conf'}
08:22:04,238 ccm INFO node1: using Java 8 for the current invocation
08:22:04,419 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3yu1sp0j/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3yu1sp0j/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:22:04,420 ccm INFO node1: using Java 8 for the current invocation
08:22:04,498 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:22:04,772 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3yu1sp0j/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3yu1sp0j/test/node2/conf'}
08:22:04,773 ccm INFO node2: using Java 8 for the current invocation
08:22:04,942 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3yu1sp0j/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3yu1sp0j/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:22:04,943 ccm INFO node2: using Java 8 for the current invocation
08:22:05,27 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:22:05,282 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3yu1sp0j/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3yu1sp0j/test/node3/conf'}
08:22:05,283 ccm INFO node3: using Java 8 for the current invocation
08:22:05,459 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3yu1sp0j/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3yu1sp0j/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:22:05,459 ccm INFO node3: using Java 8 for the current invocation
08:22:05,556 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:22:30,306 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
08:22:30,307 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
08:21:58,667 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
08:21:58,667 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]08:22:53,710 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 109.65 seconds ==========================
[msx] rc = 1
v2v2 running time = 131402849676
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: truncate_request_timeout_in_ms@@@CassandraDaemon@@@-2@@@6000@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

v2v2 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: truncate_request_timeout_in_ms@@@CassandraDaemon@@@-2@@@6000@@@15000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:24:09,135 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:24:09,137 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 58.63 seconds ===========================
[msx] rc = 0
v1v2 running time = 80291019818
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:25:28,836 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
08:25:29,865 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.72 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
08:26:24,523 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 62

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f3cc021de48>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f3cb86656d8>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
08:24:38,99 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
08:24:36,522 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 08:24:36.522505
08:24:37,984 dtest_setup INFO cluster ccm directory: /tmp/dtest-n0drfqjt
----------------------------- Captured stdout call -----------------------------

08:24:38,102 ccm DEBUG using balanced tokens for non-vnode cluster
08:24:39,543 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n0drfqjt/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n0drfqjt/test/node1/conf'}
08:24:39,543 ccm INFO node1: using Java 8 for the current invocation
08:24:39,717 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n0drfqjt/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n0drfqjt/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:24:39,717 ccm INFO node1: using Java 8 for the current invocation
08:24:39,810 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:24:40,96 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n0drfqjt/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n0drfqjt/test/node2/conf'}
08:24:40,96 ccm INFO node2: using Java 8 for the current invocation
08:24:40,261 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n0drfqjt/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n0drfqjt/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:24:40,262 ccm INFO node2: using Java 8 for the current invocation
08:24:40,345 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:24:40,618 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n0drfqjt/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n0drfqjt/test/node3/conf'}
08:24:40,619 ccm INFO node3: using Java 8 for the current invocation
08:24:40,792 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n0drfqjt/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n0drfqjt/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:24:40,793 ccm INFO node3: using Java 8 for the current invocation
08:24:40,886 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
08:24:39,543 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n0drfqjt/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n0drfqjt/test/node1/conf'}
08:24:39,543 ccm INFO node1: using Java 8 for the current invocation
08:24:39,717 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n0drfqjt/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n0drfqjt/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:24:39,717 ccm INFO node1: using Java 8 for the current invocation
08:24:39,810 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:24:40,96 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n0drfqjt/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n0drfqjt/test/node2/conf'}
08:24:40,96 ccm INFO node2: using Java 8 for the current invocation
08:24:40,261 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n0drfqjt/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n0drfqjt/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:24:40,262 ccm INFO node2: using Java 8 for the current invocation
08:24:40,345 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:24:40,618 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n0drfqjt/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n0drfqjt/test/node3/conf'}
08:24:40,619 ccm INFO node3: using Java 8 for the current invocation
08:24:40,792 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n0drfqjt/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n0drfqjt/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:24:40,793 ccm INFO node3: using Java 8 for the current invocation
08:24:40,886 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:25:05,646 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
08:25:05,648 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
08:25:31,832 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
08:25:35,497 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
08:25:34,690 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 08:25:34.690395
08:25:35,404 dtest_setup INFO cluster ccm directory: /tmp/dtest-8t_rozn_
------------------------------ Captured log call -------------------------------
08:25:37,12 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8t_rozn_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8t_rozn_/test/node1/conf'}
08:25:37,13 ccm INFO node1: using Java 8 for the current invocation
08:25:37,190 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8t_rozn_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8t_rozn_/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:25:37,191 ccm INFO node1: using Java 8 for the current invocation
08:25:37,272 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:25:37,538 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8t_rozn_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8t_rozn_/test/node2/conf'}
08:25:37,538 ccm INFO node2: using Java 8 for the current invocation
08:25:37,713 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8t_rozn_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8t_rozn_/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:25:37,714 ccm INFO node2: using Java 8 for the current invocation
08:25:37,796 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:25:38,69 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8t_rozn_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8t_rozn_/test/node3/conf'}
08:25:38,70 ccm INFO node3: using Java 8 for the current invocation
08:25:38,248 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8t_rozn_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8t_rozn_/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:25:38,249 ccm INFO node3: using Java 8 for the current invocation
08:25:38,335 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:26:01,105 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
08:26:01,106 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
08:25:31,832 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
08:25:31,832 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]08:26:24,717 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 108.91 seconds ==========================
[msx] rc = 1
v1v1 running time = 130611737970
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:27:37,969 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:27:37,971 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:27:42,361 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 56.50 seconds ===========================
[msx] rc = 0
v2v2 running time = 78127322377
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: truncate_request_timeout_in_ms@@@CassandraDaemon@@@-2@@@6000@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:28:56,986 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:28:57,7 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 57.35 seconds ===========================
[msx] rc = 0
v1v2 running time = 79010801179
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:30:17,221 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
08:30:17,223 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 58.77 seconds ===========================
[msx] rc = 0
v1v1 running time = 80355558591
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
08:31:38,141 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
08:31:39,158 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.78 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
08:31:40,965 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.84 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
08:32:39,786 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 45

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f308c1edd68>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f3084685dd8>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
08:30:45,206 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
08:30:44,500 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 08:30:44.500925
08:30:45,108 dtest_setup INFO cluster ccm directory: /tmp/dtest-2_v7wkj_
----------------------------- Captured stdout call -----------------------------
08:30:45,209 ccm DEBUG using balanced tokens for non-vnode cluster
08:30:46,492 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2_v7wkj_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2_v7wkj_/test/node1/conf'}
08:30:46,493 ccm INFO node1: using Java 8 for the current invocation
08:30:46,672 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2_v7wkj_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2_v7wkj_/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:30:46,673 ccm INFO node1: using Java 8 for the current invocation
08:30:46,758 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:30:47,30 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2_v7wkj_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2_v7wkj_/test/node2/conf'}
08:30:47,31 ccm INFO node2: using Java 8 for the current invocation
08:30:47,196 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2_v7wkj_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2_v7wkj_/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:30:47,196 ccm INFO node2: using Java 8 for the current invocation
08:30:47,278 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:30:47,548 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2_v7wkj_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2_v7wkj_/test/node3/conf'}
08:30:47,549 ccm INFO node3: using Java 8 for the current invocation
08:30:47,727 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2_v7wkj_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2_v7wkj_/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:30:47,728 ccm INFO node3: using Java 8 for the current invocation
08:30:47,803 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
08:30:46,492 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2_v7wkj_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2_v7wkj_/test/node1/conf'}
08:30:46,493 ccm INFO node1: using Java 8 for the current invocation
08:30:46,672 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2_v7wkj_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2_v7wkj_/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:30:46,673 ccm INFO node1: using Java 8 for the current invocation
08:30:46,758 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:30:47,30 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2_v7wkj_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2_v7wkj_/test/node2/conf'}
08:30:47,31 ccm INFO node2: using Java 8 for the current invocation
08:30:47,196 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2_v7wkj_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2_v7wkj_/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:30:47,196 ccm INFO node2: using Java 8 for the current invocation
08:30:47,278 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:30:47,548 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2_v7wkj_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2_v7wkj_/test/node3/conf'}
08:30:47,549 ccm INFO node3: using Java 8 for the current invocation
08:30:47,727 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2_v7wkj_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2_v7wkj_/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:30:47,728 ccm INFO node3: using Java 8 for the current invocation
08:30:47,803 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:31:12,619 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
08:31:12,621 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
08:31:41,598 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
08:31:45,575 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
08:31:44,674 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-02 08:31:44.674837
08:31:45,481 dtest_setup INFO cluster ccm directory: /tmp/dtest-8j37mf30
----------------------------- Captured stdout call -----------------------------
08:31:45,577 ccm DEBUG using balanced tokens for non-vnode cluster
08:31:47,102 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8j37mf30/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8j37mf30/test/node1/conf'}
08:31:47,103 ccm INFO node1: using Java 8 for the current invocation
08:31:47,277 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8j37mf30/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8j37mf30/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:31:47,278 ccm INFO node1: using Java 8 for the current invocation
08:31:47,357 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:31:47,619 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8j37mf30/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8j37mf30/test/node2/conf'}
08:31:47,620 ccm INFO node2: using Java 8 for the current invocation
08:31:47,798 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8j37mf30/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8j37mf30/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:31:47,799 ccm INFO node2: using Java 8 for the current invocation
08:31:47,884 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:31:48,166 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8j37mf30/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8j37mf30/test/node3/conf'}
08:31:48,167 ccm INFO node3: using Java 8 for the current invocation
08:31:48,329 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8j37mf30/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8j37mf30/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:31:48,329 ccm INFO node3: using Java 8 for the current invocation
08:31:48,418 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
08:31:47,102 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8j37mf30/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8j37mf30/test/node1/conf'}
08:31:47,103 ccm INFO node1: using Java 8 for the current invocation
08:31:47,277 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8j37mf30/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8j37mf30/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
08:31:47,278 ccm INFO node1: using Java 8 for the current invocation
08:31:47,357 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:31:47,619 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8j37mf30/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8j37mf30/test/node2/conf'}
08:31:47,620 ccm INFO node2: using Java 8 for the current invocation
08:31:47,798 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8j37mf30/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8j37mf30/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:31:47,799 ccm INFO node2: using Java 8 for the current invocation
08:31:47,884 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:31:48,166 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8j37mf30/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8j37mf30/test/node3/conf'}
08:31:48,167 ccm INFO node3: using Java 8 for the current invocation
08:31:48,329 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '376dbb733093', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-8j37mf30/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-8j37mf30/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
08:31:48,329 ccm INFO node3: using Java 8 for the current invocation
08:31:48,418 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
08:32:15,191 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
08:32:15,192 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
08:31:41,598 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
08:31:41,598 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]08:32:40,18 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 116.20 seconds ==========================
[msx] rc = 1
v2v2 running time = 137788741623
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: truncate_request_timeout_in_ms@@@CassandraDaemon@@@-2@@@6000@@@15000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

early stop after 7 is satisfied
v1v2 failed with probability 3 out of 11
v1v1v2v2 failed with probability 7 out of 11
Total execution time in seconds : 3302
0
