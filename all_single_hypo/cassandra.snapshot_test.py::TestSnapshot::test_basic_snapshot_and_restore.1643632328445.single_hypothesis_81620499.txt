my_type=hypothesis
proj=cassandra
u_test=snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list[1]=snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
12:46:21,910 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
12:46:35,341 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
12:46:35,344 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
12:47:14,80 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7f84b6e4feb8>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
12:45:48,64 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:45:46,532 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 12:45:46.532091
12:45:47,944 dtest_setup INFO cluster ccm directory: /tmp/dtest-chiltgqy
------------------------------ Captured log call -------------------------------
12:45:48,696 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-chiltgqy/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-chiltgqy/test/node1/conf'}
12:45:48,697 ccm INFO node1: using Java 8 for the current invocation
12:45:48,865 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-chiltgqy/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-chiltgqy/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:45:48,865 ccm INFO node1: using Java 8 for the current invocation
12:45:48,964 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:46:08,751 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-chiltgqy/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-chiltgqy/test/node1/conf'}
12:46:08,752 ccm INFO node1: using Java 8 for the current invocation
12:46:10,256 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-chiltgqy/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-chiltgqy/test/node1/conf'}
12:46:10,257 ccm INFO node1: using Java 8 for the current invocation
12:46:20,613 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-chiltgqy/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-chiltgqy/test/node1/conf'}
12:46:20,614 ccm INFO node1: using Java 8 for the current invocation
12:46:21,910 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
12:46:35,700 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
12:46:40,515 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:46:39,186 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 12:46:39.186158
12:46:40,396 dtest_setup INFO cluster ccm directory: /tmp/dtest-cn1lvdki
------------------------------ Captured log call -------------------------------
12:46:41,240 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cn1lvdki/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cn1lvdki/test/node1/conf'}
12:46:41,241 ccm INFO node1: using Java 8 for the current invocation
12:46:41,390 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cn1lvdki/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cn1lvdki/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:46:41,390 ccm INFO node1: using Java 8 for the current invocation
12:46:41,476 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:47:02,393 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cn1lvdki/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cn1lvdki/test/node1/conf'}
12:47:02,394 ccm INFO node1: using Java 8 for the current invocation
12:47:03,920 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cn1lvdki/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cn1lvdki/test/node1/conf'}
12:47:03,920 ccm INFO node1: using Java 8 for the current invocation
12:47:12,777 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cn1lvdki/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cn1lvdki/test/node1/conf'}
12:47:12,778 ccm INFO node1: using Java 8 for the current invocation
12:47:14,80 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
12:46:35,700 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:46:35,700 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:47:24,323 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 98.38 seconds ===========================
[msx] rc = 1
v1v2 running time = 119963752734
---> v1v2 test failed.
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
12:48:21,10 cassandra.protocol WARNING Server warning: Aggregation query used without partition key

-------------------------------- live log call ---------------------------------
12:49:13,511 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7f16f875a278>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
12:47:47,970 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:47:46,413 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 12:47:46.413739
12:47:47,874 dtest_setup INFO cluster ccm directory: /tmp/dtest-feti3kb4
------------------------------ Captured log call -------------------------------
12:47:48,573 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-feti3kb4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-feti3kb4/test/node1/conf'}
12:47:48,574 ccm INFO node1: using Java 8 for the current invocation
12:47:48,751 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-feti3kb4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-feti3kb4/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:47:48,751 ccm INFO node1: using Java 8 for the current invocation
12:47:48,837 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:48:08,407 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-feti3kb4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-feti3kb4/test/node1/conf'}
12:48:08,407 ccm INFO node1: using Java 8 for the current invocation
12:48:09,934 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-feti3kb4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-feti3kb4/test/node1/conf'}
12:48:09,934 ccm INFO node1: using Java 8 for the current invocation
12:48:19,690 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-feti3kb4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-feti3kb4/test/node1/conf'}
12:48:19,691 ccm INFO node1: using Java 8 for the current invocation
12:48:21,10 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
12:48:35,210 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
12:48:39,863 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:48:38,737 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 12:48:38.737053
12:48:39,747 dtest_setup INFO cluster ccm directory: /tmp/dtest-j7497kca
------------------------------ Captured log call -------------------------------
12:48:40,506 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j7497kca/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j7497kca/test/node1/conf'}
12:48:40,507 ccm INFO node1: using Java 8 for the current invocation
12:48:40,682 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j7497kca/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j7497kca/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:48:40,683 ccm INFO node1: using Java 8 for the current invocation
12:48:40,774 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:49:00,364 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j7497kca/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j7497kca/test/node1/conf'}
12:49:00,364 ccm INFO node1: using Java 8 for the current invocation
12:49:01,857 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j7497kca/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j7497kca/test/node1/conf'}
12:49:01,857 ccm INFO node1: using Java 8 for the current invocation
12:49:12,198 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j7497kca/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j7497kca/test/node1/conf'}
12:49:12,199 ccm INFO node1: using Java 8 for the current invocation
12:49:13,511 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
12:48:35,210 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:48:35,210 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:49:23,742 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 99.91 seconds ===========================
[msx] rc = 1
v1v1 running time = 121428296807
cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
12:50:20,929 cassandra.protocol WARNING Server warning: Aggregation query used without partition key

-------------------------------- live log call ---------------------------------
12:51:10,421 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7f0e4f82e710>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
12:49:49,647 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:49:47,783 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 12:49:47.783215
12:49:49,545 dtest_setup INFO cluster ccm directory: /tmp/dtest-nv9v5845
------------------------------ Captured log call -------------------------------
12:49:50,283 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nv9v5845/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nv9v5845/test/node1/conf'}
12:49:50,284 ccm INFO node1: using Java 8 for the current invocation
12:49:50,448 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nv9v5845/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nv9v5845/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:49:50,449 ccm INFO node1: using Java 8 for the current invocation
12:49:50,593 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:50:08,586 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nv9v5845/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nv9v5845/test/node1/conf'}
12:50:08,586 ccm INFO node1: using Java 8 for the current invocation
12:50:10,88 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nv9v5845/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nv9v5845/test/node1/conf'}
12:50:10,89 ccm INFO node1: using Java 8 for the current invocation
12:50:19,67 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nv9v5845/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nv9v5845/test/node1/conf'}
12:50:19,67 ccm INFO node1: using Java 8 for the current invocation
12:50:20,929 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
12:50:34,780 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
12:50:39,893 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:50:38,579 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 12:50:38.579184
12:50:39,789 dtest_setup INFO cluster ccm directory: /tmp/dtest-kr7_7stu
------------------------------ Captured log call -------------------------------
12:50:40,638 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kr7_7stu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kr7_7stu/test/node1/conf'}
12:50:40,640 ccm INFO node1: using Java 8 for the current invocation
12:50:40,806 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kr7_7stu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kr7_7stu/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:50:40,806 ccm INFO node1: using Java 8 for the current invocation
12:50:40,891 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:50:58,420 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kr7_7stu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kr7_7stu/test/node1/conf'}
12:50:58,421 ccm INFO node1: using Java 8 for the current invocation
12:50:59,862 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kr7_7stu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kr7_7stu/test/node1/conf'}
12:50:59,863 ccm INFO node1: using Java 8 for the current invocation
12:51:08,708 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kr7_7stu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kr7_7stu/test/node1/conf'}
12:51:08,709 ccm INFO node1: using Java 8 for the current invocation
12:51:10,421 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
12:50:34,780 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:50:34,780 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:51:20,506 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 95.27 seconds ===========================
[msx] rc = 1
v2v2 running time = 116751443265
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

v2v2 failed in a hypo test
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
12:52:15,772 cassandra.protocol WARNING Server warning: Aggregation query used without partition key

-------------------------------- live log call ---------------------------------
12:53:03,22 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7f64d3a53630>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
12:51:45,916 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:51:44,586 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 12:51:44.586753
12:51:45,797 dtest_setup INFO cluster ccm directory: /tmp/dtest-6kz37788
------------------------------ Captured log call -------------------------------
12:51:46,519 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6kz37788/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6kz37788/test/node1/conf'}
12:51:46,520 ccm INFO node1: using Java 8 for the current invocation
12:51:46,701 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6kz37788/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6kz37788/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:51:46,701 ccm INFO node1: using Java 8 for the current invocation
12:51:46,788 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:52:04,754 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6kz37788/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6kz37788/test/node1/conf'}
12:52:04,754 ccm INFO node1: using Java 8 for the current invocation
12:52:06,219 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6kz37788/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6kz37788/test/node1/conf'}
12:52:06,220 ccm INFO node1: using Java 8 for the current invocation
12:52:14,287 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6kz37788/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6kz37788/test/node1/conf'}
12:52:14,288 ccm INFO node1: using Java 8 for the current invocation
12:52:15,772 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
12:52:29,535 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
12:52:33,970 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:52:32,659 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 12:52:32.659876
12:52:33,870 dtest_setup INFO cluster ccm directory: /tmp/dtest-ccwp2rk1
------------------------------ Captured log call -------------------------------
12:52:34,631 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ccwp2rk1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ccwp2rk1/test/node1/conf'}
12:52:34,633 ccm INFO node1: using Java 8 for the current invocation
12:52:34,821 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ccwp2rk1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ccwp2rk1/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:52:34,821 ccm INFO node1: using Java 8 for the current invocation
12:52:34,905 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:52:51,164 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ccwp2rk1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ccwp2rk1/test/node1/conf'}
12:52:51,165 ccm INFO node1: using Java 8 for the current invocation
12:52:52,611 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ccwp2rk1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ccwp2rk1/test/node1/conf'}
12:52:52,612 ccm INFO node1: using Java 8 for the current invocation
12:53:01,724 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ccwp2rk1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ccwp2rk1/test/node1/conf'}
12:53:01,725 ccm INFO node1: using Java 8 for the current invocation
12:53:03,22 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
12:52:29,535 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:52:29,535 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:53:13,96 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 91.08 seconds ===========================
[msx] rc = 1
v1v2 running time = 112717007663
---> v1v2 test failed.
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
12:54:13,712 cassandra.protocol WARNING Server warning: Aggregation query used without partition key

-------------------------------- live log call ---------------------------------
12:55:04,468 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7efc3fcd74e0>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
12:53:38,919 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:53:37,349 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 12:53:37.349745
12:53:38,810 dtest_setup INFO cluster ccm directory: /tmp/dtest-220og6vd
------------------------------ Captured log call -------------------------------
12:53:39,594 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-220og6vd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-220og6vd/test/node1/conf'}
12:53:39,595 ccm INFO node1: using Java 8 for the current invocation
12:53:39,758 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-220og6vd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-220og6vd/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:53:39,759 ccm INFO node1: using Java 8 for the current invocation
12:53:39,846 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:54:00,681 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-220og6vd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-220og6vd/test/node1/conf'}
12:54:00,681 ccm INFO node1: using Java 8 for the current invocation
12:54:02,172 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-220og6vd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-220og6vd/test/node1/conf'}
12:54:02,173 ccm INFO node1: using Java 8 for the current invocation
12:54:12,366 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-220og6vd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-220og6vd/test/node1/conf'}
12:54:12,366 ccm INFO node1: using Java 8 for the current invocation
12:54:13,712 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
12:54:27,321 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
12:54:31,921 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:54:30,628 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 12:54:30.628194
12:54:31,839 dtest_setup INFO cluster ccm directory: /tmp/dtest-73xw5jpm
------------------------------ Captured log call -------------------------------
12:54:32,619 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-73xw5jpm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-73xw5jpm/test/node1/conf'}
12:54:32,620 ccm INFO node1: using Java 8 for the current invocation
12:54:32,833 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-73xw5jpm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-73xw5jpm/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:54:32,834 ccm INFO node1: using Java 8 for the current invocation
12:54:32,996 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:54:52,604 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-73xw5jpm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-73xw5jpm/test/node1/conf'}
12:54:52,604 ccm INFO node1: using Java 8 for the current invocation
12:54:54,42 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-73xw5jpm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-73xw5jpm/test/node1/conf'}
12:54:54,43 ccm INFO node1: using Java 8 for the current invocation
12:55:03,75 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-73xw5jpm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-73xw5jpm/test/node1/conf'}
12:55:03,75 ccm INFO node1: using Java 8 for the current invocation
12:55:04,468 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
12:54:27,321 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:54:27,321 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:55:14,538 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 97.79 seconds ===========================
[msx] rc = 1
v1v1 running time = 119338456584
cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
12:56:12,282 cassandra.protocol WARNING Server warning: Aggregation query used without partition key

-------------------------------- live log call ---------------------------------
12:57:02,347 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7f8e0cdb7cc0>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
12:55:38,758 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:55:37,635 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 12:55:37.635843
12:55:38,645 dtest_setup INFO cluster ccm directory: /tmp/dtest-01y6vazq
------------------------------ Captured log call -------------------------------
12:55:39,375 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-01y6vazq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-01y6vazq/test/node1/conf'}
12:55:39,375 ccm INFO node1: using Java 8 for the current invocation
12:55:39,561 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-01y6vazq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-01y6vazq/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:55:39,561 ccm INFO node1: using Java 8 for the current invocation
12:55:39,649 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:55:59,433 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-01y6vazq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-01y6vazq/test/node1/conf'}
12:55:59,434 ccm INFO node1: using Java 8 for the current invocation
12:56:00,988 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-01y6vazq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-01y6vazq/test/node1/conf'}
12:56:00,989 ccm INFO node1: using Java 8 for the current invocation
12:56:10,533 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-01y6vazq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-01y6vazq/test/node1/conf'}
12:56:10,534 ccm INFO node1: using Java 8 for the current invocation
12:56:12,282 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
12:56:25,643 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
12:56:30,226 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:56:28,948 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 12:56:28.948265
12:56:30,109 dtest_setup INFO cluster ccm directory: /tmp/dtest-mdln8i3n
------------------------------ Captured log call -------------------------------
12:56:30,887 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mdln8i3n/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mdln8i3n/test/node1/conf'}
12:56:30,888 ccm INFO node1: using Java 8 for the current invocation
12:56:31,57 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mdln8i3n/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mdln8i3n/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:56:31,58 ccm INFO node1: using Java 8 for the current invocation
12:56:31,143 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:56:48,864 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mdln8i3n/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mdln8i3n/test/node1/conf'}
12:56:48,865 ccm INFO node1: using Java 8 for the current invocation
12:56:50,311 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mdln8i3n/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mdln8i3n/test/node1/conf'}
12:56:50,312 ccm INFO node1: using Java 8 for the current invocation
12:57:00,587 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mdln8i3n/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mdln8i3n/test/node1/conf'}
12:57:00,588 ccm INFO node1: using Java 8 for the current invocation
12:57:02,347 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
12:56:25,643 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:56:25,643 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:57:12,603 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 98.19 seconds ===========================
[msx] rc = 1
v2v2 running time = 120016375592
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

v2v2 failed in a hypo test
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
12:58:12,186 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
12:58:25,646 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
12:58:25,649 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
12:59:05,399 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7f840b0ad978>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
12:57:38,362 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:57:36,652 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 12:57:36.652564
12:57:38,262 dtest_setup INFO cluster ccm directory: /tmp/dtest-2myz84ym
------------------------------ Captured log call -------------------------------
12:57:38,977 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2myz84ym/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2myz84ym/test/node1/conf'}
12:57:38,978 ccm INFO node1: using Java 8 for the current invocation
12:57:39,170 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2myz84ym/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2myz84ym/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:57:39,171 ccm INFO node1: using Java 8 for the current invocation
12:57:39,254 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:57:58,551 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2myz84ym/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2myz84ym/test/node1/conf'}
12:57:58,552 ccm INFO node1: using Java 8 for the current invocation
12:58:00,37 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2myz84ym/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2myz84ym/test/node1/conf'}
12:58:00,38 ccm INFO node1: using Java 8 for the current invocation
12:58:10,793 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2myz84ym/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2myz84ym/test/node1/conf'}
12:58:10,793 ccm INFO node1: using Java 8 for the current invocation
12:58:12,186 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
12:58:26,274 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
12:58:31,520 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:58:29,904 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 12:58:29.904913
12:58:31,418 dtest_setup INFO cluster ccm directory: /tmp/dtest-oi6p2ju3
------------------------------ Captured log call -------------------------------
12:58:32,164 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-oi6p2ju3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-oi6p2ju3/test/node1/conf'}
12:58:32,165 ccm INFO node1: using Java 8 for the current invocation
12:58:32,336 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-oi6p2ju3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-oi6p2ju3/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:58:32,337 ccm INFO node1: using Java 8 for the current invocation
12:58:32,412 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:58:51,714 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-oi6p2ju3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-oi6p2ju3/test/node1/conf'}
12:58:51,715 ccm INFO node1: using Java 8 for the current invocation
12:58:53,201 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-oi6p2ju3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-oi6p2ju3/test/node1/conf'}
12:58:53,202 ccm INFO node1: using Java 8 for the current invocation
12:59:04,53 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-oi6p2ju3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-oi6p2ju3/test/node1/conf'}
12:59:04,54 ccm INFO node1: using Java 8 for the current invocation
12:59:05,399 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
12:58:26,274 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:58:26,274 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:59:15,551 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 99.46 seconds ===========================
[msx] rc = 1
v1v2 running time = 120980422582
---> v1v2 test failed.
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
13:00:11,994 cassandra.protocol WARNING Server warning: Aggregation query used without partition key

-------------------------------- live log call ---------------------------------
13:01:04,959 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7f555d33b240>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
12:59:39,143 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:59:37,614 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 12:59:37.614231
12:59:38,975 dtest_setup INFO cluster ccm directory: /tmp/dtest-mwj3cd_q
------------------------------ Captured log call -------------------------------
12:59:39,763 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mwj3cd_q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mwj3cd_q/test/node1/conf'}
12:59:39,763 ccm INFO node1: using Java 8 for the current invocation
12:59:39,928 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mwj3cd_q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mwj3cd_q/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:59:39,929 ccm INFO node1: using Java 8 for the current invocation
12:59:40,30 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:59:59,482 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mwj3cd_q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mwj3cd_q/test/node1/conf'}
12:59:59,483 ccm INFO node1: using Java 8 for the current invocation
13:00:00,930 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mwj3cd_q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mwj3cd_q/test/node1/conf'}
13:00:00,931 ccm INFO node1: using Java 8 for the current invocation
13:00:10,648 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mwj3cd_q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mwj3cd_q/test/node1/conf'}
13:00:10,648 ccm INFO node1: using Java 8 for the current invocation
13:00:11,994 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:00:25,773 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
3:00:30,665 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:00:29,313 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:00:29.313260
13:00:30,563 dtest_setup INFO cluster ccm directory: /tmp/dtest-lblf9nn5
------------------------------ Captured log call -------------------------------
13:00:31,404 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lblf9nn5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lblf9nn5/test/node1/conf'}
13:00:31,405 ccm INFO node1: using Java 8 for the current invocation
13:00:31,568 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lblf9nn5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lblf9nn5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:00:31,569 ccm INFO node1: using Java 8 for the current invocation
13:00:31,647 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:00:51,820 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lblf9nn5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lblf9nn5/test/node1/conf'}
13:00:51,820 ccm INFO node1: using Java 8 for the current invocation
13:00:53,262 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lblf9nn5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lblf9nn5/test/node1/conf'}
13:00:53,262 ccm INFO node1: using Java 8 for the current invocation
13:01:03,628 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lblf9nn5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lblf9nn5/test/node1/conf'}
13:01:03,629 ccm INFO node1: using Java 8 for the current invocation
13:01:04,959 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:00:25,773 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:00:25,773 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:01:15,49 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 97.98 seconds ===========================
[msx] rc = 1
v1v1 running time = 119456879604
cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
13:02:12,262 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
13:02:26,334 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
13:02:26,337 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
13:03:03,241 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7fb274586278>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
13:01:38,945 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:01:37,127 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:01:37.126948
13:01:38,837 dtest_setup INFO cluster ccm directory: /tmp/dtest-hldszhcz
------------------------------ Captured log call -------------------------------
13:01:39,624 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hldszhcz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hldszhcz/test/node1/conf'}
13:01:39,625 ccm INFO node1: using Java 8 for the current invocation
13:01:39,820 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hldszhcz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hldszhcz/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:01:39,821 ccm INFO node1: using Java 8 for the current invocation
13:01:39,921 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:01:59,94 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hldszhcz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hldszhcz/test/node1/conf'}
13:01:59,95 ccm INFO node1: using Java 8 for the current invocation
13:02:00,551 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hldszhcz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hldszhcz/test/node1/conf'}
13:02:00,551 ccm INFO node1: using Java 8 for the current invocation
13:02:10,482 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hldszhcz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hldszhcz/test/node1/conf'}
13:02:10,483 ccm INFO node1: using Java 8 for the current invocation
13:02:12,262 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:02:26,597 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
13:02:31,630 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:02:30,265 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:02:30.265099
13:02:31,528 dtest_setup INFO cluster ccm directory: /tmp/dtest-00a2l5gw
------------------------------ Captured log call -------------------------------
13:02:32,311 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-00a2l5gw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-00a2l5gw/test/node1/conf'}
13:02:32,312 ccm INFO node1: using Java 8 for the current invocation
13:02:32,476 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-00a2l5gw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-00a2l5gw/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:02:32,477 ccm INFO node1: using Java 8 for the current invocation
13:02:32,562 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:02:50,724 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-00a2l5gw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-00a2l5gw/test/node1/conf'}
13:02:50,725 ccm INFO node1: using Java 8 for the current invocation
13:02:52,575 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-00a2l5gw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-00a2l5gw/test/node1/conf'}
13:02:52,575 ccm INFO node1: using Java 8 for the current invocation
13:03:01,509 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-00a2l5gw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-00a2l5gw/test/node1/conf'}
13:03:01,510 ccm INFO node1: using Java 8 for the current invocation
13:03:03,241 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:02:26,597 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:02:26,597 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:03:13,294 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 96.72 seconds ===========================
[msx] rc = 1
v2v2 running time = 118244659692
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

v2v2 failed in a hypo test
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
13:04:11,920 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
13:04:25,361 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
13:04:25,364 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
13:05:02,593 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7f6f4a14c240>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
13:03:37,107 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:03:35,798 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:03:35.798121
13:03:37,8 dtest_setup INFO cluster ccm directory: /tmp/dtest-mbmqqtra
------------------------------ Captured log call -------------------------------
13:03:37,727 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mbmqqtra/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mbmqqtra/test/node1/conf'}
13:03:37,728 ccm INFO node1: using Java 8 for the current invocation
13:03:37,904 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mbmqqtra/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mbmqqtra/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:03:37,905 ccm INFO node1: using Java 8 for the current invocation
13:03:37,988 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:03:58,761 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mbmqqtra/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mbmqqtra/test/node1/conf'}
13:03:58,762 ccm INFO node1: using Java 8 for the current invocation
13:04:00,303 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mbmqqtra/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mbmqqtra/test/node1/conf'}
13:04:00,304 ccm INFO node1: using Java 8 for the current invocation
13:04:10,565 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mbmqqtra/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mbmqqtra/test/node1/conf'}
13:04:10,566 ccm INFO node1: using Java 8 for the current invocation
13:04:11,920 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:04:25,758 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
13:04:30,415 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:04:29,201 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:04:29.201784
13:04:30,311 dtest_setup INFO cluster ccm directory: /tmp/dtest-busa5vr9
------------------------------ Captured log call -------------------------------
13:04:31,57 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-busa5vr9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-busa5vr9/test/node1/conf'}
13:04:31,58 ccm INFO node1: using Java 8 for the current invocation
13:04:31,216 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-busa5vr9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-busa5vr9/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:04:31,217 ccm INFO node1: using Java 8 for the current invocation
13:04:31,312 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:04:50,830 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-busa5vr9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-busa5vr9/test/node1/conf'}
13:04:50,830 ccm INFO node1: using Java 8 for the current invocation
13:04:52,358 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-busa5vr9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-busa5vr9/test/node1/conf'}
13:04:52,359 ccm INFO node1: using Java 8 for the current invocation
13:05:01,156 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-busa5vr9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-busa5vr9/test/node1/conf'}
13:05:01,157 ccm INFO node1: using Java 8 for the current invocation
13:05:02,593 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:04:25,758 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:04:25,758 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:05:12,824 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 98.03 seconds ===========================
[msx] rc = 1
v1v2 running time = 119521425074
---> v1v2 test failed.
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
13:06:09,569 cassandra.protocol WARNING Server warning: Aggregation query used without partition key

-------------------------------- live log call ---------------------------------
13:07:00,793 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7f046bfadc88>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
13:05:36,104 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:05:34,988 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:05:34.988193
13:05:35,996 dtest_setup INFO cluster ccm directory: /tmp/dtest-4b1lke6s
------------------------------ Captured log call -------------------------------
13:05:36,884 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4b1lke6s/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4b1lke6s/test/node1/conf'}
13:05:36,885 ccm INFO node1: using Java 8 for the current invocation
13:05:37,120 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4b1lke6s/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4b1lke6s/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:05:37,121 ccm INFO node1: using Java 8 for the current invocation
13:05:37,252 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:05:57,940 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4b1lke6s/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4b1lke6s/test/node1/conf'}
13:05:57,941 ccm INFO node1: using Java 8 for the current invocation
13:05:59,390 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4b1lke6s/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4b1lke6s/test/node1/conf'}
13:05:59,391 ccm INFO node1: using Java 8 for the current invocation
13:06:08,242 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4b1lke6s/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4b1lke6s/test/node1/conf'}
13:06:08,243 ccm INFO node1: using Java 8 for the current invocation
13:06:09,569 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:06:23,34 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
13:06:27,960 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:06:26,743 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:06:26.743535
13:06:27,855 dtest_setup INFO cluster ccm directory: /tmp/dtest-9hyrv717
------------------------------ Captured log call -------------------------------
13:06:28,558 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9hyrv717/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9hyrv717/test/node1/conf'}
13:06:28,559 ccm INFO node1: using Java 8 for the current invocation
13:06:28,746 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9hyrv717/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9hyrv717/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:06:28,747 ccm INFO node1: using Java 8 for the current invocation
13:06:28,830 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:06:47,145 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9hyrv717/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9hyrv717/test/node1/conf'}
13:06:47,145 ccm INFO node1: using Java 8 for the current invocation
13:06:48,659 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9hyrv717/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9hyrv717/test/node1/conf'}
13:06:48,660 ccm INFO node1: using Java 8 for the current invocation
13:06:59,304 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9hyrv717/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9hyrv717/test/node1/conf'}
13:06:59,305 ccm INFO node1: using Java 8 for the current invocation
13:07:00,793 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:06:23,34 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:06:23,34 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:07:11,92 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 98.67 seconds ===========================
[msx] rc = 1
v1v1 running time = 120280579845
cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
13:08:09,601 cassandra.protocol WARNING Server warning: Aggregation query used without partition key

-------------------------------- live log call ---------------------------------
13:08:59,763 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7fda36339eb8>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
13:07:37,106 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:07:35,461 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:07:35.461209
13:07:37,13 dtest_setup INFO cluster ccm directory: /tmp/dtest-k73o5d7t
------------------------------ Captured log call -------------------------------
13:07:37,754 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k73o5d7t/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k73o5d7t/test/node1/conf'}
13:07:37,754 ccm INFO node1: using Java 8 for the current invocation
13:07:37,924 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k73o5d7t/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k73o5d7t/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:07:37,925 ccm INFO node1: using Java 8 for the current invocation
13:07:38,5 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:07:57,539 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k73o5d7t/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k73o5d7t/test/node1/conf'}
13:07:57,617 ccm INFO node1: using Java 8 for the current invocation
13:07:59,256 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k73o5d7t/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k73o5d7t/test/node1/conf'}
13:07:59,257 ccm INFO node1: using Java 8 for the current invocation
13:08:07,795 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k73o5d7t/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k73o5d7t/test/node1/conf'}
13:08:07,795 ccm INFO node1: using Java 8 for the current invocation
13:08:09,601 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:08:22,986 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
13:08:27,930 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:08:26,623 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:08:26.623893
13:08:27,835 dtest_setup INFO cluster ccm directory: /tmp/dtest-zycdfkdu
------------------------------ Captured log call -------------------------------
13:08:28,582 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-zycdfkdu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-zycdfkdu/test/node1/conf'}
13:08:28,583 ccm INFO node1: using Java 8 for the current invocation
13:08:28,766 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-zycdfkdu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-zycdfkdu/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:08:28,767 ccm INFO node1: using Java 8 for the current invocation
13:08:28,851 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:08:46,800 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-zycdfkdu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-zycdfkdu/test/node1/conf'}
13:08:46,801 ccm INFO node1: using Java 8 for the current invocation
13:08:48,736 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-zycdfkdu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-zycdfkdu/test/node1/conf'}
13:08:48,737 ccm INFO node1: using Java 8 for the current invocation
13:08:58,71 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-zycdfkdu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-zycdfkdu/test/node1/conf'}
13:08:58,71 ccm INFO node1: using Java 8 for the current invocation
13:08:59,763 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:08:22,986 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:08:22,986 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:09:10,62 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 97.39 seconds ===========================
[msx] rc = 1
v2v2 running time = 118986817595
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

v2v2 failed in a hypo test
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
13:10:07,633 cassandra.protocol WARNING Server warning: Aggregation query used without partition key

-------------------------------- live log call ---------------------------------
13:10:57,317 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7f0798c330f0>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
13:09:36,105 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:09:34,292 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:09:34.292222
13:09:36,3 dtest_setup INFO cluster ccm directory: /tmp/dtest-mg7apyxg
------------------------------ Captured log call -------------------------------
13:09:36,748 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mg7apyxg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mg7apyxg/test/node1/conf'}
13:09:36,749 ccm INFO node1: using Java 8 for the current invocation
13:09:36,910 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mg7apyxg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mg7apyxg/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:09:36,911 ccm INFO node1: using Java 8 for the current invocation
13:09:36,989 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:09:55,368 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mg7apyxg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mg7apyxg/test/node1/conf'}
13:09:55,369 ccm INFO node1: using Java 8 for the current invocation
13:09:56,894 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mg7apyxg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mg7apyxg/test/node1/conf'}
13:09:56,894 ccm INFO node1: using Java 8 for the current invocation
13:10:06,327 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mg7apyxg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mg7apyxg/test/node1/conf'}
13:10:06,328 ccm INFO node1: using Java 8 for the current invocation
13:10:07,633 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:10:21,74 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
13:10:25,487 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:10:24,432 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:10:24.432571
13:10:25,393 dtest_setup INFO cluster ccm directory: /tmp/dtest-uwf9jv16
------------------------------ Captured log call -------------------------------
13:10:26,124 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-uwf9jv16/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-uwf9jv16/test/node1/conf'}
13:10:26,125 ccm INFO node1: using Java 8 for the current invocation
13:10:26,287 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-uwf9jv16/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-uwf9jv16/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:10:26,288 ccm INFO node1: using Java 8 for the current invocation
13:10:26,366 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:10:47,4 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-uwf9jv16/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-uwf9jv16/test/node1/conf'}
13:10:47,4 ccm INFO node1: using Java 8 for the current invocation
13:10:48,502 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-uwf9jv16/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-uwf9jv16/test/node1/conf'}
13:10:48,502 ccm INFO node1: using Java 8 for the current invocation
13:10:55,915 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-uwf9jv16/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-uwf9jv16/test/node1/conf'}
13:10:55,915 ccm INFO node1: using Java 8 for the current invocation
13:10:57,317 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:10:21,74 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:10:21,74 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:11:07,612 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 95.94 seconds ===========================
[msx] rc = 1
v1v2 running time = 117498635344
---> v1v2 test failed.
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
13:12:07,743 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
13:12:20,859 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
13:12:20,862 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
13:12:59,998 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7f57d02d4ef0>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
13:11:33,499 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:11:31,730 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:11:31.730489
13:11:33,392 dtest_setup INFO cluster ccm directory: /tmp/dtest-yhsh3kr1
------------------------------ Captured log call -------------------------------
13:11:34,188 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yhsh3kr1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yhsh3kr1/test/node1/conf'}
13:11:34,189 ccm INFO node1: using Java 8 for the current invocation
13:11:34,367 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yhsh3kr1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yhsh3kr1/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:11:34,367 ccm INFO node1: using Java 8 for the current invocation
13:11:34,457 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:11:54,989 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yhsh3kr1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yhsh3kr1/test/node1/conf'}
13:11:54,990 ccm INFO node1: using Java 8 for the current invocation
13:11:56,475 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yhsh3kr1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yhsh3kr1/test/node1/conf'}
13:11:56,475 ccm INFO node1: using Java 8 for the current invocation
13:12:06,370 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yhsh3kr1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yhsh3kr1/test/node1/conf'}
13:12:06,371 ccm INFO node1: using Java 8 for the current invocation
13:12:07,743 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:12:21,713 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
13:12:26,865 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:12:25,642 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:12:25.642604
13:12:26,756 dtest_setup INFO cluster ccm directory: /tmp/dtest-v3j2g2vs
------------------------------ Captured log call -------------------------------
13:12:27,530 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v3j2g2vs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v3j2g2vs/test/node1/conf'}
13:12:27,531 ccm INFO node1: using Java 8 for the current invocation
13:12:27,718 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v3j2g2vs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v3j2g2vs/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:12:27,719 ccm INFO node1: using Java 8 for the current invocation
13:12:27,797 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:12:46,840 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v3j2g2vs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v3j2g2vs/test/node1/conf'}
13:12:46,841 ccm INFO node1: using Java 8 for the current invocation
13:12:48,378 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v3j2g2vs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v3j2g2vs/test/node1/conf'}
13:12:48,379 ccm INFO node1: using Java 8 for the current invocation
13:12:58,600 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v3j2g2vs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v3j2g2vs/test/node1/conf'}
13:12:58,601 ccm INFO node1: using Java 8 for the current invocation
13:12:59,998 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:12:21,713 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:12:21,713 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:13:10,247 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 99.11 seconds ===========================
[msx] rc = 1
v1v1 running time = 120652502069
cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
13:14:03,297 cassandra.protocol WARNING Server warning: Aggregation query used without partition key

-------------------------------- live log call ---------------------------------
13:14:54,933 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7fe1ca50f550>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
13:13:34,7 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:13:32,355 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:13:32.355413
13:13:33,865 dtest_setup INFO cluster ccm directory: /tmp/dtest-ykwk3bix
------------------------------ Captured log call -------------------------------
13:13:34,863 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ykwk3bix/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ykwk3bix/test/node1/conf'}
13:13:34,863 ccm INFO node1: using Java 8 for the current invocation
13:13:35,36 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ykwk3bix/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ykwk3bix/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:13:35,37 ccm INFO node1: using Java 8 for the current invocation
13:13:35,127 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:13:53,751 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ykwk3bix/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ykwk3bix/test/node1/conf'}
13:13:53,752 ccm INFO node1: using Java 8 for the current invocation
13:13:55,240 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ykwk3bix/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ykwk3bix/test/node1/conf'}
13:13:55,241 ccm INFO node1: using Java 8 for the current invocation
13:14:01,531 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ykwk3bix/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ykwk3bix/test/node1/conf'}
13:14:01,532 ccm INFO node1: using Java 8 for the current invocation
13:14:03,297 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:14:16,637 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
13:14:21,485 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:14:20,306 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:14:20.306293
13:14:21,357 dtest_setup INFO cluster ccm directory: /tmp/dtest-4h88rays
------------------------------ Captured log call -------------------------------
13:14:22,204 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h88rays/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h88rays/test/node1/conf'}
13:14:22,206 ccm INFO node1: using Java 8 for the current invocation
13:14:22,374 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h88rays/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h88rays/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:14:22,375 ccm INFO node1: using Java 8 for the current invocation
13:14:22,460 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:14:42,751 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h88rays/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h88rays/test/node1/conf'}
13:14:42,752 ccm INFO node1: using Java 8 for the current invocation
13:14:44,183 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h88rays/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h88rays/test/node1/conf'}
13:14:44,184 ccm INFO node1: using Java 8 for the current invocation
13:14:53,209 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h88rays/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h88rays/test/node1/conf'}
13:14:53,210 ccm INFO node1: using Java 8 for the current invocation
13:14:54,933 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:14:16,637 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:14:16,637 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:15:05,108 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 93.33 seconds ===========================
[msx] rc = 1
v2v2 running time = 114831575795
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

v2v2 failed in a hypo test
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
13:16:03,781 cassandra.protocol WARNING Server warning: Aggregation query used without partition key

-------------------------------- live log call ---------------------------------
13:16:54,732 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7fb7ade23a20>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
13:15:28,392 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:15:27,187 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:15:27.187478
13:15:28,298 dtest_setup INFO cluster ccm directory: /tmp/dtest-959qsxod
------------------------------ Captured log call -------------------------------
13:15:29,2 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-959qsxod/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-959qsxod/test/node1/conf'}
13:15:29,3 ccm INFO node1: using Java 8 for the current invocation
13:15:29,178 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-959qsxod/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-959qsxod/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:15:29,179 ccm INFO node1: using Java 8 for the current invocation
13:15:29,270 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:15:50,770 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-959qsxod/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-959qsxod/test/node1/conf'}
13:15:50,771 ccm INFO node1: using Java 8 for the current invocation
13:15:52,262 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-959qsxod/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-959qsxod/test/node1/conf'}
13:15:52,263 ccm INFO node1: using Java 8 for the current invocation
13:16:02,418 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-959qsxod/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-959qsxod/test/node1/conf'}
13:16:02,419 ccm INFO node1: using Java 8 for the current invocation
13:16:03,781 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:16:17,373 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
13:16:22,351 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:16:21,77 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:16:21.077902
13:16:22,238 dtest_setup INFO cluster ccm directory: /tmp/dtest-a9g9d94e
------------------------------ Captured log call -------------------------------
13:16:22,962 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a9g9d94e/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a9g9d94e/test/node1/conf'}
13:16:22,963 ccm INFO node1: using Java 8 for the current invocation
13:16:23,138 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a9g9d94e/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a9g9d94e/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:16:23,138 ccm INFO node1: using Java 8 for the current invocation
13:16:23,225 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:16:42,227 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a9g9d94e/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a9g9d94e/test/node1/conf'}
13:16:42,227 ccm INFO node1: using Java 8 for the current invocation
13:16:43,641 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a9g9d94e/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a9g9d94e/test/node1/conf'}
13:16:43,642 ccm INFO node1: using Java 8 for the current invocation
13:16:53,329 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a9g9d94e/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a9g9d94e/test/node1/conf'}
13:16:53,330 ccm INFO node1: using Java 8 for the current invocation
13:16:54,732 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:16:17,373 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:16:17,373 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:17:04,968 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 98.36 seconds ===========================
[msx] rc = 1
v1v2 running time = 119868085349
---> v1v2 test failed.
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
13:18:01,451 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
13:18:14,597 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
13:18:14,600 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
13:18:49,519 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
13:19:00,16 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
13:19:33,836 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
PASSED                                                                   [100%]
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 127.52 seconds ==========================
[msx] rc = 0
v1v1 running time = 149001661437
cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
13:20:29,311 cassandra.protocol WARNING Server warning: Aggregation query used without partition key

-------------------------------- live log call ---------------------------------
13:21:16,467 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7f1d1b5cbc88>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
13:19:57,781 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:19:56,369 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:19:56.369603
13:19:57,681 dtest_setup INFO cluster ccm directory: /tmp/dtest-fpmhy0ak
------------------------------ Captured log call -------------------------------
13:19:58,405 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fpmhy0ak/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fpmhy0ak/test/node1/conf'}
13:19:58,406 ccm INFO node1: using Java 8 for the current invocation
13:19:58,581 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fpmhy0ak/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fpmhy0ak/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:19:58,582 ccm INFO node1: using Java 8 for the current invocation
13:19:58,666 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:20:16,655 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fpmhy0ak/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fpmhy0ak/test/node1/conf'}
13:20:16,656 ccm INFO node1: using Java 8 for the current invocation
13:20:18,117 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fpmhy0ak/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fpmhy0ak/test/node1/conf'}
13:20:18,118 ccm INFO node1: using Java 8 for the current invocation
13:20:27,273 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fpmhy0ak/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fpmhy0ak/test/node1/conf'}
13:20:27,274 ccm INFO node1: using Java 8 for the current invocation
13:20:29,311 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:20:42,921 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
13:20:47,653 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:20:46,397 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:20:46.397316
13:20:47,550 dtest_setup INFO cluster ccm directory: /tmp/dtest-4t_fiuh8
------------------------------ Captured log call -------------------------------
13:20:48,281 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4t_fiuh8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4t_fiuh8/test/node1/conf'}
13:20:48,282 ccm INFO node1: using Java 8 for the current invocation
13:20:48,455 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4t_fiuh8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4t_fiuh8/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:20:48,456 ccm INFO node1: using Java 8 for the current invocation
13:20:48,547 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:21:06,340 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4t_fiuh8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4t_fiuh8/test/node1/conf'}
13:21:06,341 ccm INFO node1: using Java 8 for the current invocation
13:21:07,774 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4t_fiuh8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4t_fiuh8/test/node1/conf'}
13:21:07,775 ccm INFO node1: using Java 8 for the current invocation
13:21:14,735 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4t_fiuh8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4t_fiuh8/test/node1/conf'}
13:21:14,736 ccm INFO node1: using Java 8 for the current invocation
13:21:16,467 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:20:42,921 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:20:42,921 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:21:26,536 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 90.79 seconds ===========================
[msx] rc = 1
v2v2 running time = 112613791105
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
13:22:21,188 cassandra.protocol WARNING Server warning: Aggregation query used without partition key

-------------------------------- live log call ---------------------------------
13:23:10,629 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7f7b8e322400>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
13:21:50,309 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:21:48,693 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:21:48.693136
13:21:50,204 dtest_setup INFO cluster ccm directory: /tmp/dtest-a2kxcqij
------------------------------ Captured log call -------------------------------
13:21:51,2 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a2kxcqij/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a2kxcqij/test/node1/conf'}
13:21:51,2 ccm INFO node1: using Java 8 for the current invocation
13:21:51,191 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a2kxcqij/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a2kxcqij/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:21:51,192 ccm INFO node1: using Java 8 for the current invocation
13:21:51,279 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:22:09,506 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a2kxcqij/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a2kxcqij/test/node1/conf'}
13:22:09,506 ccm INFO node1: using Java 8 for the current invocation
13:22:11,251 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a2kxcqij/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a2kxcqij/test/node1/conf'}
13:22:11,252 ccm INFO node1: using Java 8 for the current invocation
13:22:19,814 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a2kxcqij/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a2kxcqij/test/node1/conf'}
13:22:19,815 ccm INFO node1: using Java 8 for the current invocation
13:22:21,188 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:22:34,686 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
13:22:39,188 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:22:37,975 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:22:37.975023
13:22:39,86 dtest_setup INFO cluster ccm directory: /tmp/dtest-0yyw7219
------------------------------ Captured log call -------------------------------
13:22:39,968 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0yyw7219/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0yyw7219/test/node1/conf'}
13:22:39,969 ccm INFO node1: using Java 8 for the current invocation
13:22:40,215 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0yyw7219/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0yyw7219/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:22:40,215 ccm INFO node1: using Java 8 for the current invocation
13:22:40,301 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:22:59,352 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0yyw7219/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0yyw7219/test/node1/conf'}
13:22:59,352 ccm INFO node1: using Java 8 for the current invocation
13:23:01,244 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0yyw7219/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0yyw7219/test/node1/conf'}
13:23:01,245 ccm INFO node1: using Java 8 for the current invocation
13:23:09,291 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0yyw7219/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0yyw7219/test/node1/conf'}
13:23:09,292 ccm INFO node1: using Java 8 for the current invocation
13:23:10,629 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:22:34,686 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:22:34,686 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:23:20,811 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 94.72 seconds ===========================
[msx] rc = 1
v1v2 running time = 116242500398
---> v1v2 test failed.
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
13:24:17,995 cassandra.protocol WARNING Server warning: Aggregation query used without partition key

-------------------------------- live log call ---------------------------------
13:25:09,551 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7fd111891160>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
13:23:46,615 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:23:45,32 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:23:45.032667
13:23:46,494 dtest_setup INFO cluster ccm directory: /tmp/dtest-ik6s0nqo
------------------------------ Captured log call -------------------------------
13:23:47,256 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ik6s0nqo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ik6s0nqo/test/node1/conf'}
13:23:47,256 ccm INFO node1: using Java 8 for the current invocation
13:23:47,432 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ik6s0nqo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ik6s0nqo/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:23:47,433 ccm INFO node1: using Java 8 for the current invocation
13:23:47,517 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:24:06,234 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ik6s0nqo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ik6s0nqo/test/node1/conf'}
13:24:06,235 ccm INFO node1: using Java 8 for the current invocation
13:24:07,757 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ik6s0nqo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ik6s0nqo/test/node1/conf'}
13:24:07,758 ccm INFO node1: using Java 8 for the current invocation
13:24:16,652 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ik6s0nqo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ik6s0nqo/test/node1/conf'}
13:24:16,653 ccm INFO node1: using Java 8 for the current invocation
13:24:17,995 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:24:31,740 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
13:24:36,276 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:24:35,72 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:24:35.072594
13:24:36,182 dtest_setup INFO cluster ccm directory: /tmp/dtest-u9yig07m
------------------------------ Captured log call -------------------------------
13:24:36,988 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u9yig07m/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u9yig07m/test/node1/conf'}
13:24:36,989 ccm INFO node1: using Java 8 for the current invocation
13:24:37,170 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u9yig07m/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u9yig07m/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:24:37,171 ccm INFO node1: using Java 8 for the current invocation
13:24:37,273 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:24:56,818 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u9yig07m/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u9yig07m/test/node1/conf'}
13:24:56,819 ccm INFO node1: using Java 8 for the current invocation
13:24:58,336 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u9yig07m/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u9yig07m/test/node1/conf'}
13:24:58,337 ccm INFO node1: using Java 8 for the current invocation
13:25:08,192 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u9yig07m/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u9yig07m/test/node1/conf'}
13:25:08,192 ccm INFO node1: using Java 8 for the current invocation
13:25:09,551 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:24:31,740 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:24:31,740 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:25:19,848 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 97.46 seconds ===========================
[msx] rc = 1
v1v1 running time = 119014613049
cassandra snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore 
-------------------------------- live log call ---------------------------------
13:26:16,900 cassandra.protocol WARNING Server warning: Aggregation query used without partition key

-------------------------------- live log call ---------------------------------
13:27:10,328 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
FAILED                                                                   [100%]

=================================== FAILURES ===================================
_________________ TestSnapshot.test_basic_snapshot_and_restore _________________

self = <snapshot_test.TestSnapshot object at 0x7f6a50739470>

    def test_basic_snapshot_and_restore(self):
        cluster = self.cluster
        cluster.populate(1).start()
        (node1,) = cluster.nodelist()
        session = self.patient_cql_connection(node1)
        self.create_schema(session)
    
        self.insert_rows(session, 0, 100)
        snapshot_dir = self.make_snapshot(node1, 'ks', 'cf', 'basic')
    
        # Write more data after the snapshot, this will get thrown
        # away when we restore:
        self.insert_rows(session, 100, 200)
        rows = session.execute('SELECT count(*) from ks.cf')
        assert rows[0][0] == 200
    
        # Drop the keyspace, make sure we have no data:
>       session.execute('DROP KEYSPACE ks')

snapshot_test.py:107: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

cassandra/cluster.py:4894: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
3:25:45,541 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:25:43,983 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:25:43.983133
13:25:45,442 dtest_setup INFO cluster ccm directory: /tmp/dtest-rr4wkbdk
------------------------------ Captured log call -------------------------------
13:25:46,203 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-rr4wkbdk/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-rr4wkbdk/test/node1/conf'}
13:25:46,204 ccm INFO node1: using Java 8 for the current invocation
13:25:46,380 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-rr4wkbdk/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-rr4wkbdk/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:25:46,381 ccm INFO node1: using Java 8 for the current invocation
13:25:46,481 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:26:05,102 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-rr4wkbdk/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-rr4wkbdk/test/node1/conf'}
13:26:05,103 ccm INFO node1: using Java 8 for the current invocation
13:26:06,535 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-rr4wkbdk/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-rr4wkbdk/test/node1/conf'}
13:26:06,536 ccm INFO node1: using Java 8 for the current invocation
13:26:15,110 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-rr4wkbdk/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-rr4wkbdk/test/node1/conf'}
13:26:15,111 ccm INFO node1: using Java 8 for the current invocation
13:26:16,900 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:26:31,177 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
13:26:36,256 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:26:34,949 conftest INFO Starting execution of test_basic_snapshot_and_restore at 2022-01-31 13:26:34.949351
13:26:36,160 dtest_setup INFO cluster ccm directory: /tmp/dtest-89ypjydo
------------------------------ Captured log call -------------------------------
13:26:36,941 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-89ypjydo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-89ypjydo/test/node1/conf'}
13:26:36,943 ccm INFO node1: using Java 8 for the current invocation
13:26:37,101 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-89ypjydo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-89ypjydo/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:26:37,101 ccm INFO node1: using Java 8 for the current invocation
13:26:37,185 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:26:56,694 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-89ypjydo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-89ypjydo/test/node1/conf'}
13:26:56,695 ccm INFO node1: using Java 8 for the current invocation
13:26:58,284 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-89ypjydo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-89ypjydo/test/node1/conf'}
13:26:58,285 ccm INFO node1: using Java 8 for the current invocation
13:27:08,570 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '1920c215b53c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'snapshot_test.py::TestSnapshot::()::test_basic_snapshot_and_restore (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-89ypjydo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-89ypjydo/test/node1/conf'}
13:27:08,571 ccm INFO node1: using Java 8 for the current invocation
13:27:10,328 cassandra.protocol WARNING Server warning: Aggregation query used without partition key
--------------------------- Captured stdout teardown ---------------------------
13:26:31,177 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:26:31,177 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
13:27:20,387 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_basic_snapshot_and_restore failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]
test_basic_snapshot_and_restore failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/snapshot_test.py:107>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
========================== 1 failed in 96.99 seconds ===========================
[msx] rc = 1
v2v2 running time = 118484170448
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

v2v2 failed in a hypo test
proj: cassandra
u_test: snapshot_test.py::TestSnapshot::test_basic_snapshot_and_restore
h_list: snapshot_links_per_second@@@Tool@@@-3@@@0@@@60
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

early stop after 7 is satisfied
v1v2 failed with probability 7 out of 7
v1v1v2v2 failed with probability 7 out of 7
Total execution time in seconds : 2516
0
