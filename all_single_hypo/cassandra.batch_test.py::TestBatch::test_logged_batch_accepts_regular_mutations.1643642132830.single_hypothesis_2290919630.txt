my_type=hypothesis
proj=cassandra
u_test=batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list[1]=commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
proj: cassandra
u_test: batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations FAILED [100%]
------------------------------ live log teardown -------------------------------
15:23:30,402 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:22:59,802 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations ERROR [100%]

==================================== ERRORS ====================================
__ ERROR at teardown of TestBatch.test_logged_batch_accepts_regular_mutations __
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-01-31 15:22:59,802 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:22:59,805 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:22:59,805 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:22:59,802 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
15:22:41,894 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:22:40,98 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:22:40.098560
15:22:41,792 dtest_setup INFO cluster ccm directory: /tmp/dtest-_103vdne
----------------------------- Captured stdout call -----------------------------

15:22:41,896 ccm DEBUG using balanced tokens for non-vnode cluster
15:22:42,560 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_103vdne/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_103vdne/test/node1/conf'}
15:22:42,568 ccm INFO node1: using Java 8 for the current invocation
15:22:42,722 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_103vdne/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_103vdne/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:22:42,723 ccm INFO node1: using Java 8 for the current invocation
15:22:42,812 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:22:59,802 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:22:59,805 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:22:59,805 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
15:22:42,560 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_103vdne/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_103vdne/test/node1/conf'}
15:22:42,568 ccm INFO node1: using Java 8 for the current invocation
15:22:42,722 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_103vdne/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_103vdne/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:22:42,723 ccm INFO node1: using Java 8 for the current invocation
15:22:42,812 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
15:23:30,402 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:22:59,802 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
____________ TestBatch.test_logged_batch_accepts_regular_mutations _____________

self = <batch_test.TestBatch object at 0x7f950c042e48>

    def test_logged_batch_accepts_regular_mutations(self):
        """ Test that logged batch accepts regular mutations """
>       session = self.prepare()

batch_test.py:61: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
batch_test.py:448: in prepare
    session = self.patient_cql_connection(node1, protocol_version=protocol_version)
dtest_setup.py:250: in patient_cql_connection
    **kwargs
dtest_setup.py:39: in retry_till_success
    return fun(*args, **kwargs)
dtest_setup.py:177: in cql_connection
    protocol_version, port=port, ssl_opts=ssl_opts, **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.1:9042': ConnectionRefusedError(111, "Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused")})

cassandra/cluster.py:3533: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
15:22:41,894 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:22:40,98 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:22:40.098560
15:22:41,792 dtest_setup INFO cluster ccm directory: /tmp/dtest-_103vdne
----------------------------- Captured stdout call -----------------------------

15:22:41,896 ccm DEBUG using balanced tokens for non-vnode cluster
15:22:42,560 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_103vdne/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_103vdne/test/node1/conf'}
15:22:42,568 ccm INFO node1: using Java 8 for the current invocation
15:22:42,722 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_103vdne/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_103vdne/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:22:42,723 ccm INFO node1: using Java 8 for the current invocation
15:22:42,812 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:22:59,802 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:22:59,805 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:22:59,805 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
15:22:42,560 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_103vdne/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_103vdne/test/node1/conf'}
15:22:42,568 ccm INFO node1: using Java 8 for the current invocation
15:22:42,722 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_103vdne/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_103vdne/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:22:42,723 ccm INFO node1: using Java 8 for the current invocation
15:22:42,812 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.1:9042': ConnectionRefusedError(111, "Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused")})
	[<TracebackEntry /root/cassandra-dtest/batch_test.py:61>, <TracebackEntry /root/cassandra-dtest/batch_test.py:448>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:250>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:39>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:177>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 51.27 seconds ======================
[msx] rc = 1
v1v2 running time = 72921059412
---> v1v2 test failed.
proj: cassandra
u_test: batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 14.37 seconds ===========================
[msx] rc = 0
v1v1 running time = 36015427607
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations 
-------------------------------- live log call ---------------------------------
15:24:49,140 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
15:24:49,247 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:24:48,529 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations ERROR [100%]

==================================== ERRORS ====================================
__ ERROR at teardown of TestBatch.test_logged_batch_accepts_regular_mutations __
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-01-31 15:24:48,529 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:24:48,531 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:24:48,532 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:24:48,529 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
15:24:30,200 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:24:28,895 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:24:28.895554
15:24:30,102 dtest_setup INFO cluster ccm directory: /tmp/dtest-wcedtz_6
----------------------------- Captured stdout call -----------------------------

15:24:30,202 ccm DEBUG using balanced tokens for non-vnode cluster
15:24:30,893 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-wcedtz_6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-wcedtz_6/test/node1/conf'}
15:24:30,893 ccm INFO node1: using Java 8 for the current invocation
15:24:31,68 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-wcedtz_6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-wcedtz_6/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:24:31,68 ccm INFO node1: using Java 8 for the current invocation
15:24:31,153 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:24:48,529 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:24:48,531 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:24:48,532 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
15:24:30,893 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-wcedtz_6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-wcedtz_6/test/node1/conf'}
15:24:30,893 ccm INFO node1: using Java 8 for the current invocation
15:24:31,68 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-wcedtz_6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-wcedtz_6/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:24:31,68 ccm INFO node1: using Java 8 for the current invocation
15:24:31,153 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
15:24:49,247 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:24:48,529 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
____________ TestBatch.test_logged_batch_accepts_regular_mutations _____________

self = <batch_test.TestBatch object at 0x7f90bf906b00>

    def test_logged_batch_accepts_regular_mutations(self):
        """ Test that logged batch accepts regular mutations """
>       session = self.prepare()

batch_test.py:61: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
batch_test.py:449: in prepare
    self.create_schema(session, nodes)
batch_test.py:463: in create_schema
    """)
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
15:24:30,200 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:24:28,895 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:24:28.895554
15:24:30,102 dtest_setup INFO cluster ccm directory: /tmp/dtest-wcedtz_6
----------------------------- Captured stdout call -----------------------------

15:24:30,202 ccm DEBUG using balanced tokens for non-vnode cluster
15:24:30,893 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-wcedtz_6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-wcedtz_6/test/node1/conf'}
15:24:30,893 ccm INFO node1: using Java 8 for the current invocation
15:24:31,68 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-wcedtz_6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-wcedtz_6/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:24:31,68 ccm INFO node1: using Java 8 for the current invocation
15:24:31,153 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:24:48,529 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:24:48,531 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:24:48,532 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
15:24:30,893 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-wcedtz_6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-wcedtz_6/test/node1/conf'}
15:24:30,893 ccm INFO node1: using Java 8 for the current invocation
15:24:31,68 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-wcedtz_6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-wcedtz_6/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:24:31,68 ccm INFO node1: using Java 8 for the current invocation
15:24:31,153 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/batch_test.py:61>, <TracebackEntry /root/cassandra-dtest/batch_test.py:449>, <TracebackEntry /root/cassandra-dtest/batch_test.py:463>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 21.35 seconds ======================
[msx] rc = 1
v2v2 running time = 42834046505
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 18.89 seconds ===========================
[msx] rc = 0
v1v2 running time = 40480965730
---> v1v2 test suceeded.
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 14.70 seconds ===========================
[msx] rc = 0
v1v1 running time = 36240012951
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations 
-------------------------------- live log call ---------------------------------
15:26:49,129 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
15:26:49,237 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:26:48,508 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations ERROR [100%]

==================================== ERRORS ====================================
__ ERROR at teardown of TestBatch.test_logged_batch_accepts_regular_mutations __
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-01-31 15:26:48,508 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:26:48,511 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:26:48,511 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:26:48,508 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
15:26:30,202 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:26:28,680 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:26:28.680308
15:26:30,91 dtest_setup INFO cluster ccm directory: /tmp/dtest-s6e7cmym
------------------------------ Captured log call -------------------------------
15:26:30,860 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-s6e7cmym/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-s6e7cmym/test/node1/conf'}
15:26:30,861 ccm INFO node1: using Java 8 for the current invocation
15:26:31,12 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-s6e7cmym/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-s6e7cmym/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:26:31,13 ccm INFO node1: using Java 8 for the current invocation
15:26:31,94 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
15:26:49,237 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:26:48,508 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
____________ TestBatch.test_logged_batch_accepts_regular_mutations _____________

self = <batch_test.TestBatch object at 0x7fe93cc52518>

    def test_logged_batch_accepts_regular_mutations(self):
        """ Test that logged batch accepts regular mutations """
>       session = self.prepare()

batch_test.py:61: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
batch_test.py:449: in prepare
    self.create_schema(session, nodes)
batch_test.py:463: in create_schema
    """)
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
15:26:30,202 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:26:28,680 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:26:28.680308
15:26:30,91 dtest_setup INFO cluster ccm directory: /tmp/dtest-s6e7cmym
------------------------------ Captured log call -------------------------------
15:26:30,860 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-s6e7cmym/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-s6e7cmym/test/node1/conf'}
15:26:30,861 ccm INFO node1: using Java 8 for the current invocation
15:26:31,12 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-s6e7cmym/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-s6e7cmym/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:26:31,13 ccm INFO node1: using Java 8 for the current invocation
15:26:31,94 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/batch_test.py:61>, <TracebackEntry /root/cassandra-dtest/batch_test.py:449>, <TracebackEntry /root/cassandra-dtest/batch_test.py:463>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 21.53 seconds ======================
[msx] rc = 1
v2v2 running time = 43112523487
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 19.03 seconds ===========================
[msx] rc = 0
v1v2 running time = 40666397951
---> v1v2 test suceeded.
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 15.71 seconds ===========================
[msx] rc = 0
v1v1 running time = 37313152104
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations 
-------------------------------- live log call ---------------------------------
15:28:49,311 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
15:28:49,419 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:28:48,715 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations ERROR [100%]

==================================== ERRORS ====================================
__ ERROR at teardown of TestBatch.test_logged_batch_accepts_regular_mutations __
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-01-31 15:28:48,715 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:28:48,717 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:28:48,718 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:28:48,715 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
15:28:30,861 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:28:29,707 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:28:29.707088
15:28:30,764 dtest_setup INFO cluster ccm directory: /tmp/dtest-nfv_lbxs
----------------------------- Captured stdout call -----------------------------
15:28:30,864 ccm DEBUG using balanced tokens for non-vnode cluster
15:28:31,479 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nfv_lbxs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nfv_lbxs/test/node1/conf'}
15:28:31,480 ccm INFO node1: using Java 8 for the current invocation
15:28:31,646 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nfv_lbxs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nfv_lbxs/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:28:31,647 ccm INFO node1: using Java 8 for the current invocation
15:28:31,725 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
15:28:31,479 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nfv_lbxs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nfv_lbxs/test/node1/conf'}
15:28:31,480 ccm INFO node1: using Java 8 for the current invocation
15:28:31,646 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nfv_lbxs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nfv_lbxs/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:28:31,647 ccm INFO node1: using Java 8 for the current invocation
15:28:31,725 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
15:28:49,419 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:28:48,715 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
____________ TestBatch.test_logged_batch_accepts_regular_mutations _____________

self = <batch_test.TestBatch object at 0x7f3faf2da550>

    def test_logged_batch_accepts_regular_mutations(self):
        """ Test that logged batch accepts regular mutations """
>       session = self.prepare()

batch_test.py:61: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
batch_test.py:449: in prepare
    self.create_schema(session, nodes)
batch_test.py:472: in create_schema
    """)
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
15:28:30,861 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:28:29,707 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:28:29.707088
15:28:30,764 dtest_setup INFO cluster ccm directory: /tmp/dtest-nfv_lbxs
----------------------------- Captured stdout call -----------------------------
15:28:30,864 ccm DEBUG using balanced tokens for non-vnode cluster
15:28:31,479 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nfv_lbxs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nfv_lbxs/test/node1/conf'}
15:28:31,480 ccm INFO node1: using Java 8 for the current invocation
15:28:31,646 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nfv_lbxs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nfv_lbxs/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:28:31,647 ccm INFO node1: using Java 8 for the current invocation
15:28:31,725 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
15:28:31,479 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nfv_lbxs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nfv_lbxs/test/node1/conf'}
15:28:31,480 ccm INFO node1: using Java 8 for the current invocation
15:28:31,646 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nfv_lbxs/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nfv_lbxs/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:28:31,647 ccm INFO node1: using Java 8 for the current invocation
15:28:31,725 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/batch_test.py:61>, <TracebackEntry /root/cassandra-dtest/batch_test.py:449>, <TracebackEntry /root/cassandra-dtest/batch_test.py:472>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 20.67 seconds ======================
[msx] rc = 1
v2v2 running time = 42174201704
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations FAILED [100%]
------------------------------ live log teardown -------------------------------
15:30:01,302 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:29:31,072 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations ERROR [100%]

==================================== ERRORS ====================================
__ ERROR at teardown of TestBatch.test_logged_batch_accepts_regular_mutations __
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-01-31 15:29:31,072 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:29:31,076 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:29:31,077 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:29:31,072 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
15:29:13,98 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:29:11,941 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:29:11.941425
15:29:13,0 dtest_setup INFO cluster ccm directory: /tmp/dtest-d01jsp_z
----------------------------- Captured stdout call -----------------------------
15:29:13,100 ccm DEBUG using balanced tokens for non-vnode cluster
15:29:13,799 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d01jsp_z/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d01jsp_z/test/node1/conf'}
15:29:13,800 ccm INFO node1: using Java 8 for the current invocation
15:29:13,978 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d01jsp_z/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d01jsp_z/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:29:13,979 ccm INFO node1: using Java 8 for the current invocation
15:29:14,62 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:29:31,072 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:29:31,076 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:29:31,077 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
15:29:13,799 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d01jsp_z/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d01jsp_z/test/node1/conf'}
15:29:13,800 ccm INFO node1: using Java 8 for the current invocation
15:29:13,978 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d01jsp_z/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d01jsp_z/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:29:13,979 ccm INFO node1: using Java 8 for the current invocation
15:29:14,62 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
15:30:01,302 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:29:31,072 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
____________ TestBatch.test_logged_batch_accepts_regular_mutations _____________

self = <batch_test.TestBatch object at 0x7fb21cef8860>

    def test_logged_batch_accepts_regular_mutations(self):
        """ Test that logged batch accepts regular mutations """
>       session = self.prepare()

batch_test.py:61: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
batch_test.py:448: in prepare
    session = self.patient_cql_connection(node1, protocol_version=protocol_version)
dtest_setup.py:250: in patient_cql_connection
    **kwargs
dtest_setup.py:39: in retry_till_success
    return fun(*args, **kwargs)
dtest_setup.py:177: in cql_connection
    protocol_version, port=port, ssl_opts=ssl_opts, **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.1:9042': ConnectionRefusedError(111, "Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused")})

cassandra/cluster.py:3533: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
15:29:13,98 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:29:11,941 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:29:11.941425
15:29:13,0 dtest_setup INFO cluster ccm directory: /tmp/dtest-d01jsp_z
----------------------------- Captured stdout call -----------------------------
15:29:13,100 ccm DEBUG using balanced tokens for non-vnode cluster
15:29:13,799 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d01jsp_z/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d01jsp_z/test/node1/conf'}
15:29:13,800 ccm INFO node1: using Java 8 for the current invocation
15:29:13,978 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d01jsp_z/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d01jsp_z/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:29:13,979 ccm INFO node1: using Java 8 for the current invocation
15:29:14,62 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:29:31,072 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:29:31,076 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:29:31,077 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
15:29:13,799 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d01jsp_z/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d01jsp_z/test/node1/conf'}
15:29:13,800 ccm INFO node1: using Java 8 for the current invocation
15:29:13,978 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-d01jsp_z/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-d01jsp_z/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:29:13,979 ccm INFO node1: using Java 8 for the current invocation
15:29:14,62 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.1:9042': ConnectionRefusedError(111, "Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused")})
	[<TracebackEntry /root/cassandra-dtest/batch_test.py:61>, <TracebackEntry /root/cassandra-dtest/batch_test.py:448>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:250>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:39>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:177>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 50.32 seconds ======================
[msx] rc = 1
v1v2 running time = 71865609247
---> v1v2 test failed.
proj: cassandra
u_test: batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 19.55 seconds ===========================
[msx] rc = 0
v1v1 running time = 41101583052
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations 
-------------------------------- live log call ---------------------------------
15:31:24,627 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
FAILED                                                                   [100%]
------------------------------ live log teardown -------------------------------
15:31:24,732 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:31:24,050 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations ERROR [100%]

==================================== ERRORS ====================================
__ ERROR at teardown of TestBatch.test_logged_batch_accepts_regular_mutations __
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-01-31 15:31:24,050 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:31:24,053 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:31:24,054 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:31:24,050 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
15:31:06,328 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:31:04,857 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:31:04.857524
15:31:06,219 dtest_setup INFO cluster ccm directory: /tmp/dtest-v3vghz3o
------------------------------ Captured log call -------------------------------
15:31:06,958 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v3vghz3o/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v3vghz3o/test/node1/conf'}
15:31:06,959 ccm INFO node1: using Java 8 for the current invocation
15:31:07,108 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v3vghz3o/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v3vghz3o/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:31:07,109 ccm INFO node1: using Java 8 for the current invocation
15:31:07,201 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
15:31:24,627 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
---------------------------- Captured log teardown -----------------------------
15:31:24,732 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:31:24,050 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
____________ TestBatch.test_logged_batch_accepts_regular_mutations _____________

self = <batch_test.TestBatch object at 0x7f6f47ca8588>

    def test_logged_batch_accepts_regular_mutations(self):
        """ Test that logged batch accepts regular mutations """
>       session = self.prepare()

batch_test.py:61: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
batch_test.py:449: in prepare
    self.create_schema(session, nodes)
batch_test.py:463: in create_schema
    """)
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
15:31:06,328 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:31:04,857 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:31:04.857524
15:31:06,219 dtest_setup INFO cluster ccm directory: /tmp/dtest-v3vghz3o
------------------------------ Captured log call -------------------------------
15:31:06,958 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v3vghz3o/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v3vghz3o/test/node1/conf'}
15:31:06,959 ccm INFO node1: using Java 8 for the current invocation
15:31:07,108 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v3vghz3o/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v3vghz3o/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:31:07,109 ccm INFO node1: using Java 8 for the current invocation
15:31:07,201 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
15:31:24,627 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/batch_test.py:61>, <TracebackEntry /root/cassandra-dtest/batch_test.py:449>, <TracebackEntry /root/cassandra-dtest/batch_test.py:463>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 20.82 seconds ======================
[msx] rc = 1
v2v2 running time = 42349611016
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations 
-------------------------------- live log call ---------------------------------
15:32:06,319 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
15:32:06,426 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:32:05,626 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations ERROR [100%]

==================================== ERRORS ====================================
__ ERROR at teardown of TestBatch.test_logged_batch_accepts_regular_mutations __
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-01-31 15:32:05,626 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:32:05,629 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:32:05,629 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:32:05,626 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
15:31:48,899 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:31:47,226 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:31:47.226102
15:31:48,787 dtest_setup INFO cluster ccm directory: /tmp/dtest-vkhgcdm5
----------------------------- Captured stdout call -----------------------------
15:31:48,901 ccm DEBUG using balanced tokens for non-vnode cluster
15:31:49,544 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vkhgcdm5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vkhgcdm5/test/node1/conf'}
15:31:49,545 ccm INFO node1: using Java 8 for the current invocation
15:31:49,723 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vkhgcdm5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vkhgcdm5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:31:49,724 ccm INFO node1: using Java 8 for the current invocation
15:31:49,812 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:32:05,626 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:32:05,629 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:32:05,629 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
------------------------------ Captured log call -------------------------------
15:31:49,544 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vkhgcdm5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vkhgcdm5/test/node1/conf'}
15:31:49,545 ccm INFO node1: using Java 8 for the current invocation
15:31:49,723 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vkhgcdm5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vkhgcdm5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:31:49,724 ccm INFO node1: using Java 8 for the current invocation
15:31:49,812 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
15:32:06,426 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:32:05,626 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
____________ TestBatch.test_logged_batch_accepts_regular_mutations _____________

self = <batch_test.TestBatch object at 0x7f1c142b5518>

    def test_logged_batch_accepts_regular_mutations(self):
        """ Test that logged batch accepts regular mutations """
>       session = self.prepare()

batch_test.py:61: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
batch_test.py:449: in prepare
    self.create_schema(session, nodes)
batch_test.py:463: in create_schema
    """)
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
15:31:48,899 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:31:47,226 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:31:47.226102
15:31:48,787 dtest_setup INFO cluster ccm directory: /tmp/dtest-vkhgcdm5
----------------------------- Captured stdout call -----------------------------
15:31:48,901 ccm DEBUG using balanced tokens for non-vnode cluster
15:31:49,544 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vkhgcdm5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vkhgcdm5/test/node1/conf'}
15:31:49,545 ccm INFO node1: using Java 8 for the current invocation
15:31:49,723 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vkhgcdm5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vkhgcdm5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:31:49,724 ccm INFO node1: using Java 8 for the current invocation
15:31:49,812 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:32:05,626 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:32:05,629 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:32:05,629 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
------------------------------ Captured log call -------------------------------
15:31:49,544 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vkhgcdm5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vkhgcdm5/test/node1/conf'}
15:31:49,545 ccm INFO node1: using Java 8 for the current invocation
15:31:49,723 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vkhgcdm5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vkhgcdm5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:31:49,724 ccm INFO node1: using Java 8 for the current invocation
15:31:49,812 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/batch_test.py:61>, <TracebackEntry /root/cassandra-dtest/batch_test.py:449>, <TracebackEntry /root/cassandra-dtest/batch_test.py:463>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 20.20 seconds ======================
[msx] rc = 1
v1v2 running time = 41743627746
---> v1v2 test failed.
proj: cassandra
u_test: batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 18.24 seconds ===========================
[msx] rc = 0
v1v1 running time = 39758208576
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 18.58 seconds ===========================
[msx] rc = 0
v2v2 running time = 40059851099
---> v1v1 and v2v2 test test suceeded.
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 19.18 seconds ===========================
[msx] rc = 0
v1v2 running time = 40704989701
---> v1v2 test suceeded.
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 14.40 seconds ===========================
[msx] rc = 0
v1v1 running time = 35927483304
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 17.69 seconds ===========================
[msx] rc = 0
v2v2 running time = 39196765599
---> v1v1 and v2v2 test test suceeded.
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations 
-------------------------------- live log call ---------------------------------
15:36:03,369 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
15:36:03,478 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:36:02,714 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations ERROR [100%]

==================================== ERRORS ====================================
__ ERROR at teardown of TestBatch.test_logged_batch_accepts_regular_mutations __
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-01-31 15:36:02,714 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:36:02,717 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:36:02,718 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:36:02,714 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
15:35:45,901 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:35:44,603 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:35:44.603815
15:35:45,813 dtest_setup INFO cluster ccm directory: /tmp/dtest-86ymhiks
----------------------------- Captured stdout call -----------------------------
15:35:45,903 ccm DEBUG using balanced tokens for non-vnode cluster
15:35:46,542 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-86ymhiks/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-86ymhiks/test/node1/conf'}
15:35:46,543 ccm INFO node1: using Java 8 for the current invocation
15:35:46,726 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-86ymhiks/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-86ymhiks/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:35:46,726 ccm INFO node1: using Java 8 for the current invocation
15:35:46,805 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:36:02,714 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:36:02,717 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:36:02,718 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
15:35:46,542 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-86ymhiks/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-86ymhiks/test/node1/conf'}
15:35:46,543 ccm INFO node1: using Java 8 for the current invocation
15:35:46,726 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-86ymhiks/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-86ymhiks/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:35:46,726 ccm INFO node1: using Java 8 for the current invocation
15:35:46,805 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
15:36:03,478 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:36:02,714 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
____________ TestBatch.test_logged_batch_accepts_regular_mutations _____________

self = <batch_test.TestBatch object at 0x7fd02a44b080>

    def test_logged_batch_accepts_regular_mutations(self):
        """ Test that logged batch accepts regular mutations """
        session = self.prepare()
        session.execute("""
                BEGIN BATCH
                INSERT INTO users (id, firstname, lastname) VALUES (0, 'Jack', 'Sparrow')
                INSERT INTO users (id, firstname, lastname) VALUES (1, 'Will', 'Turner')
                APPLY BATCH
>           """)

batch_test.py:67: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
15:35:45,901 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:35:44,603 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:35:44.603815
15:35:45,813 dtest_setup INFO cluster ccm directory: /tmp/dtest-86ymhiks
----------------------------- Captured stdout call -----------------------------
15:35:45,903 ccm DEBUG using balanced tokens for non-vnode cluster
15:35:46,542 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-86ymhiks/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-86ymhiks/test/node1/conf'}
15:35:46,543 ccm INFO node1: using Java 8 for the current invocation
15:35:46,726 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-86ymhiks/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-86ymhiks/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:35:46,726 ccm INFO node1: using Java 8 for the current invocation
15:35:46,805 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:36:02,714 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:36:02,717 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-01-31 15:36:02,718 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
15:35:46,542 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-86ymhiks/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-86ymhiks/test/node1/conf'}
15:35:46,543 ccm INFO node1: using Java 8 for the current invocation
15:35:46,726 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-86ymhiks/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-86ymhiks/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:35:46,726 ccm INFO node1: using Java 8 for the current invocation
15:35:46,805 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/batch_test.py:67>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 19.83 seconds ======================
[msx] rc = 1
v1v2 running time = 41369379919
---> v1v2 test failed.
proj: cassandra
u_test: batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 20.63 seconds ===========================
[msx] rc = 0
v1v1 running time = 42144013414
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 16.89 seconds ===========================
[msx] rc = 0
v2v2 running time = 38413847300
---> v1v1 and v2v2 test test suceeded.
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations 
-------------------------------- live log call ---------------------------------
15:38:05,275 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
15:38:05,382 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:38:04,559 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations ERROR [100%]

==================================== ERRORS ====================================
__ ERROR at teardown of TestBatch.test_logged_batch_accepts_regular_mutations __
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-01-31 15:38:04,559 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:38:04,563 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:38:04,564 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:38:04,559 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
15:37:47,664 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:37:46,695 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:37:46.695115
15:37:47,555 dtest_setup INFO cluster ccm directory: /tmp/dtest-ojvdxrpv
------------------------------ Captured log call -------------------------------
15:37:48,286 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ojvdxrpv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ojvdxrpv/test/node1/conf'}
15:37:48,287 ccm INFO node1: using Java 8 for the current invocation
15:37:48,479 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ojvdxrpv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ojvdxrpv/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:37:48,480 ccm INFO node1: using Java 8 for the current invocation
15:37:48,564 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
15:38:05,382 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:38:04,559 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
____________ TestBatch.test_logged_batch_accepts_regular_mutations _____________

self = <batch_test.TestBatch object at 0x7fa055d8d0f0>

    def test_logged_batch_accepts_regular_mutations(self):
        """ Test that logged batch accepts regular mutations """
>       session = self.prepare()

batch_test.py:61: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
batch_test.py:449: in prepare
    self.create_schema(session, nodes)
batch_test.py:472: in create_schema
    """)
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
15:37:47,664 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:37:46,695 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:37:46.695115
15:37:47,555 dtest_setup INFO cluster ccm directory: /tmp/dtest-ojvdxrpv
------------------------------ Captured log call -------------------------------
15:37:48,286 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ojvdxrpv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ojvdxrpv/test/node1/conf'}
15:37:48,287 ccm INFO node1: using Java 8 for the current invocation
15:37:48,479 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ojvdxrpv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ojvdxrpv/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:37:48,480 ccm INFO node1: using Java 8 for the current invocation
15:37:48,564 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/batch_test.py:61>, <TracebackEntry /root/cassandra-dtest/batch_test.py:449>, <TracebackEntry /root/cassandra-dtest/batch_test.py:472>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 19.80 seconds ======================
[msx] rc = 1
v1v2 running time = 41334461446
---> v1v2 test failed.
proj: cassandra
u_test: batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 21.49 seconds ===========================
[msx] rc = 0
v1v1 running time = 42966528707
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations 
-------------------------------- live log call ---------------------------------
15:39:30,945 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
15:39:31,53 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:39:30,235 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations ERROR [100%]

==================================== ERRORS ====================================
__ ERROR at teardown of TestBatch.test_logged_batch_accepts_regular_mutations __
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-01-31 15:39:30,235 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:39:30,238 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:39:30,239 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:39:30,235 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
15:39:12,545 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:39:11,131 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:39:11.131068
15:39:12,441 dtest_setup INFO cluster ccm directory: /tmp/dtest-602c25lq
------------------------------ Captured log call -------------------------------
15:39:13,211 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-602c25lq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-602c25lq/test/node1/conf'}
15:39:13,211 ccm INFO node1: using Java 8 for the current invocation
15:39:13,393 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-602c25lq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-602c25lq/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:39:13,394 ccm INFO node1: using Java 8 for the current invocation
15:39:13,479 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
15:39:31,53 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:39:30,235 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
____________ TestBatch.test_logged_batch_accepts_regular_mutations _____________

self = <batch_test.TestBatch object at 0x7f37ec0944e0>

    def test_logged_batch_accepts_regular_mutations(self):
        """ Test that logged batch accepts regular mutations """
        session = self.prepare()
        session.execute("""
                BEGIN BATCH
                INSERT INTO users (id, firstname, lastname) VALUES (0, 'Jack', 'Sparrow')
                INSERT INTO users (id, firstname, lastname) VALUES (1, 'Will', 'Turner')
                APPLY BATCH
>           """)

batch_test.py:67: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
15:39:12,545 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:39:11,131 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:39:11.131068
15:39:12,441 dtest_setup INFO cluster ccm directory: /tmp/dtest-602c25lq
------------------------------ Captured log call -------------------------------
15:39:13,211 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-602c25lq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-602c25lq/test/node1/conf'}
15:39:13,211 ccm INFO node1: using Java 8 for the current invocation
15:39:13,393 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-602c25lq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-602c25lq/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:39:13,394 ccm INFO node1: using Java 8 for the current invocation
15:39:13,479 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/batch_test.py:67>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 20.91 seconds ======================
[msx] rc = 1
v2v2 running time = 42681506942
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations 
-------------------------------- live log call ---------------------------------
15:40:11,840 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
15:40:11,947 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:40:11,168 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations ERROR [100%]

==================================== ERRORS ====================================
__ ERROR at teardown of TestBatch.test_logged_batch_accepts_regular_mutations __
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-01-31 15:40:11,168 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:40:11,172 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:40:11,172 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:40:11,168 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
15:39:54,253 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:39:53,449 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:39:53.449517
15:39:54,158 dtest_setup INFO cluster ccm directory: /tmp/dtest-op43pgx5
------------------------------ Captured log call -------------------------------
15:39:55,9 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-op43pgx5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-op43pgx5/test/node1/conf'}
15:39:55,10 ccm INFO node1: using Java 8 for the current invocation
15:39:55,201 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-op43pgx5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-op43pgx5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:39:55,201 ccm INFO node1: using Java 8 for the current invocation
15:39:55,279 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
15:40:11,947 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:40:11,168 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
____________ TestBatch.test_logged_batch_accepts_regular_mutations _____________

self = <batch_test.TestBatch object at 0x7f9480592630>

    def test_logged_batch_accepts_regular_mutations(self):
        """ Test that logged batch accepts regular mutations """
>       session = self.prepare()

batch_test.py:61: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
batch_test.py:449: in prepare
    self.create_schema(session, nodes)
batch_test.py:472: in create_schema
    """)
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
15:39:54,253 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:39:53,449 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:39:53.449517
15:39:54,158 dtest_setup INFO cluster ccm directory: /tmp/dtest-op43pgx5
------------------------------ Captured log call -------------------------------
15:39:55,9 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-op43pgx5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-op43pgx5/test/node1/conf'}
15:39:55,10 ccm INFO node1: using Java 8 for the current invocation
15:39:55,201 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-op43pgx5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-op43pgx5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:39:55,201 ccm INFO node1: using Java 8 for the current invocation
15:39:55,279 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/batch_test.py:61>, <TracebackEntry /root/cassandra-dtest/batch_test.py:449>, <TracebackEntry /root/cassandra-dtest/batch_test.py:472>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 19.43 seconds ======================
[msx] rc = 1
v1v2 running time = 40856660299
---> v1v2 test failed.
proj: cassandra
u_test: batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 19.46 seconds ===========================
[msx] rc = 0
v1v1 running time = 41092804888
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations 
-------------------------------- live log call ---------------------------------
15:41:34,984 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
15:41:35,91 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:41:34,333 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations ERROR [100%]

==================================== ERRORS ====================================
__ ERROR at teardown of TestBatch.test_logged_batch_accepts_regular_mutations __
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-01-31 15:41:34,333 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:41:34,336 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:41:34,336 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:41:34,333 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
15:41:16,904 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:41:15,501 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:41:15.501337
15:41:16,810 dtest_setup INFO cluster ccm directory: /tmp/dtest-c8c8hko5
------------------------------ Captured log call -------------------------------
15:41:17,520 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-c8c8hko5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-c8c8hko5/test/node1/conf'}
15:41:17,520 ccm INFO node1: using Java 8 for the current invocation
15:41:17,685 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-c8c8hko5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-c8c8hko5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:41:17,686 ccm INFO node1: using Java 8 for the current invocation
15:41:17,778 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
15:41:35,91 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:41:34,333 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
____________ TestBatch.test_logged_batch_accepts_regular_mutations _____________

self = <batch_test.TestBatch object at 0x7fc3c90af588>

    def test_logged_batch_accepts_regular_mutations(self):
        """ Test that logged batch accepts regular mutations """
>       session = self.prepare()

batch_test.py:61: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
batch_test.py:449: in prepare
    self.create_schema(session, nodes)
batch_test.py:472: in create_schema
    """)
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
15:41:16,904 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:41:15,501 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:41:15.501337
15:41:16,810 dtest_setup INFO cluster ccm directory: /tmp/dtest-c8c8hko5
------------------------------ Captured log call -------------------------------
15:41:17,520 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-c8c8hko5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-c8c8hko5/test/node1/conf'}
15:41:17,520 ccm INFO node1: using Java 8 for the current invocation
15:41:17,685 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-c8c8hko5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-c8c8hko5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:41:17,686 ccm INFO node1: using Java 8 for the current invocation
15:41:17,778 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/batch_test.py:61>, <TracebackEntry /root/cassandra-dtest/batch_test.py:449>, <TracebackEntry /root/cassandra-dtest/batch_test.py:472>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 20.53 seconds ======================
[msx] rc = 1
v2v2 running time = 42062045382
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations 
-------------------------------- live log call ---------------------------------
15:42:17,232 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
15:42:17,316 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:42:16,670 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations ERROR [100%]

==================================== ERRORS ====================================
__ ERROR at teardown of TestBatch.test_logged_batch_accepts_regular_mutations __
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-01-31 15:42:16,670 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:42:16,673 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:42:16,674 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:42:16,670 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
15:41:58,512 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:41:57,457 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:41:57.457246
15:41:58,415 dtest_setup INFO cluster ccm directory: /tmp/dtest-5u24y3dw
----------------------------- Captured stdout call -----------------------------
15:41:58,514 ccm DEBUG using balanced tokens for non-vnode cluster
15:41:59,152 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5u24y3dw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5u24y3dw/test/node1/conf'}
15:41:59,153 ccm INFO node1: using Java 8 for the current invocation
15:41:59,315 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5u24y3dw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5u24y3dw/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:41:59,316 ccm INFO node1: using Java 8 for the current invocation
15:41:59,404 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra

1
------------------------------ Captured log call -------------------------------
15:41:59,152 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5u24y3dw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5u24y3dw/test/node1/conf'}
15:41:59,153 ccm INFO node1: using Java 8 for the current invocation
15:41:59,315 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5u24y3dw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5u24y3dw/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:41:59,316 ccm INFO node1: using Java 8 for the current invocation
15:41:59,404 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
15:42:17,316 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:42:16,670 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
____________ TestBatch.test_logged_batch_accepts_regular_mutations _____________

self = <batch_test.TestBatch object at 0x7f56a5c24518>

    def test_logged_batch_accepts_regular_mutations(self):
        """ Test that logged batch accepts regular mutations """
>       session = self.prepare()

batch_test.py:61: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
batch_test.py:449: in prepare
    self.create_schema(session, nodes)
batch_test.py:463: in create_schema
    """)
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
15:41:58,512 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:41:57,457 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:41:57.457246
15:41:58,415 dtest_setup INFO cluster ccm directory: /tmp/dtest-5u24y3dw
----------------------------- Captured stdout call -----------------------------
15:41:58,514 ccm DEBUG using balanced tokens for non-vnode cluster
15:41:59,152 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5u24y3dw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5u24y3dw/test/node1/conf'}
15:41:59,153 ccm INFO node1: using Java 8 for the current invocation
15:41:59,315 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5u24y3dw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5u24y3dw/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:41:59,316 ccm INFO node1: using Java 8 for the current invocation
15:41:59,404 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra

1
------------------------------ Captured log call -------------------------------
15:41:59,152 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5u24y3dw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5u24y3dw/test/node1/conf'}
15:41:59,153 ccm INFO node1: using Java 8 for the current invocation
15:41:59,315 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5u24y3dw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5u24y3dw/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:41:59,316 ccm INFO node1: using Java 8 for the current invocation
15:41:59,404 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/batch_test.py:61>, <TracebackEntry /root/cassandra-dtest/batch_test.py:449>, <TracebackEntry /root/cassandra-dtest/batch_test.py:463>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 20.77 seconds ======================
[msx] rc = 1
v1v2 running time = 42228031706
---> v1v2 test failed.
proj: cassandra
u_test: batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 15.64 seconds ===========================
[msx] rc = 0
v1v1 running time = 37157179821
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 15.87 seconds ===========================
[msx] rc = 0
v2v2 running time = 37356754764
---> v1v1 and v2v2 test test suceeded.
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 14.65 seconds ===========================
[msx] rc = 0
v1v2 running time = 36157227150
---> v1v2 test suceeded.
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations PASSED [100%]
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 18.82 seconds ===========================
[msx] rc = 0
v1v1 running time = 40416623442
cassandra batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations 
-------------------------------- live log call ---------------------------------
15:45:30,969 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
15:45:31,77 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:45:30,348 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations ERROR [100%]

==================================== ERRORS ====================================
__ ERROR at teardown of TestBatch.test_logged_batch_accepts_regular_mutations __
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-01-31 15:45:30,348 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:45:30,382 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:45:30,382 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-01-31 15:45:30,348 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
15:45:12,585 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:45:11,90 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:45:11.090576
15:45:12,490 dtest_setup INFO cluster ccm directory: /tmp/dtest-n9mpbply
----------------------------- Captured stdout call -----------------------------

15:45:12,588 ccm DEBUG using balanced tokens for non-vnode cluster
15:45:13,278 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n9mpbply/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n9mpbply/test/node1/conf'}
15:45:13,279 ccm INFO node1: using Java 8 for the current invocation
15:45:13,460 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n9mpbply/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n9mpbply/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:45:13,460 ccm INFO node1: using Java 8 for the current invocation
15:45:13,536 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra

15:45:12,588 ccm DEBUG using balanced tokens for non-vnode cluster
15:45:13,278 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n9mpbply/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n9mpbply/test/node1/conf'}
15:45:13,279 ccm INFO node1: using Java 8 for the current invocation
15:45:13,460 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n9mpbply/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n9mpbply/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:45:13,460 ccm INFO node1: using Java 8 for the current invocation
15:45:13,536 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
15:45:13,278 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n9mpbply/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n9mpbply/test/node1/conf'}
15:45:13,279 ccm INFO node1: using Java 8 for the current invocation
15:45:13,460 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n9mpbply/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n9mpbply/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:45:13,460 ccm INFO node1: using Java 8 for the current invocation
15:45:13,536 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
15:45:31,77 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-01-31 15:45:30,348 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
____________ TestBatch.test_logged_batch_accepts_regular_mutations _____________

self = <batch_test.TestBatch object at 0x7fa3195e50b8>

    def test_logged_batch_accepts_regular_mutations(self):
        """ Test that logged batch accepts regular mutations """
>       session = self.prepare()

batch_test.py:61: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
batch_test.py:449: in prepare
    self.create_schema(session, nodes)
batch_test.py:472: in create_schema
    """)
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
15:45:12,585 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
15:45:11,90 conftest INFO Starting execution of test_logged_batch_accepts_regular_mutations at 2022-01-31 15:45:11.090576
15:45:12,490 dtest_setup INFO cluster ccm directory: /tmp/dtest-n9mpbply
----------------------------- Captured stdout call -----------------------------

15:45:12,588 ccm DEBUG using balanced tokens for non-vnode cluster
15:45:13,278 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n9mpbply/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n9mpbply/test/node1/conf'}
15:45:13,279 ccm INFO node1: using Java 8 for the current invocation
15:45:13,460 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n9mpbply/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n9mpbply/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:45:13,460 ccm INFO node1: using Java 8 for the current invocation
15:45:13,536 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra

15:45:12,588 ccm DEBUG using balanced tokens for non-vnode cluster
15:45:13,278 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n9mpbply/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n9mpbply/test/node1/conf'}
15:45:13,279 ccm INFO node1: using Java 8 for the current invocation
15:45:13,460 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n9mpbply/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n9mpbply/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:45:13,460 ccm INFO node1: using Java 8 for the current invocation
15:45:13,536 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
15:45:13,278 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n9mpbply/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n9mpbply/test/node1/conf'}
15:45:13,279 ccm INFO node1: using Java 8 for the current invocation
15:45:13,460 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'b93eac84022c', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'batch_test.py::TestBatch::()::test_logged_batch_accepts_regular_mutations (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n9mpbply/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n9mpbply/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
15:45:13,460 ccm INFO node1: using Java 8 for the current invocation
15:45:13,536 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_logged_batch_accepts_regular_mutations failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/batch_test.py:61>, <TracebackEntry /root/cassandra-dtest/batch_test.py:449>, <TracebackEntry /root/cassandra-dtest/batch_test.py:472>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 20.92 seconds ======================
[msx] rc = 1
v2v2 running time = 42503858928
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: batch_test.py::TestBatch::test_logged_batch_accepts_regular_mutations
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

early stop after 7 is satisfied
v1v2 failed with probability 7 out of 11
v1v1v2v2 failed with probability 7 out of 11
Total execution time in seconds : 1393
0
