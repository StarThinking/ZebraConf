my_type=hypothesis
proj=cassandra
u_test=transient_replication_test.py::TestTransientReplication::test_transient_write
h_list[1]=range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write 
-------------------------------- live log call ---------------------------------
13:45:51,755 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:45:51,757 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
FAILED                                                                   [100%]

=================================== FAILURES ===================================
________________ TestTransientReplication.test_transient_write _________________

self = <transient_replication_test.TestTransientReplication object at 0x7f056b15d080>

    @pytest.mark.no_vnodes
    def test_transient_write(self):
        """ If write can't succeed on full replica, it's written to the transient node instead """
        for node in self.nodes:
            self.assert_has_no_sstables(node)
    
        tm = lambda n: self.table_metrics(n)
        with tm(self.node1) as tm1, tm(self.node2) as tm2, tm(self.node3) as tm3:
            self.insert_row(1, 1, 1)
            # Stop writes to the other full node
            self.node2.byteman_submit([mk_bman_path('stop_writes.btm')])
            self.insert_row(1, 2, 2)
    
        # node1 should contain both rows
        self.assert_local_rows(self.node1,
                               [[1, 1, 1],
                                [1, 2, 2]])
    
        # write couldn't succeed on node2, so it has only the first row
        self.assert_local_rows(self.node2,
>                              [[1, 1, 1]])

transient_replication_test.py:330: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
transient_replication_test.py:249: in assert_local_rows
    assert_all(self.exclusive_cql_connection(node),
dtest_setup.py:188: in exclusive_cql_connection
    **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})

cassandra/cluster.py:3533: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
13:45:15,480 ccm DEBUG Log-watching thread starting.
13:45:17,146 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h2zvunf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h2zvunf/test/node1/conf'}
13:45:17,147 ccm INFO node1: using Java 8 for the current invocation
13:45:17,391 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h2zvunf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h2zvunf/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
13:45:17,392 ccm INFO node1: using Java 8 for the current invocation
13:45:17,505 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:45:17,849 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h2zvunf/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h2zvunf/test/node2/conf'}
13:45:17,850 ccm INFO node2: using Java 8 for the current invocation
13:45:18,74 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h2zvunf/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h2zvunf/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:45:18,75 ccm INFO node2: using Java 8 for the current invocation
13:45:18,186 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:45:18,511 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h2zvunf/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h2zvunf/test/node3/conf'}
13:45:18,512 ccm INFO node3: using Java 8 for the current invocation
13:45:18,716 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h2zvunf/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h2zvunf/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:45:18,717 ccm INFO node3: using Java 8 for the current invocation
13:45:18,816 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
install rule block digest

---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:45:15,255 conftest INFO Starting execution of test_transient_write at 2022-02-01 13:45:15.255689
13:45:15,384 dtest_setup INFO cluster ccm directory: /tmp/dtest-4h2zvunf
13:45:17,146 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h2zvunf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h2zvunf/test/node1/conf'}
13:45:17,147 ccm INFO node1: using Java 8 for the current invocation
13:45:17,391 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h2zvunf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h2zvunf/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
13:45:17,392 ccm INFO node1: using Java 8 for the current invocation
13:45:17,505 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:45:17,849 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h2zvunf/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h2zvunf/test/node2/conf'}
13:45:17,850 ccm INFO node2: using Java 8 for the current invocation
13:45:18,74 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h2zvunf/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h2zvunf/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:45:18,75 ccm INFO node2: using Java 8 for the current invocation
13:45:18,186 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:45:18,511 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h2zvunf/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h2zvunf/test/node3/conf'}
13:45:18,512 ccm INFO node3: using Java 8 for the current invocation
13:45:18,716 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4h2zvunf/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4h2zvunf/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:45:18,717 ccm INFO node3: using Java 8 for the current invocation
13:45:18,816 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:45:37,10 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
13:45:37,13 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:45:37,244 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:45:37,245 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:45:38,956 cassandra.cluster INFO Host 127.0.0.3:9042 may be up; will prepare queries and open connection pool
------------------------------ Captured log call -------------------------------
13:45:42,572 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:45:42,573 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:45:43,23 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:45:43,24 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:45:51,441 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:45:51,442 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:45:51,662 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:45:51,662 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
13:45:51,755 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:45:51,757 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
--------------------------- Captured stdout teardown ---------------------------
13:45:52,147 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_transient_write failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
	[<TracebackEntry /root/cassandra-dtest/transient_replication_test.py:330>, <TracebackEntry /root/cassandra-dtest/transient_replication_test.py:249>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:188>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
========================== 1 failed in 37.70 seconds ===========================
[msx] rc = 1
v1v2 running time = 59545728577
---> v1v2 test failed.
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write PASSED [100%]
===Flaky Test Report===

test_transient_write passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 40.48 seconds ===========================
[msx] rc = 0
v1v1 running time = 62222048011
cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write PASSED [100%]
===Flaky Test Report===

test_transient_write passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 39.38 seconds ===========================
[msx] rc = 0
v2v2 running time = 61227911202
---> v1v1 and v2v2 test test suceeded.
cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write 
-------------------------------- live log call ---------------------------------
13:48:54,433 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:48:54,435 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
FAILED                                                                   [100%]

=================================== FAILURES ===================================
________________ TestTransientReplication.test_transient_write _________________

self = <transient_replication_test.TestTransientReplication object at 0x7fc6dca0fef0>

    @pytest.mark.no_vnodes
    def test_transient_write(self):
        """ If write can't succeed on full replica, it's written to the transient node instead """
        for node in self.nodes:
            self.assert_has_no_sstables(node)
    
        tm = lambda n: self.table_metrics(n)
        with tm(self.node1) as tm1, tm(self.node2) as tm2, tm(self.node3) as tm3:
            self.insert_row(1, 1, 1)
            # Stop writes to the other full node
            self.node2.byteman_submit([mk_bman_path('stop_writes.btm')])
            self.insert_row(1, 2, 2)
    
        # node1 should contain both rows
        self.assert_local_rows(self.node1,
                               [[1, 1, 1],
                                [1, 2, 2]])
    
        # write couldn't succeed on node2, so it has only the first row
        self.assert_local_rows(self.node2,
>                              [[1, 1, 1]])

transient_replication_test.py:330: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
transient_replication_test.py:249: in assert_local_rows
    assert_all(self.exclusive_cql_connection(node),
dtest_setup.py:188: in exclusive_cql_connection
    **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})

cassandra/cluster.py:3533: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
13:48:18,407 ccm DEBUG Log-watching thread starting.
13:48:20,11 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q0o021jx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q0o021jx/test/node1/conf'}
13:48:20,12 ccm INFO node1: using Java 8 for the current invocation
13:48:20,232 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q0o021jx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q0o021jx/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
13:48:20,233 ccm INFO node1: using Java 8 for the current invocation
13:48:20,347 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:48:20,695 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q0o021jx/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q0o021jx/test/node2/conf'}
13:48:20,696 ccm INFO node2: using Java 8 for the current invocation
13:48:20,907 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q0o021jx/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q0o021jx/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:48:20,908 ccm INFO node2: using Java 8 for the current invocation
13:48:21,15 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:48:21,329 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q0o021jx/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q0o021jx/test/node3/conf'}
13:48:21,330 ccm INFO node3: using Java 8 for the current invocation
13:48:21,552 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q0o021jx/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q0o021jx/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:48:21,553 ccm INFO node3: using Java 8 for the current invocation
13:48:21,656 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
install rule block digest

---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:48:18,179 conftest INFO Starting execution of test_transient_write at 2022-02-01 13:48:18.179813
13:48:18,307 dtest_setup INFO cluster ccm directory: /tmp/dtest-q0o021jx
13:48:20,11 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q0o021jx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q0o021jx/test/node1/conf'}
13:48:20,12 ccm INFO node1: using Java 8 for the current invocation
13:48:20,232 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q0o021jx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q0o021jx/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
13:48:20,233 ccm INFO node1: using Java 8 for the current invocation
13:48:20,347 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:48:20,695 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q0o021jx/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q0o021jx/test/node2/conf'}
13:48:20,696 ccm INFO node2: using Java 8 for the current invocation
13:48:20,907 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q0o021jx/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q0o021jx/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:48:20,908 ccm INFO node2: using Java 8 for the current invocation
13:48:21,15 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:48:21,329 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q0o021jx/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q0o021jx/test/node3/conf'}
13:48:21,330 ccm INFO node3: using Java 8 for the current invocation
13:48:21,552 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q0o021jx/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q0o021jx/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:48:21,553 ccm INFO node3: using Java 8 for the current invocation
13:48:21,656 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:48:39,825 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
13:48:39,828 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:48:40,34 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:48:40,34 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
------------------------------ Captured log call -------------------------------
13:48:45,242 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:48:45,243 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:48:45,682 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:48:45,683 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:48:54,99 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:48:54,100 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:48:54,339 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:48:54,339 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
13:48:54,433 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:48:54,435 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
--------------------------- Captured stdout teardown ---------------------------
13:48:54,640 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_transient_write failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
	[<TracebackEntry /root/cassandra-dtest/transient_replication_test.py:330>, <TracebackEntry /root/cassandra-dtest/transient_replication_test.py:249>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:188>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
========================== 1 failed in 37.29 seconds ===========================
[msx] rc = 1
v1v2 running time = 59071120619
---> v1v2 test failed.
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write 
-------------------------------- live log call ---------------------------------
13:49:54,333 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:49:54,335 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
FAILED                                                                   [100%]

=================================== FAILURES ===================================
________________ TestTransientReplication.test_transient_write _________________

self = <transient_replication_test.TestTransientReplication object at 0x7fc9a59b2e48>

    @pytest.mark.no_vnodes
    def test_transient_write(self):
        """ If write can't succeed on full replica, it's written to the transient node instead """
        for node in self.nodes:
            self.assert_has_no_sstables(node)
    
        tm = lambda n: self.table_metrics(n)
        with tm(self.node1) as tm1, tm(self.node2) as tm2, tm(self.node3) as tm3:
            self.insert_row(1, 1, 1)
            # Stop writes to the other full node
            self.node2.byteman_submit([mk_bman_path('stop_writes.btm')])
            self.insert_row(1, 2, 2)
    
        # node1 should contain both rows
        self.assert_local_rows(self.node1,
                               [[1, 1, 1],
                                [1, 2, 2]])
    
        # write couldn't succeed on node2, so it has only the first row
        self.assert_local_rows(self.node2,
>                              [[1, 1, 1]])

transient_replication_test.py:330: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
transient_replication_test.py:249: in assert_local_rows
    assert_all(self.exclusive_cql_connection(node),
dtest_setup.py:188: in exclusive_cql_connection
    **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})

cassandra/cluster.py:3533: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
13:49:17,393 ccm DEBUG Log-watching thread starting.
13:49:18,944 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z5pgv1ev/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z5pgv1ev/test/node1/conf'}
13:49:18,946 ccm INFO node1: using Java 8 for the current invocation
13:49:19,166 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z5pgv1ev/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z5pgv1ev/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
13:49:19,167 ccm INFO node1: using Java 8 for the current invocation
13:49:19,288 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:49:19,627 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z5pgv1ev/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z5pgv1ev/test/node2/conf'}
13:49:19,628 ccm INFO node2: using Java 8 for the current invocation
13:49:19,838 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z5pgv1ev/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z5pgv1ev/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:49:19,838 ccm INFO node2: using Java 8 for the current invocation
13:49:19,953 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:49:20,293 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z5pgv1ev/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z5pgv1ev/test/node3/conf'}
13:49:20,294 ccm INFO node3: using Java 8 for the current invocation
13:49:20,518 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z5pgv1ev/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z5pgv1ev/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:49:20,519 ccm INFO node3: using Java 8 for the current invocation
13:49:20,626 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
install rule block digest

---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:49:17,217 conftest INFO Starting execution of test_transient_write at 2022-02-01 13:49:17.217078
13:49:17,294 dtest_setup INFO cluster ccm directory: /tmp/dtest-z5pgv1ev
13:49:18,944 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z5pgv1ev/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z5pgv1ev/test/node1/conf'}
13:49:18,946 ccm INFO node1: using Java 8 for the current invocation
13:49:19,166 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z5pgv1ev/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z5pgv1ev/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
13:49:19,167 ccm INFO node1: using Java 8 for the current invocation
13:49:19,288 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:49:19,627 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z5pgv1ev/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z5pgv1ev/test/node2/conf'}
13:49:19,628 ccm INFO node2: using Java 8 for the current invocation
13:49:19,838 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z5pgv1ev/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z5pgv1ev/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:49:19,838 ccm INFO node2: using Java 8 for the current invocation
13:49:19,953 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:49:20,293 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z5pgv1ev/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z5pgv1ev/test/node3/conf'}
13:49:20,294 ccm INFO node3: using Java 8 for the current invocation
13:49:20,518 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z5pgv1ev/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z5pgv1ev/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:49:20,519 ccm INFO node3: using Java 8 for the current invocation
13:49:20,626 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:49:39,815 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
13:49:39,818 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:49:40,66 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:49:40,66 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
------------------------------ Captured log call -------------------------------
13:49:45,117 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:49:45,118 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:49:45,578 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:49:45,579 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:49:53,985 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:49:53,986 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:49:54,228 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:49:54,229 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
13:49:54,333 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:49:54,335 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
--------------------------- Captured stdout teardown ---------------------------
13:49:54,587 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_transient_write failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
	[<TracebackEntry /root/cassandra-dtest/transient_replication_test.py:330>, <TracebackEntry /root/cassandra-dtest/transient_replication_test.py:249>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:188>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
========================== 1 failed in 38.18 seconds ===========================
[msx] rc = 1
v1v1 running time = 59873180338
cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write PASSED [100%]
===Flaky Test Report===

test_transient_write passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 38.97 seconds ===========================
[msx] rc = 0
v2v2 running time = 60686631400
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write 
-------------------------------- live log call ---------------------------------
13:51:54,809 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:51:54,811 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
FAILED                                                                   [100%]

=================================== FAILURES ===================================
________________ TestTransientReplication.test_transient_write _________________

self = <transient_replication_test.TestTransientReplication object at 0x7f308ae49c18>

    @pytest.mark.no_vnodes
    def test_transient_write(self):
        """ If write can't succeed on full replica, it's written to the transient node instead """
        for node in self.nodes:
            self.assert_has_no_sstables(node)
    
        tm = lambda n: self.table_metrics(n)
        with tm(self.node1) as tm1, tm(self.node2) as tm2, tm(self.node3) as tm3:
            self.insert_row(1, 1, 1)
            # Stop writes to the other full node
            self.node2.byteman_submit([mk_bman_path('stop_writes.btm')])
            self.insert_row(1, 2, 2)
    
        # node1 should contain both rows
        self.assert_local_rows(self.node1,
                               [[1, 1, 1],
                                [1, 2, 2]])
    
        # write couldn't succeed on node2, so it has only the first row
        self.assert_local_rows(self.node2,
>                              [[1, 1, 1]])

transient_replication_test.py:330: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
transient_replication_test.py:249: in assert_local_rows
    assert_all(self.exclusive_cql_connection(node),
dtest_setup.py:188: in exclusive_cql_connection
    **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})

cassandra/cluster.py:3533: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
13:51:17,985 ccm DEBUG Log-watching thread starting.
13:51:19,550 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-syea7s5y/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-syea7s5y/test/node1/conf'}
13:51:19,551 ccm INFO node1: using Java 8 for the current invocation
13:51:19,760 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-syea7s5y/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-syea7s5y/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
13:51:19,761 ccm INFO node1: using Java 8 for the current invocation
13:51:19,868 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:51:20,207 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-syea7s5y/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-syea7s5y/test/node2/conf'}
13:51:20,208 ccm INFO node2: using Java 8 for the current invocation
13:51:20,417 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-syea7s5y/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-syea7s5y/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:51:20,418 ccm INFO node2: using Java 8 for the current invocation
13:51:20,530 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:51:20,872 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-syea7s5y/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-syea7s5y/test/node3/conf'}
13:51:20,874 ccm INFO node3: using Java 8 for the current invocation
13:51:21,83 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-syea7s5y/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-syea7s5y/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:51:21,84 ccm INFO node3: using Java 8 for the current invocation
13:51:21,209 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
install rule block digest

---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:51:17,777 conftest INFO Starting execution of test_transient_write at 2022-02-01 13:51:17.777000
13:51:17,888 dtest_setup INFO cluster ccm directory: /tmp/dtest-syea7s5y
13:51:19,550 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-syea7s5y/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-syea7s5y/test/node1/conf'}
13:51:19,551 ccm INFO node1: using Java 8 for the current invocation
13:51:19,760 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-syea7s5y/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-syea7s5y/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
13:51:19,761 ccm INFO node1: using Java 8 for the current invocation
13:51:19,868 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:51:20,207 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-syea7s5y/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-syea7s5y/test/node2/conf'}
13:51:20,208 ccm INFO node2: using Java 8 for the current invocation
13:51:20,417 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-syea7s5y/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-syea7s5y/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:51:20,418 ccm INFO node2: using Java 8 for the current invocation
13:51:20,530 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:51:20,872 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-syea7s5y/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-syea7s5y/test/node3/conf'}
13:51:20,874 ccm INFO node3: using Java 8 for the current invocation
13:51:21,83 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-syea7s5y/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-syea7s5y/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:51:21,84 ccm INFO node3: using Java 8 for the current invocation
13:51:21,209 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:51:39,376 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
13:51:39,377 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:51:39,581 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:51:39,582 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:51:41,139 cassandra.cluster INFO Host 127.0.0.2:9042 may be up; will prepare queries and open connection pool
13:51:41,533 cassandra.cluster INFO Host 127.0.0.3:9042 may be up; will prepare queries and open connection pool
------------------------------ Captured log call -------------------------------
13:51:45,598 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:51:45,599 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:51:46,58 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:51:46,59 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:51:54,472 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:51:54,473 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:51:54,688 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:51:54,689 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
13:51:54,809 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:51:54,811 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
--------------------------- Captured stdout teardown ---------------------------
13:51:55,194 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_transient_write failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
	[<TracebackEntry /root/cassandra-dtest/transient_replication_test.py:330>, <TracebackEntry /root/cassandra-dtest/transient_replication_test.py:249>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:188>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
========================== 1 failed in 42.22 seconds ===========================
[msx] rc = 1
v1v2 running time = 64143342463
---> v1v2 test failed.
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write 
-------------------------------- live log call ---------------------------------
13:52:58,276 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:52:58,278 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
FAILED                                                                   [100%]

=================================== FAILURES ===================================
________________ TestTransientReplication.test_transient_write _________________

self = <transient_replication_test.TestTransientReplication object at 0x7f8882e992b0>

    @pytest.mark.no_vnodes
    def test_transient_write(self):
        """ If write can't succeed on full replica, it's written to the transient node instead """
        for node in self.nodes:
            self.assert_has_no_sstables(node)
    
        tm = lambda n: self.table_metrics(n)
        with tm(self.node1) as tm1, tm(self.node2) as tm2, tm(self.node3) as tm3:
            self.insert_row(1, 1, 1)
            # Stop writes to the other full node
            self.node2.byteman_submit([mk_bman_path('stop_writes.btm')])
            self.insert_row(1, 2, 2)
    
        # node1 should contain both rows
        self.assert_local_rows(self.node1,
                               [[1, 1, 1],
                                [1, 2, 2]])
    
        # write couldn't succeed on node2, so it has only the first row
        self.assert_local_rows(self.node2,
>                              [[1, 1, 1]])

transient_replication_test.py:330: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
transient_replication_test.py:249: in assert_local_rows
    assert_all(self.exclusive_cql_connection(node),
dtest_setup.py:188: in exclusive_cql_connection
    **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})

cassandra/cluster.py:3533: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
13:52:22,249 ccm DEBUG Log-watching thread starting.
13:52:24,78 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cyr2tn_a/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cyr2tn_a/test/node1/conf'}
13:52:24,79 ccm INFO node1: using Java 8 for the current invocation
13:52:24,296 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cyr2tn_a/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cyr2tn_a/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
13:52:24,296 ccm INFO node1: using Java 8 for the current invocation
13:52:24,404 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:52:24,744 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cyr2tn_a/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cyr2tn_a/test/node2/conf'}
13:52:24,745 ccm INFO node2: using Java 8 for the current invocation
13:52:24,966 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cyr2tn_a/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cyr2tn_a/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:52:24,967 ccm INFO node2: using Java 8 for the current invocation
13:52:25,69 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:52:25,401 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cyr2tn_a/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cyr2tn_a/test/node3/conf'}
13:52:25,402 ccm INFO node3: using Java 8 for the current invocation
13:52:25,619 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cyr2tn_a/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cyr2tn_a/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:52:25,620 ccm INFO node3: using Java 8 for the current invocation
13:52:25,724 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
install rule block digest

---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:52:21,971 conftest INFO Starting execution of test_transient_write at 2022-02-01 13:52:21.971885
13:52:22,150 dtest_setup INFO cluster ccm directory: /tmp/dtest-cyr2tn_a
13:52:24,78 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cyr2tn_a/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cyr2tn_a/test/node1/conf'}
13:52:24,79 ccm INFO node1: using Java 8 for the current invocation
13:52:24,296 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cyr2tn_a/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cyr2tn_a/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
13:52:24,296 ccm INFO node1: using Java 8 for the current invocation
13:52:24,404 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:52:24,744 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cyr2tn_a/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cyr2tn_a/test/node2/conf'}
13:52:24,745 ccm INFO node2: using Java 8 for the current invocation
13:52:24,966 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cyr2tn_a/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cyr2tn_a/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:52:24,967 ccm INFO node2: using Java 8 for the current invocation
13:52:25,69 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:52:25,401 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cyr2tn_a/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cyr2tn_a/test/node3/conf'}
13:52:25,402 ccm INFO node3: using Java 8 for the current invocation
13:52:25,619 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cyr2tn_a/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cyr2tn_a/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:52:25,620 ccm INFO node3: using Java 8 for the current invocation
13:52:25,724 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:52:43,893 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
13:52:43,896 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:52:44,126 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:52:44,127 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
------------------------------ Captured log call -------------------------------
13:52:49,87 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:52:49,88 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:52:49,548 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:52:49,549 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:52:57,931 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:52:57,932 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:52:58,159 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:52:58,159 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
13:52:58,276 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:52:58,278 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
--------------------------- Captured stdout teardown ---------------------------
13:52:58,701 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_transient_write failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
	[<TracebackEntry /root/cassandra-dtest/transient_replication_test.py:330>, <TracebackEntry /root/cassandra-dtest/transient_replication_test.py:249>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:188>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
========================== 1 failed in 37.55 seconds ===========================
[msx] rc = 1
v1v1 running time = 59306686584
cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write PASSED [100%]
===Flaky Test Report===

test_transient_write passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 37.48 seconds ===========================
[msx] rc = 0
v2v2 running time = 59283310981
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write 
-------------------------------- live log call ---------------------------------
13:54:58,582 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:54:58,586 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
FAILED                                                                   [100%]

=================================== FAILURES ===================================
________________ TestTransientReplication.test_transient_write _________________

self = <transient_replication_test.TestTransientReplication object at 0x7f54db48e160>

    @pytest.mark.no_vnodes
    def test_transient_write(self):
        """ If write can't succeed on full replica, it's written to the transient node instead """
        for node in self.nodes:
            self.assert_has_no_sstables(node)
    
        tm = lambda n: self.table_metrics(n)
        with tm(self.node1) as tm1, tm(self.node2) as tm2, tm(self.node3) as tm3:
            self.insert_row(1, 1, 1)
            # Stop writes to the other full node
            self.node2.byteman_submit([mk_bman_path('stop_writes.btm')])
            self.insert_row(1, 2, 2)
    
        # node1 should contain both rows
        self.assert_local_rows(self.node1,
                               [[1, 1, 1],
                                [1, 2, 2]])
    
        # write couldn't succeed on node2, so it has only the first row
        self.assert_local_rows(self.node2,
>                              [[1, 1, 1]])

transient_replication_test.py:330: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
transient_replication_test.py:249: in assert_local_rows
    assert_all(self.exclusive_cql_connection(node),
dtest_setup.py:188: in exclusive_cql_connection
    **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})

cassandra/cluster.py:3533: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
13:54:20,869 ccm DEBUG Log-watching thread starting.
13:54:22,706 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-laa49h8n/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-laa49h8n/test/node1/conf'}
13:54:22,707 ccm INFO node1: using Java 8 for the current invocation
13:54:22,918 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-laa49h8n/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-laa49h8n/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
13:54:22,919 ccm INFO node1: using Java 8 for the current invocation
13:54:23,18 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:54:23,378 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-laa49h8n/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-laa49h8n/test/node2/conf'}
13:54:23,379 ccm INFO node2: using Java 8 for the current invocation
13:54:23,598 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-laa49h8n/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-laa49h8n/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:54:23,599 ccm INFO node2: using Java 8 for the current invocation
13:54:23,711 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:54:24,46 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-laa49h8n/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-laa49h8n/test/node3/conf'}
13:54:24,47 ccm INFO node3: using Java 8 for the current invocation
13:54:24,251 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-laa49h8n/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-laa49h8n/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:54:24,252 ccm INFO node3: using Java 8 for the current invocation
13:54:24,373 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
install rule block digest

---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:54:20,546 conftest INFO Starting execution of test_transient_write at 2022-02-01 13:54:20.546196
13:54:20,708 dtest_setup INFO cluster ccm directory: /tmp/dtest-laa49h8n
13:54:22,706 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-laa49h8n/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-laa49h8n/test/node1/conf'}
13:54:22,707 ccm INFO node1: using Java 8 for the current invocation
13:54:22,918 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-laa49h8n/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-laa49h8n/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
13:54:22,919 ccm INFO node1: using Java 8 for the current invocation
13:54:23,18 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:54:23,378 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-laa49h8n/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-laa49h8n/test/node2/conf'}
13:54:23,379 ccm INFO node2: using Java 8 for the current invocation
13:54:23,598 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-laa49h8n/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-laa49h8n/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:54:23,599 ccm INFO node2: using Java 8 for the current invocation
13:54:23,711 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:54:24,46 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-laa49h8n/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-laa49h8n/test/node3/conf'}
13:54:24,47 ccm INFO node3: using Java 8 for the current invocation
13:54:24,251 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-laa49h8n/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-laa49h8n/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:54:24,252 ccm INFO node3: using Java 8 for the current invocation
13:54:24,373 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:54:43,571 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
13:54:43,573 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:54:43,801 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:54:43,801 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
------------------------------ Captured log call -------------------------------
13:54:49,461 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:54:49,461 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:54:49,892 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:54:49,893 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:54:58,259 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:54:58,260 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:54:58,481 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:54:58,481 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
13:54:58,582 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:54:58,586 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
--------------------------- Captured stdout teardown ---------------------------
13:54:58,835 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_transient_write failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
	[<TracebackEntry /root/cassandra-dtest/transient_replication_test.py:330>, <TracebackEntry /root/cassandra-dtest/transient_replication_test.py:249>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:188>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
========================== 1 failed in 39.12 seconds ===========================
[msx] rc = 1
v1v2 running time = 60869789124
---> v1v2 test failed.
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write 
-------------------------------- live log call ---------------------------------
13:55:58,172 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:55:58,174 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
FAILED                                                                   [100%]

=================================== FAILURES ===================================
________________ TestTransientReplication.test_transient_write _________________

self = <transient_replication_test.TestTransientReplication object at 0x7f48c15ca198>

    @pytest.mark.no_vnodes
    def test_transient_write(self):
        """ If write can't succeed on full replica, it's written to the transient node instead """
        for node in self.nodes:
            self.assert_has_no_sstables(node)
    
        tm = lambda n: self.table_metrics(n)
        with tm(self.node1) as tm1, tm(self.node2) as tm2, tm(self.node3) as tm3:
            self.insert_row(1, 1, 1)
            # Stop writes to the other full node
            self.node2.byteman_submit([mk_bman_path('stop_writes.btm')])
            self.insert_row(1, 2, 2)
    
        # node1 should contain both rows
        self.assert_local_rows(self.node1,
                               [[1, 1, 1],
                                [1, 2, 2]])
    
        # write couldn't succeed on node2, so it has only the first row
        self.assert_local_rows(self.node2,
>                              [[1, 1, 1]])

transient_replication_test.py:330: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
transient_replication_test.py:249: in assert_local_rows
    assert_all(self.exclusive_cql_connection(node),
dtest_setup.py:188: in exclusive_cql_connection
    **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})

cassandra/cluster.py:3533: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
13:55:21,607 ccm DEBUG Log-watching thread starting.
13:55:23,260 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z61ff0_c/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z61ff0_c/test/node1/conf'}
13:55:23,261 ccm INFO node1: using Java 8 for the current invocation
13:55:23,475 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z61ff0_c/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z61ff0_c/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
13:55:23,476 ccm INFO node1: using Java 8 for the current invocation
13:55:23,580 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:55:23,916 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z61ff0_c/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z61ff0_c/test/node2/conf'}
13:55:23,917 ccm INFO node2: using Java 8 for the current invocation
13:55:24,134 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z61ff0_c/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z61ff0_c/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:55:24,135 ccm INFO node2: using Java 8 for the current invocation
13:55:24,245 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:55:24,561 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z61ff0_c/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z61ff0_c/test/node3/conf'}
13:55:24,562 ccm INFO node3: using Java 8 for the current invocation
13:55:24,752 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z61ff0_c/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z61ff0_c/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:55:24,753 ccm INFO node3: using Java 8 for the current invocation
13:55:24,866 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
install rule block digest

---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:55:21,398 conftest INFO Starting execution of test_transient_write at 2022-02-01 13:55:21.398372
13:55:21,509 dtest_setup INFO cluster ccm directory: /tmp/dtest-z61ff0_c
13:55:23,260 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z61ff0_c/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z61ff0_c/test/node1/conf'}
13:55:23,261 ccm INFO node1: using Java 8 for the current invocation
13:55:23,475 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z61ff0_c/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z61ff0_c/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
13:55:23,476 ccm INFO node1: using Java 8 for the current invocation
13:55:23,580 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:55:23,916 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z61ff0_c/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z61ff0_c/test/node2/conf'}
13:55:23,917 ccm INFO node2: using Java 8 for the current invocation
13:55:24,134 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z61ff0_c/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z61ff0_c/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:55:24,135 ccm INFO node2: using Java 8 for the current invocation
13:55:24,245 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:55:24,561 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z61ff0_c/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z61ff0_c/test/node3/conf'}
13:55:24,562 ccm INFO node3: using Java 8 for the current invocation
13:55:24,752 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z61ff0_c/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z61ff0_c/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:55:24,753 ccm INFO node3: using Java 8 for the current invocation
13:55:24,866 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:55:43,85 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
13:55:43,87 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:55:43,307 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:55:43,307 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
------------------------------ Captured log call -------------------------------
13:55:48,998 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:55:48,999 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:55:49,420 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:55:49,421 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:55:57,832 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:55:57,833 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:55:58,67 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
13:55:58,68 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
13:55:58,172 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:55:58,174 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
--------------------------- Captured stdout teardown ---------------------------
13:55:58,556 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_transient_write failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
	[<TracebackEntry /root/cassandra-dtest/transient_replication_test.py:330>, <TracebackEntry /root/cassandra-dtest/transient_replication_test.py:249>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:188>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
========================== 1 failed in 37.96 seconds ===========================
[msx] rc = 1
v1v1 running time = 59743109349
cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write PASSED [100%]
===Flaky Test Report===

test_transient_write passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 38.30 seconds ===========================
[msx] rc = 0
v2v2 running time = 60035507881
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write PASSED [100%]
===Flaky Test Report===

test_transient_write passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 37.61 seconds ===========================
[msx] rc = 0
v1v2 running time = 59444702266
---> v1v2 test suceeded.
cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write 
-------------------------------- live log setup --------------------------------
13:58:43,457 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.3:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2833, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:58:43,461 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.3:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
ERROR                                                                    [100%]

==================================== ERRORS ====================================
_______ ERROR at setup of TestTransientReplication.test_transient_write ________

self = <transient_replication_test.TestTransientReplication object at 0x7fb818838208>
fixture_dtest_setup = <dtest_setup.DTestSetup object at 0x7fb8188354e0>

    @pytest.fixture(scope='function', autouse=True)
    def setup_cluster(self, fixture_dtest_setup):
        self.tokens = self.tokens()
    
        patch_start(self.cluster)
        self.cluster.set_configuration_options(values={'hinted_handoff_enabled': False,
                                                       'num_tokens': 1,
                                                       'stream_entire_sstables': self.stream_entire_sstables(),
                                                       'commitlog_sync_period_in_ms': 500,
                                                       'enable_transient_replication': True,
                                                       'dynamic_snitch': False})
        self.populate()
        self.cluster.start()
    
        self.nodes = [patch_start(node) for node in self.cluster.nodelist()]
        self.set_nodes()
    
>       session = self.exclusive_cql_connection(self.node3)

transient_replication_test.py:221: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
dtest_setup.py:188: in exclusive_cql_connection
    **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.3:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})

cassandra/cluster.py:3533: NoHostAvailable
------------------------------ Captured log setup ------------------------------
13:58:20,614 conftest INFO Starting execution of test_transient_write at 2022-02-01 13:58:20.614287
13:58:20,727 dtest_setup INFO cluster ccm directory: /tmp/dtest-n2kyd8s2
13:58:22,418 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n2kyd8s2/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n2kyd8s2/test/node1/conf'}
13:58:22,420 ccm INFO node1: using Java 8 for the current invocation
13:58:22,641 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n2kyd8s2/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n2kyd8s2/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
13:58:22,641 ccm INFO node1: using Java 8 for the current invocation
13:58:22,746 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:58:23,100 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n2kyd8s2/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n2kyd8s2/test/node2/conf'}
13:58:23,101 ccm INFO node2: using Java 8 for the current invocation
13:58:23,324 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n2kyd8s2/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n2kyd8s2/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:58:23,326 ccm INFO node2: using Java 8 for the current invocation
13:58:23,435 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:58:23,793 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n2kyd8s2/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n2kyd8s2/test/node3/conf'}
13:58:23,794 ccm INFO node3: using Java 8 for the current invocation
13:58:24,23 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n2kyd8s2/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n2kyd8s2/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
13:58:24,24 ccm INFO node3: using Java 8 for the current invocation
13:58:24,133 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
13:58:43,341 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
13:58:43,344 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
13:58:43,457 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.3:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2833, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
13:58:43,461 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.3:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
===Flaky Test Report===

test_transient_write failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.3:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
	[<TracebackEntry /root/cassandra-dtest/transient_replication_test.py:221>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:188>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
=========================== 1 error in 23.93 seconds ===========================
[msx] rc = 1
v1v1 running time = 45658577459
cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write PASSED [100%]
===Flaky Test Report===

test_transient_write passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 37.47 seconds ===========================
[msx] rc = 0
v2v2 running time = 59294430568
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write 
-------------------------------- live log call ---------------------------------
14:00:42,880 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
14:00:42,882 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
FAILED                                                                   [100%]

=================================== FAILURES ===================================
________________ TestTransientReplication.test_transient_write _________________

self = <transient_replication_test.TestTransientReplication object at 0x7f3c64493128>

    @pytest.mark.no_vnodes
    def test_transient_write(self):
        """ If write can't succeed on full replica, it's written to the transient node instead """
        for node in self.nodes:
            self.assert_has_no_sstables(node)
    
        tm = lambda n: self.table_metrics(n)
        with tm(self.node1) as tm1, tm(self.node2) as tm2, tm(self.node3) as tm3:
            self.insert_row(1, 1, 1)
            # Stop writes to the other full node
            self.node2.byteman_submit([mk_bman_path('stop_writes.btm')])
            self.insert_row(1, 2, 2)
    
        # node1 should contain both rows
        self.assert_local_rows(self.node1,
                               [[1, 1, 1],
                                [1, 2, 2]])
    
        # write couldn't succeed on node2, so it has only the first row
        self.assert_local_rows(self.node2,
>                              [[1, 1, 1]])

transient_replication_test.py:330: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
transient_replication_test.py:249: in assert_local_rows
    assert_all(self.exclusive_cql_connection(node),
dtest_setup.py:188: in exclusive_cql_connection
    **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})

cassandra/cluster.py:3533: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
14:00:05,784 ccm DEBUG Log-watching thread starting.
14:00:07,409 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ytwnzpa6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ytwnzpa6/test/node1/conf'}
14:00:07,410 ccm INFO node1: using Java 8 for the current invocation
14:00:07,623 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ytwnzpa6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ytwnzpa6/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
14:00:07,624 ccm INFO node1: using Java 8 for the current invocation
14:00:07,730 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:00:08,60 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ytwnzpa6/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ytwnzpa6/test/node2/conf'}
14:00:08,61 ccm INFO node2: using Java 8 for the current invocation
14:00:08,282 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ytwnzpa6/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ytwnzpa6/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:00:08,283 ccm INFO node2: using Java 8 for the current invocation
14:00:08,384 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:00:08,711 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ytwnzpa6/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ytwnzpa6/test/node3/conf'}
14:00:08,712 ccm INFO node3: using Java 8 for the current invocation
14:00:08,916 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ytwnzpa6/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ytwnzpa6/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:00:08,917 ccm INFO node3: using Java 8 for the current invocation
14:00:09,25 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
install rule block digest

---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
14:00:05,577 conftest INFO Starting execution of test_transient_write at 2022-02-01 14:00:05.577050
14:00:05,689 dtest_setup INFO cluster ccm directory: /tmp/dtest-ytwnzpa6
14:00:07,409 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ytwnzpa6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ytwnzpa6/test/node1/conf'}
14:00:07,410 ccm INFO node1: using Java 8 for the current invocation
14:00:07,623 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ytwnzpa6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ytwnzpa6/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
14:00:07,624 ccm INFO node1: using Java 8 for the current invocation
14:00:07,730 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:00:08,60 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ytwnzpa6/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ytwnzpa6/test/node2/conf'}
14:00:08,61 ccm INFO node2: using Java 8 for the current invocation
14:00:08,282 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ytwnzpa6/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ytwnzpa6/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:00:08,283 ccm INFO node2: using Java 8 for the current invocation
14:00:08,384 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:00:08,711 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ytwnzpa6/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ytwnzpa6/test/node3/conf'}
14:00:08,712 ccm INFO node3: using Java 8 for the current invocation
14:00:08,916 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ytwnzpa6/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ytwnzpa6/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:00:08,917 ccm INFO node3: using Java 8 for the current invocation
14:00:09,25 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:00:28,192 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
14:00:28,195 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:00:28,409 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:00:28,410 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
------------------------------ Captured log call -------------------------------
14:00:33,738 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:00:33,739 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:00:34,151 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:00:34,152 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:00:42,604 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:00:42,605 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:00:42,796 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:00:42,796 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
14:00:42,880 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
14:00:42,882 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
--------------------------- Captured stdout teardown ---------------------------
14:00:43,273 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_transient_write failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
	[<TracebackEntry /root/cassandra-dtest/transient_replication_test.py:330>, <TracebackEntry /root/cassandra-dtest/transient_replication_test.py:249>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:188>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
========================== 1 failed in 40.64 seconds ===========================
[msx] rc = 1
v1v2 running time = 62424249075
---> v1v2 test failed.
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write PASSED [100%]
===Flaky Test Report===

test_transient_write passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 37.75 seconds ===========================
[msx] rc = 0
v1v1 running time = 59459379724
cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write PASSED [100%]
===Flaky Test Report===

test_transient_write passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 38.25 seconds ===========================
[msx] rc = 0
v2v2 running time = 60021692404
---> v1v1 and v2v2 test test suceeded.
cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write 
-------------------------------- live log call ---------------------------------
14:03:45,7 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
14:03:45,10 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
FAILED                                                                   [100%]

=================================== FAILURES ===================================
________________ TestTransientReplication.test_transient_write _________________

self = <transient_replication_test.TestTransientReplication object at 0x7f0881665160>

    @pytest.mark.no_vnodes
    def test_transient_write(self):
        """ If write can't succeed on full replica, it's written to the transient node instead """
        for node in self.nodes:
            self.assert_has_no_sstables(node)
    
        tm = lambda n: self.table_metrics(n)
        with tm(self.node1) as tm1, tm(self.node2) as tm2, tm(self.node3) as tm3:
            self.insert_row(1, 1, 1)
            # Stop writes to the other full node
            self.node2.byteman_submit([mk_bman_path('stop_writes.btm')])
            self.insert_row(1, 2, 2)
    
        # node1 should contain both rows
        self.assert_local_rows(self.node1,
                               [[1, 1, 1],
                                [1, 2, 2]])
    
        # write couldn't succeed on node2, so it has only the first row
        self.assert_local_rows(self.node2,
>                              [[1, 1, 1]])

transient_replication_test.py:330: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
transient_replication_test.py:249: in assert_local_rows
    assert_all(self.exclusive_cql_connection(node),
dtest_setup.py:188: in exclusive_cql_connection
    **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})

cassandra/cluster.py:3533: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
14:03:07,826 ccm DEBUG Log-watching thread starting.
14:03:09,738 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bp4hz2cq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bp4hz2cq/test/node1/conf'}
14:03:09,738 ccm INFO node1: using Java 8 for the current invocation
14:03:09,990 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bp4hz2cq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bp4hz2cq/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
14:03:09,991 ccm INFO node1: using Java 8 for the current invocation
14:03:10,83 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:03:10,540 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bp4hz2cq/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bp4hz2cq/test/node2/conf'}
14:03:10,540 ccm INFO node2: using Java 8 for the current invocation
14:03:10,770 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bp4hz2cq/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bp4hz2cq/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:03:10,770 ccm INFO node2: using Java 8 for the current invocation
14:03:10,880 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:03:11,299 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bp4hz2cq/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bp4hz2cq/test/node3/conf'}
14:03:11,299 ccm INFO node3: using Java 8 for the current invocation
14:03:11,559 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bp4hz2cq/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bp4hz2cq/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:03:11,560 ccm INFO node3: using Java 8 for the current invocation
14:03:11,668 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
install rule block digest

---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
14:03:07,631 conftest INFO Starting execution of test_transient_write at 2022-02-01 14:03:07.631247
14:03:07,730 dtest_setup INFO cluster ccm directory: /tmp/dtest-bp4hz2cq
14:03:09,738 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bp4hz2cq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bp4hz2cq/test/node1/conf'}
14:03:09,738 ccm INFO node1: using Java 8 for the current invocation
14:03:09,990 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bp4hz2cq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bp4hz2cq/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
14:03:09,991 ccm INFO node1: using Java 8 for the current invocation
14:03:10,83 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:03:10,540 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bp4hz2cq/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bp4hz2cq/test/node2/conf'}
14:03:10,540 ccm INFO node2: using Java 8 for the current invocation
14:03:10,770 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bp4hz2cq/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bp4hz2cq/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:03:10,770 ccm INFO node2: using Java 8 for the current invocation
14:03:10,880 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:03:11,299 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bp4hz2cq/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bp4hz2cq/test/node3/conf'}
14:03:11,299 ccm INFO node3: using Java 8 for the current invocation
14:03:11,559 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-bp4hz2cq/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-bp4hz2cq/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:03:11,560 ccm INFO node3: using Java 8 for the current invocation
14:03:11,668 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:03:30,804 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
14:03:30,805 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:03:31,75 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:03:31,75 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
------------------------------ Captured log call -------------------------------
14:03:35,776 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:03:35,777 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:03:36,272 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:03:36,273 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:03:44,649 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:03:44,650 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:03:44,907 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:03:44,908 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
14:03:45,7 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
14:03:45,10 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
--------------------------- Captured stdout teardown ---------------------------
14:03:45,300 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_transient_write failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
	[<TracebackEntry /root/cassandra-dtest/transient_replication_test.py:330>, <TracebackEntry /root/cassandra-dtest/transient_replication_test.py:249>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:188>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
========================== 1 failed in 38.48 seconds ===========================
[msx] rc = 1
v1v2 running time = 60346252590
---> v1v2 test failed.
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write 
-------------------------------- live log setup --------------------------------
14:04:29,845 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2833, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
14:04:29,846 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.1:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
ERROR                                                                    [100%]

==================================== ERRORS ====================================
_______ ERROR at setup of TestTransientReplication.test_transient_write ________

self = <transient_replication_test.TestTransientReplication object at 0x7fb92098d358>
fixture_dtest_setup = <dtest_setup.DTestSetup object at 0x7fb920719898>

    @pytest.fixture(scope='function', autouse=True)
    def setup_cluster(self, fixture_dtest_setup):
        self.tokens = self.tokens()
    
        patch_start(self.cluster)
        self.cluster.set_configuration_options(values={'hinted_handoff_enabled': False,
                                                       'num_tokens': 1,
                                                       'stream_entire_sstables': self.stream_entire_sstables(),
                                                       'commitlog_sync_period_in_ms': 500,
                                                       'enable_transient_replication': True,
                                                       'dynamic_snitch': False})
        self.populate()
        self.cluster.start()
    
        self.nodes = [patch_start(node) for node in self.cluster.nodelist()]
        self.set_nodes()
    
        session = self.exclusive_cql_connection(self.node3)
>       self.setup_schema()

transient_replication_test.py:222: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
transient_replication_test.py:196: in setup_schema
    session = self.exclusive_cql_connection(self.node1)
dtest_setup.py:188: in exclusive_cql_connection
    **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.1:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})

cassandra/cluster.py:3533: NoHostAvailable
------------------------------ Captured log setup ------------------------------
14:04:07,884 conftest INFO Starting execution of test_transient_write at 2022-02-01 14:04:07.884180
14:04:08,13 dtest_setup INFO cluster ccm directory: /tmp/dtest-0ixojt5k
14:04:09,733 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0ixojt5k/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0ixojt5k/test/node1/conf'}
14:04:09,734 ccm INFO node1: using Java 8 for the current invocation
14:04:09,951 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0ixojt5k/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0ixojt5k/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
14:04:09,952 ccm INFO node1: using Java 8 for the current invocation
14:04:10,63 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:04:10,391 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0ixojt5k/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0ixojt5k/test/node2/conf'}
14:04:10,392 ccm INFO node2: using Java 8 for the current invocation
14:04:10,598 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0ixojt5k/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0ixojt5k/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:04:10,599 ccm INFO node2: using Java 8 for the current invocation
14:04:10,708 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:04:11,19 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0ixojt5k/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0ixojt5k/test/node3/conf'}
14:04:11,20 ccm INFO node3: using Java 8 for the current invocation
14:04:11,248 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0ixojt5k/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0ixojt5k/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:04:11,248 ccm INFO node3: using Java 8 for the current invocation
14:04:11,363 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:04:29,570 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
14:04:29,571 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:04:29,770 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:04:29,770 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:04:29,845 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2833, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
14:04:29,846 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.1:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
===Flaky Test Report===

test_transient_write failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.1:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
	[<TracebackEntry /root/cassandra-dtest/transient_replication_test.py:222>, <TracebackEntry /root/cassandra-dtest/transient_replication_test.py:196>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:188>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
=========================== 1 error in 22.91 seconds ===========================
[msx] rc = 1
v1v1 running time = 44715209766
cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write PASSED [100%]
===Flaky Test Report===

test_transient_write passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 38.53 seconds ===========================
[msx] rc = 0
v2v2 running time = 60228176788
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write 
-------------------------------- live log call ---------------------------------
14:06:30,886 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
14:06:30,890 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
FAILED                                                                   [100%]

=================================== FAILURES ===================================
________________ TestTransientReplication.test_transient_write _________________

self = <transient_replication_test.TestTransientReplication object at 0x7f23a68c2128>

    @pytest.mark.no_vnodes
    def test_transient_write(self):
        """ If write can't succeed on full replica, it's written to the transient node instead """
        for node in self.nodes:
            self.assert_has_no_sstables(node)
    
        tm = lambda n: self.table_metrics(n)
        with tm(self.node1) as tm1, tm(self.node2) as tm2, tm(self.node3) as tm3:
            self.insert_row(1, 1, 1)
            # Stop writes to the other full node
            self.node2.byteman_submit([mk_bman_path('stop_writes.btm')])
            self.insert_row(1, 2, 2)
    
        # node1 should contain both rows
        self.assert_local_rows(self.node1,
                               [[1, 1, 1],
                                [1, 2, 2]])
    
        # write couldn't succeed on node2, so it has only the first row
        self.assert_local_rows(self.node2,
>                              [[1, 1, 1]])

transient_replication_test.py:330: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
transient_replication_test.py:249: in assert_local_rows
    assert_all(self.exclusive_cql_connection(node),
dtest_setup.py:188: in exclusive_cql_connection
    **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})

cassandra/cluster.py:3533: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
14:05:53,233 ccm DEBUG Log-watching thread starting.
14:05:55,226 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j0mk72p5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j0mk72p5/test/node1/conf'}
14:05:55,227 ccm INFO node1: using Java 8 for the current invocation
14:05:55,444 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j0mk72p5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j0mk72p5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
14:05:55,446 ccm INFO node1: using Java 8 for the current invocation
14:05:55,540 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:05:55,884 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j0mk72p5/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j0mk72p5/test/node2/conf'}
14:05:55,885 ccm INFO node2: using Java 8 for the current invocation
14:05:56,125 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j0mk72p5/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j0mk72p5/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:05:56,127 ccm INFO node2: using Java 8 for the current invocation
14:05:56,239 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:05:56,569 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j0mk72p5/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j0mk72p5/test/node3/conf'}
14:05:56,570 ccm INFO node3: using Java 8 for the current invocation
14:05:56,797 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j0mk72p5/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j0mk72p5/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:05:56,798 ccm INFO node3: using Java 8 for the current invocation
14:05:56,906 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
install rule block digest

---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
14:05:52,951 conftest INFO Starting execution of test_transient_write at 2022-02-01 14:05:52.951042
14:05:53,130 dtest_setup INFO cluster ccm directory: /tmp/dtest-j0mk72p5
14:05:55,226 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j0mk72p5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j0mk72p5/test/node1/conf'}
14:05:55,227 ccm INFO node1: using Java 8 for the current invocation
14:05:55,444 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j0mk72p5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j0mk72p5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
14:05:55,446 ccm INFO node1: using Java 8 for the current invocation
14:05:55,540 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:05:55,884 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j0mk72p5/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j0mk72p5/test/node2/conf'}
14:05:55,885 ccm INFO node2: using Java 8 for the current invocation
14:05:56,125 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j0mk72p5/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j0mk72p5/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:05:56,127 ccm INFO node2: using Java 8 for the current invocation
14:05:56,239 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:05:56,569 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j0mk72p5/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j0mk72p5/test/node3/conf'}
14:05:56,570 ccm INFO node3: using Java 8 for the current invocation
14:05:56,797 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-j0mk72p5/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-j0mk72p5/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:05:56,798 ccm INFO node3: using Java 8 for the current invocation
14:05:56,906 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:06:15,87 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
14:06:15,90 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:06:15,363 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:06:15,364 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
------------------------------ Captured log call -------------------------------
14:06:21,643 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:06:21,644 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:06:22,144 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:06:22,145 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:06:30,542 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:06:30,543 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:06:30,774 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:06:30,774 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
14:06:30,886 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
14:06:30,890 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
--------------------------- Captured stdout teardown ---------------------------
14:06:31,222 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_transient_write failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
	[<TracebackEntry /root/cassandra-dtest/transient_replication_test.py:330>, <TracebackEntry /root/cassandra-dtest/transient_replication_test.py:249>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:188>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
========================== 1 failed in 39.11 seconds ===========================
[msx] rc = 1
v1v2 running time = 60938413545
---> v1v2 test failed.
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write 
-------------------------------- live log setup --------------------------------
14:07:16,427 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.3:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2833, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
14:07:16,429 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.3:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
ERROR                                                                    [100%]

==================================== ERRORS ====================================
_______ ERROR at setup of TestTransientReplication.test_transient_write ________

self = <transient_replication_test.TestTransientReplication object at 0x7feec952ec50>
fixture_dtest_setup = <dtest_setup.DTestSetup object at 0x7feec922a898>

    @pytest.fixture(scope='function', autouse=True)
    def setup_cluster(self, fixture_dtest_setup):
        self.tokens = self.tokens()
    
        patch_start(self.cluster)
        self.cluster.set_configuration_options(values={'hinted_handoff_enabled': False,
                                                       'num_tokens': 1,
                                                       'stream_entire_sstables': self.stream_entire_sstables(),
                                                       'commitlog_sync_period_in_ms': 500,
                                                       'enable_transient_replication': True,
                                                       'dynamic_snitch': False})
        self.populate()
        self.cluster.start()
    
        self.nodes = [patch_start(node) for node in self.cluster.nodelist()]
        self.set_nodes()
    
>       session = self.exclusive_cql_connection(self.node3)

transient_replication_test.py:221: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
dtest_setup.py:188: in exclusive_cql_connection
    **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.3:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})

cassandra/cluster.py:3533: NoHostAvailable
------------------------------ Captured log setup ------------------------------
14:06:53,730 conftest INFO Starting execution of test_transient_write at 2022-02-01 14:06:53.729940
14:06:53,810 dtest_setup INFO cluster ccm directory: /tmp/dtest-kj9ofw26
14:06:55,493 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kj9ofw26/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kj9ofw26/test/node1/conf'}
14:06:55,494 ccm INFO node1: using Java 8 for the current invocation
14:06:55,711 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kj9ofw26/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kj9ofw26/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
14:06:55,712 ccm INFO node1: using Java 8 for the current invocation
14:06:55,818 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:06:56,177 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kj9ofw26/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kj9ofw26/test/node2/conf'}
14:06:56,178 ccm INFO node2: using Java 8 for the current invocation
14:06:56,396 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kj9ofw26/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kj9ofw26/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:06:56,397 ccm INFO node2: using Java 8 for the current invocation
14:06:56,497 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:06:56,853 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kj9ofw26/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kj9ofw26/test/node3/conf'}
14:06:56,854 ccm INFO node3: using Java 8 for the current invocation
14:06:57,74 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kj9ofw26/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kj9ofw26/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:06:57,75 ccm INFO node3: using Java 8 for the current invocation
14:06:57,188 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:07:16,352 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
14:07:16,354 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:07:16,427 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.3:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2833, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
14:07:16,429 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.3:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
===Flaky Test Report===

test_transient_write failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.3:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
	[<TracebackEntry /root/cassandra-dtest/transient_replication_test.py:221>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:188>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
=========================== 1 error in 25.61 seconds ===========================
[msx] rc = 1
v1v1 running time = 47309920741
cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write PASSED [100%]
===Flaky Test Report===

test_transient_write passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 37.18 seconds ===========================
[msx] rc = 0
v2v2 running time = 59012125291
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write 
-------------------------------- live log call ---------------------------------
14:09:17,577 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
14:09:17,581 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
FAILED                                                                   [100%]

=================================== FAILURES ===================================
________________ TestTransientReplication.test_transient_write _________________

self = <transient_replication_test.TestTransientReplication object at 0x7fea864591d0>

    @pytest.mark.no_vnodes
    def test_transient_write(self):
        """ If write can't succeed on full replica, it's written to the transient node instead """
        for node in self.nodes:
            self.assert_has_no_sstables(node)
    
        tm = lambda n: self.table_metrics(n)
        with tm(self.node1) as tm1, tm(self.node2) as tm2, tm(self.node3) as tm3:
            self.insert_row(1, 1, 1)
            # Stop writes to the other full node
            self.node2.byteman_submit([mk_bman_path('stop_writes.btm')])
            self.insert_row(1, 2, 2)
    
        # node1 should contain both rows
        self.assert_local_rows(self.node1,
                               [[1, 1, 1],
                                [1, 2, 2]])
    
        # write couldn't succeed on node2, so it has only the first row
        self.assert_local_rows(self.node2,
>                              [[1, 1, 1]])

transient_replication_test.py:330: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
transient_replication_test.py:249: in assert_local_rows
    assert_all(self.exclusive_cql_connection(node),
dtest_setup.py:188: in exclusive_cql_connection
    **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})

cassandra/cluster.py:3533: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
14:08:40,380 ccm DEBUG Log-watching thread starting.
14:08:42,120 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7edyuyxr/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7edyuyxr/test/node1/conf'}
14:08:42,121 ccm INFO node1: using Java 8 for the current invocation
14:08:42,337 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7edyuyxr/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7edyuyxr/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
14:08:42,338 ccm INFO node1: using Java 8 for the current invocation
14:08:42,447 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:08:42,791 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7edyuyxr/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7edyuyxr/test/node2/conf'}
14:08:42,792 ccm INFO node2: using Java 8 for the current invocation
14:08:43,4 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7edyuyxr/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7edyuyxr/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:08:43,5 ccm INFO node2: using Java 8 for the current invocation
14:08:43,110 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:08:43,449 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7edyuyxr/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7edyuyxr/test/node3/conf'}
14:08:43,450 ccm INFO node3: using Java 8 for the current invocation
14:08:43,660 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7edyuyxr/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7edyuyxr/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:08:43,661 ccm INFO node3: using Java 8 for the current invocation
14:08:43,762 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
install rule block digest

---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
14:08:40,113 conftest INFO Starting execution of test_transient_write at 2022-02-01 14:08:40.113312
14:08:40,277 dtest_setup INFO cluster ccm directory: /tmp/dtest-7edyuyxr
14:08:42,120 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7edyuyxr/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7edyuyxr/test/node1/conf'}
14:08:42,121 ccm INFO node1: using Java 8 for the current invocation
14:08:42,337 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7edyuyxr/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7edyuyxr/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
14:08:42,338 ccm INFO node1: using Java 8 for the current invocation
14:08:42,447 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:08:42,791 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7edyuyxr/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7edyuyxr/test/node2/conf'}
14:08:42,792 ccm INFO node2: using Java 8 for the current invocation
14:08:43,4 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7edyuyxr/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7edyuyxr/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:08:43,5 ccm INFO node2: using Java 8 for the current invocation
14:08:43,110 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:08:43,449 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7edyuyxr/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7edyuyxr/test/node3/conf'}
14:08:43,450 ccm INFO node3: using Java 8 for the current invocation
14:08:43,660 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7edyuyxr/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7edyuyxr/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:08:43,661 ccm INFO node3: using Java 8 for the current invocation
14:08:43,762 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:09:02,962 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
14:09:02,966 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:09:03,253 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:09:03,254 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
------------------------------ Captured log call -------------------------------
14:09:08,401 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:09:08,402 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:09:08,873 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:09:08,874 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:09:17,245 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:09:17,246 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:09:17,473 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
14:09:17,474 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
14:09:17,577 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
14:09:17,581 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
--------------------------- Captured stdout teardown ---------------------------
14:09:17,833 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_transient_write failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.2:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
	[<TracebackEntry /root/cassandra-dtest/transient_replication_test.py:330>, <TracebackEntry /root/cassandra-dtest/transient_replication_test.py:249>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:188>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
========================== 1 failed in 38.55 seconds ===========================
[msx] rc = 1
v1v2 running time = 60332717951
---> v1v2 test failed.
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write 
-------------------------------- live log setup --------------------------------
14:10:03,882 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.3:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2833, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
14:10:03,886 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.3:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
ERROR                                                                    [100%]

==================================== ERRORS ====================================
_______ ERROR at setup of TestTransientReplication.test_transient_write ________

self = <transient_replication_test.TestTransientReplication object at 0x7f830885f080>
fixture_dtest_setup = <dtest_setup.DTestSetup object at 0x7f830885f940>

    @pytest.fixture(scope='function', autouse=True)
    def setup_cluster(self, fixture_dtest_setup):
        self.tokens = self.tokens()
    
        patch_start(self.cluster)
        self.cluster.set_configuration_options(values={'hinted_handoff_enabled': False,
                                                       'num_tokens': 1,
                                                       'stream_entire_sstables': self.stream_entire_sstables(),
                                                       'commitlog_sync_period_in_ms': 500,
                                                       'enable_transient_replication': True,
                                                       'dynamic_snitch': False})
        self.populate()
        self.cluster.start()
    
        self.nodes = [patch_start(node) for node in self.cluster.nodelist()]
        self.set_nodes()
    
>       session = self.exclusive_cql_connection(self.node3)

transient_replication_test.py:221: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
dtest_setup.py:188: in exclusive_cql_connection
    **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.3:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})

cassandra/cluster.py:3533: NoHostAvailable
------------------------------ Captured log setup ------------------------------
14:09:40,636 conftest INFO Starting execution of test_transient_write at 2022-02-01 14:09:40.636187
14:09:40,704 dtest_setup INFO cluster ccm directory: /tmp/dtest-chsh_0oz
14:09:42,891 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-chsh_0oz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-chsh_0oz/test/node1/conf'}
14:09:42,893 ccm INFO node1: using Java 8 for the current invocation
14:09:43,121 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-chsh_0oz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-chsh_0oz/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6'}
14:09:43,122 ccm INFO node1: using Java 8 for the current invocation
14:09:43,234 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:09:43,595 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-chsh_0oz/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-chsh_0oz/test/node2/conf'}
14:09:43,596 ccm INFO node2: using Java 8 for the current invocation
14:09:43,818 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-chsh_0oz/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-chsh_0oz/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:09:43,819 ccm INFO node2: using Java 8 for the current invocation
14:09:43,934 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:09:44,279 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-chsh_0oz/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-chsh_0oz/test/node3/conf'}
14:09:44,280 ccm INFO node3: using Java 8 for the current invocation
14:09:44,481 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '96ee0bc7f42f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'transient_replication_test.py::TestTransientReplication::()::test_transient_write (setup)', 'CASSANDRA_INCLUDE': '/tmp/dtest-chsh_0oz/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-chsh_0oz/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -XX:-PerfDisableSharedMem -Dcassandra.enable_nodelocal_queries=true -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
14:09:44,482 ccm INFO node3: using Java 8 for the current invocation
14:09:44,595 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
14:10:03,781 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.1:9042 datacenter1> discovered
14:10:03,786 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
14:10:03,882 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.3:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2833, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
14:10:03,886 cassandra.cluster ERROR Control connection failed to connect, shutting down Cluster:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 1690, in cassandra.cluster.Cluster.connect
  File "cassandra/cluster.py", line 3488, in cassandra.cluster.ControlConnection.connect
  File "cassandra/cluster.py", line 3533, in cassandra.cluster.ControlConnection._reconnect_internal
cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.3:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
===Flaky Test Report===

test_transient_write failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.3:9042': ReadTimeout('Error from server: code=1200 [Coordinator node timed out waiting for replica nodes\' responses] message="Operation timed out - received only 0 responses." info={\'consistency\': \'ONE\', \'required_responses\': 1, \'received_responses\': 0}',)})
	[<TracebackEntry /root/cassandra-dtest/transient_replication_test.py:221>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:188>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
=========================== 1 error in 24.44 seconds ===========================
[msx] rc = 1
v1v1 running time = 46348994110
cassandra transient_replication_test.py::TestTransientReplication::test_transient_write false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is transient_replication_test.py::TestTransientReplication::test_transient_write
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

transient_replication_test.py::TestTransientReplication::test_transient_write PASSED [100%]
===Flaky Test Report===

test_transient_write passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 39.68 seconds ===========================
[msx] rc = 0
v2v2 running time = 61460988363
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: transient_replication_test.py::TestTransientReplication::test_transient_write
h_list: range_request_timeout_in_ms@@@CassandraDaemon@@@-1@@@50@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

early stop after 7 is satisfied
v1v2 failed with probability 8 out of 9
v1v1v2v2 failed with probability 7 out of 9
Total execution time in seconds : 1573
0
