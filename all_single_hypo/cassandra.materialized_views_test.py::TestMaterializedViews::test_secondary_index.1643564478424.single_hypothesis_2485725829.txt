my_type=hypothesis
proj=cassandra
u_test=materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list[1]=internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:05:34,909 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:05:37,16 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:05:29,314 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:05:37,20 conftest ERROR Unexpected error in node3 log, error: 
ERROR [Messaging-EventLoop-3-12] 2022-01-30 18:05:33,108 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-e59b1628 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [Messaging-EventLoop-3-12] 2022-01-30 18:05:33,108 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-e59b1628 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [Messaging-EventLoop-3-12] 2022-01-30 18:05:33,108 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-e59b1628 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
18:05:02,433 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:05:01,282 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:05:01.282329
18:05:02,342 dtest_setup INFO cluster ccm directory: /tmp/dtest-an9um_bd
------------------------------ Captured log call -------------------------------
18:05:03,986 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-an9um_bd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-an9um_bd/test/node1/conf'}
18:05:03,986 ccm INFO node1: using Java 8 for the current invocation
18:05:04,141 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-an9um_bd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-an9um_bd/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:05:04,142 ccm INFO node1: using Java 8 for the current invocation
18:05:04,221 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:05:04,483 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-an9um_bd/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-an9um_bd/test/node2/conf'}
18:05:04,484 ccm INFO node2: using Java 8 for the current invocation
18:05:04,659 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-an9um_bd/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-an9um_bd/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:05:04,660 ccm INFO node2: using Java 8 for the current invocation
18:05:04,741 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:05:04,995 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-an9um_bd/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-an9um_bd/test/node3/conf'}
18:05:04,995 ccm INFO node3: using Java 8 for the current invocation
18:05:05,156 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-an9um_bd/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-an9um_bd/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:05:05,157 ccm INFO node3: using Java 8 for the current invocation
18:05:05,235 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:05:28,20 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:05:28,22 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:05:34,909 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:05:37,16 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:05:29,314 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:05:37,20 conftest ERROR Unexpected error in node3 log, error: 
ERROR [Messaging-EventLoop-3-12] 2022-01-30 18:05:33,108 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-e59b1628 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 39.10 seconds ======================
[msx] rc = 1
v1v2 running time = 60720419456
---> v1v2 test failed.
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:06:38,288 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 39.51 seconds ===========================
[msx] rc = 0
v1v1 running time = 60915598338
cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:07:35,425 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:07:37,823 conftest ERROR Unexpected error in node2 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:07:33,863 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11798 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:07:37,828 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:07:30,108 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [MigrationStage:1] 2022-01-30 18:07:30,108 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:07:37,038 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:07:37,068 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:07:30,108 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
18:07:03,510 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:07:02,751 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:07:02.751897
18:07:03,412 dtest_setup INFO cluster ccm directory: /tmp/dtest-2pc48w7w
------------------------------ Captured log call -------------------------------
18:07:05,40 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2pc48w7w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2pc48w7w/test/node1/conf'}
18:07:05,41 ccm INFO node1: using Java 8 for the current invocation
18:07:05,215 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2pc48w7w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2pc48w7w/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:07:05,216 ccm INFO node1: using Java 8 for the current invocation
18:07:05,307 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:07:05,563 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2pc48w7w/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2pc48w7w/test/node2/conf'}
18:07:05,564 ccm INFO node2: using Java 8 for the current invocation
18:07:05,736 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2pc48w7w/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2pc48w7w/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:07:05,737 ccm INFO node2: using Java 8 for the current invocation
18:07:05,830 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:07:06,84 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2pc48w7w/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2pc48w7w/test/node3/conf'}
18:07:06,84 ccm INFO node3: using Java 8 for the current invocation
18:07:06,240 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2pc48w7w/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2pc48w7w/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:07:06,241 ccm INFO node3: using Java 8 for the current invocation
18:07:06,317 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:07:29,114 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:07:29,116 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:07:35,425 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:07:37,823 conftest ERROR Unexpected error in node2 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:07:33,863 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11798 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:07:37,828 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:07:30,108 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 38.40 seconds ======================
[msx] rc = 1
v2v2 running time = 59823261870
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:08:39,709 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:08:42,52 conftest ERROR Unexpected error in node1 log, error: 
ERROR [Messaging-EventLoop-3-10] 2022-01-30 18:08:41,380 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.1:7000-SMALL_MESSAGES-44568bfb unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:08:42,55 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:08:37,116 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11798 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [MigrationStage:1] 2022-01-30 18:08:37,116 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11798 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:08:37,138 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11798 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [Messaging-EventLoop-3-12] 2022-01-30 18:08:41,438 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-5ce120eb unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:08:37,116 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11798 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
18:08:03,684 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:08:02,514 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:08:02.514607
18:08:03,574 dtest_setup INFO cluster ccm directory: /tmp/dtest-s1n3o7_e
------------------------------ Captured log call -------------------------------
18:08:05,280 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-s1n3o7_e/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-s1n3o7_e/test/node1/conf'}
18:08:05,281 ccm INFO node1: using Java 8 for the current invocation
18:08:05,459 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-s1n3o7_e/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-s1n3o7_e/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:08:05,459 ccm INFO node1: using Java 8 for the current invocation
18:08:05,546 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:08:05,799 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-s1n3o7_e/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-s1n3o7_e/test/node2/conf'}
18:08:05,800 ccm INFO node2: using Java 8 for the current invocation
18:08:05,962 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-s1n3o7_e/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-s1n3o7_e/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:08:05,963 ccm INFO node2: using Java 8 for the current invocation
18:08:06,45 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:08:06,298 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-s1n3o7_e/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-s1n3o7_e/test/node3/conf'}
18:08:06,298 ccm INFO node3: using Java 8 for the current invocation
18:08:06,474 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-s1n3o7_e/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-s1n3o7_e/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:08:06,475 ccm INFO node3: using Java 8 for the current invocation
18:08:06,557 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:08:30,324 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:08:30,326 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:08:39,709 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:08:42,52 conftest ERROR Unexpected error in node1 log, error: 
ERROR [Messaging-EventLoop-3-10] 2022-01-30 18:08:41,380 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.1:7000-SMALL_MESSAGES-44568bfb unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:08:42,55 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:08:37,116 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11798 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 42.88 seconds ======================
[msx] rc = 1
v1v2 running time = 64240569486
---> v1v2 test failed.
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:09:41,522 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 37.77 seconds ===========================
[msx] rc = 0
v1v1 running time = 59173979834
cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:10:41,991 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:10:44,551 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:10:34,915 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:10:44,554 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:10:39,572 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [MigrationStage:1] 2022-01-30 18:10:39,572 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:10:39,586 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:10:39,572 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
8:10:07,108 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:10:06,7 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:10:06.007900
18:10:07,6 dtest_setup INFO cluster ccm directory: /tmp/dtest-a8_kfuv4
------------------------------ Captured log call -------------------------------
18:10:08,810 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a8_kfuv4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a8_kfuv4/test/node1/conf'}
18:10:08,811 ccm INFO node1: using Java 8 for the current invocation
18:10:08,981 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a8_kfuv4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a8_kfuv4/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:10:08,982 ccm INFO node1: using Java 8 for the current invocation
18:10:09,69 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:10:09,348 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a8_kfuv4/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a8_kfuv4/test/node2/conf'}
18:10:09,348 ccm INFO node2: using Java 8 for the current invocation
18:10:09,516 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a8_kfuv4/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a8_kfuv4/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:10:09,517 ccm INFO node2: using Java 8 for the current invocation
18:10:09,608 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:10:09,864 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a8_kfuv4/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a8_kfuv4/test/node3/conf'}
18:10:09,865 ccm INFO node3: using Java 8 for the current invocation
18:10:10,33 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a8_kfuv4/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a8_kfuv4/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:10:10,43 ccm INFO node3: using Java 8 for the current invocation
18:10:10,126 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:10:33,918 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:10:33,920 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:10:41,991 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:10:44,551 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:10:34,915 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:10:44,554 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:10:39,572 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 39.88 seconds ======================
[msx] rc = 1
v2v2 running time = 61475948438
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:11:40,391 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:11:42,521 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:11:35,861 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:11:42,524 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:11:38,984 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [MigrationStage:1] 2022-01-30 18:11:38,984 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:11:38,995 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:11:38,984 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
18:11:08,386 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:11:07,837 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:11:07.837316
18:11:08,294 dtest_setup INFO cluster ccm directory: /tmp/dtest-1y7zuc00
------------------------------ Captured log call -------------------------------
18:11:09,814 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1y7zuc00/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1y7zuc00/test/node1/conf'}
18:11:09,815 ccm INFO node1: using Java 8 for the current invocation
18:11:09,981 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1y7zuc00/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1y7zuc00/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:11:09,982 ccm INFO node1: using Java 8 for the current invocation
18:11:10,66 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:11:10,351 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1y7zuc00/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1y7zuc00/test/node2/conf'}
18:11:10,352 ccm INFO node2: using Java 8 for the current invocation
18:11:10,517 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1y7zuc00/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1y7zuc00/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:11:10,518 ccm INFO node2: using Java 8 for the current invocation
18:11:10,599 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:11:10,855 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1y7zuc00/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1y7zuc00/test/node3/conf'}
18:11:10,856 ccm INFO node3: using Java 8 for the current invocation
18:11:11,19 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1y7zuc00/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1y7zuc00/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:11:11,20 ccm INFO node3: using Java 8 for the current invocation
18:11:11,103 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:11:34,891 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:11:34,894 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:11:40,391 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:11:42,521 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:11:35,861 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:11:42,524 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:11:38,984 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 36.26 seconds ======================
[msx] rc = 1
v1v2 running time = 57804088946
---> v1v2 test failed.
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:12:37,649 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 36.06 seconds ===========================
[msx] rc = 0
v1v1 running time = 57485886518
cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:13:34,422 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:13:36,556 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:13:30,141 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:13:36,559 conftest ERROR Unexpected error in node2 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:13:32,950 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 35.03 seconds ===========================
[msx] rc = 0
v2v2 running time = 56560721438
---> v1v1 and v2v2 test test suceeded.
cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:14:31,335 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:14:33,742 conftest ERROR Unexpected error in node1 log, error: 
ERROR [Messaging-EventLoop-3-9] 2022-01-30 18:14:32,866 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.1:7000-SMALL_MESSAGES-26134543 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:14:33,748 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:14:29,395 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [MigrationStage:1] 2022-01-30 18:14:29,395 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:14:29,405 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [Messaging-EventLoop-3-12] 2022-01-30 18:14:32,882 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-3e7c71cb unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:14:29,395 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
8:14:00,48 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:13:59,344 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:13:59.344624
18:13:59,953 dtest_setup INFO cluster ccm directory: /tmp/dtest-tpddzsks
------------------------------ Captured log call -------------------------------
18:14:01,536 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tpddzsks/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tpddzsks/test/node1/conf'}
18:14:01,536 ccm INFO node1: using Java 8 for the current invocation
18:14:01,705 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tpddzsks/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tpddzsks/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:14:01,706 ccm INFO node1: using Java 8 for the current invocation
18:14:01,796 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:14:02,62 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tpddzsks/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tpddzsks/test/node2/conf'}
18:14:02,63 ccm INFO node2: using Java 8 for the current invocation
18:14:02,234 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tpddzsks/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tpddzsks/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:14:02,235 ccm INFO node2: using Java 8 for the current invocation
18:14:02,320 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:14:02,580 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tpddzsks/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tpddzsks/test/node3/conf'}
18:14:02,581 ccm INFO node3: using Java 8 for the current invocation
18:14:02,745 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tpddzsks/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tpddzsks/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:14:02,746 ccm INFO node3: using Java 8 for the current invocation
18:14:02,823 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:14:25,602 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:14:25,603 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:14:31,335 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:14:33,742 conftest ERROR Unexpected error in node1 log, error: 
ERROR [Messaging-EventLoop-3-9] 2022-01-30 18:14:32,866 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.1:7000-SMALL_MESSAGES-26134543 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:14:33,748 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:14:29,395 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 35.74 seconds ======================
[msx] rc = 1
v1v2 running time = 57168650694
---> v1v2 test failed.
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:15:32,730 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 39.11 seconds ===========================
[msx] rc = 0
v1v1 running time = 60490788439
cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:16:31,762 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:16:34,305 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:16:15,526 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10665 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:16:34,318 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:16:26,798 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [MigrationStage:1] 2022-01-30 18:16:26,798 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:16:33,410 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:16:33,433 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:16:26,798 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
18:15:58,10 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:15:57,10 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:15:57.010749
18:15:57,918 dtest_setup INFO cluster ccm directory: /tmp/dtest-1ozekyof
------------------------------ Captured log call -------------------------------
18:16:00,8 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1ozekyof/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1ozekyof/test/node1/conf'}
18:16:00,8 ccm INFO node1: using Java 8 for the current invocation
18:16:00,380 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1ozekyof/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1ozekyof/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:16:00,380 ccm INFO node1: using Java 8 for the current invocation
18:16:00,552 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:16:00,983 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1ozekyof/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1ozekyof/test/node2/conf'}
18:16:00,984 ccm INFO node2: using Java 8 for the current invocation
18:16:01,256 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1ozekyof/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1ozekyof/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:16:01,256 ccm INFO node2: using Java 8 for the current invocation
18:16:01,359 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:16:01,708 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1ozekyof/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1ozekyof/test/node3/conf'}
18:16:01,708 ccm INFO node3: using Java 8 for the current invocation
18:16:01,921 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1ozekyof/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1ozekyof/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:16:01,922 ccm INFO node3: using Java 8 for the current invocation
18:16:02,51 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:16:25,855 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:16:25,856 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:16:31,762 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:16:34,305 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:16:15,526 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10665 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:16:34,318 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:16:26,798 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 40.64 seconds ======================
[msx] rc = 1
v2v2 running time = 62102352607
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:17:34,988 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:17:37,335 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:17:19,052 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10665 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:17:37,338 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:17:32,976 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [MigrationStage:1] 2022-01-30 18:17:32,976 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:17:32,987 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:17:32,976 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
8:17:00,286 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:16:59,154 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:16:59.154911
18:17:00,163 dtest_setup INFO cluster ccm directory: /tmp/dtest-5ve21a5m
------------------------------ Captured log call -------------------------------
18:17:01,841 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5ve21a5m/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5ve21a5m/test/node1/conf'}
18:17:01,841 ccm INFO node1: using Java 8 for the current invocation
18:17:02,28 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5ve21a5m/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5ve21a5m/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:17:02,29 ccm INFO node1: using Java 8 for the current invocation
18:17:02,106 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:17:02,347 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5ve21a5m/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5ve21a5m/test/node2/conf'}
18:17:02,348 ccm INFO node2: using Java 8 for the current invocation
18:17:02,511 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5ve21a5m/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5ve21a5m/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:17:02,512 ccm INFO node2: using Java 8 for the current invocation
18:17:02,596 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:17:02,841 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5ve21a5m/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5ve21a5m/test/node3/conf'}
18:17:02,842 ccm INFO node3: using Java 8 for the current invocation
18:17:03,7 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5ve21a5m/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5ve21a5m/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:17:03,8 ccm INFO node3: using Java 8 for the current invocation
18:17:03,88 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:17:28,872 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:17:28,874 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:17:34,988 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:17:37,335 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:17:19,052 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10665 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:17:37,338 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:17:32,976 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 39.54 seconds ======================
[msx] rc = 1
v1v2 running time = 60981350506
---> v1v2 test failed.
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:18:32,633 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 36.04 seconds ===========================
[msx] rc = 0
v1v1 running time = 57461125210
cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:19:29,180 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:19:31,718 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:19:24,825 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:19:31,720 conftest ERROR Unexpected error in node2 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:19:27,620 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 37.49 seconds ===========================
[msx] rc = 0
v2v2 running time = 58906601377
---> v1v1 and v2v2 test test suceeded.
cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:20:31,673 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:20:33,893 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:20:15,118 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10665 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:20:33,896 conftest ERROR Unexpected error in node3 log, error: 
ERROR [Messaging-EventLoop-3-12] 2022-01-30 18:20:33,240 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-3261d2b5 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [Messaging-EventLoop-3-12] 2022-01-30 18:20:33,240 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-3261d2b5 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [Messaging-EventLoop-3-12] 2022-01-30 18:20:33,240 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-3261d2b5 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
18:19:57,313 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:19:56,358 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:19:56.358559
18:19:57,218 dtest_setup INFO cluster ccm directory: /tmp/dtest-ohju825p
------------------------------ Captured log call -------------------------------
18:19:58,856 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ohju825p/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ohju825p/test/node1/conf'}
18:19:58,858 ccm INFO node1: using Java 8 for the current invocation
18:19:59,32 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ohju825p/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ohju825p/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:19:59,33 ccm INFO node1: using Java 8 for the current invocation
18:19:59,115 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:19:59,390 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ohju825p/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ohju825p/test/node2/conf'}
18:19:59,391 ccm INFO node2: using Java 8 for the current invocation
18:19:59,714 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ohju825p/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ohju825p/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:19:59,757 ccm INFO node2: using Java 8 for the current invocation
18:19:59,844 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:20:00,244 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ohju825p/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ohju825p/test/node3/conf'}
18:20:00,245 ccm INFO node3: using Java 8 for the current invocation
18:20:00,472 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ohju825p/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ohju825p/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:20:00,473 ccm INFO node3: using Java 8 for the current invocation
18:20:00,575 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:20:25,375 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:20:25,378 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:20:31,673 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:20:33,893 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:20:15,118 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10665 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:20:33,896 conftest ERROR Unexpected error in node3 log, error: 
ERROR [Messaging-EventLoop-3-12] 2022-01-30 18:20:33,240 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-3261d2b5 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 38.87 seconds ======================
[msx] rc = 1
v1v2 running time = 60187278864
---> v1v2 test failed.
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:21:30,796 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 37.30 seconds ===========================
[msx] rc = 0
v1v1 running time = 58681966876
cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:22:28,192 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:22:30,499 conftest ERROR Unexpected error in node2 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:22:26,450 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:22:30,502 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:22:29,812 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [MigrationStage:1] 2022-01-30 18:22:29,812 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:22:29,833 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:22:29,812 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
18:21:56,202 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:21:55,302 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:21:55.302063
18:21:56,110 dtest_setup INFO cluster ccm directory: /tmp/dtest-6mv95va9
------------------------------ Captured log call -------------------------------
18:21:57,699 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mv95va9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mv95va9/test/node1/conf'}
18:21:57,699 ccm INFO node1: using Java 8 for the current invocation
18:21:57,853 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mv95va9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mv95va9/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:21:57,854 ccm INFO node1: using Java 8 for the current invocation
18:21:57,936 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:21:58,194 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mv95va9/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mv95va9/test/node2/conf'}
18:21:58,195 ccm INFO node2: using Java 8 for the current invocation
18:21:58,356 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mv95va9/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mv95va9/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:21:58,356 ccm INFO node2: using Java 8 for the current invocation
18:21:58,431 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:21:58,688 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mv95va9/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mv95va9/test/node3/conf'}
18:21:58,688 ccm INFO node3: using Java 8 for the current invocation
18:21:58,879 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6mv95va9/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6mv95va9/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:21:58,880 ccm INFO node3: using Java 8 for the current invocation
18:21:58,960 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:22:21,739 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:22:21,741 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:22:28,192 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:22:30,499 conftest ERROR Unexpected error in node2 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:22:26,450 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:22:30,502 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:22:29,812 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 36.49 seconds ======================
[msx] rc = 1
v2v2 running time = 57907716153
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:23:26,899 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:23:28,828 conftest ERROR Unexpected error in node1 log, error: 
ERROR [Messaging-EventLoop-3-9] 2022-01-30 18:23:25,278 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.1:7000-SMALL_MESSAGES-aaee1c56 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:23:28,831 conftest ERROR Unexpected error in node3 log, error: 
ERROR [Messaging-EventLoop-3-11] 2022-01-30 18:23:25,336 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-7b883b0f unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [Messaging-EventLoop-3-11] 2022-01-30 18:23:25,336 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-7b883b0f unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [Messaging-EventLoop-3-11] 2022-01-30 18:23:25,336 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-7b883b0f unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
18:22:53,999 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:22:53,180 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:22:53.180490
18:22:53,890 dtest_setup INFO cluster ccm directory: /tmp/dtest-7udrpbgk
------------------------------ Captured log call -------------------------------
18:22:55,558 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7udrpbgk/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7udrpbgk/test/node1/conf'}
18:22:55,559 ccm INFO node1: using Java 8 for the current invocation
18:22:55,729 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7udrpbgk/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7udrpbgk/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:22:55,730 ccm INFO node1: using Java 8 for the current invocation
18:22:55,806 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:22:56,52 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7udrpbgk/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7udrpbgk/test/node2/conf'}
18:22:56,53 ccm INFO node2: using Java 8 for the current invocation
18:22:56,247 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7udrpbgk/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7udrpbgk/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:22:56,247 ccm INFO node2: using Java 8 for the current invocation
18:22:56,325 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:22:56,579 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7udrpbgk/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7udrpbgk/test/node3/conf'}
18:22:56,580 ccm INFO node3: using Java 8 for the current invocation
18:22:56,760 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7udrpbgk/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7udrpbgk/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:22:56,760 ccm INFO node3: using Java 8 for the current invocation
18:22:56,853 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:23:21,626 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:23:21,628 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:23:26,899 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:23:28,828 conftest ERROR Unexpected error in node1 log, error: 
ERROR [Messaging-EventLoop-3-9] 2022-01-30 18:23:25,278 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.1:7000-SMALL_MESSAGES-aaee1c56 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:23:28,831 conftest ERROR Unexpected error in node3 log, error: 
ERROR [Messaging-EventLoop-3-11] 2022-01-30 18:23:25,336 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-7b883b0f unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 38.97 seconds ======================
[msx] rc = 1
v1v2 running time = 60330631311
---> v1v2 test failed.
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:24:27,590 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 38.04 seconds ===========================
[msx] rc = 0
v1v1 running time = 59480862583
cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:25:26,427 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:25:29,31 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:25:24,187 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:25:29,37 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:25:27,953 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [MigrationStage:1] 2022-01-30 18:25:27,953 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:25:27,967 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:25:27,953 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
8:24:53,928 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:24:53,126 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:24:53.126248
18:24:53,836 dtest_setup INFO cluster ccm directory: /tmp/dtest-cixpku_d
------------------------------ Captured log call -------------------------------
18:24:55,377 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cixpku_d/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cixpku_d/test/node1/conf'}
18:24:55,378 ccm INFO node1: using Java 8 for the current invocation
18:24:55,539 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cixpku_d/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cixpku_d/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:24:55,540 ccm INFO node1: using Java 8 for the current invocation
18:24:55,621 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:24:55,885 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cixpku_d/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cixpku_d/test/node2/conf'}
18:24:55,886 ccm INFO node2: using Java 8 for the current invocation
18:24:56,56 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cixpku_d/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cixpku_d/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:24:56,57 ccm INFO node2: using Java 8 for the current invocation
18:24:56,136 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:24:56,387 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cixpku_d/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cixpku_d/test/node3/conf'}
18:24:56,387 ccm INFO node3: using Java 8 for the current invocation
18:24:56,552 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-cixpku_d/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-cixpku_d/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:24:56,553 ccm INFO node3: using Java 8 for the current invocation
18:24:56,629 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:25:20,437 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:25:20,439 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:25:26,427 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:25:29,31 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:25:24,187 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:25:29,37 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:25:27,953 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 37.25 seconds ======================
[msx] rc = 1
v2v2 running time = 58764543980
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:26:25,168 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:26:27,737 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:26:19,666 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:26:27,740 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:26:23,283 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [MigrationStage:1] 2022-01-30 18:26:23,283 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:26:23,300 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:26:23,283 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
18:25:52,381 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:25:51,828 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:25:51.828634
18:25:52,287 dtest_setup INFO cluster ccm directory: /tmp/dtest-92naj4hh
------------------------------ Captured log call -------------------------------
18:25:53,708 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-92naj4hh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-92naj4hh/test/node1/conf'}
18:25:53,709 ccm INFO node1: using Java 8 for the current invocation
18:25:53,882 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-92naj4hh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-92naj4hh/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:25:53,882 ccm INFO node1: using Java 8 for the current invocation
18:25:53,968 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:25:54,223 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-92naj4hh/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-92naj4hh/test/node2/conf'}
18:25:54,224 ccm INFO node2: using Java 8 for the current invocation
18:25:54,384 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-92naj4hh/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-92naj4hh/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:25:54,385 ccm INFO node2: using Java 8 for the current invocation
18:25:54,467 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:25:54,712 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-92naj4hh/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-92naj4hh/test/node3/conf'}
18:25:54,713 ccm INFO node3: using Java 8 for the current invocation
18:25:54,874 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-92naj4hh/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-92naj4hh/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:25:54,875 ccm INFO node3: using Java 8 for the current invocation
18:25:54,956 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:26:18,735 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:26:18,737 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:26:25,168 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:26:27,737 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:26:19,666 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:26:27,740 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:26:23,283 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 37.27 seconds ======================
[msx] rc = 1
v1v2 running time = 58755768934
---> v1v2 test failed.
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:27:25,826 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 38.67 seconds ===========================
[msx] rc = 0
v1v1 running time = 60114197246
cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:28:28,883 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:28:31,677 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:28:12,054 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10665 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:28:31,680 conftest ERROR Unexpected error in node2 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:28:27,020 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11798 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:28:31,682 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:28:22,590 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [MigrationStage:1] 2022-01-30 18:28:22,590 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:28:30,697 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:28:30,743 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:28:22,590 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
18:27:51,703 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:27:50,740 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:27:50.740007
18:27:51,597 dtest_setup INFO cluster ccm directory: /tmp/dtest-2txm1zdy
------------------------------ Captured log call -------------------------------
18:27:53,299 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2txm1zdy/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2txm1zdy/test/node1/conf'}
18:27:53,300 ccm INFO node1: using Java 8 for the current invocation
18:27:53,467 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2txm1zdy/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2txm1zdy/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:27:53,468 ccm INFO node1: using Java 8 for the current invocation
18:27:53,550 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:27:53,796 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2txm1zdy/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2txm1zdy/test/node2/conf'}
18:27:53,797 ccm INFO node2: using Java 8 for the current invocation
18:27:53,957 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2txm1zdy/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2txm1zdy/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:27:53,958 ccm INFO node2: using Java 8 for the current invocation
18:27:54,38 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:27:54,296 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2txm1zdy/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2txm1zdy/test/node3/conf'}
18:27:54,297 ccm INFO node3: using Java 8 for the current invocation
18:27:54,480 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2txm1zdy/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2txm1zdy/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:27:54,480 ccm INFO node3: using Java 8 for the current invocation
18:27:54,570 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:28:21,372 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:28:21,375 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:28:28,883 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:28:31,677 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:28:12,054 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10665 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:28:31,680 conftest ERROR Unexpected error in node2 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:28:27,020 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11798 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:28:31,682 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:28:22,590 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 42.27 seconds ======================
[msx] rc = 1
v2v2 running time = 63745805956
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:29:27,746 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:29:30,379 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:29:22,327 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:29:30,382 conftest ERROR Unexpected error in node3 log, error: 
ERROR [Messaging-EventLoop-3-11] 2022-01-30 18:29:25,579 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-254bc6e8 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [Messaging-EventLoop-3-11] 2022-01-30 18:29:25,579 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-254bc6e8 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [Messaging-EventLoop-3-11] 2022-01-30 18:29:25,579 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-254bc6e8 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
18:28:55,688 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:28:54,519 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:28:54.519745
18:28:55,579 dtest_setup INFO cluster ccm directory: /tmp/dtest-23jldfjv
------------------------------ Captured log call -------------------------------
18:28:57,275 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-23jldfjv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-23jldfjv/test/node1/conf'}
18:28:57,276 ccm INFO node1: using Java 8 for the current invocation
18:28:57,442 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-23jldfjv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-23jldfjv/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:28:57,443 ccm INFO node1: using Java 8 for the current invocation
18:28:57,526 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:28:57,769 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-23jldfjv/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-23jldfjv/test/node2/conf'}
18:28:57,770 ccm INFO node2: using Java 8 for the current invocation
18:28:57,942 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-23jldfjv/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-23jldfjv/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:28:57,942 ccm INFO node2: using Java 8 for the current invocation
18:28:58,23 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:28:58,288 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-23jldfjv/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-23jldfjv/test/node3/conf'}
18:28:58,289 ccm INFO node3: using Java 8 for the current invocation
18:28:58,483 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-23jldfjv/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-23jldfjv/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:28:58,484 ccm INFO node3: using Java 8 for the current invocation
18:28:58,560 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:29:21,344 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:29:21,346 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:29:27,746 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:29:30,379 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:29:22,327 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:29:30,382 conftest ERROR Unexpected error in node3 log, error: 
ERROR [Messaging-EventLoop-3-11] 2022-01-30 18:29:25,579 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-254bc6e8 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 39.26 seconds ======================
[msx] rc = 1
v1v2 running time = 60678081718
---> v1v2 test failed.
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:30:29,856 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 38.16 seconds ===========================
[msx] rc = 0
v1v1 running time = 59560982018
cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:31:32,82 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:31:35,42 conftest ERROR Unexpected error in node1 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:31:29,661 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11798 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:31:35,45 conftest ERROR Unexpected error in node2 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:31:24,606 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 43.70 seconds ===========================
[msx] rc = 0
v2v2 running time = 65114413689
---> v1v1 and v2v2 test test suceeded.
cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:32:36,444 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:32:39,614 conftest ERROR Unexpected error in node1 log, error: 
ERROR [Messaging-EventLoop-3-10] 2022-01-30 18:32:34,781 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.1:7000-SMALL_MESSAGES-743f9568 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:32:39,619 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:32:30,793 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [MigrationStage:1] 2022-01-30 18:32:30,793 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:32:30,805 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [Messaging-EventLoop-3-11] 2022-01-30 18:32:34,769 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.3:7000-SMALL_MESSAGES-5baa0df1 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:32:38,225 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:32:38,245 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:32:30,793 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
18:32:00,982 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:31:59,910 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:31:59.910754
18:32:00,867 dtest_setup INFO cluster ccm directory: /tmp/dtest-1uxjpu47
------------------------------ Captured log call -------------------------------
18:32:03,186 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1uxjpu47/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1uxjpu47/test/node1/conf'}
18:32:03,187 ccm INFO node1: using Java 8 for the current invocation
18:32:03,398 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1uxjpu47/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1uxjpu47/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:32:03,398 ccm INFO node1: using Java 8 for the current invocation
18:32:03,508 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:32:03,940 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1uxjpu47/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1uxjpu47/test/node2/conf'}
18:32:03,941 ccm INFO node2: using Java 8 for the current invocation
18:32:04,219 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1uxjpu47/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1uxjpu47/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:32:04,219 ccm INFO node2: using Java 8 for the current invocation
18:32:04,316 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:32:04,673 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1uxjpu47/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1uxjpu47/test/node3/conf'}
18:32:04,673 ccm INFO node3: using Java 8 for the current invocation
18:32:04,874 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1uxjpu47/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1uxjpu47/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:32:04,874 ccm INFO node3: using Java 8 for the current invocation
18:32:05,10 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:32:29,824 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:32:29,827 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:32:36,444 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:32:39,614 conftest ERROR Unexpected error in node1 log, error: 
ERROR [Messaging-EventLoop-3-10] 2022-01-30 18:32:34,781 InboundMessageHandler.java:300 - /127.0.0.2:7000->/127.0.0.1:7000-SMALL_MESSAGES-743f9568 unexpected exception caught while processing inbound messages; terminating connection
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11797 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.Message$Serializer.inferMessageSize(Message.java:657)
	at org.apache.cassandra.net.InboundMessageHandler.processOneContainedMessage(InboundMessageHandler.java:130)
	at org.apache.cassandra.net.AbstractMessageHandler.processFrameOfContainedMessages(AbstractMessageHandler.java:242)
	at org.apache.cassandra.net.AbstractMessageHandler.processIntactFrame(AbstractMessageHandler.java:227)
	at org.apache.cassandra.net.AbstractMessageHandler.process(AbstractMessageHandler.java:218)
	at org.apache.cassandra.net.FrameDecoder.deliver(FrameDecoder.java:321)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:285)
	at org.apache.cassandra.net.FrameDecoder.channelRead(FrameDecoder.java:269)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:357)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:379)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:365)
	at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)
	at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:795)
	at io.netty.channel.epoll.AbstractEpollChannel$AbstractEpollUnsafe$1.run(AbstractEpollChannel.java:388)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:384)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:32:39,619 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:32:30,793 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 43.09 seconds ======================
[msx] rc = 1
v1v2 running time = 64552748328
---> v1v2 test failed.
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:33:39,410 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 39.28 seconds ===========================
[msx] rc = 0
v1v1 running time = 60680856491
cassandra materialized_views_test.py::TestMaterializedViews::test_secondary_index false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is materialized_views_test.py::TestMaterializedViews::test_secondary_index
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

materialized_views_test.py::TestMaterializedViews::test_secondary_index 
-------------------------------- live log call ---------------------------------
18:34:47,675 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
PASSED                                                                   [100%]
------------------------------ live log teardown -------------------------------
18:34:50,854 conftest ERROR Unexpected error in node2 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:34:45,739 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11798 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:34:50,858 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:34:40,932 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

materialized_views_test.py::TestMaterializedViews::test_secondary_index ERROR [100%]

==================================== ERRORS ====================================
_______ ERROR at teardown of TestMaterializedViews.test_secondary_index ________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [MigrationStage:1] 2022-01-30 18:34:40,932 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:34:40,950 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:34:49,091 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:34:49,120 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 12832 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [MigrationStage:1] 2022-01-30 18:34:40,932 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
18:34:06,160 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
18:34:05,40 conftest INFO Starting execution of test_secondary_index at 2022-01-30 18:34:05.040756
18:34:06,49 dtest_setup INFO cluster ccm directory: /tmp/dtest-k7ao_k5_
------------------------------ Captured log call -------------------------------
18:34:07,974 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k7ao_k5_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k7ao_k5_/test/node1/conf'}
18:34:07,975 ccm INFO node1: using Java 8 for the current invocation
18:34:08,150 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k7ao_k5_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k7ao_k5_/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
18:34:08,150 ccm INFO node1: using Java 8 for the current invocation
18:34:08,249 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:34:08,552 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k7ao_k5_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k7ao_k5_/test/node2/conf'}
18:34:08,552 ccm INFO node2: using Java 8 for the current invocation
18:34:08,746 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k7ao_k5_/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k7ao_k5_/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:34:08,747 ccm INFO node2: using Java 8 for the current invocation
18:34:08,837 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:34:09,105 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k7ao_k5_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k7ao_k5_/test/node3/conf'}
18:34:09,106 ccm INFO node3: using Java 8 for the current invocation
18:34:09,272 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '42eabfac3c6d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'materialized_views_test.py::TestMaterializedViews::()::test_secondary_index (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k7ao_k5_/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k7ao_k5_/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
18:34:09,272 ccm INFO node3: using Java 8 for the current invocation
18:34:09,366 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
18:34:39,149 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 dc1> discovered
18:34:39,151 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 dc1> discovered
18:34:47,675 cassandra.protocol WARNING Server warning: Materialized views are experimental and are not recommended for production use.
---------------------------- Captured log teardown -----------------------------
18:34:50,854 conftest ERROR Unexpected error in node2 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:34:45,739 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 11798 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
18:34:50,858 conftest ERROR Unexpected error in node3 log, error: 
ERROR [MigrationStage:1] 2022-01-30 18:34:40,932 CassandraDaemon.java:581 - Exception in thread Thread[MigrationStage:1,5,main]
org.apache.cassandra.net.Message$OversizedMessageException: Message of size 10818 bytes exceeds allowed maximum of 4096 bytes
	at org.apache.cassandra.net.OutboundConnection.enqueue(OutboundConnection.java:328)
	at org.apache.cassandra.net.OutboundConnections.enqueue(OutboundConnections.java:84)
	at org.apache.cassandra.net.MessagingService.doSend(MessagingService.java:338)
	at org.apache.cassandra.net.OutboundSink.accept(OutboundSink.java:70)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:327)
	at org.apache.cassandra.net.MessagingService.send(MessagingService.java:314)
	at org.apache.cassandra.schema.SchemaPullVerbHandler.doVerb(SchemaPullVerbHandler.java:45)
	at org.apache.cassandra.net.InboundSink.lambda$new$0(InboundSink.java:78)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:97)
	at org.apache.cassandra.net.InboundSink.accept(InboundSink.java:45)
	at org.apache.cassandra.net.InboundMessageHandler$ProcessMessage.run(InboundMessageHandler.java:432)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
===Flaky Test Report===

test_secondary_index passed 1 out of the required 1 times. Success!

===End Flaky Test Report===
====================== 1 passed, 1 error in 49.17 seconds ======================
[msx] rc = 1
v2v2 running time = 70546532881
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: materialized_views_test.py::TestMaterializedViews::test_secondary_index
h_list: internode_application_send_queue_reserve_endpoint_capacity_in_bytes@@@CassandraDaemon@@@-1@@@134217728@@@4096
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

early stop after 7 is satisfied
v1v2 failed with probability 10 out of 10
v1v1v2v2 failed with probability 7 out of 10
Total execution time in seconds : 1814
0
