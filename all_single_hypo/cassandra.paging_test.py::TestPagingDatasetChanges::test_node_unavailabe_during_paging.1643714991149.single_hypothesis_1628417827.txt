my_type=hypothesis
proj=cassandra
u_test=paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list[1]=phi_convict_threshold@@@CassandraDaemon@@@-3@@@6@@@5.0
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: phi_convict_threshold@@@CassandraDaemon@@@-3@@@6@@@5.0
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
11:37:41,293 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
11:37:41,296 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
11:37:44,699 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:37:44,700 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:37:45,905 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.12 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 63.63 seconds ===========================
[msx] rc = 0
v1v2 running time = 85404907229
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
11:39:04,888 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:39:05,906 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.08 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:39:08,112 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.84 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
11:40:10,911 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 44

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f26d7bc0828>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f26bf0382e8>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
11:38:09,927 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:38:08,578 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 11:38:08.578333
11:38:09,837 dtest_setup INFO cluster ccm directory: /tmp/dtest-p7jp0s21
----------------------------- Captured stdout call -----------------------------

11:38:09,929 ccm DEBUG using balanced tokens for non-vnode cluster
11:38:11,731 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p7jp0s21/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p7jp0s21/test/node1/conf'}
11:38:11,732 ccm INFO node1: using Java 8 for the current invocation
11:38:11,908 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p7jp0s21/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p7jp0s21/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:38:11,909 ccm INFO node1: using Java 8 for the current invocation
11:38:11,999 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:38:12,278 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p7jp0s21/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p7jp0s21/test/node2/conf'}
11:38:12,279 ccm INFO node2: using Java 8 for the current invocation
11:38:12,464 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p7jp0s21/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p7jp0s21/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:38:12,464 ccm INFO node2: using Java 8 for the current invocation
11:38:12,559 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:38:12,833 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p7jp0s21/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p7jp0s21/test/node3/conf'}
11:38:12,834 ccm INFO node3: using Java 8 for the current invocation
11:38:13,3 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p7jp0s21/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p7jp0s21/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:38:13,4 ccm INFO node3: using Java 8 for the current invocation
11:38:13,111 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:38:11,731 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p7jp0s21/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p7jp0s21/test/node1/conf'}
11:38:11,732 ccm INFO node1: using Java 8 for the current invocation
11:38:11,908 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p7jp0s21/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p7jp0s21/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:38:11,909 ccm INFO node1: using Java 8 for the current invocation
11:38:11,999 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:38:12,278 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p7jp0s21/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p7jp0s21/test/node2/conf'}
11:38:12,279 ccm INFO node2: using Java 8 for the current invocation
11:38:12,464 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p7jp0s21/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p7jp0s21/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:38:12,464 ccm INFO node2: using Java 8 for the current invocation
11:38:12,559 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:38:12,833 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p7jp0s21/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p7jp0s21/test/node3/conf'}
11:38:12,834 ccm INFO node3: using Java 8 for the current invocation
11:38:13,3 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p7jp0s21/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p7jp0s21/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:38:13,4 ccm INFO node3: using Java 8 for the current invocation
11:38:13,111 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:38:39,861 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
11:38:39,863 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
11:39:08,635 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
1:39:13,409 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:39:11,977 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 11:39:11.977528
11:39:13,294 dtest_setup INFO cluster ccm directory: /tmp/dtest-_k_2nmnv
----------------------------- Captured stdout call -----------------------------
11:39:13,411 ccm DEBUG using balanced tokens for non-vnode cluster
11:39:14,970 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_k_2nmnv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_k_2nmnv/test/node1/conf'}
11:39:14,972 ccm INFO node1: using Java 8 for the current invocation
11:39:15,144 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_k_2nmnv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_k_2nmnv/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:39:15,145 ccm INFO node1: using Java 8 for the current invocation
11:39:15,222 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:39:15,480 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_k_2nmnv/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_k_2nmnv/test/node2/conf'}
11:39:15,480 ccm INFO node2: using Java 8 for the current invocation
11:39:15,672 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_k_2nmnv/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_k_2nmnv/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:39:15,672 ccm INFO node2: using Java 8 for the current invocation
11:39:15,762 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:39:16,25 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_k_2nmnv/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_k_2nmnv/test/node3/conf'}
11:39:16,25 ccm INFO node3: using Java 8 for the current invocation
11:39:16,208 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_k_2nmnv/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_k_2nmnv/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:39:16,208 ccm INFO node3: using Java 8 for the current invocation
11:39:16,292 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:39:14,970 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_k_2nmnv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_k_2nmnv/test/node1/conf'}
11:39:14,972 ccm INFO node1: using Java 8 for the current invocation
11:39:15,144 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_k_2nmnv/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_k_2nmnv/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:39:15,145 ccm INFO node1: using Java 8 for the current invocation
11:39:15,222 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:39:15,480 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_k_2nmnv/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_k_2nmnv/test/node2/conf'}
11:39:15,480 ccm INFO node2: using Java 8 for the current invocation
11:39:15,672 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_k_2nmnv/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_k_2nmnv/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:39:15,672 ccm INFO node2: using Java 8 for the current invocation
11:39:15,762 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:39:16,25 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_k_2nmnv/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_k_2nmnv/test/node3/conf'}
11:39:16,25 ccm INFO node3: using Java 8 for the current invocation
11:39:16,208 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_k_2nmnv/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_k_2nmnv/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:39:16,208 ccm INFO node3: using Java 8 for the current invocation
11:39:16,292 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:39:45,82 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
11:39:45,83 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
11:39:08,635 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:39:08,635 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]11:40:11,285 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 123.39 seconds ==========================
[msx] rc = 1
v1v1 running time = 145016105211
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
11:41:33,970 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
11:41:33,972 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
11:41:36,369 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:41:37,474 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.98 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 66.05 seconds ===========================
[msx] rc = 0
v2v2 running time = 87666620441
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: phi_convict_threshold@@@CassandraDaemon@@@-3@@@6@@@5.0
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
11:42:53,531 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:42:54,555 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.96 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:42:56,563 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.24 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
11:43:55,246 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 28

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7fcc5ca13320>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7fcc43fd6358>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
11:42:03,268 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:42:01,354 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 11:42:01.354920
11:42:03,165 dtest_setup INFO cluster ccm directory: /tmp/dtest-ttl8upcm
------------------------------ Captured log call -------------------------------
11:42:04,679 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ttl8upcm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ttl8upcm/test/node1/conf'}
11:42:04,680 ccm INFO node1: using Java 8 for the current invocation
11:42:04,853 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ttl8upcm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ttl8upcm/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:42:04,853 ccm INFO node1: using Java 8 for the current invocation
11:42:04,934 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:42:05,212 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ttl8upcm/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ttl8upcm/test/node2/conf'}
11:42:05,213 ccm INFO node2: using Java 8 for the current invocation
11:42:05,382 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ttl8upcm/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ttl8upcm/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:42:05,383 ccm INFO node2: using Java 8 for the current invocation
11:42:05,468 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:42:05,758 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ttl8upcm/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ttl8upcm/test/node3/conf'}
11:42:05,759 ccm INFO node3: using Java 8 for the current invocation
11:42:05,934 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ttl8upcm/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ttl8upcm/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:42:05,935 ccm INFO node3: using Java 8 for the current invocation
11:42:06,16 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:42:28,769 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
11:42:28,770 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
11:42:57,7 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:43:01,728 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:43:00,263 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 11:43:00.263350
11:43:01,632 dtest_setup INFO cluster ccm directory: /tmp/dtest-r2uz4hyy
------------------------------ Captured log call -------------------------------
11:43:03,245 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r2uz4hyy/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r2uz4hyy/test/node1/conf'}
11:43:03,247 ccm INFO node1: using Java 8 for the current invocation
11:43:03,445 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r2uz4hyy/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r2uz4hyy/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:43:03,446 ccm INFO node1: using Java 8 for the current invocation
11:43:03,538 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:43:03,826 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r2uz4hyy/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r2uz4hyy/test/node2/conf'}
11:43:03,826 ccm INFO node2: using Java 8 for the current invocation
11:43:04,6 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r2uz4hyy/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r2uz4hyy/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:43:04,6 ccm INFO node2: using Java 8 for the current invocation
11:43:04,89 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:43:04,383 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r2uz4hyy/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r2uz4hyy/test/node3/conf'}
11:43:04,384 ccm INFO node3: using Java 8 for the current invocation
11:43:04,564 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-r2uz4hyy/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-r2uz4hyy/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:43:04,565 ccm INFO node3: using Java 8 for the current invocation
11:43:04,654 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:43:28,428 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
11:43:28,430 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
11:42:57,7 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:42:57,7 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]11:43:55,660 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 115.03 seconds ==========================
[msx] rc = 1
v1v2 running time = 136708044362
---> v1v2 test failed.
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: phi_convict_threshold@@@CassandraDaemon@@@-3@@@6@@@5.0
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
11:45:14,455 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
11:45:14,457 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 62.08 seconds ===========================
[msx] rc = 0
v1v1 running time = 83706571656
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
11:46:38,542 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:46:39,664 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.86 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
11:47:39,458 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 80

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f7a8977edd8>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f7a79ba6f28>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
1:45:43,542 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:45:41,761 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 11:45:41.761578
11:45:43,422 dtest_setup INFO cluster ccm directory: /tmp/dtest-nu9h35dk
------------------------------ Captured log call -------------------------------
11:45:45,136 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nu9h35dk/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nu9h35dk/test/node1/conf'}
11:45:45,138 ccm INFO node1: using Java 8 for the current invocation
11:45:45,306 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nu9h35dk/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nu9h35dk/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:45:45,306 ccm INFO node1: using Java 8 for the current invocation
11:45:45,394 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:45:45,650 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nu9h35dk/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nu9h35dk/test/node2/conf'}
11:45:45,650 ccm INFO node2: using Java 8 for the current invocation
11:45:45,818 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nu9h35dk/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nu9h35dk/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:45:45,818 ccm INFO node2: using Java 8 for the current invocation
11:45:45,897 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:45:46,175 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nu9h35dk/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nu9h35dk/test/node3/conf'}
11:45:46,176 ccm INFO node3: using Java 8 for the current invocation
11:45:46,360 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nu9h35dk/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nu9h35dk/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:45:46,360 ccm INFO node3: using Java 8 for the current invocation
11:45:46,446 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:46:12,236 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
11:46:12,239 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
11:46:41,747 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:46:45,864 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:46:44,885 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 11:46:44.884972
11:46:45,746 dtest_setup INFO cluster ccm directory: /tmp/dtest-aaae9igk
----------------------------- Captured stdout call -----------------------------
11:46:45,868 ccm DEBUG using balanced tokens for non-vnode cluster
11:46:47,381 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-aaae9igk/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-aaae9igk/test/node1/conf'}
11:46:47,382 ccm INFO node1: using Java 8 for the current invocation
11:46:47,558 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-aaae9igk/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-aaae9igk/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:46:47,559 ccm INFO node1: using Java 8 for the current invocation
11:46:47,642 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:46:47,909 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-aaae9igk/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-aaae9igk/test/node2/conf'}
11:46:47,910 ccm INFO node2: using Java 8 for the current invocation
11:46:48,75 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-aaae9igk/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-aaae9igk/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:46:48,75 ccm INFO node2: using Java 8 for the current invocation
11:46:48,161 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:46:48,435 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-aaae9igk/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-aaae9igk/test/node3/conf'}
11:46:48,436 ccm INFO node3: using Java 8 for the current invocation
11:46:48,621 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-aaae9igk/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-aaae9igk/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:46:48,622 ccm INFO node3: using Java 8 for the current invocation
11:46:48,697 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:46:47,381 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-aaae9igk/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-aaae9igk/test/node1/conf'}
11:46:47,382 ccm INFO node1: using Java 8 for the current invocation
11:46:47,558 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-aaae9igk/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-aaae9igk/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:46:47,559 ccm INFO node1: using Java 8 for the current invocation
11:46:47,642 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:46:47,909 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-aaae9igk/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-aaae9igk/test/node2/conf'}
11:46:47,910 ccm INFO node2: using Java 8 for the current invocation
11:46:48,75 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-aaae9igk/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-aaae9igk/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:46:48,75 ccm INFO node2: using Java 8 for the current invocation
11:46:48,161 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:46:48,435 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-aaae9igk/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-aaae9igk/test/node3/conf'}
11:46:48,436 ccm INFO node3: using Java 8 for the current invocation
11:46:48,621 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-aaae9igk/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-aaae9igk/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:46:48,622 ccm INFO node3: using Java 8 for the current invocation
11:46:48,697 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:47:14,445 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
11:47:14,445 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
11:46:41,747 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:46:41,747 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]11:47:39,861 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 118.85 seconds ==========================
[msx] rc = 1
v2v2 running time = 140480444590
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: phi_convict_threshold@@@CassandraDaemon@@@-3@@@6@@@5.0
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
11:48:57,502 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
11:48:57,505 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 60.93 seconds ===========================
[msx] rc = 0
v1v2 running time = 82524251751
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
11:50:20,180 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
11:50:20,182 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
11:50:24,14 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 61.03 seconds ===========================
[msx] rc = 0
v1v1 running time = 82708249265
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
11:51:40,717 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:51:41,738 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.26 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:51:44,46 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.72 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
11:52:42,366 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 15

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f04dd0ec668>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f04d4c01208>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
11:50:49,232 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:50:47,622 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 11:50:47.622315
11:50:49,132 dtest_setup INFO cluster ccm directory: /tmp/dtest-55b5gr17
----------------------------- Captured stdout call -----------------------------
11:50:49,235 ccm DEBUG using balanced tokens for non-vnode cluster
11:50:50,742 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-55b5gr17/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-55b5gr17/test/node1/conf'}
11:50:50,743 ccm INFO node1: using Java 8 for the current invocation
11:50:50,909 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-55b5gr17/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-55b5gr17/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:50:50,910 ccm INFO node1: using Java 8 for the current invocation
11:50:50,986 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:50:51,233 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-55b5gr17/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-55b5gr17/test/node2/conf'}
11:50:51,234 ccm INFO node2: using Java 8 for the current invocation
11:50:51,405 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-55b5gr17/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-55b5gr17/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:50:51,406 ccm INFO node2: using Java 8 for the current invocation
11:50:51,489 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:50:51,759 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-55b5gr17/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-55b5gr17/test/node3/conf'}
11:50:51,761 ccm INFO node3: using Java 8 for the current invocation
11:50:51,922 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-55b5gr17/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-55b5gr17/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:50:51,923 ccm INFO node3: using Java 8 for the current invocation
11:50:52,1 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:50:50,742 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-55b5gr17/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-55b5gr17/test/node1/conf'}
11:50:50,743 ccm INFO node1: using Java 8 for the current invocation
11:50:50,909 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-55b5gr17/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-55b5gr17/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:50:50,910 ccm INFO node1: using Java 8 for the current invocation
11:50:50,986 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:50:51,233 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-55b5gr17/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-55b5gr17/test/node2/conf'}
11:50:51,234 ccm INFO node2: using Java 8 for the current invocation
11:50:51,405 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-55b5gr17/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-55b5gr17/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:50:51,406 ccm INFO node2: using Java 8 for the current invocation
11:50:51,489 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:50:51,759 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-55b5gr17/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-55b5gr17/test/node3/conf'}
11:50:51,761 ccm INFO node3: using Java 8 for the current invocation
11:50:51,922 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-55b5gr17/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-55b5gr17/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:50:51,923 ccm INFO node3: using Java 8 for the current invocation
11:50:52,1 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:51:15,757 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
11:51:15,759 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
11:51:45,295 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
1:51:49,909 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:51:48,634 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 11:51:48.634088
11:51:49,790 dtest_setup INFO cluster ccm directory: /tmp/dtest-jez24h5o
----------------------------- Captured stdout call -----------------------------
11:51:49,911 ccm DEBUG using balanced tokens for non-vnode cluster
11:51:51,528 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-jez24h5o/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-jez24h5o/test/node1/conf'}
11:51:51,528 ccm INFO node1: using Java 8 for the current invocation
11:51:51,698 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-jez24h5o/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-jez24h5o/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:51:51,699 ccm INFO node1: using Java 8 for the current invocation
11:51:51,784 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:51:52,38 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-jez24h5o/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-jez24h5o/test/node2/conf'}
11:51:52,38 ccm INFO node2: using Java 8 for the current invocation
11:51:52,225 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-jez24h5o/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-jez24h5o/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:51:52,226 ccm INFO node2: using Java 8 for the current invocation
11:51:52,307 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:51:52,575 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-jez24h5o/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-jez24h5o/test/node3/conf'}
11:51:52,576 ccm INFO node3: using Java 8 for the current invocation
11:51:52,745 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-jez24h5o/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-jez24h5o/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:51:52,745 ccm INFO node3: using Java 8 for the current invocation
11:51:52,831 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:51:51,528 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-jez24h5o/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-jez24h5o/test/node1/conf'}
11:51:51,528 ccm INFO node1: using Java 8 for the current invocation
11:51:51,698 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-jez24h5o/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-jez24h5o/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:51:51,699 ccm INFO node1: using Java 8 for the current invocation
11:51:51,784 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:51:52,38 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-jez24h5o/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-jez24h5o/test/node2/conf'}
11:51:52,38 ccm INFO node2: using Java 8 for the current invocation
11:51:52,225 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-jez24h5o/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-jez24h5o/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:51:52,226 ccm INFO node2: using Java 8 for the current invocation
11:51:52,307 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:51:52,575 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-jez24h5o/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-jez24h5o/test/node3/conf'}
11:51:52,576 ccm INFO node3: using Java 8 for the current invocation
11:51:52,745 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-jez24h5o/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-jez24h5o/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:51:52,745 ccm INFO node3: using Java 8 for the current invocation
11:51:52,831 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:52:17,579 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
11:52:17,580 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
11:51:45,295 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:51:45,295 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]11:52:42,774 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 115.87 seconds ==========================
[msx] rc = 1
v2v2 running time = 137618954938
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: phi_convict_threshold@@@CassandraDaemon@@@-3@@@6@@@5.0
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
11:54:02,943 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:54:04,77 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.06 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:54:06,188 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.2 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:54:06,550 cassandra.cluster WARNING Host 127.0.0.2:9042 has been marked down
11:54:06,550 cassandra.cluster WARNING Host 127.0.0.3:9042 has been marked down
11:54:06,552 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.3:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.3', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
11:55:02,223 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 64

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f26731a7d30>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f265a79bd30>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
11:53:06,836 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:53:05,165 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 11:53:05.165392
11:53:06,717 dtest_setup INFO cluster ccm directory: /tmp/dtest-40l_fs_1
----------------------------- Captured stdout call -----------------------------
11:53:06,839 ccm DEBUG using balanced tokens for non-vnode cluster
11:53:08,394 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-40l_fs_1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-40l_fs_1/test/node1/conf'}
11:53:08,395 ccm INFO node1: using Java 8 for the current invocation
11:53:08,551 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-40l_fs_1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-40l_fs_1/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:53:08,552 ccm INFO node1: using Java 8 for the current invocation
11:53:08,648 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:53:08,921 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-40l_fs_1/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-40l_fs_1/test/node2/conf'}
11:53:08,921 ccm INFO node2: using Java 8 for the current invocation
11:53:09,107 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-40l_fs_1/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-40l_fs_1/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:53:09,108 ccm INFO node2: using Java 8 for the current invocation
11:53:09,199 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:53:09,456 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-40l_fs_1/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-40l_fs_1/test/node3/conf'}
11:53:09,457 ccm INFO node3: using Java 8 for the current invocation
11:53:09,627 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-40l_fs_1/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-40l_fs_1/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:53:09,627 ccm INFO node3: using Java 8 for the current invocation
11:53:09,712 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:53:08,394 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-40l_fs_1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-40l_fs_1/test/node1/conf'}
11:53:08,395 ccm INFO node1: using Java 8 for the current invocation
11:53:08,551 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-40l_fs_1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-40l_fs_1/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:53:08,552 ccm INFO node1: using Java 8 for the current invocation
11:53:08,648 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:53:08,921 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-40l_fs_1/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-40l_fs_1/test/node2/conf'}
11:53:08,921 ccm INFO node2: using Java 8 for the current invocation
11:53:09,107 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-40l_fs_1/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-40l_fs_1/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:53:09,108 ccm INFO node2: using Java 8 for the current invocation
11:53:09,199 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:53:09,456 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-40l_fs_1/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-40l_fs_1/test/node3/conf'}
11:53:09,457 ccm INFO node3: using Java 8 for the current invocation
11:53:09,627 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-40l_fs_1/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-40l_fs_1/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:53:09,627 ccm INFO node3: using Java 8 for the current invocation
11:53:09,712 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:53:36,475 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
11:53:36,478 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
11:54:06,701 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:54:11,74 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:54:09,940 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 11:54:09.940460
11:54:10,960 dtest_setup INFO cluster ccm directory: /tmp/dtest-0r7132_k
----------------------------- Captured stdout call -----------------------------

11:54:11,76 ccm DEBUG using balanced tokens for non-vnode cluster
11:54:12,711 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0r7132_k/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0r7132_k/test/node1/conf'}
11:54:12,712 ccm INFO node1: using Java 8 for the current invocation
11:54:12,886 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0r7132_k/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0r7132_k/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:54:12,887 ccm INFO node1: using Java 8 for the current invocation
11:54:12,987 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:54:13,260 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0r7132_k/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0r7132_k/test/node2/conf'}
11:54:13,261 ccm INFO node2: using Java 8 for the current invocation
11:54:13,456 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0r7132_k/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0r7132_k/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:54:13,457 ccm INFO node2: using Java 8 for the current invocation
11:54:13,543 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:54:13,837 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0r7132_k/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0r7132_k/test/node3/conf'}
11:54:13,838 ccm INFO node3: using Java 8 for the current invocation
11:54:14,17 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0r7132_k/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0r7132_k/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:54:14,17 ccm INFO node3: using Java 8 for the current invocation
11:54:14,100 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra

------------------------------ Captured log call -------------------------------
11:54:12,711 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0r7132_k/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0r7132_k/test/node1/conf'}
11:54:12,712 ccm INFO node1: using Java 8 for the current invocation
11:54:12,886 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0r7132_k/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0r7132_k/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:54:12,887 ccm INFO node1: using Java 8 for the current invocation
11:54:12,987 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:54:13,260 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0r7132_k/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0r7132_k/test/node2/conf'}
11:54:13,261 ccm INFO node2: using Java 8 for the current invocation
11:54:13,456 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0r7132_k/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0r7132_k/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:54:13,457 ccm INFO node2: using Java 8 for the current invocation
11:54:13,543 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:54:13,837 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0r7132_k/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0r7132_k/test/node3/conf'}
11:54:13,838 ccm INFO node3: using Java 8 for the current invocation
11:54:14,17 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0r7132_k/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0r7132_k/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:54:14,17 ccm INFO node3: using Java 8 for the current invocation
11:54:14,100 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:54:37,871 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
11:54:37,872 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
11:54:06,701 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:54:06,701 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]11:55:02,572 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 118.14 seconds ==========================
[msx] rc = 1
v1v2 running time = 139788251593
---> v1v2 test failed.
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: phi_convict_threshold@@@CassandraDaemon@@@-3@@@6@@@5.0
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
11:56:20,103 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
11:56:20,105 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
11:56:24,354 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 60.85 seconds ===========================
[msx] rc = 0
v1v1 running time = 82429857497
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
11:57:46,986 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:57:48,152 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.2 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:57:50,375 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.88 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:57:50,643 cassandra.cluster WARNING Host 127.0.0.3:9042 has been marked down
11:57:50,643 cassandra.cluster WARNING Host 127.0.0.2:9042 has been marked down
11:57:50,645 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.2', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
11:58:50,562 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 68

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7fd94a734f28>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7fd932b66710>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
11:56:48,986 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:56:47,361 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 11:56:47.361126
11:56:48,871 dtest_setup INFO cluster ccm directory: /tmp/dtest-ovvjd7i0
----------------------------- Captured stdout call -----------------------------
11:56:48,989 ccm DEBUG using balanced tokens for non-vnode cluster
11:56:50,501 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ovvjd7i0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ovvjd7i0/test/node1/conf'}
11:56:50,502 ccm INFO node1: using Java 8 for the current invocation
11:56:50,681 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ovvjd7i0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ovvjd7i0/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:56:50,681 ccm INFO node1: using Java 8 for the current invocation
11:56:50,761 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:56:51,10 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ovvjd7i0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ovvjd7i0/test/node2/conf'}
11:56:51,10 ccm INFO node2: using Java 8 for the current invocation
11:56:51,170 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ovvjd7i0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ovvjd7i0/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:56:51,170 ccm INFO node2: using Java 8 for the current invocation
11:56:51,272 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:56:51,511 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ovvjd7i0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ovvjd7i0/test/node3/conf'}
11:56:51,511 ccm INFO node3: using Java 8 for the current invocation
11:56:51,698 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ovvjd7i0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ovvjd7i0/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:56:51,699 ccm INFO node3: using Java 8 for the current invocation
11:56:51,795 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:56:50,501 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ovvjd7i0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ovvjd7i0/test/node1/conf'}
11:56:50,502 ccm INFO node1: using Java 8 for the current invocation
11:56:50,681 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ovvjd7i0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ovvjd7i0/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:56:50,681 ccm INFO node1: using Java 8 for the current invocation
11:56:50,761 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:56:51,10 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ovvjd7i0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ovvjd7i0/test/node2/conf'}
11:56:51,10 ccm INFO node2: using Java 8 for the current invocation
11:56:51,170 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ovvjd7i0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ovvjd7i0/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:56:51,170 ccm INFO node2: using Java 8 for the current invocation
11:56:51,272 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:56:51,511 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ovvjd7i0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ovvjd7i0/test/node3/conf'}
11:56:51,511 ccm INFO node3: using Java 8 for the current invocation
11:56:51,698 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ovvjd7i0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ovvjd7i0/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:56:51,699 ccm INFO node3: using Java 8 for the current invocation
11:56:51,795 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:57:20,579 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
11:57:20,581 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
11:57:50,819 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:57:55,105 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:57:54,32 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 11:57:54.032277
11:57:55,0 dtest_setup INFO cluster ccm directory: /tmp/dtest-l5hy2mhm
----------------------------- Captured stdout call -----------------------------

11:57:55,108 ccm DEBUG using balanced tokens for non-vnode cluster
11:57:56,730 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node1/conf'}
11:57:56,731 ccm INFO node1: using Java 8 for the current invocation
11:57:56,899 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:57:56,899 ccm INFO node1: using Java 8 for the current invocation
11:57:56,991 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:57:57,263 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node2/conf'}
11:57:57,264 ccm INFO node2: using Java 8 for the current invocation
11:57:57,430 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:57:57,431 ccm INFO node2: using Java 8 for the current invocation
11:57:57,529 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:57:57,808 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node3/conf'}
11:57:57,808 ccm INFO node3: using Java 8 for the current invocation
11:57:57,977 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:57:57,978 ccm INFO node3: using Java 8 for the current invocation
11:57:58,60 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra

11:57:55,108 ccm DEBUG using balanced tokens for non-vnode cluster
11:57:56,730 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node1/conf'}
11:57:56,731 ccm INFO node1: using Java 8 for the current invocation
11:57:56,899 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:57:56,899 ccm INFO node1: using Java 8 for the current invocation
11:57:56,991 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:57:57,263 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node2/conf'}
11:57:57,264 ccm INFO node2: using Java 8 for the current invocation
11:57:57,430 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:57:57,431 ccm INFO node2: using Java 8 for the current invocation
11:57:57,529 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:57:57,808 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node3/conf'}
11:57:57,808 ccm INFO node3: using Java 8 for the current invocation
11:57:57,977 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:57:57,978 ccm INFO node3: using Java 8 for the current invocation
11:57:58,60 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:57:56,730 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node1/conf'}
11:57:56,731 ccm INFO node1: using Java 8 for the current invocation
11:57:56,899 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
11:57:56,899 ccm INFO node1: using Java 8 for the current invocation
11:57:56,991 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:57:57,263 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node2/conf'}
11:57:57,264 ccm INFO node2: using Java 8 for the current invocation
11:57:57,430 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:57:57,431 ccm INFO node2: using Java 8 for the current invocation
11:57:57,529 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:57:57,808 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node3/conf'}
11:57:57,808 ccm INFO node3: using Java 8 for the current invocation
11:57:57,977 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-l5hy2mhm/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-l5hy2mhm/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
11:57:57,978 ccm INFO node3: using Java 8 for the current invocation
11:57:58,60 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:58:22,806 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
11:58:22,806 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
11:57:50,819 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:57:50,819 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]11:58:50,962 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 124.33 seconds ==========================
[msx] rc = 1
v2v2 running time = 146001932755
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: phi_convict_threshold@@@CassandraDaemon@@@-3@@@6@@@5.0
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
12:00:08,917 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
12:00:08,919 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
12:00:12,393 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
12:00:12,394 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
12:00:13,599 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.86 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 61.25 seconds ===========================
[msx] rc = 0
v1v2 running time = 82845398776
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
12:01:30,376 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
12:01:30,378 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 59.88 seconds ===========================
[msx] rc = 0
v1v1 running time = 81461574093
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
12:02:55,365 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
12:02:56,399 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.96 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
12:02:58,406 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.72 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
12:03:56,36 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 90

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7fc1d4f4a630>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7fc1b7abe9b0>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
12:01:58,742 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:01:57,584 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 12:01:57.584238
12:01:58,644 dtest_setup INFO cluster ccm directory: /tmp/dtest-m9zd72o0
----------------------------- Captured stdout call -----------------------------
12:01:58,744 ccm DEBUG using balanced tokens for non-vnode cluster
12:02:00,145 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9zd72o0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9zd72o0/test/node1/conf'}
12:02:00,146 ccm INFO node1: using Java 8 for the current invocation
12:02:00,311 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9zd72o0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9zd72o0/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
12:02:00,312 ccm INFO node1: using Java 8 for the current invocation
12:02:00,398 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:02:00,658 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9zd72o0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9zd72o0/test/node2/conf'}
12:02:00,658 ccm INFO node2: using Java 8 for the current invocation
12:02:00,830 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9zd72o0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9zd72o0/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:02:00,831 ccm INFO node2: using Java 8 for the current invocation
12:02:00,910 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:02:01,172 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9zd72o0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9zd72o0/test/node3/conf'}
12:02:01,172 ccm INFO node3: using Java 8 for the current invocation
12:02:01,343 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9zd72o0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9zd72o0/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:02:01,344 ccm INFO node3: using Java 8 for the current invocation
12:02:01,432 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
12:02:00,145 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9zd72o0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9zd72o0/test/node1/conf'}
12:02:00,146 ccm INFO node1: using Java 8 for the current invocation
12:02:00,311 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9zd72o0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9zd72o0/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
12:02:00,312 ccm INFO node1: using Java 8 for the current invocation
12:02:00,398 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:02:00,658 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9zd72o0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9zd72o0/test/node2/conf'}
12:02:00,658 ccm INFO node2: using Java 8 for the current invocation
12:02:00,830 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9zd72o0/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9zd72o0/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:02:00,831 ccm INFO node2: using Java 8 for the current invocation
12:02:00,910 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:02:01,172 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9zd72o0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9zd72o0/test/node3/conf'}
12:02:01,172 ccm INFO node3: using Java 8 for the current invocation
12:02:01,343 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9zd72o0/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9zd72o0/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:02:01,344 ccm INFO node3: using Java 8 for the current invocation
12:02:01,432 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:02:31,254 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
12:02:31,257 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
12:02:59,95 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
12:03:03,497 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:03:02,683 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 12:03:02.683841
12:03:03,400 dtest_setup INFO cluster ccm directory: /tmp/dtest-m358uc5e
----------------------------- Captured stdout call -----------------------------

12:03:03,500 ccm DEBUG using balanced tokens for non-vnode cluster
12:03:05,127 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m358uc5e/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m358uc5e/test/node1/conf'}
12:03:05,128 ccm INFO node1: using Java 8 for the current invocation
12:03:05,294 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m358uc5e/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m358uc5e/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
12:03:05,295 ccm INFO node1: using Java 8 for the current invocation
12:03:05,383 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:03:06,15 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m358uc5e/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m358uc5e/test/node2/conf'}
12:03:06,16 ccm INFO node2: using Java 8 for the current invocation
12:03:06,195 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m358uc5e/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m358uc5e/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:03:06,196 ccm INFO node2: using Java 8 for the current invocation
12:03:06,282 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:03:06,563 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m358uc5e/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m358uc5e/test/node3/conf'}
12:03:06,564 ccm INFO node3: using Java 8 for the current invocation
12:03:06,750 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m358uc5e/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m358uc5e/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:03:06,751 ccm INFO node3: using Java 8 for the current invocation
12:03:06,834 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
12:03:05,127 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m358uc5e/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m358uc5e/test/node1/conf'}
12:03:05,128 ccm INFO node1: using Java 8 for the current invocation
12:03:05,294 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m358uc5e/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m358uc5e/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
12:03:05,295 ccm INFO node1: using Java 8 for the current invocation
12:03:05,383 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:03:06,15 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m358uc5e/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m358uc5e/test/node2/conf'}
12:03:06,16 ccm INFO node2: using Java 8 for the current invocation
12:03:06,195 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m358uc5e/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m358uc5e/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:03:06,196 ccm INFO node2: using Java 8 for the current invocation
12:03:06,282 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:03:06,563 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m358uc5e/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m358uc5e/test/node3/conf'}
12:03:06,564 ccm INFO node3: using Java 8 for the current invocation
12:03:06,750 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m358uc5e/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m358uc5e/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:03:06,751 ccm INFO node3: using Java 8 for the current invocation
12:03:06,834 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:03:30,621 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
12:03:30,622 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
12:02:59,95 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:02:59,95 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]12:03:56,431 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 119.54 seconds ==========================
[msx] rc = 1
v2v2 running time = 141116552973
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: phi_convict_threshold@@@CassandraDaemon@@@-3@@@6@@@5.0
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
12:05:12,845 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
12:05:13,957 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.04 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
12:05:16,65 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.68 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
12:06:19,973 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 61

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f2c67e31a58>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f2c4ed8e208>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
12:04:20,64 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:04:18,759 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 12:04:18.759257
12:04:19,968 dtest_setup INFO cluster ccm directory: /tmp/dtest-670d4s0q
----------------------------- Captured stdout call -----------------------------

12:04:20,67 ccm DEBUG using balanced tokens for non-vnode cluster
12:04:21,633 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-670d4s0q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-670d4s0q/test/node1/conf'}
12:04:21,634 ccm INFO node1: using Java 8 for the current invocation
12:04:21,793 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-670d4s0q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-670d4s0q/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
12:04:21,794 ccm INFO node1: using Java 8 for the current invocation
12:04:21,876 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:04:22,138 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-670d4s0q/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-670d4s0q/test/node2/conf'}
12:04:22,138 ccm INFO node2: using Java 8 for the current invocation
12:04:22,302 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-670d4s0q/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-670d4s0q/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:04:22,302 ccm INFO node2: using Java 8 for the current invocation
12:04:22,393 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:04:22,661 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-670d4s0q/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-670d4s0q/test/node3/conf'}
12:04:22,662 ccm INFO node3: using Java 8 for the current invocation
12:04:22,821 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-670d4s0q/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-670d4s0q/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:04:22,822 ccm INFO node3: using Java 8 for the current invocation
12:04:22,905 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
12:04:21,633 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-670d4s0q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-670d4s0q/test/node1/conf'}
12:04:21,634 ccm INFO node1: using Java 8 for the current invocation
12:04:21,793 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-670d4s0q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-670d4s0q/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
12:04:21,794 ccm INFO node1: using Java 8 for the current invocation
12:04:21,876 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:04:22,138 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-670d4s0q/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-670d4s0q/test/node2/conf'}
12:04:22,138 ccm INFO node2: using Java 8 for the current invocation
12:04:22,302 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-670d4s0q/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-670d4s0q/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:04:22,302 ccm INFO node2: using Java 8 for the current invocation
12:04:22,393 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:04:22,661 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-670d4s0q/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-670d4s0q/test/node3/conf'}
12:04:22,662 ccm INFO node3: using Java 8 for the current invocation
12:04:22,821 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-670d4s0q/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-670d4s0q/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:04:22,822 ccm INFO node3: using Java 8 for the current invocation
12:04:22,905 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:04:47,692 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
12:04:47,694 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
12:05:16,584 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
12:05:20,997 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:05:19,760 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 12:05:19.760854
12:05:20,896 dtest_setup INFO cluster ccm directory: /tmp/dtest-67yry_60
------------------------------ Captured log call -------------------------------
12:05:22,523 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-67yry_60/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-67yry_60/test/node1/conf'}
12:05:22,523 ccm INFO node1: using Java 8 for the current invocation
12:05:22,690 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-67yry_60/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-67yry_60/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
12:05:22,691 ccm INFO node1: using Java 8 for the current invocation
12:05:22,773 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:05:23,49 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-67yry_60/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-67yry_60/test/node2/conf'}
12:05:23,50 ccm INFO node2: using Java 8 for the current invocation
12:05:23,236 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-67yry_60/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-67yry_60/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:05:23,237 ccm INFO node2: using Java 8 for the current invocation
12:05:23,343 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:05:23,978 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-67yry_60/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-67yry_60/test/node3/conf'}
12:05:23,978 ccm INFO node3: using Java 8 for the current invocation
12:05:24,190 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-67yry_60/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-67yry_60/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:05:24,191 ccm INFO node3: using Java 8 for the current invocation
12:05:24,341 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:05:54,223 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
12:05:54,223 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
12:05:16,584 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:05:16,584 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]12:06:20,213 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 122.16 seconds ==========================
[msx] rc = 1
v1v2 running time = 143804281087
---> v1v2 test failed.
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: phi_convict_threshold@@@CassandraDaemon@@@-3@@@6@@@5.0
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
12:07:35,506 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
12:07:36,652 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.0 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
12:07:38,660 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.76 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
12:07:39,389 cassandra.cluster WARNING Host 127.0.0.3:9042 has been marked down
12:07:39,389 cassandra.cluster WARNING Host 127.0.0.2:9042 has been marked down
12:07:39,391 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.2:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.2', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
12:08:39,588 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 42

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f1a696dd160>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f1a59ae0160>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
12:06:43,720 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:06:42,611 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 12:06:42.611467
12:06:43,622 dtest_setup INFO cluster ccm directory: /tmp/dtest-0apotkmj
----------------------------- Captured stdout call -----------------------------
12:06:43,723 ccm DEBUG using balanced tokens for non-vnode cluster
12:06:45,188 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0apotkmj/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0apotkmj/test/node1/conf'}
12:06:45,189 ccm INFO node1: using Java 8 for the current invocation
12:06:45,356 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0apotkmj/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0apotkmj/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
12:06:45,357 ccm INFO node1: using Java 8 for the current invocation
12:06:45,447 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:06:45,705 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0apotkmj/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0apotkmj/test/node2/conf'}
12:06:45,706 ccm INFO node2: using Java 8 for the current invocation
12:06:45,873 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0apotkmj/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0apotkmj/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:06:45,874 ccm INFO node2: using Java 8 for the current invocation
12:06:45,953 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:06:46,264 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0apotkmj/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0apotkmj/test/node3/conf'}
12:06:46,265 ccm INFO node3: using Java 8 for the current invocation
12:06:46,443 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0apotkmj/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0apotkmj/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:06:46,444 ccm INFO node3: using Java 8 for the current invocation
12:06:46,541 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
12:06:45,188 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0apotkmj/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0apotkmj/test/node1/conf'}
12:06:45,189 ccm INFO node1: using Java 8 for the current invocation
12:06:45,356 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0apotkmj/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0apotkmj/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
12:06:45,357 ccm INFO node1: using Java 8 for the current invocation
12:06:45,447 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:06:45,705 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0apotkmj/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0apotkmj/test/node2/conf'}
12:06:45,706 ccm INFO node2: using Java 8 for the current invocation
12:06:45,873 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0apotkmj/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0apotkmj/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:06:45,874 ccm INFO node2: using Java 8 for the current invocation
12:06:45,953 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:06:46,264 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0apotkmj/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0apotkmj/test/node3/conf'}
12:06:46,265 ccm INFO node3: using Java 8 for the current invocation
12:06:46,443 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0apotkmj/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0apotkmj/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:06:46,444 ccm INFO node3: using Java 8 for the current invocation
12:06:46,541 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:07:09,293 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
12:07:09,294 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
12:07:39,737 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
12:07:43,953 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:07:42,988 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 12:07:42.988301
12:07:43,855 dtest_setup INFO cluster ccm directory: /tmp/dtest-erbu0yub
------------------------------ Captured log call -------------------------------
12:07:46,6 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-erbu0yub/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-erbu0yub/test/node1/conf'}
12:07:46,7 ccm INFO node1: using Java 8 for the current invocation
12:07:46,175 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-erbu0yub/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-erbu0yub/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
12:07:46,175 ccm INFO node1: using Java 8 for the current invocation
12:07:46,257 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:07:46,529 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-erbu0yub/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-erbu0yub/test/node2/conf'}
12:07:46,530 ccm INFO node2: using Java 8 for the current invocation
12:07:46,705 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-erbu0yub/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-erbu0yub/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:07:46,706 ccm INFO node2: using Java 8 for the current invocation
12:07:46,798 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:07:47,75 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-erbu0yub/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-erbu0yub/test/node3/conf'}
12:07:47,76 ccm INFO node3: using Java 8 for the current invocation
12:07:47,262 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-erbu0yub/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-erbu0yub/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:07:47,263 ccm INFO node3: using Java 8 for the current invocation
12:07:47,347 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:08:14,193 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
12:08:14,194 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
12:07:39,737 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
12:07:39,737 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]12:08:39,993 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 118.09 seconds ==========================
[msx] rc = 1
v1v1 running time = 139769065018
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
12:10:03,441 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
12:10:03,442 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
12:10:07,782 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
12:10:07,783 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 66.70 seconds ===========================
[msx] rc = 0
v2v2 running time = 88341420749
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: phi_convict_threshold@@@CassandraDaemon@@@-3@@@6@@@5.0
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
12:11:28,511 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
12:11:29,552 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.04 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
12:11:31,660 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.36 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
12:12:38,737 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
12:12:38,738 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
12:12:39,742 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.8 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
12:12:41,548 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.24 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
12:12:45,859 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 8.88 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
12:12:51,712 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
12:12:51,713 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
12:12:54,781 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 15.04 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 146.67 seconds ==========================
[msx] rc = 0
v1v2 running time = 168344967676
---> v1v2 test suceeded.
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
12:14:17,214 cassandra.cluster ERROR Unexpected exception while handling result in ResponseFuture:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
12:14:17,216 cassandra.connection ERROR Callback handler errored, ignoring:
Traceback (most recent call last):
  File "cassandra/connection.py", line 1218, in cassandra.connection.Connection.process_msg
  File "cassandra/cluster.py", line 4703, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
  File "cassandra/cluster.py", line 4678, in cassandra.cluster.ResponseFuture._set_result
  File "cassandra/cluster.py", line 4831, in cassandra.cluster.ResponseFuture._handle_retry_decision
  File "cassandra/cluster.py", line 4815, in cassandra.cluster.ResponseFuture._set_final_exception
  File "/root/cassandra-dtest/tools/paging.py", line 68, in handle_error
    raise exc
cassandra.Unavailable: Error from server: code=1000 [Unavailable exception] message="Cannot achieve consistency level ALL" info={'consistency': 'ALL', 'required_replicas': 1, 'alive_replicas': 0}
12:14:20,268 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
12:14:21,272 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.84 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_node_unavailabe_during_paging passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 63.92 seconds ===========================
[msx] rc = 0
v1v1 running time = 85565824926
cassandra paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging 
-------------------------------- live log call ---------------------------------
12:15:39,690 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
12:15:40,900 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.12 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused

-------------------------------- live log call ---------------------------------
12:16:41,797 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down


=================================== FAILURES ===================================
_________ TestPagingDatasetChanges.test_node_unavailabe_during_paging __________

>   ???
E   KeyError: 12

cassandra/cluster.py:4351: KeyError

During handling of the above exception, another exception occurred:

self = <paging_test.TestPagingDatasetChanges object at 0x7f832ac7d1d0>

    def test_node_unavailabe_during_paging(self):
        cluster = self.cluster
        cluster.populate(3).start()
        node1, node2, node3 = cluster.nodelist()
        session = self.cql_connection(node1)
        create_ks(session, 'test_paging_size', 1)
        session.execute("CREATE TABLE paging_test ( id uuid, mytext text, PRIMARY KEY (id, mytext) )")
    
        def make_uuid(text):
            return uuid.uuid4()
    
        create_rows(
            """
                      | id      | mytext |
                      +---------+--------+
                *10000| [uuid]  | foo    |
                """,
            session, 'paging_test', cl=CL.ALL, format_funcs={'id': make_uuid}
        )
    
        future = session.execute_async(
            SimpleStatement("select * from paging_test where mytext = 'foo' allow filtering", fetch_size=2000, consistency_level=CL.ALL)
        )
    
        pf = PageFetcher(future)
        # no need to request page here, because the first page is automatically retrieved
    
        # stop a node and make sure we get an error trying to page the rest
        node1.stop()
        with pytest.raises(RuntimeError, match='Requested pages were not delivered before timeout'):
>           pf.request_all()

paging_test.py:3044: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tools/paging.py:92: in request_all
    self.future.start_fetching_next_page()
cassandra/cluster.py:4544: in cassandra.cluster.ResponseFuture.start_fetching_next_page
    ???
cassandra/cluster.py:4425: in cassandra.cluster.ResponseFuture.send_request
    ???
cassandra/cluster.py:4359: in cassandra.cluster.ResponseFuture._on_timeout
    ???
cassandra/cluster.py:4815: in cassandra.cluster.ResponseFuture._set_final_exception
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tools.paging.PageFetcher object at 0x7f83118f2da0>
exc = OperationTimedOut("errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042",)

    def handle_error(self, exc):
        self.error = exc
>       raise exc
E       cassandra.OperationTimedOut: errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

tools/paging.py:68: OperationTimedOut
---------------------------- Captured stdout setup -----------------------------
12:14:46,525 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:14:44,696 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 12:14:44.696708
12:14:46,407 dtest_setup INFO cluster ccm directory: /tmp/dtest-h1s8cn8u
----------------------------- Captured stdout call -----------------------------

12:14:46,528 ccm DEBUG using balanced tokens for non-vnode cluster
12:14:48,32 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h1s8cn8u/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h1s8cn8u/test/node1/conf'}
12:14:48,33 ccm INFO node1: using Java 8 for the current invocation
12:14:48,208 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h1s8cn8u/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h1s8cn8u/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
12:14:48,208 ccm INFO node1: using Java 8 for the current invocation
12:14:48,303 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:14:48,591 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h1s8cn8u/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h1s8cn8u/test/node2/conf'}
12:14:48,592 ccm INFO node2: using Java 8 for the current invocation
12:14:48,957 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h1s8cn8u/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h1s8cn8u/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:14:48,958 ccm INFO node2: using Java 8 for the current invocation
12:14:49,145 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:14:49,490 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h1s8cn8u/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h1s8cn8u/test/node3/conf'}
12:14:49,491 ccm INFO node3: using Java 8 for the current invocation
12:14:49,657 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h1s8cn8u/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h1s8cn8u/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:14:49,658 ccm INFO node3: using Java 8 for the current invocation
12:14:49,740 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
12:14:48,32 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h1s8cn8u/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h1s8cn8u/test/node1/conf'}
12:14:48,33 ccm INFO node1: using Java 8 for the current invocation
12:14:48,208 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h1s8cn8u/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h1s8cn8u/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
12:14:48,208 ccm INFO node1: using Java 8 for the current invocation
12:14:48,303 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:14:48,591 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h1s8cn8u/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h1s8cn8u/test/node2/conf'}
12:14:48,592 ccm INFO node2: using Java 8 for the current invocation
12:14:48,957 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h1s8cn8u/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h1s8cn8u/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:14:48,958 ccm INFO node2: using Java 8 for the current invocation
12:14:49,145 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:14:49,490 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h1s8cn8u/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h1s8cn8u/test/node3/conf'}
12:14:49,491 ccm INFO node3: using Java 8 for the current invocation
12:14:49,657 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-h1s8cn8u/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-h1s8cn8u/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:14:49,658 ccm INFO node3: using Java 8 for the current invocation
12:14:49,740 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:15:14,556 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
12:15:14,558 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
12:15:39,690 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
--------------------------- Captured stdout teardown ---------------------------
12:15:43,181 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stderr teardown ---------------------------
swapoff: Not superuser.
---------------------------- Captured stdout setup -----------------------------
12:15:48,185 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:15:46,862 conftest INFO Starting execution of test_node_unavailabe_during_paging at 2022-02-01 12:15:46.862336
12:15:48,80 dtest_setup INFO cluster ccm directory: /tmp/dtest-3b9ca77o
------------------------------ Captured log call -------------------------------
12:15:49,775 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3b9ca77o/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3b9ca77o/test/node1/conf'}
12:15:49,777 ccm INFO node1: using Java 8 for the current invocation
12:15:49,946 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3b9ca77o/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3b9ca77o/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6'}
12:15:49,947 ccm INFO node1: using Java 8 for the current invocation
12:15:50,47 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:15:50,309 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3b9ca77o/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3b9ca77o/test/node2/conf'}
12:15:50,309 ccm INFO node2: using Java 8 for the current invocation
12:15:50,480 ccm INFO node2: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3b9ca77o/test/node2/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3b9ca77o/test/node2/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:15:50,481 ccm INFO node2: using Java 8 for the current invocation
12:15:50,559 ccm INFO Starting node2 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:15:50,822 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3b9ca77o/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3b9ca77o/test/node3/conf'}
12:15:50,823 ccm INFO node3: using Java 8 for the current invocation
12:15:50,991 ccm INFO node3: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '2e2da1c1770d', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'paging_test.py::TestPagingDatasetChanges::()::test_node_unavailabe_during_paging (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3b9ca77o/test/node3/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3b9ca77o/test/node3/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6 -Dcassandra.migration_task_wait_in_seconds=6'}
12:15:50,992 ccm INFO node3: using Java 8 for the current invocation
12:15:51,81 ccm INFO Starting node3 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:16:15,856 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.3:9042 datacenter1> discovered
12:16:15,856 cassandra.cluster INFO New Cassandra host <Host: 127.0.0.2:9042 datacenter1> discovered
--------------------------- Captured stdout teardown ---------------------------
12:15:43,181 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stderr teardown ---------------------------
swapoff: Not superuser.
--------------------------- Captured stdout teardown ---------------------------
12:15:43,181 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stderr teardown ---------------------------
swapoff: Not superuser.
--------------------------- Captured stdout teardown ---------------------------
FAILED                                                                   [100%]12:16:42,197 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_node_unavailabe_during_paging failed (1 runs remaining out of 2).
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]
test_node_unavailabe_during_paging failed; it passed 0 out of the required 1 times.
	<class 'cassandra.OperationTimedOut'>
	errors={'Connection defunct by heartbeat': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042
	[<TracebackEntry /root/cassandra-dtest/paging_test.py:3044>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:92>, <TracebackEntry cassandra/cluster.py:4544>, <TracebackEntry cassandra/cluster.py:4425>, <TracebackEntry cassandra/cluster.py:4359>, <TracebackEntry cassandra/cluster.py:4815>, <TracebackEntry /root/cassandra-dtest/tools/paging.py:68>]

===End Flaky Test Report===
========================== 1 failed in 118.21 seconds ==========================
[msx] rc = 1
v2v2 running time = 139908155276
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: paging_test.py::TestPagingDatasetChanges::test_node_unavailabe_during_paging
h_list: phi_convict_threshold@@@CassandraDaemon@@@-3@@@6@@@5.0
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

early stop after 7 is satisfied
v1v2 failed with probability 3 out of 7
v1v1v2v2 failed with probability 7 out of 7
Total execution time in seconds : 2421
0
