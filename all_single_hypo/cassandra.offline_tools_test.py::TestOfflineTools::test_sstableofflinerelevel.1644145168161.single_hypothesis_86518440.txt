my_type=hypothesis
proj=cassandra
u_test=offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
h_list[1]=range_request_timeout_in_ms@@@Tool@@@-2@@@50@@@15000
proj: cassandra
u_test: offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
h_list: range_request_timeout_in_ms@@@Tool@@@-2@@@50@@@15000
cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel FAILED [100%]

=================================== FAILURES ===================================
_________________ TestOfflineTools.test_sstableofflinerelevel __________________

self = <offline_tools_test.TestOfflineTools object at 0x7effb7177588>

    def test_sstableofflinerelevel(self):
        """
            Generate sstables of varying levels.
            Reset sstables to L0 with sstablelevelreset
            Run sstableofflinerelevel and ensure tables are promoted correctly
            Also test a variety of bad inputs including nonexistent keyspace and sstables
            @since 2.1.5
            @jira_ticket CASSANDRA-8031
            """
        cluster = self.cluster
        cluster.set_configuration_options(values={'compaction_throughput_mb_per_sec': 0})
        cluster.populate(1).start()
        node1 = cluster.nodelist()[0]
    
        # NOTE - As of now this does not return when it encounters Exception and causes test to hang, temporarily commented out
        # test by trying to run on nonexistent keyspace
        # cluster.stop(gently=False)
        # output, error, rc = node1.run_sstableofflinerelevel("keyspace1", "standard1", output=True)
        # assert "java.lang.IllegalArgumentException: Unknown keyspace/columnFamily keyspace1.standard1" in error
        # # this should return exit code 1
        # assert rc, 1 == msg=str(rc)
        # cluster.start()
    
        # now test by generating keyspace but not flushing sstables
    
        node1.stress(['write', 'n=1', 'no-warmup',
                      '-schema', 'replication(factor=1)',
                      '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)',
>                     '-rate', 'threads=8'])

offline_tools_test.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1502: in stress
    return handle_external_tool_process(p, ['stress'] + stress_options)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7effb7172278>
cmd_args = ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', ...]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
E           stdout: ******************** Stress Settings ********************
E           Command:
E             Type: write
E             Count: 1
E             No Warmup: true
E             Consistency Level: LOCAL_ONE
E             Target Uncertainty: not applicable
E             Key Size (bytes): 10
E             Counter Increment Distibution: add=fixed(1)
E           Rate:
E             Auto: false
E             Thread Count: 8
E             OpsPer Sec: 0
E           Population:
E             Sequence: 1..1
E             Order: ARBITRARY
E             Wrap: true
E           Insert:
E             Revisits: Uniform:  min=1,max=1000000
E             Visits: Fixed:  key=1
E             Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
E             Batch Type: not batching
E           Columns:
E             Max Columns Per Key: 10
E             Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
E             Comparator: AsciiType
E             Timestamp: null
E             Variable Column Count: false
E             Slice: false
E             Size Distribution: Fixed:  key=1024
E             Count Distribution: Fixed:  key=10
E           Errors:
E             Ignore: false
E             Tries: 10
E           Log:
E             No Summary: false
E             No Settings: false
E             File: null
E             Interval Millis: 1000
E             Level: NORMAL
E           Mode:
E             API: JAVA_DRIVER_NATIVE
E             Connection Style: CQL_PREPARED
E             CQL Version: CQL3
E             Protocol Version: V5
E             Username: null
E             Password: null
E             Auth Provide Class: null
E             Max Pending Per Connection: 128
E             Connections Per Host: 8
E             Compression: NONE
E           Node:
E             Nodes: [127.0.0.1]
E             Is White List: false
E             Datacenter: null
E           Schema:
E             Keyspace: keyspace1
E             Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
E             Replication Strategy Options: {replication_factor=1}
E             Table Compression: null
E             Table Compaction Strategy: null
E             Table Compaction Strategy Options: {}
E           Transport:
E             truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
E           Port:
E             Native Port: 9042
E             JMX Port: 7100
E           Send To Daemon:
E             *not set*
E           Graph:
E             File: null
E             Revision: unknown
E             Title: null
E             Operation: WRITE
E           TokenRange:
E             Wrap: false
E             Split Factor: 1
E           
E           ; 
E           stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
E           	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
E           	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
E           	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
E           	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
E           	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
E           Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
E           	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
E           	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
E           	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
E           	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
E           	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
E           	... 6 more

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:11:24,934 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:11:24,711 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:11:24.711560
11:11:24,840 dtest_setup INFO cluster ccm directory: /tmp/dtest-94rqejx5
----------------------------- Captured stdout call -----------------------------

11:11:24,939 ccm DEBUG using balanced tokens for non-vnode cluster
11:11:25,593 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-94rqejx5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-94rqejx5/test/node1/conf'}
11:11:25,594 ccm INFO node1: using Java 8 for the current invocation
11:11:25,811 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-94rqejx5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-94rqejx5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:11:25,812 ccm INFO node1: using Java 8 for the current invocation
11:11:25,920 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:11:25,593 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-94rqejx5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-94rqejx5/test/node1/conf'}
11:11:25,594 ccm INFO node1: using Java 8 for the current invocation
11:11:25,811 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-94rqejx5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-94rqejx5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:11:25,812 ccm INFO node1: using Java 8 for the current invocation
11:11:25,920 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:11:37,524 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:11:40,48 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:11:39,834 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:11:39.834526
11:11:39,948 dtest_setup INFO cluster ccm directory: /tmp/dtest-4tkvmgm0
----------------------------- Captured stdout call -----------------------------

11:11:40,54 ccm DEBUG using balanced tokens for non-vnode cluster
11:11:40,716 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4tkvmgm0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4tkvmgm0/test/node1/conf'}
11:11:40,717 ccm INFO node1: using Java 8 for the current invocation
11:11:40,941 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4tkvmgm0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4tkvmgm0/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:11:40,943 ccm INFO node1: using Java 8 for the current invocation
11:11:41,54 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:11:40,716 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4tkvmgm0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4tkvmgm0/test/node1/conf'}
11:11:40,717 ccm INFO node1: using Java 8 for the current invocation
11:11:40,941 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-4tkvmgm0/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-4tkvmgm0/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:11:40,943 ccm INFO node1: using Java 8 for the current invocation
11:11:41,54 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:11:37,524 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:11:37,524 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:11:50,843 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_sstableofflinerelevel failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_sstableofflinerelevel failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 26.67 seconds ===========================
[msx] rc = 1
v1v2 running time = 48796129973
---> v1v2 test failed.
proj: cassandra
u_test: offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
h_list: range_request_timeout_in_ms@@@Tool@@@-2@@@50@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel FAILED [100%]

=================================== FAILURES ===================================
_________________ TestOfflineTools.test_sstableofflinerelevel __________________

self = <offline_tools_test.TestOfflineTools object at 0x7fbaff3517f0>

    def test_sstableofflinerelevel(self):
        """
            Generate sstables of varying levels.
            Reset sstables to L0 with sstablelevelreset
            Run sstableofflinerelevel and ensure tables are promoted correctly
            Also test a variety of bad inputs including nonexistent keyspace and sstables
            @since 2.1.5
            @jira_ticket CASSANDRA-8031
            """
        cluster = self.cluster
        cluster.set_configuration_options(values={'compaction_throughput_mb_per_sec': 0})
        cluster.populate(1).start()
        node1 = cluster.nodelist()[0]
    
        # NOTE - As of now this does not return when it encounters Exception and causes test to hang, temporarily commented out
        # test by trying to run on nonexistent keyspace
        # cluster.stop(gently=False)
        # output, error, rc = node1.run_sstableofflinerelevel("keyspace1", "standard1", output=True)
        # assert "java.lang.IllegalArgumentException: Unknown keyspace/columnFamily keyspace1.standard1" in error
        # # this should return exit code 1
        # assert rc, 1 == msg=str(rc)
        # cluster.start()
    
        # now test by generating keyspace but not flushing sstables
    
        node1.stress(['write', 'n=1', 'no-warmup',
                      '-schema', 'replication(factor=1)',
                      '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)',
>                     '-rate', 'threads=8'])

offline_tools_test.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1502: in stress
    return handle_external_tool_process(p, ['stress'] + stress_options)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7fbaff345ac8>
cmd_args = ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', ...]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
E           stdout: ******************** Stress Settings ********************
E           Command:
E             Type: write
E             Count: 1
E             No Warmup: true
E             Consistency Level: LOCAL_ONE
E             Target Uncertainty: not applicable
E             Key Size (bytes): 10
E             Counter Increment Distibution: add=fixed(1)
E           Rate:
E             Auto: false
E             Thread Count: 8
E             OpsPer Sec: 0
E           Population:
E             Sequence: 1..1
E             Order: ARBITRARY
E             Wrap: true
E           Insert:
E             Revisits: Uniform:  min=1,max=1000000
E             Visits: Fixed:  key=1
E             Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
E             Batch Type: not batching
E           Columns:
E             Max Columns Per Key: 10
E             Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
E             Comparator: AsciiType
E             Timestamp: null
E             Variable Column Count: false
E             Slice: false
E             Size Distribution: Fixed:  key=1024
E             Count Distribution: Fixed:  key=10
E           Errors:
E             Ignore: false
E             Tries: 10
E           Log:
E             No Summary: false
E             No Settings: false
E             File: null
E             Interval Millis: 1000
E             Level: NORMAL
E           Mode:
E             API: JAVA_DRIVER_NATIVE
E             Connection Style: CQL_PREPARED
E             CQL Version: CQL3
E             Protocol Version: V5
E             Username: null
E             Password: null
E             Auth Provide Class: null
E             Max Pending Per Connection: 128
E             Connections Per Host: 8
E             Compression: NONE
E           Node:
E             Nodes: [127.0.0.1]
E             Is White List: false
E             Datacenter: null
E           Schema:
E             Keyspace: keyspace1
E             Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
E             Replication Strategy Options: {replication_factor=1}
E             Table Compression: null
E             Table Compaction Strategy: null
E             Table Compaction Strategy Options: {}
E           Transport:
E             truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
E           Port:
E             Native Port: 9042
E             JMX Port: 7100
E           Send To Daemon:
E             *not set*
E           Graph:
E             File: null
E             Revision: unknown
E             Title: null
E             Operation: WRITE
E           TokenRange:
E             Wrap: false
E             Split Factor: 1
E           
E           ; 
E           stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
E           	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
E           	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
E           	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
E           	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
E           	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
E           Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
E           	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
E           	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
E           	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
E           	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
E           	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
E           	... 6 more

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:12:13,667 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:12:13,437 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:12:13.437371
11:12:13,566 dtest_setup INFO cluster ccm directory: /tmp/dtest-emhfve9_
----------------------------- Captured stdout call -----------------------------

11:12:13,673 ccm DEBUG using balanced tokens for non-vnode cluster
11:12:14,349 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-emhfve9_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-emhfve9_/test/node1/conf'}
11:12:14,351 ccm INFO node1: using Java 8 for the current invocation
11:12:14,562 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-emhfve9_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-emhfve9_/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:12:14,563 ccm INFO node1: using Java 8 for the current invocation
11:12:14,676 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:12:14,349 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-emhfve9_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-emhfve9_/test/node1/conf'}
11:12:14,351 ccm INFO node1: using Java 8 for the current invocation
11:12:14,562 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-emhfve9_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-emhfve9_/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:12:14,563 ccm INFO node1: using Java 8 for the current invocation
11:12:14,676 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:12:26,217 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
1:12:28,825 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:12:28,603 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:12:28.603828
11:12:28,716 dtest_setup INFO cluster ccm directory: /tmp/dtest-52sr1l6g
----------------------------- Captured stdout call -----------------------------
11:12:28,831 ccm DEBUG using balanced tokens for non-vnode cluster
11:12:29,579 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-52sr1l6g/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-52sr1l6g/test/node1/conf'}
11:12:29,579 ccm INFO node1: using Java 8 for the current invocation
11:12:29,805 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-52sr1l6g/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-52sr1l6g/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:12:29,806 ccm INFO node1: using Java 8 for the current invocation
11:12:29,900 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:12:29,579 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-52sr1l6g/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-52sr1l6g/test/node1/conf'}
11:12:29,579 ccm INFO node1: using Java 8 for the current invocation
11:12:29,805 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-52sr1l6g/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-52sr1l6g/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:12:29,806 ccm INFO node1: using Java 8 for the current invocation
11:12:29,900 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:12:26,217 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:12:26,217 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:12:41,875 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_sstableofflinerelevel failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_sstableofflinerelevel failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 28.98 seconds ===========================
[msx] rc = 1
v1v1 running time = 50951224027
cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel 
-------------------------------- live log call ---------------------------------
11:14:04,991 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:15:04,994 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:15:04,996 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:15:06,204 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.24 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:15:08,513 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.16 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:15:12,724 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 8.96 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:15:21,751 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 16.48 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_sstableofflinerelevel passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 143.92 seconds ==========================
[msx] rc = 0
v2v2 running time = 166045257018
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
h_list: range_request_timeout_in_ms@@@Tool@@@-2@@@50@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel 
-------------------------------- live log call ---------------------------------
11:16:53,24 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:16:53,291 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2832, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
11:17:53,28 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:17:53,31 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:17:54,37 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.02 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:17:56,145 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.56 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:17:59,761 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 7.2 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:18:06,984 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 14.72 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_sstableofflinerelevel passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 144.94 seconds ==========================
[msx] rc = 0
v1v2 running time = 167037185437
---> v1v2 test suceeded.
cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel FAILED [100%]

=================================== FAILURES ===================================
_________________ TestOfflineTools.test_sstableofflinerelevel __________________

self = <offline_tools_test.TestOfflineTools object at 0x7f33ace38f28>

    def test_sstableofflinerelevel(self):
        """
            Generate sstables of varying levels.
            Reset sstables to L0 with sstablelevelreset
            Run sstableofflinerelevel and ensure tables are promoted correctly
            Also test a variety of bad inputs including nonexistent keyspace and sstables
            @since 2.1.5
            @jira_ticket CASSANDRA-8031
            """
        cluster = self.cluster
        cluster.set_configuration_options(values={'compaction_throughput_mb_per_sec': 0})
        cluster.populate(1).start()
        node1 = cluster.nodelist()[0]
    
        # NOTE - As of now this does not return when it encounters Exception and causes test to hang, temporarily commented out
        # test by trying to run on nonexistent keyspace
        # cluster.stop(gently=False)
        # output, error, rc = node1.run_sstableofflinerelevel("keyspace1", "standard1", output=True)
        # assert "java.lang.IllegalArgumentException: Unknown keyspace/columnFamily keyspace1.standard1" in error
        # # this should return exit code 1
        # assert rc, 1 == msg=str(rc)
        # cluster.start()
    
        # now test by generating keyspace but not flushing sstables
    
        node1.stress(['write', 'n=1', 'no-warmup',
                      '-schema', 'replication(factor=1)',
                      '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)',
>                     '-rate', 'threads=8'])

offline_tools_test.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1502: in stress
    return handle_external_tool_process(p, ['stress'] + stress_options)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f33ace2b978>
cmd_args = ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', ...]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
E           stdout: ******************** Stress Settings ********************
E           Command:
E             Type: write
E             Count: 1
E             No Warmup: true
E             Consistency Level: LOCAL_ONE
E             Target Uncertainty: not applicable
E             Key Size (bytes): 10
E             Counter Increment Distibution: add=fixed(1)
E           Rate:
E             Auto: false
E             Thread Count: 8
E             OpsPer Sec: 0
E           Population:
E             Sequence: 1..1
E             Order: ARBITRARY
E             Wrap: true
E           Insert:
E             Revisits: Uniform:  min=1,max=1000000
E             Visits: Fixed:  key=1
E             Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
E             Batch Type: not batching
E           Columns:
E             Max Columns Per Key: 10
E             Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
E             Comparator: AsciiType
E             Timestamp: null
E             Variable Column Count: false
E             Slice: false
E             Size Distribution: Fixed:  key=1024
E             Count Distribution: Fixed:  key=10
E           Errors:
E             Ignore: false
E             Tries: 10
E           Log:
E             No Summary: false
E             No Settings: false
E             File: null
E             Interval Millis: 1000
E             Level: NORMAL
E           Mode:
E             API: JAVA_DRIVER_NATIVE
E             Connection Style: CQL_PREPARED
E             CQL Version: CQL3
E             Protocol Version: V5
E             Username: null
E             Password: null
E             Auth Provide Class: null
E             Max Pending Per Connection: 128
E             Connections Per Host: 8
E             Compression: NONE
E           Node:
E             Nodes: [127.0.0.1]
E             Is White List: false
E             Datacenter: null
E           Schema:
E             Keyspace: keyspace1
E             Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
E             Replication Strategy Options: {replication_factor=1}
E             Table Compression: null
E             Table Compaction Strategy: null
E             Table Compaction Strategy Options: {}
E           Transport:
E             truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
E           Port:
E             Native Port: 9042
E             JMX Port: 7100
E           Send To Daemon:
E             *not set*
E           Graph:
E             File: null
E             Revision: unknown
E             Title: null
E             Operation: WRITE
E           TokenRange:
E             Wrap: false
E             Split Factor: 1
E           
E           ; 
E           stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
E           	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
E           	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
E           	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
E           	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
E           	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
E           Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
E           	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
E           	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
E           	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
E           	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
E           	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
E           	... 6 more

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:18:37,748 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:18:37,537 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:18:37.537674
11:18:37,650 dtest_setup INFO cluster ccm directory: /tmp/dtest-nfgqqc9n
----------------------------- Captured stdout call -----------------------------
11:18:37,754 ccm DEBUG using balanced tokens for non-vnode cluster
11:18:38,450 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nfgqqc9n/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nfgqqc9n/test/node1/conf'}
11:18:38,450 ccm INFO node1: using Java 8 for the current invocation
11:18:38,657 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nfgqqc9n/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nfgqqc9n/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:18:38,658 ccm INFO node1: using Java 8 for the current invocation
11:18:38,765 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:18:38,450 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nfgqqc9n/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nfgqqc9n/test/node1/conf'}
11:18:38,450 ccm INFO node1: using Java 8 for the current invocation
11:18:38,657 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nfgqqc9n/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nfgqqc9n/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:18:38,658 ccm INFO node1: using Java 8 for the current invocation
11:18:38,765 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:18:51,801 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:18:54,421 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:18:54,202 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:18:54.202790
11:18:54,317 dtest_setup INFO cluster ccm directory: /tmp/dtest-odupctc7
----------------------------- Captured stdout call -----------------------------
11:18:54,427 ccm DEBUG using balanced tokens for non-vnode cluster
11:18:55,96 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-odupctc7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-odupctc7/test/node1/conf'}
11:18:55,97 ccm INFO node1: using Java 8 for the current invocation
11:18:55,306 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-odupctc7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-odupctc7/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:18:55,308 ccm INFO node1: using Java 8 for the current invocation
11:18:55,419 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:18:55,96 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-odupctc7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-odupctc7/test/node1/conf'}
11:18:55,97 ccm INFO node1: using Java 8 for the current invocation
11:18:55,306 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-odupctc7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-odupctc7/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:18:55,308 ccm INFO node1: using Java 8 for the current invocation
11:18:55,419 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:18:51,801 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:18:51,801 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:19:06,6 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_sstableofflinerelevel failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_sstableofflinerelevel failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 29.03 seconds ===========================
[msx] rc = 1
v1v1 running time = 51092333763
cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel 
-------------------------------- live log call ---------------------------------
11:20:28,253 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:21:28,257 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:21:28,260 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:21:29,369 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.24 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:21:31,677 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.6 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:21:35,287 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 8.08 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:21:43,429 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 17.44 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_sstableofflinerelevel passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 140.93 seconds ==========================
[msx] rc = 0
v2v2 running time = 162988229762
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
h_list: range_request_timeout_in_ms@@@Tool@@@-2@@@50@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel 
-------------------------------- live log call ---------------------------------
11:23:13,15 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:23:13,349 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2833, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
11:24:13,20 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:24:13,22 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:24:14,231 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.88 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:24:16,142 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.16 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:24:20,349 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 8.72 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:24:29,73 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 14.72 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_sstableofflinerelevel passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 143.73 seconds ==========================
[msx] rc = 0
v1v2 running time = 165809804385
---> v1v2 test suceeded.
cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel FAILED [100%]

=================================== FAILURES ===================================
_________________ TestOfflineTools.test_sstableofflinerelevel __________________

self = <offline_tools_test.TestOfflineTools object at 0x7f7616766ba8>

    def test_sstableofflinerelevel(self):
        """
            Generate sstables of varying levels.
            Reset sstables to L0 with sstablelevelreset
            Run sstableofflinerelevel and ensure tables are promoted correctly
            Also test a variety of bad inputs including nonexistent keyspace and sstables
            @since 2.1.5
            @jira_ticket CASSANDRA-8031
            """
        cluster = self.cluster
        cluster.set_configuration_options(values={'compaction_throughput_mb_per_sec': 0})
        cluster.populate(1).start()
        node1 = cluster.nodelist()[0]
    
        # NOTE - As of now this does not return when it encounters Exception and causes test to hang, temporarily commented out
        # test by trying to run on nonexistent keyspace
        # cluster.stop(gently=False)
        # output, error, rc = node1.run_sstableofflinerelevel("keyspace1", "standard1", output=True)
        # assert "java.lang.IllegalArgumentException: Unknown keyspace/columnFamily keyspace1.standard1" in error
        # # this should return exit code 1
        # assert rc, 1 == msg=str(rc)
        # cluster.start()
    
        # now test by generating keyspace but not flushing sstables
    
        node1.stress(['write', 'n=1', 'no-warmup',
                      '-schema', 'replication(factor=1)',
                      '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)',
>                     '-rate', 'threads=8'])

offline_tools_test.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1502: in stress
    return handle_external_tool_process(p, ['stress'] + stress_options)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f7617000438>
cmd_args = ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', ...]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
E           stdout: ******************** Stress Settings ********************
E           Command:
E             Type: write
E             Count: 1
E             No Warmup: true
E             Consistency Level: LOCAL_ONE
E             Target Uncertainty: not applicable
E             Key Size (bytes): 10
E             Counter Increment Distibution: add=fixed(1)
E           Rate:
E             Auto: false
E             Thread Count: 8
E             OpsPer Sec: 0
E           Population:
E             Sequence: 1..1
E             Order: ARBITRARY
E             Wrap: true
E           Insert:
E             Revisits: Uniform:  min=1,max=1000000
E             Visits: Fixed:  key=1
E             Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
E             Batch Type: not batching
E           Columns:
E             Max Columns Per Key: 10
E             Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
E             Comparator: AsciiType
E             Timestamp: null
E             Variable Column Count: false
E             Slice: false
E             Size Distribution: Fixed:  key=1024
E             Count Distribution: Fixed:  key=10
E           Errors:
E             Ignore: false
E             Tries: 10
E           Log:
E             No Summary: false
E             No Settings: false
E             File: null
E             Interval Millis: 1000
E             Level: NORMAL
E           Mode:
E             API: JAVA_DRIVER_NATIVE
E             Connection Style: CQL_PREPARED
E             CQL Version: CQL3
E             Protocol Version: V5
E             Username: null
E             Password: null
E             Auth Provide Class: null
E             Max Pending Per Connection: 128
E             Connections Per Host: 8
E             Compression: NONE
E           Node:
E             Nodes: [127.0.0.1]
E             Is White List: false
E             Datacenter: null
E           Schema:
E             Keyspace: keyspace1
E             Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
E             Replication Strategy Options: {replication_factor=1}
E             Table Compression: null
E             Table Compaction Strategy: null
E             Table Compaction Strategy Options: {}
E           Transport:
E             truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
E           Port:
E             Native Port: 9042
E             JMX Port: 7100
E           Send To Daemon:
E             *not set*
E           Graph:
E             File: null
E             Revision: unknown
E             Title: null
E             Operation: WRITE
E           TokenRange:
E             Wrap: false
E             Split Factor: 1
E           
E           ; 
E           stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
E           	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
E           	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
E           	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
E           	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
E           	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
E           Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
E           	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
E           	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
E           	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
E           	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
E           	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
E           	... 6 more

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:24:57,652 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:24:57,442 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:24:57.442173
11:24:57,554 dtest_setup INFO cluster ccm directory: /tmp/dtest-yr69m_f8
----------------------------- Captured stdout call -----------------------------
11:24:57,658 ccm DEBUG using balanced tokens for non-vnode cluster
11:24:58,334 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yr69m_f8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yr69m_f8/test/node1/conf'}
11:24:58,335 ccm INFO node1: using Java 8 for the current invocation
11:24:58,555 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yr69m_f8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yr69m_f8/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:24:58,556 ccm INFO node1: using Java 8 for the current invocation
11:24:58,669 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:24:58,334 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yr69m_f8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yr69m_f8/test/node1/conf'}
11:24:58,335 ccm INFO node1: using Java 8 for the current invocation
11:24:58,555 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-yr69m_f8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-yr69m_f8/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:24:58,556 ccm INFO node1: using Java 8 for the current invocation
11:24:58,669 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:25:11,242 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:25:13,735 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:25:13,558 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:25:13.558930
11:25:13,640 dtest_setup INFO cluster ccm directory: /tmp/dtest-9h9a_x7z
----------------------------- Captured stdout call -----------------------------

11:25:13,742 ccm DEBUG using balanced tokens for non-vnode cluster
11:25:14,395 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9h9a_x7z/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9h9a_x7z/test/node1/conf'}
11:25:14,396 ccm INFO node1: using Java 8 for the current invocation
11:25:14,619 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9h9a_x7z/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9h9a_x7z/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:25:14,620 ccm INFO node1: using Java 8 for the current invocation
11:25:14,732 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:25:14,395 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9h9a_x7z/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9h9a_x7z/test/node1/conf'}
11:25:14,396 ccm INFO node1: using Java 8 for the current invocation
11:25:14,619 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9h9a_x7z/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9h9a_x7z/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:25:14,620 ccm INFO node1: using Java 8 for the current invocation
11:25:14,732 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:25:11,242 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:25:11,242 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:25:25,339 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_sstableofflinerelevel failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_sstableofflinerelevel failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 28.46 seconds ===========================
[msx] rc = 1
v1v1 running time = 50491393250
cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel 
-------------------------------- live log call ---------------------------------
11:26:47,105 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:27:47,109 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:27:47,112 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:27:48,119 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.04 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:27:50,225 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.6 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:27:53,837 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 8.48 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:28:02,372 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 13.76 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_sstableofflinerelevel passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 145.18 seconds ==========================
[msx] rc = 0
v2v2 running time = 167248843129
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
h_list: range_request_timeout_in_ms@@@Tool@@@-2@@@50@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel FAILED [100%]

=================================== FAILURES ===================================
_________________ TestOfflineTools.test_sstableofflinerelevel __________________

self = <offline_tools_test.TestOfflineTools object at 0x7fe032b5c748>

    def test_sstableofflinerelevel(self):
        """
            Generate sstables of varying levels.
            Reset sstables to L0 with sstablelevelreset
            Run sstableofflinerelevel and ensure tables are promoted correctly
            Also test a variety of bad inputs including nonexistent keyspace and sstables
            @since 2.1.5
            @jira_ticket CASSANDRA-8031
            """
        cluster = self.cluster
        cluster.set_configuration_options(values={'compaction_throughput_mb_per_sec': 0})
        cluster.populate(1).start()
        node1 = cluster.nodelist()[0]
    
        # NOTE - As of now this does not return when it encounters Exception and causes test to hang, temporarily commented out
        # test by trying to run on nonexistent keyspace
        # cluster.stop(gently=False)
        # output, error, rc = node1.run_sstableofflinerelevel("keyspace1", "standard1", output=True)
        # assert "java.lang.IllegalArgumentException: Unknown keyspace/columnFamily keyspace1.standard1" in error
        # # this should return exit code 1
        # assert rc, 1 == msg=str(rc)
        # cluster.start()
    
        # now test by generating keyspace but not flushing sstables
    
        node1.stress(['write', 'n=1', 'no-warmup',
                      '-schema', 'replication(factor=1)',
                      '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)',
>                     '-rate', 'threads=8'])

offline_tools_test.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1502: in stress
    return handle_external_tool_process(p, ['stress'] + stress_options)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7fe032bafb00>
cmd_args = ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', ...]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
E           stdout: ******************** Stress Settings ********************
E           Command:
E             Type: write
E             Count: 1
E             No Warmup: true
E             Consistency Level: LOCAL_ONE
E             Target Uncertainty: not applicable
E             Key Size (bytes): 10
E             Counter Increment Distibution: add=fixed(1)
E           Rate:
E             Auto: false
E             Thread Count: 8
E             OpsPer Sec: 0
E           Population:
E             Sequence: 1..1
E             Order: ARBITRARY
E             Wrap: true
E           Insert:
E             Revisits: Uniform:  min=1,max=1000000
E             Visits: Fixed:  key=1
E             Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
E             Batch Type: not batching
E           Columns:
E             Max Columns Per Key: 10
E             Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
E             Comparator: AsciiType
E             Timestamp: null
E             Variable Column Count: false
E             Slice: false
E             Size Distribution: Fixed:  key=1024
E             Count Distribution: Fixed:  key=10
E           Errors:
E             Ignore: false
E             Tries: 10
E           Log:
E             No Summary: false
E             No Settings: false
E             File: null
E             Interval Millis: 1000
E             Level: NORMAL
E           Mode:
E             API: JAVA_DRIVER_NATIVE
E             Connection Style: CQL_PREPARED
E             CQL Version: CQL3
E             Protocol Version: V5
E             Username: null
E             Password: null
E             Auth Provide Class: null
E             Max Pending Per Connection: 128
E             Connections Per Host: 8
E             Compression: NONE
E           Node:
E             Nodes: [127.0.0.1]
E             Is White List: false
E             Datacenter: null
E           Schema:
E             Keyspace: keyspace1
E             Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
E             Replication Strategy Options: {replication_factor=1}
E             Table Compression: null
E             Table Compaction Strategy: null
E             Table Compaction Strategy Options: {}
E           Transport:
E             truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
E           Port:
E             Native Port: 9042
E             JMX Port: 7100
E           Send To Daemon:
E             *not set*
E           Graph:
E             File: null
E             Revision: unknown
E             Title: null
E             Operation: WRITE
E           TokenRange:
E             Wrap: false
E             Split Factor: 1
E           
E           ; 
E           stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
E           	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
E           	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
E           	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
E           	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
E           	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
E           Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
E           	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
E           	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
E           	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
E           	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
E           	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
E           	... 6 more

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:28:35,488 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:28:35,223 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:28:35.223828
11:28:35,387 dtest_setup INFO cluster ccm directory: /tmp/dtest-9cch0asa
----------------------------- Captured stdout call -----------------------------
11:28:35,494 ccm DEBUG using balanced tokens for non-vnode cluster
11:28:36,208 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9cch0asa/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9cch0asa/test/node1/conf'}
11:28:36,209 ccm INFO node1: using Java 8 for the current invocation
11:28:36,426 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9cch0asa/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9cch0asa/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:28:36,427 ccm INFO node1: using Java 8 for the current invocation
11:28:36,538 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:28:36,208 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9cch0asa/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9cch0asa/test/node1/conf'}
11:28:36,209 ccm INFO node1: using Java 8 for the current invocation
11:28:36,426 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-9cch0asa/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-9cch0asa/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:28:36,427 ccm INFO node1: using Java 8 for the current invocation
11:28:36,538 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:28:48,72 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:28:50,627 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:28:50,451 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:28:50.451376
11:28:50,532 dtest_setup INFO cluster ccm directory: /tmp/dtest-6crgo4wg
----------------------------- Captured stdout call -----------------------------

11:28:50,634 ccm DEBUG using balanced tokens for non-vnode cluster
11:28:51,367 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6crgo4wg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6crgo4wg/test/node1/conf'}
11:28:51,368 ccm INFO node1: using Java 8 for the current invocation
11:28:51,554 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6crgo4wg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6crgo4wg/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:28:51,556 ccm INFO node1: using Java 8 for the current invocation
11:28:51,659 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:28:51,367 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6crgo4wg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6crgo4wg/test/node1/conf'}
11:28:51,368 ccm INFO node1: using Java 8 for the current invocation
11:28:51,554 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6crgo4wg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6crgo4wg/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:28:51,556 ccm INFO node1: using Java 8 for the current invocation
11:28:51,659 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:28:48,72 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:28:48,72 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:29:02,223 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_sstableofflinerelevel failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_sstableofflinerelevel failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 27.54 seconds ===========================
[msx] rc = 1
v1v2 running time = 49612022031
---> v1v2 test failed.
proj: cassandra
u_test: offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
h_list: range_request_timeout_in_ms@@@Tool@@@-2@@@50@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel FAILED [100%]

=================================== FAILURES ===================================
_________________ TestOfflineTools.test_sstableofflinerelevel __________________

self = <offline_tools_test.TestOfflineTools object at 0x7f90d8d06208>

    def test_sstableofflinerelevel(self):
        """
            Generate sstables of varying levels.
            Reset sstables to L0 with sstablelevelreset
            Run sstableofflinerelevel and ensure tables are promoted correctly
            Also test a variety of bad inputs including nonexistent keyspace and sstables
            @since 2.1.5
            @jira_ticket CASSANDRA-8031
            """
        cluster = self.cluster
        cluster.set_configuration_options(values={'compaction_throughput_mb_per_sec': 0})
        cluster.populate(1).start()
        node1 = cluster.nodelist()[0]
    
        # NOTE - As of now this does not return when it encounters Exception and causes test to hang, temporarily commented out
        # test by trying to run on nonexistent keyspace
        # cluster.stop(gently=False)
        # output, error, rc = node1.run_sstableofflinerelevel("keyspace1", "standard1", output=True)
        # assert "java.lang.IllegalArgumentException: Unknown keyspace/columnFamily keyspace1.standard1" in error
        # # this should return exit code 1
        # assert rc, 1 == msg=str(rc)
        # cluster.start()
    
        # now test by generating keyspace but not flushing sstables
    
        node1.stress(['write', 'n=1', 'no-warmup',
                      '-schema', 'replication(factor=1)',
                      '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)',
>                     '-rate', 'threads=8'])

offline_tools_test.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1502: in stress
    return handle_external_tool_process(p, ['stress'] + stress_options)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f90d8d06710>
cmd_args = ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', ...]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
E           stdout: ******************** Stress Settings ********************
E           Command:
E             Type: write
E             Count: 1
E             No Warmup: true
E             Consistency Level: LOCAL_ONE
E             Target Uncertainty: not applicable
E             Key Size (bytes): 10
E             Counter Increment Distibution: add=fixed(1)
E           Rate:
E             Auto: false
E             Thread Count: 8
E             OpsPer Sec: 0
E           Population:
E             Sequence: 1..1
E             Order: ARBITRARY
E             Wrap: true
E           Insert:
E             Revisits: Uniform:  min=1,max=1000000
E             Visits: Fixed:  key=1
E             Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
E             Batch Type: not batching
E           Columns:
E             Max Columns Per Key: 10
E             Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
E             Comparator: AsciiType
E             Timestamp: null
E             Variable Column Count: false
E             Slice: false
E             Size Distribution: Fixed:  key=1024
E             Count Distribution: Fixed:  key=10
E           Errors:
E             Ignore: false
E             Tries: 10
E           Log:
E             No Summary: false
E             No Settings: false
E             File: null
E             Interval Millis: 1000
E             Level: NORMAL
E           Mode:
E             API: JAVA_DRIVER_NATIVE
E             Connection Style: CQL_PREPARED
E             CQL Version: CQL3
E             Protocol Version: V5
E             Username: null
E             Password: null
E             Auth Provide Class: null
E             Max Pending Per Connection: 128
E             Connections Per Host: 8
E             Compression: NONE
E           Node:
E             Nodes: [127.0.0.1]
E             Is White List: false
E             Datacenter: null
E           Schema:
E             Keyspace: keyspace1
E             Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
E             Replication Strategy Options: {replication_factor=1}
E             Table Compression: null
E             Table Compaction Strategy: null
E             Table Compaction Strategy Options: {}
E           Transport:
E             truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
E           Port:
E             Native Port: 9042
E             JMX Port: 7100
E           Send To Daemon:
E             *not set*
E           Graph:
E             File: null
E             Revision: unknown
E             Title: null
E             Operation: WRITE
E           TokenRange:
E             Wrap: false
E             Split Factor: 1
E           
E           ; 
E           stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
E           	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
E           	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
E           	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
E           	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
E           	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
E           Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
E           	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
E           	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
E           	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
E           	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
E           	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
E           	... 6 more

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
1:29:25,169 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:29:24,883 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:29:24.882938
11:29:25,63 dtest_setup INFO cluster ccm directory: /tmp/dtest-2pceq73m
----------------------------- Captured stdout call -----------------------------
11:29:25,176 ccm DEBUG using balanced tokens for non-vnode cluster
11:29:25,855 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2pceq73m/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2pceq73m/test/node1/conf'}
11:29:25,856 ccm INFO node1: using Java 8 for the current invocation
11:29:26,76 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2pceq73m/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2pceq73m/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:29:26,78 ccm INFO node1: using Java 8 for the current invocation
11:29:26,189 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:29:25,855 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2pceq73m/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2pceq73m/test/node1/conf'}
11:29:25,856 ccm INFO node1: using Java 8 for the current invocation
11:29:26,76 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2pceq73m/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2pceq73m/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:29:26,78 ccm INFO node1: using Java 8 for the current invocation
11:29:26,189 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:29:37,972 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:29:40,541 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:29:40,327 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:29:40.327206
11:29:40,441 dtest_setup INFO cluster ccm directory: /tmp/dtest-0o2ih0vo
----------------------------- Captured stdout call -----------------------------

11:29:40,552 ccm DEBUG using balanced tokens for non-vnode cluster
11:29:41,212 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0o2ih0vo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0o2ih0vo/test/node1/conf'}
11:29:41,213 ccm INFO node1: using Java 8 for the current invocation
11:29:41,435 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0o2ih0vo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0o2ih0vo/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:29:41,437 ccm INFO node1: using Java 8 for the current invocation
11:29:41,554 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:29:41,212 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0o2ih0vo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0o2ih0vo/test/node1/conf'}
11:29:41,213 ccm INFO node1: using Java 8 for the current invocation
11:29:41,435 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0o2ih0vo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0o2ih0vo/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:29:41,437 ccm INFO node1: using Java 8 for the current invocation
11:29:41,554 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:29:37,972 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:29:37,972 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:29:52,628 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_sstableofflinerelevel failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_sstableofflinerelevel failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 28.35 seconds ===========================
[msx] rc = 1
v1v1 running time = 50497190610
cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel 
-------------------------------- live log call ---------------------------------
11:31:15,575 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:32:15,578 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:32:15,580 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:32:16,590 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.98 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:32:18,595 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.12 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:32:22,809 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 6.88 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:32:29,733 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 17.28 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_sstableofflinerelevel passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 145.71 seconds ==========================
[msx] rc = 0
v2v2 running time = 167781030051
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
h_list: range_request_timeout_in_ms@@@Tool@@@-2@@@50@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel FAILED [100%]

=================================== FAILURES ===================================
_________________ TestOfflineTools.test_sstableofflinerelevel __________________

self = <offline_tools_test.TestOfflineTools object at 0x7fd9eef82ac8>

    def test_sstableofflinerelevel(self):
        """
            Generate sstables of varying levels.
            Reset sstables to L0 with sstablelevelreset
            Run sstableofflinerelevel and ensure tables are promoted correctly
            Also test a variety of bad inputs including nonexistent keyspace and sstables
            @since 2.1.5
            @jira_ticket CASSANDRA-8031
            """
        cluster = self.cluster
        cluster.set_configuration_options(values={'compaction_throughput_mb_per_sec': 0})
        cluster.populate(1).start()
        node1 = cluster.nodelist()[0]
    
        # NOTE - As of now this does not return when it encounters Exception and causes test to hang, temporarily commented out
        # test by trying to run on nonexistent keyspace
        # cluster.stop(gently=False)
        # output, error, rc = node1.run_sstableofflinerelevel("keyspace1", "standard1", output=True)
        # assert "java.lang.IllegalArgumentException: Unknown keyspace/columnFamily keyspace1.standard1" in error
        # # this should return exit code 1
        # assert rc, 1 == msg=str(rc)
        # cluster.start()
    
        # now test by generating keyspace but not flushing sstables
    
        node1.stress(['write', 'n=1', 'no-warmup',
                      '-schema', 'replication(factor=1)',
                      '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)',
>                     '-rate', 'threads=8'])

offline_tools_test.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1502: in stress
    return handle_external_tool_process(p, ['stress'] + stress_options)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7fd9eef82f60>
cmd_args = ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', ...]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
E           stdout: ******************** Stress Settings ********************
E           Command:
E             Type: write
E             Count: 1
E             No Warmup: true
E             Consistency Level: LOCAL_ONE
E             Target Uncertainty: not applicable
E             Key Size (bytes): 10
E             Counter Increment Distibution: add=fixed(1)
E           Rate:
E             Auto: false
E             Thread Count: 8
E             OpsPer Sec: 0
E           Population:
E             Sequence: 1..1
E             Order: ARBITRARY
E             Wrap: true
E           Insert:
E             Revisits: Uniform:  min=1,max=1000000
E             Visits: Fixed:  key=1
E             Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
E             Batch Type: not batching
E           Columns:
E             Max Columns Per Key: 10
E             Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
E             Comparator: AsciiType
E             Timestamp: null
E             Variable Column Count: false
E             Slice: false
E             Size Distribution: Fixed:  key=1024
E             Count Distribution: Fixed:  key=10
E           Errors:
E             Ignore: false
E             Tries: 10
E           Log:
E             No Summary: false
E             No Settings: false
E             File: null
E             Interval Millis: 1000
E             Level: NORMAL
E           Mode:
E             API: JAVA_DRIVER_NATIVE
E             Connection Style: CQL_PREPARED
E             CQL Version: CQL3
E             Protocol Version: V5
E             Username: null
E             Password: null
E             Auth Provide Class: null
E             Max Pending Per Connection: 128
E             Connections Per Host: 8
E             Compression: NONE
E           Node:
E             Nodes: [127.0.0.1]
E             Is White List: false
E             Datacenter: null
E           Schema:
E             Keyspace: keyspace1
E             Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
E             Replication Strategy Options: {replication_factor=1}
E             Table Compression: null
E             Table Compaction Strategy: null
E             Table Compaction Strategy Options: {}
E           Transport:
E             truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
E           Port:
E             Native Port: 9042
E             JMX Port: 7100
E           Send To Daemon:
E             *not set*
E           Graph:
E             File: null
E             Revision: unknown
E             Title: null
E             Operation: WRITE
E           TokenRange:
E             Wrap: false
E             Split Factor: 1
E           
E           ; 
E           stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
E           	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
E           	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
E           	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
E           	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
E           	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
E           Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
E           	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
E           	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
E           	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
E           	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
E           	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
E           	... 6 more

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:33:03,248 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:33:03,23 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:33:03.023252
11:33:03,151 dtest_setup INFO cluster ccm directory: /tmp/dtest-edxi9at1
----------------------------- Captured stdout call -----------------------------

11:33:03,254 ccm DEBUG using balanced tokens for non-vnode cluster
11:33:03,885 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-edxi9at1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-edxi9at1/test/node1/conf'}
11:33:03,886 ccm INFO node1: using Java 8 for the current invocation
11:33:04,106 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-edxi9at1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-edxi9at1/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:33:04,107 ccm INFO node1: using Java 8 for the current invocation
11:33:04,217 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:33:03,885 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-edxi9at1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-edxi9at1/test/node1/conf'}
11:33:03,886 ccm INFO node1: using Java 8 for the current invocation
11:33:04,106 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-edxi9at1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-edxi9at1/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:33:04,107 ccm INFO node1: using Java 8 for the current invocation
11:33:04,217 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:33:16,858 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:33:19,414 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:33:19,208 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:33:19.208825
11:33:19,319 dtest_setup INFO cluster ccm directory: /tmp/dtest-ahhb61dw
----------------------------- Captured stdout call -----------------------------

11:33:19,419 ccm DEBUG using balanced tokens for non-vnode cluster
11:33:20,42 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ahhb61dw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ahhb61dw/test/node1/conf'}
11:33:20,43 ccm INFO node1: using Java 8 for the current invocation
11:33:20,286 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ahhb61dw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ahhb61dw/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:33:20,287 ccm INFO node1: using Java 8 for the current invocation
11:33:20,402 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:33:20,42 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ahhb61dw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ahhb61dw/test/node1/conf'}
11:33:20,43 ccm INFO node1: using Java 8 for the current invocation
11:33:20,286 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ahhb61dw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ahhb61dw/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:33:20,287 ccm INFO node1: using Java 8 for the current invocation
11:33:20,402 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:33:16,858 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:33:16,858 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:33:30,952 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_sstableofflinerelevel failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_sstableofflinerelevel failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 28.44 seconds ===========================
[msx] rc = 1
v1v2 running time = 50606777027
---> v1v2 test failed.
proj: cassandra
u_test: offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
h_list: range_request_timeout_in_ms@@@Tool@@@-2@@@50@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel FAILED [100%]

=================================== FAILURES ===================================
_________________ TestOfflineTools.test_sstableofflinerelevel __________________

self = <offline_tools_test.TestOfflineTools object at 0x7f5fcb9bc630>

    def test_sstableofflinerelevel(self):
        """
            Generate sstables of varying levels.
            Reset sstables to L0 with sstablelevelreset
            Run sstableofflinerelevel and ensure tables are promoted correctly
            Also test a variety of bad inputs including nonexistent keyspace and sstables
            @since 2.1.5
            @jira_ticket CASSANDRA-8031
            """
        cluster = self.cluster
        cluster.set_configuration_options(values={'compaction_throughput_mb_per_sec': 0})
        cluster.populate(1).start()
        node1 = cluster.nodelist()[0]
    
        # NOTE - As of now this does not return when it encounters Exception and causes test to hang, temporarily commented out
        # test by trying to run on nonexistent keyspace
        # cluster.stop(gently=False)
        # output, error, rc = node1.run_sstableofflinerelevel("keyspace1", "standard1", output=True)
        # assert "java.lang.IllegalArgumentException: Unknown keyspace/columnFamily keyspace1.standard1" in error
        # # this should return exit code 1
        # assert rc, 1 == msg=str(rc)
        # cluster.start()
    
        # now test by generating keyspace but not flushing sstables
    
        node1.stress(['write', 'n=1', 'no-warmup',
                      '-schema', 'replication(factor=1)',
                      '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)',
>                     '-rate', 'threads=8'])

offline_tools_test.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1502: in stress
    return handle_external_tool_process(p, ['stress'] + stress_options)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f5fcb9b05c0>
cmd_args = ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', ...]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
E           stdout: ******************** Stress Settings ********************
E           Command:
E             Type: write
E             Count: 1
E             No Warmup: true
E             Consistency Level: LOCAL_ONE
E             Target Uncertainty: not applicable
E             Key Size (bytes): 10
E             Counter Increment Distibution: add=fixed(1)
E           Rate:
E             Auto: false
E             Thread Count: 8
E             OpsPer Sec: 0
E           Population:
E             Sequence: 1..1
E             Order: ARBITRARY
E             Wrap: true
E           Insert:
E             Revisits: Uniform:  min=1,max=1000000
E             Visits: Fixed:  key=1
E             Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
E             Batch Type: not batching
E           Columns:
E             Max Columns Per Key: 10
E             Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
E             Comparator: AsciiType
E             Timestamp: null
E             Variable Column Count: false
E             Slice: false
E             Size Distribution: Fixed:  key=1024
E             Count Distribution: Fixed:  key=10
E           Errors:
E             Ignore: false
E             Tries: 10
E           Log:
E             No Summary: false
E             No Settings: false
E             File: null
E             Interval Millis: 1000
E             Level: NORMAL
E           Mode:
E             API: JAVA_DRIVER_NATIVE
E             Connection Style: CQL_PREPARED
E             CQL Version: CQL3
E             Protocol Version: V5
E             Username: null
E             Password: null
E             Auth Provide Class: null
E             Max Pending Per Connection: 128
E             Connections Per Host: 8
E             Compression: NONE
E           Node:
E             Nodes: [127.0.0.1]
E             Is White List: false
E             Datacenter: null
E           Schema:
E             Keyspace: keyspace1
E             Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
E             Replication Strategy Options: {replication_factor=1}
E             Table Compression: null
E             Table Compaction Strategy: null
E             Table Compaction Strategy Options: {}
E           Transport:
E             truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
E           Port:
E             Native Port: 9042
E             JMX Port: 7100
E           Send To Daemon:
E             *not set*
E           Graph:
E             File: null
E             Revision: unknown
E             Title: null
E             Operation: WRITE
E           TokenRange:
E             Wrap: false
E             Split Factor: 1
E           
E           ; 
E           stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
E           	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
E           	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
E           	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
E           	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
E           	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
E           Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
E           	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
E           	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
E           	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
E           	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
E           	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
E           	... 6 more

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:33:53,851 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:33:53,640 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:33:53.640508
11:33:53,752 dtest_setup INFO cluster ccm directory: /tmp/dtest-3ihkcvzg
----------------------------- Captured stdout call -----------------------------

11:33:53,857 ccm DEBUG using balanced tokens for non-vnode cluster
11:33:54,536 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3ihkcvzg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3ihkcvzg/test/node1/conf'}
11:33:54,537 ccm INFO node1: using Java 8 for the current invocation
11:33:54,731 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3ihkcvzg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3ihkcvzg/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:33:54,732 ccm INFO node1: using Java 8 for the current invocation
11:33:54,840 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:33:54,536 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3ihkcvzg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3ihkcvzg/test/node1/conf'}
11:33:54,537 ccm INFO node1: using Java 8 for the current invocation
11:33:54,731 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3ihkcvzg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3ihkcvzg/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:33:54,732 ccm INFO node1: using Java 8 for the current invocation
11:33:54,840 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:34:07,399 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:34:09,941 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:34:09,761 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:34:09.761270
11:34:09,841 dtest_setup INFO cluster ccm directory: /tmp/dtest-m9g2pvx6
----------------------------- Captured stdout call -----------------------------

11:34:09,948 ccm DEBUG using balanced tokens for non-vnode cluster
11:34:10,627 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9g2pvx6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9g2pvx6/test/node1/conf'}
11:34:10,628 ccm INFO node1: using Java 8 for the current invocation
11:34:10,850 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9g2pvx6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9g2pvx6/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:34:10,851 ccm INFO node1: using Java 8 for the current invocation
11:34:10,960 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:34:10,627 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9g2pvx6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9g2pvx6/test/node1/conf'}
11:34:10,628 ccm INFO node1: using Java 8 for the current invocation
11:34:10,850 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-m9g2pvx6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-m9g2pvx6/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:34:10,851 ccm INFO node1: using Java 8 for the current invocation
11:34:10,960 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:34:07,399 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:34:07,399 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:34:21,524 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_sstableofflinerelevel failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_sstableofflinerelevel failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 28.42 seconds ===========================
[msx] rc = 1
v1v1 running time = 50435701805
cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel 
-------------------------------- live log call ---------------------------------
11:35:44,352 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:36:44,356 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:36:44,359 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:36:45,567 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.2 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:36:47,776 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.4 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:36:51,189 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 8.0 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:36:59,216 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 16.0 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_sstableofflinerelevel passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 143.67 seconds ==========================
[msx] rc = 0
v2v2 running time = 165654909753
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
h_list: range_request_timeout_in_ms@@@Tool@@@-2@@@50@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel 
-------------------------------- live log call ---------------------------------
11:38:45,457 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:38:45,768 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3599, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3596, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 3698, in cassandra.cluster.ControlConnection._refresh_schema
  File "cassandra/metadata.py", line 142, in cassandra.metadata.Metadata.refresh
  File "cassandra/metadata.py", line 165, in cassandra.metadata.Metadata._rebuild_all
  File "cassandra/metadata.py", line 2872, in get_all_keyspaces
  File "cassandra/metadata.py", line 2522, in get_all_keyspaces
  File "cassandra/metadata.py", line 2031, in get_all_keyspaces
  File "cassandra/metadata.py", line 2833, in cassandra.metadata.SchemaParserV4._query_all
  File "cassandra/metadata.py", line 1953, in cassandra.metadata._SchemaParser._handle_results
cassandra.ReadTimeout: Error from server: code=1200 [Coordinator node timed out waiting for replica nodes' responses] message="Operation timed out - received only 0 responses." info={'consistency': 'ONE', 'required_responses': 1, 'received_responses': 0}
11:39:45,459 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:39:45,461 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:39:46,568 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.88 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:39:48,477 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.04 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:39:52,588 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 7.12 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:39:59,815 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 16.32 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_sstableofflinerelevel failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_sstableofflinerelevel passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 158.96 seconds ==========================
[msx] rc = 0
v1v2 running time = 181086065015
---> v1v2 test suceeded.
cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel FAILED [100%]

=================================== FAILURES ===================================
_________________ TestOfflineTools.test_sstableofflinerelevel __________________

self = <offline_tools_test.TestOfflineTools object at 0x7f63fb81b400>

    def test_sstableofflinerelevel(self):
        """
            Generate sstables of varying levels.
            Reset sstables to L0 with sstablelevelreset
            Run sstableofflinerelevel and ensure tables are promoted correctly
            Also test a variety of bad inputs including nonexistent keyspace and sstables
            @since 2.1.5
            @jira_ticket CASSANDRA-8031
            """
        cluster = self.cluster
        cluster.set_configuration_options(values={'compaction_throughput_mb_per_sec': 0})
        cluster.populate(1).start()
        node1 = cluster.nodelist()[0]
    
        # NOTE - As of now this does not return when it encounters Exception and causes test to hang, temporarily commented out
        # test by trying to run on nonexistent keyspace
        # cluster.stop(gently=False)
        # output, error, rc = node1.run_sstableofflinerelevel("keyspace1", "standard1", output=True)
        # assert "java.lang.IllegalArgumentException: Unknown keyspace/columnFamily keyspace1.standard1" in error
        # # this should return exit code 1
        # assert rc, 1 == msg=str(rc)
        # cluster.start()
    
        # now test by generating keyspace but not flushing sstables
    
        node1.stress(['write', 'n=1', 'no-warmup',
                      '-schema', 'replication(factor=1)',
                      '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)',
>                     '-rate', 'threads=8'])

offline_tools_test.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1502: in stress
    return handle_external_tool_process(p, ['stress'] + stress_options)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f63fb803a20>
cmd_args = ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', ...]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
E           stdout: ******************** Stress Settings ********************
E           Command:
E             Type: write
E             Count: 1
E             No Warmup: true
E             Consistency Level: LOCAL_ONE
E             Target Uncertainty: not applicable
E             Key Size (bytes): 10
E             Counter Increment Distibution: add=fixed(1)
E           Rate:
E             Auto: false
E             Thread Count: 8
E             OpsPer Sec: 0
E           Population:
E             Sequence: 1..1
E             Order: ARBITRARY
E             Wrap: true
E           Insert:
E             Revisits: Uniform:  min=1,max=1000000
E             Visits: Fixed:  key=1
E             Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
E             Batch Type: not batching
E           Columns:
E             Max Columns Per Key: 10
E             Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
E             Comparator: AsciiType
E             Timestamp: null
E             Variable Column Count: false
E             Slice: false
E             Size Distribution: Fixed:  key=1024
E             Count Distribution: Fixed:  key=10
E           Errors:
E             Ignore: false
E             Tries: 10
E           Log:
E             No Summary: false
E             No Settings: false
E             File: null
E             Interval Millis: 1000
E             Level: NORMAL
E           Mode:
E             API: JAVA_DRIVER_NATIVE
E             Connection Style: CQL_PREPARED
E             CQL Version: CQL3
E             Protocol Version: V5
E             Username: null
E             Password: null
E             Auth Provide Class: null
E             Max Pending Per Connection: 128
E             Connections Per Host: 8
E             Compression: NONE
E           Node:
E             Nodes: [127.0.0.1]
E             Is White List: false
E             Datacenter: null
E           Schema:
E             Keyspace: keyspace1
E             Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
E             Replication Strategy Options: {replication_factor=1}
E             Table Compression: null
E             Table Compaction Strategy: null
E             Table Compaction Strategy Options: {}
E           Transport:
E             truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
E           Port:
E             Native Port: 9042
E             JMX Port: 7100
E           Send To Daemon:
E             *not set*
E           Graph:
E             File: null
E             Revision: unknown
E             Title: null
E             Operation: WRITE
E           TokenRange:
E             Wrap: false
E             Split Factor: 1
E           
E           ; 
E           stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
E           	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
E           	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
E           	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
E           	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
E           	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
E           Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
E           	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
E           	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
E           	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
E           	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
E           	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
E           	... 6 more

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:40:31,67 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:40:30,873 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:40:30.872963
11:40:30,969 dtest_setup INFO cluster ccm directory: /tmp/dtest-twtdja4v
----------------------------- Captured stdout call -----------------------------
11:40:31,73 ccm DEBUG using balanced tokens for non-vnode cluster
11:40:31,794 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-twtdja4v/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-twtdja4v/test/node1/conf'}
11:40:31,796 ccm INFO node1: using Java 8 for the current invocation
11:40:32,15 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-twtdja4v/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-twtdja4v/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:40:32,16 ccm INFO node1: using Java 8 for the current invocation
11:40:32,126 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:40:31,794 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-twtdja4v/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-twtdja4v/test/node1/conf'}
11:40:31,796 ccm INFO node1: using Java 8 for the current invocation
11:40:32,15 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-twtdja4v/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-twtdja4v/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:40:32,16 ccm INFO node1: using Java 8 for the current invocation
11:40:32,126 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:40:44,647 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
1:40:47,282 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:40:47,57 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:40:47.057137
11:40:47,171 dtest_setup INFO cluster ccm directory: /tmp/dtest-5wukxu9v
----------------------------- Captured stdout call -----------------------------
11:40:47,291 ccm DEBUG using balanced tokens for non-vnode cluster
11:40:48,15 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5wukxu9v/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5wukxu9v/test/node1/conf'}
11:40:48,16 ccm INFO node1: using Java 8 for the current invocation
11:40:48,227 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5wukxu9v/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5wukxu9v/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:40:48,227 ccm INFO node1: using Java 8 for the current invocation
11:40:48,351 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:40:48,15 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5wukxu9v/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5wukxu9v/test/node1/conf'}
11:40:48,16 ccm INFO node1: using Java 8 for the current invocation
11:40:48,227 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-5wukxu9v/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-5wukxu9v/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:40:48,227 ccm INFO node1: using Java 8 for the current invocation
11:40:48,351 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:40:44,647 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:40:44,647 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:40:59,615 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_sstableofflinerelevel failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_sstableofflinerelevel failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 29.29 seconds ===========================
[msx] rc = 1
v1v1 running time = 51314739814
cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel 
-------------------------------- live log call ---------------------------------
11:42:23,18 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:42:23,22 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:43:23,21 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:43:23,24 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:43:24,132 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 2.24 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:43:26,442 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.24 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:43:30,755 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 7.28 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:43:38,78 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 16.32 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_sstableofflinerelevel passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 145.73 seconds ==========================
[msx] rc = 0
v2v2 running time = 167908282163
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
h_list: range_request_timeout_in_ms@@@Tool@@@-2@@@50@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel FAILED [100%]

=================================== FAILURES ===================================
_________________ TestOfflineTools.test_sstableofflinerelevel __________________

self = <offline_tools_test.TestOfflineTools object at 0x7f3748552d68>

    def test_sstableofflinerelevel(self):
        """
            Generate sstables of varying levels.
            Reset sstables to L0 with sstablelevelreset
            Run sstableofflinerelevel and ensure tables are promoted correctly
            Also test a variety of bad inputs including nonexistent keyspace and sstables
            @since 2.1.5
            @jira_ticket CASSANDRA-8031
            """
        cluster = self.cluster
        cluster.set_configuration_options(values={'compaction_throughput_mb_per_sec': 0})
        cluster.populate(1).start()
        node1 = cluster.nodelist()[0]
    
        # NOTE - As of now this does not return when it encounters Exception and causes test to hang, temporarily commented out
        # test by trying to run on nonexistent keyspace
        # cluster.stop(gently=False)
        # output, error, rc = node1.run_sstableofflinerelevel("keyspace1", "standard1", output=True)
        # assert "java.lang.IllegalArgumentException: Unknown keyspace/columnFamily keyspace1.standard1" in error
        # # this should return exit code 1
        # assert rc, 1 == msg=str(rc)
        # cluster.start()
    
        # now test by generating keyspace but not flushing sstables
    
        node1.stress(['write', 'n=1', 'no-warmup',
                      '-schema', 'replication(factor=1)',
                      '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)',
>                     '-rate', 'threads=8'])

offline_tools_test.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1502: in stress
    return handle_external_tool_process(p, ['stress'] + stress_options)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f3747ca55c0>
cmd_args = ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', ...]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
E           stdout: ******************** Stress Settings ********************
E           Command:
E             Type: write
E             Count: 1
E             No Warmup: true
E             Consistency Level: LOCAL_ONE
E             Target Uncertainty: not applicable
E             Key Size (bytes): 10
E             Counter Increment Distibution: add=fixed(1)
E           Rate:
E             Auto: false
E             Thread Count: 8
E             OpsPer Sec: 0
E           Population:
E             Sequence: 1..1
E             Order: ARBITRARY
E             Wrap: true
E           Insert:
E             Revisits: Uniform:  min=1,max=1000000
E             Visits: Fixed:  key=1
E             Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
E             Batch Type: not batching
E           Columns:
E             Max Columns Per Key: 10
E             Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
E             Comparator: AsciiType
E             Timestamp: null
E             Variable Column Count: false
E             Slice: false
E             Size Distribution: Fixed:  key=1024
E             Count Distribution: Fixed:  key=10
E           Errors:
E             Ignore: false
E             Tries: 10
E           Log:
E             No Summary: false
E             No Settings: false
E             File: null
E             Interval Millis: 1000
E             Level: NORMAL
E           Mode:
E             API: JAVA_DRIVER_NATIVE
E             Connection Style: CQL_PREPARED
E             CQL Version: CQL3
E             Protocol Version: V5
E             Username: null
E             Password: null
E             Auth Provide Class: null
E             Max Pending Per Connection: 128
E             Connections Per Host: 8
E             Compression: NONE
E           Node:
E             Nodes: [127.0.0.1]
E             Is White List: false
E             Datacenter: null
E           Schema:
E             Keyspace: keyspace1
E             Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
E             Replication Strategy Options: {replication_factor=1}
E             Table Compression: null
E             Table Compaction Strategy: null
E             Table Compaction Strategy Options: {}
E           Transport:
E             truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
E           Port:
E             Native Port: 9042
E             JMX Port: 7100
E           Send To Daemon:
E             *not set*
E           Graph:
E             File: null
E             Revision: unknown
E             Title: null
E             Operation: WRITE
E           TokenRange:
E             Wrap: false
E             Split Factor: 1
E           
E           ; 
E           stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
E           	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
E           	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
E           	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
E           	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
E           	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
E           Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
E           	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
E           	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
E           	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
E           	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
E           	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
E           	... 6 more

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:44:10,305 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:44:10,111 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:44:10.111665
11:44:10,206 dtest_setup INFO cluster ccm directory: /tmp/dtest-ja2vqdpf
----------------------------- Captured stdout call -----------------------------
11:44:10,311 ccm DEBUG using balanced tokens for non-vnode cluster
11:44:11,0 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ja2vqdpf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ja2vqdpf/test/node1/conf'}
11:44:11,1 ccm INFO node1: using Java 8 for the current invocation
11:44:11,228 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ja2vqdpf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ja2vqdpf/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:44:11,229 ccm INFO node1: using Java 8 for the current invocation
11:44:11,343 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:44:11,0 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ja2vqdpf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ja2vqdpf/test/node1/conf'}
11:44:11,1 ccm INFO node1: using Java 8 for the current invocation
11:44:11,228 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ja2vqdpf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ja2vqdpf/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:44:11,229 ccm INFO node1: using Java 8 for the current invocation
11:44:11,343 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:44:23,888 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:44:26,510 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:44:26,283 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:44:26.283181
11:44:26,413 dtest_setup INFO cluster ccm directory: /tmp/dtest-7tg70q0t
----------------------------- Captured stdout call -----------------------------

11:44:26,517 ccm DEBUG using balanced tokens for non-vnode cluster
11:44:27,166 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7tg70q0t/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7tg70q0t/test/node1/conf'}
11:44:27,168 ccm INFO node1: using Java 8 for the current invocation
11:44:27,391 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7tg70q0t/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7tg70q0t/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:44:27,392 ccm INFO node1: using Java 8 for the current invocation
11:44:27,504 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:44:27,166 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7tg70q0t/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7tg70q0t/test/node1/conf'}
11:44:27,168 ccm INFO node1: using Java 8 for the current invocation
11:44:27,391 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7tg70q0t/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7tg70q0t/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:44:27,392 ccm INFO node1: using Java 8 for the current invocation
11:44:27,504 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:44:23,888 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:44:23,888 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:44:37,802 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_sstableofflinerelevel failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_sstableofflinerelevel failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 28.24 seconds ===========================
[msx] rc = 1
v1v2 running time = 50283477480
---> v1v2 test failed.
proj: cassandra
u_test: offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
h_list: range_request_timeout_in_ms@@@Tool@@@-2@@@50@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel 
-------------------------------- live log call ---------------------------------
11:46:00,479 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:46:00,483 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:47:00,482 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:47:00,485 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:47:01,495 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.88 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:47:03,403 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.04 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:47:07,516 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 7.2 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:47:14,740 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 14.88 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_sstableofflinerelevel passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 145.17 seconds ==========================
[msx] rc = 0
v1v1 running time = 167191194051
cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel 
-------------------------------- live log call ---------------------------------
11:48:47,942 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:48:47,945 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:49:47,946 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:49:47,949 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:49:48,956 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.8 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:49:50,762 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 3.48 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:49:54,281 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 8.48 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:50:02,803 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 16.96 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_sstableofflinerelevel passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 144.01 seconds ==========================
[msx] rc = 0
v2v2 running time = 166181748799
---> v1v1 and v2v2 test test suceeded.
cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel FAILED [100%]

=================================== FAILURES ===================================
_________________ TestOfflineTools.test_sstableofflinerelevel __________________

self = <offline_tools_test.TestOfflineTools object at 0x7f191ca04b00>

    def test_sstableofflinerelevel(self):
        """
            Generate sstables of varying levels.
            Reset sstables to L0 with sstablelevelreset
            Run sstableofflinerelevel and ensure tables are promoted correctly
            Also test a variety of bad inputs including nonexistent keyspace and sstables
            @since 2.1.5
            @jira_ticket CASSANDRA-8031
            """
        cluster = self.cluster
        cluster.set_configuration_options(values={'compaction_throughput_mb_per_sec': 0})
        cluster.populate(1).start()
        node1 = cluster.nodelist()[0]
    
        # NOTE - As of now this does not return when it encounters Exception and causes test to hang, temporarily commented out
        # test by trying to run on nonexistent keyspace
        # cluster.stop(gently=False)
        # output, error, rc = node1.run_sstableofflinerelevel("keyspace1", "standard1", output=True)
        # assert "java.lang.IllegalArgumentException: Unknown keyspace/columnFamily keyspace1.standard1" in error
        # # this should return exit code 1
        # assert rc, 1 == msg=str(rc)
        # cluster.start()
    
        # now test by generating keyspace but not flushing sstables
    
        node1.stress(['write', 'n=1', 'no-warmup',
                      '-schema', 'replication(factor=1)',
                      '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)',
>                     '-rate', 'threads=8'])

offline_tools_test.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1502: in stress
    return handle_external_tool_process(p, ['stress'] + stress_options)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f191ca01a20>
cmd_args = ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', ...]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
E           stdout: ******************** Stress Settings ********************
E           Command:
E             Type: write
E             Count: 1
E             No Warmup: true
E             Consistency Level: LOCAL_ONE
E             Target Uncertainty: not applicable
E             Key Size (bytes): 10
E             Counter Increment Distibution: add=fixed(1)
E           Rate:
E             Auto: false
E             Thread Count: 8
E             OpsPer Sec: 0
E           Population:
E             Sequence: 1..1
E             Order: ARBITRARY
E             Wrap: true
E           Insert:
E             Revisits: Uniform:  min=1,max=1000000
E             Visits: Fixed:  key=1
E             Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
E             Batch Type: not batching
E           Columns:
E             Max Columns Per Key: 10
E             Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
E             Comparator: AsciiType
E             Timestamp: null
E             Variable Column Count: false
E             Slice: false
E             Size Distribution: Fixed:  key=1024
E             Count Distribution: Fixed:  key=10
E           Errors:
E             Ignore: false
E             Tries: 10
E           Log:
E             No Summary: false
E             No Settings: false
E             File: null
E             Interval Millis: 1000
E             Level: NORMAL
E           Mode:
E             API: JAVA_DRIVER_NATIVE
E             Connection Style: CQL_PREPARED
E             CQL Version: CQL3
E             Protocol Version: V5
E             Username: null
E             Password: null
E             Auth Provide Class: null
E             Max Pending Per Connection: 128
E             Connections Per Host: 8
E             Compression: NONE
E           Node:
E             Nodes: [127.0.0.1]
E             Is White List: false
E             Datacenter: null
E           Schema:
E             Keyspace: keyspace1
E             Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
E             Replication Strategy Options: {replication_factor=1}
E             Table Compression: null
E             Table Compaction Strategy: null
E             Table Compaction Strategy Options: {}
E           Transport:
E             truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
E           Port:
E             Native Port: 9042
E             JMX Port: 7100
E           Send To Daemon:
E             *not set*
E           Graph:
E             File: null
E             Revision: unknown
E             Title: null
E             Operation: WRITE
E           TokenRange:
E             Wrap: false
E             Split Factor: 1
E           
E           ; 
E           stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
E           	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
E           	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
E           	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
E           	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
E           	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
E           Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
E           	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
E           	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
E           	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
E           	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
E           	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
E           	... 6 more

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:50:34,140 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:50:33,874 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:50:33.874295
11:50:34,39 dtest_setup INFO cluster ccm directory: /tmp/dtest-7jcts9nc
----------------------------- Captured stdout call -----------------------------

11:50:34,147 ccm DEBUG using balanced tokens for non-vnode cluster
11:50:34,843 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7jcts9nc/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7jcts9nc/test/node1/conf'}
11:50:34,843 ccm INFO node1: using Java 8 for the current invocation
11:50:35,61 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7jcts9nc/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7jcts9nc/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:50:35,63 ccm INFO node1: using Java 8 for the current invocation
11:50:35,178 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:50:34,843 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7jcts9nc/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7jcts9nc/test/node1/conf'}
11:50:34,843 ccm INFO node1: using Java 8 for the current invocation
11:50:35,61 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7jcts9nc/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7jcts9nc/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:50:35,63 ccm INFO node1: using Java 8 for the current invocation
11:50:35,178 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:50:47,711 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:50:50,350 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:50:50,144 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:50:50.144811
11:50:50,225 dtest_setup INFO cluster ccm directory: /tmp/dtest-byiv1uxu
----------------------------- Captured stdout call -----------------------------

11:50:50,367 ccm DEBUG using balanced tokens for non-vnode cluster
11:50:51,137 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-byiv1uxu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-byiv1uxu/test/node1/conf'}
11:50:51,138 ccm INFO node1: using Java 8 for the current invocation
11:50:51,386 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-byiv1uxu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-byiv1uxu/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:50:51,387 ccm INFO node1: using Java 8 for the current invocation
11:50:51,504 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:50:51,137 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-byiv1uxu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-byiv1uxu/test/node1/conf'}
11:50:51,138 ccm INFO node1: using Java 8 for the current invocation
11:50:51,386 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-byiv1uxu/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-byiv1uxu/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:50:51,387 ccm INFO node1: using Java 8 for the current invocation
11:50:51,504 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:50:47,711 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:50:47,711 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:51:02,439 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_sstableofflinerelevel failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_sstableofflinerelevel failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 29.14 seconds ===========================
[msx] rc = 1
v1v2 running time = 51336229634
---> v1v2 test failed.
proj: cassandra
u_test: offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
h_list: range_request_timeout_in_ms@@@Tool@@@-2@@@50@@@15000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel FAILED [100%]

=================================== FAILURES ===================================
_________________ TestOfflineTools.test_sstableofflinerelevel __________________

self = <offline_tools_test.TestOfflineTools object at 0x7ff1f8cb8748>

    def test_sstableofflinerelevel(self):
        """
            Generate sstables of varying levels.
            Reset sstables to L0 with sstablelevelreset
            Run sstableofflinerelevel and ensure tables are promoted correctly
            Also test a variety of bad inputs including nonexistent keyspace and sstables
            @since 2.1.5
            @jira_ticket CASSANDRA-8031
            """
        cluster = self.cluster
        cluster.set_configuration_options(values={'compaction_throughput_mb_per_sec': 0})
        cluster.populate(1).start()
        node1 = cluster.nodelist()[0]
    
        # NOTE - As of now this does not return when it encounters Exception and causes test to hang, temporarily commented out
        # test by trying to run on nonexistent keyspace
        # cluster.stop(gently=False)
        # output, error, rc = node1.run_sstableofflinerelevel("keyspace1", "standard1", output=True)
        # assert "java.lang.IllegalArgumentException: Unknown keyspace/columnFamily keyspace1.standard1" in error
        # # this should return exit code 1
        # assert rc, 1 == msg=str(rc)
        # cluster.start()
    
        # now test by generating keyspace but not flushing sstables
    
        node1.stress(['write', 'n=1', 'no-warmup',
                      '-schema', 'replication(factor=1)',
                      '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)',
>                     '-rate', 'threads=8'])

offline_tools_test.py:139: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1502: in stress
    return handle_external_tool_process(p, ['stress'] + stress_options)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7ff1f8caa9b0>
cmd_args = ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', ...]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
E           stdout: ******************** Stress Settings ********************
E           Command:
E             Type: write
E             Count: 1
E             No Warmup: true
E             Consistency Level: LOCAL_ONE
E             Target Uncertainty: not applicable
E             Key Size (bytes): 10
E             Counter Increment Distibution: add=fixed(1)
E           Rate:
E             Auto: false
E             Thread Count: 8
E             OpsPer Sec: 0
E           Population:
E             Sequence: 1..1
E             Order: ARBITRARY
E             Wrap: true
E           Insert:
E             Revisits: Uniform:  min=1,max=1000000
E             Visits: Fixed:  key=1
E             Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
E             Batch Type: not batching
E           Columns:
E             Max Columns Per Key: 10
E             Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
E             Comparator: AsciiType
E             Timestamp: null
E             Variable Column Count: false
E             Slice: false
E             Size Distribution: Fixed:  key=1024
E             Count Distribution: Fixed:  key=10
E           Errors:
E             Ignore: false
E             Tries: 10
E           Log:
E             No Summary: false
E             No Settings: false
E             File: null
E             Interval Millis: 1000
E             Level: NORMAL
E           Mode:
E             API: JAVA_DRIVER_NATIVE
E             Connection Style: CQL_PREPARED
E             CQL Version: CQL3
E             Protocol Version: V5
E             Username: null
E             Password: null
E             Auth Provide Class: null
E             Max Pending Per Connection: 128
E             Connections Per Host: 8
E             Compression: NONE
E           Node:
E             Nodes: [127.0.0.1]
E             Is White List: false
E             Datacenter: null
E           Schema:
E             Keyspace: keyspace1
E             Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
E             Replication Strategy Options: {replication_factor=1}
E             Table Compression: null
E             Table Compaction Strategy: null
E             Table Compaction Strategy Options: {}
E           Transport:
E             truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
E           Port:
E             Native Port: 9042
E             JMX Port: 7100
E           Send To Daemon:
E             *not set*
E           Graph:
E             File: null
E             Revision: unknown
E             Title: null
E             Operation: WRITE
E           TokenRange:
E             Wrap: false
E             Split Factor: 1
E           
E           ; 
E           stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
E           	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
E           	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
E           	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
E           	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
E           	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
E           Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
E           	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
E           	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
E           	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
E           	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
E           	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
E           	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
E           	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
E           	... 6 more

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:51:25,251 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:51:25,45 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:51:25.045435
11:51:25,154 dtest_setup INFO cluster ccm directory: /tmp/dtest-frbp2t_g
----------------------------- Captured stdout call -----------------------------

11:51:25,256 ccm DEBUG using balanced tokens for non-vnode cluster
11:51:25,951 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-frbp2t_g/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-frbp2t_g/test/node1/conf'}
11:51:25,952 ccm INFO node1: using Java 8 for the current invocation
11:51:26,168 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-frbp2t_g/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-frbp2t_g/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:51:26,169 ccm INFO node1: using Java 8 for the current invocation
11:51:26,276 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:51:25,951 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-frbp2t_g/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-frbp2t_g/test/node1/conf'}
11:51:25,952 ccm INFO node1: using Java 8 for the current invocation
11:51:26,168 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-frbp2t_g/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-frbp2t_g/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:51:26,169 ccm INFO node1: using Java 8 for the current invocation
11:51:26,276 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:51:38,848 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
1:51:41,463 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:51:41,239 conftest INFO Starting execution of test_sstableofflinerelevel at 2022-02-06 11:51:41.239235
11:51:41,353 dtest_setup INFO cluster ccm directory: /tmp/dtest-vpuwzg2r
----------------------------- Captured stdout call -----------------------------
11:51:41,470 ccm DEBUG using balanced tokens for non-vnode cluster
11:51:42,160 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vpuwzg2r/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vpuwzg2r/test/node1/conf'}
11:51:42,161 ccm INFO node1: using Java 8 for the current invocation
11:51:42,381 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vpuwzg2r/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vpuwzg2r/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:51:42,381 ccm INFO node1: using Java 8 for the current invocation
11:51:42,494 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
11:51:42,160 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vpuwzg2r/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vpuwzg2r/test/node1/conf'}
11:51:42,161 ccm INFO node1: using Java 8 for the current invocation
11:51:42,381 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '93a41b8f881b', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'offline_tools_test.py::TestOfflineTools::()::test_sstableofflinerelevel (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vpuwzg2r/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vpuwzg2r/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:51:42,381 ccm INFO node1: using Java 8 for the current invocation
11:51:42,494 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
11:51:38,848 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:51:38,848 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:51:52,756 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_sstableofflinerelevel failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_sstableofflinerelevel failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['stress', 'write', 'n=1', 'no-warmup', '-schema', 'replication(factor=1)', '-col', 'n=FIXED(10)', 'SIZE=FIXED(1024)', '-rate', 'threads=8'] exited with non-zero status; exit status: 1; 
stdout: ******************** Stress Settings ********************
Command:
  Type: write
  Count: 1
  No Warmup: true
  Consistency Level: LOCAL_ONE
  Target Uncertainty: not applicable
  Key Size (bytes): 10
  Counter Increment Distibution: add=fixed(1)
Rate:
  Auto: false
  Thread Count: 8
  OpsPer Sec: 0
Population:
  Sequence: 1..1
  Order: ARBITRARY
  Wrap: true
Insert:
  Revisits: Uniform:  min=1,max=1000000
  Visits: Fixed:  key=1
  Row Population Ratio: Ratio: divisor=1.000000;delegate=Fixed:  key=1
  Batch Type: not batching
Columns:
  Max Columns Per Key: 10
  Column Names: [C0, C1, C2, C3, C4, C5, C6, C7, C8, C9]
  Comparator: AsciiType
  Timestamp: null
  Variable Column Count: false
  Slice: false
  Size Distribution: Fixed:  key=1024
  Count Distribution: Fixed:  key=10
Errors:
  Ignore: false
  Tries: 10
Log:
  No Summary: false
  No Settings: false
  File: null
  Interval Millis: 1000
  Level: NORMAL
Mode:
  API: JAVA_DRIVER_NATIVE
  Connection Style: CQL_PREPARED
  CQL Version: CQL3
  Protocol Version: V5
  Username: null
  Password: null
  Auth Provide Class: null
  Max Pending Per Connection: 128
  Connections Per Host: 8
  Compression: NONE
Node:
  Nodes: [127.0.0.1]
  Is White List: false
  Datacenter: null
Schema:
  Keyspace: keyspace1
  Replication Strategy: org.apache.cassandra.locator.SimpleStrategy
  Replication Strategy Options: {replication_factor=1}
  Table Compression: null
  Table Compaction Strategy: null
  Table Compaction Strategy Options: {}
Transport:
  truststore=null; truststore-password=null; keystore=null; keystore-password=null; ssl-protocol=TLS; ssl-alg=null; ssl-ciphers=TLS_RSA_WITH_AES_128_CBC_SHA,TLS_RSA_WITH_AES_256_CBC_SHA; 
Port:
  Native Port: 9042
  JMX Port: 7100
Send To Daemon:
  *not set*
Graph:
  File: null
  Revision: unknown
  Title: null
  Operation: WRITE
TokenRange:
  Wrap: false
  Split Factor: 1

; 
stderr: java.lang.RuntimeException: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:146)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:114)
	at org.apache.cassandra.stress.settings.SettingsSchema.createKeySpaces(SettingsSchema.java:66)
	at org.apache.cassandra.stress.settings.StressSettings.maybeCreateKeyspaces(StressSettings.java:154)
	at org.apache.cassandra.stress.StressAction.run(StressAction.java:56)
	at org.apache.cassandra.stress.Stress.run(Stress.java:155)
	at org.apache.cassandra.stress.Stress.main(Stress.java:63)
Caused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: /127.0.0.1:9042 (com.datastax.driver.core.exceptions.ReadTimeoutException: Cassandra timeout during read query at consistency ONE (1 responses were required but only 0 replica responded)))
	at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:270)
	at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:109)
	at com.datastax.driver.core.Cluster$Manager.negotiateProtocolVersionAndConnect(Cluster.java:1813)
	at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1726)
	at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:462)
	at org.apache.cassandra.stress.util.JavaDriverClient.connect(JavaDriverClient.java:181)
	at org.apache.cassandra.stress.settings.StressSettings.getJavaDriverClient(StressSettings.java:137)
	... 6 more

	[<TracebackEntry /root/cassandra-dtest/offline_tools_test.py:139>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1502>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 28.26 seconds ===========================
[msx] rc = 1
v1v1 running time = 50273934309
cassandra offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel 
-------------------------------- live log call ---------------------------------
11:53:16,890 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:54:16,893 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
11:54:16,896 cassandra.cluster WARNING [control connection] Error connecting to 127.0.0.1:9042:
Traceback (most recent call last):
  File "cassandra/cluster.py", line 3522, in cassandra.cluster.ControlConnection._reconnect_internal
  File "cassandra/cluster.py", line 3544, in cassandra.cluster.ControlConnection._try_connect
  File "cassandra/cluster.py", line 1620, in cassandra.cluster.Cluster.connection_factory
  File "cassandra/connection.py", line 831, in cassandra.connection.Connection.factory
  File "/root/dtest/src/cassandra-driver/cassandra/io/libevreactor.py", line 267, in __init__
    self._connect_socket()
  File "cassandra/connection.py", line 898, in cassandra.connection.Connection._connect_socket
ConnectionRefusedError: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:54:17,903 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 1.94 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:54:19,909 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 4.4 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:54:24,328 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 8.16 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
11:54:32,556 cassandra.pool WARNING Error attempting to reconnect to 127.0.0.1:9042, scheduling retry in 15.52 seconds: [Errno 111] Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused
PASSED                                                                   [100%]
===Flaky Test Report===

test_sstableofflinerelevel passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 145.91 seconds ==========================
[msx] rc = 0
v2v2 running time = 167995239872
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: offline_tools_test.py::TestOfflineTools::test_sstableofflinerelevel
h_list: range_request_timeout_in_ms@@@Tool@@@-2@@@50@@@15000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

early stop after 7 is satisfied
v1v2 failed with probability 5 out of 8
v1v1v2v2 failed with probability 7 out of 8
Total execution time in seconds : 2618
0
