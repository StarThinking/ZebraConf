my_type=hypothesis
proj=cassandra
u_test=cql_test.py::TestCQL::test_type
h_list[1]=commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
proj: cassandra
u_test: cql_test.py::TestCQL::test_type
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type 
-------------------------------- live log call ---------------------------------
12:48:25,414 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
12:48:25,548 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:48:24,741 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

cql_test.py::TestCQL::test_type ERROR                                    [100%]

==================================== ERRORS ====================================
____________________ ERROR at teardown of TestCQL.test_type ____________________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-02-01 12:48:24,741 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:48:24,743 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:48:24,743 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:48:24,741 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
12:48:07,486 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:48:07,84 conftest INFO Starting execution of test_type at 2022-02-01 12:48:07.084746
12:48:07,393 dtest_setup INFO cluster ccm directory: /tmp/dtest-pq15xaf5
----------------------------- Captured stdout call -----------------------------

12:48:07,488 ccm DEBUG using balanced tokens for non-vnode cluster
12:48:08,48 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pq15xaf5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pq15xaf5/test/node1/conf'}
12:48:08,49 ccm INFO node1: using Java 8 for the current invocation
12:48:08,212 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pq15xaf5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pq15xaf5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:48:08,213 ccm INFO node1: using Java 8 for the current invocation
12:48:08,301 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
12:48:08,48 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pq15xaf5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pq15xaf5/test/node1/conf'}
12:48:08,49 ccm INFO node1: using Java 8 for the current invocation
12:48:08,212 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pq15xaf5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pq15xaf5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:48:08,213 ccm INFO node1: using Java 8 for the current invocation
12:48:08,301 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
12:48:25,548 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:48:24,741 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
______________________________ TestCQL.test_type _______________________________

self = <cql_test.TestCQL object at 0x7fdf4ac7d6d8>

    def test_type(self):
        """
            Smoke test basic TYPE operations:
    
            - CREATE a type
            - CREATE a table using that type
            - ALTER the type and CREATE another table
            - DROP the tables and type
            - CREATE another table using the DROPped type and assert it fails with an InvalidRequest
            # TODO run SELECTs to make sure each statement works
            # TODO is this even necessary given the existence of the auth_tests?
            """
        session = self.prepare()
        # even though we only ever use the user_types attribute of this object,
        # we have to access it each time, because attribute access is how the
        # value is updated
        ks_meta = UpdatingKeyspaceMetadataWrapper(session.cluster, ks_name='ks')
    
>       session.execute("CREATE TYPE address_t (street text, city text, zip_code int)")

cql_test.py:227: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
12:48:07,486 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:48:07,84 conftest INFO Starting execution of test_type at 2022-02-01 12:48:07.084746
12:48:07,393 dtest_setup INFO cluster ccm directory: /tmp/dtest-pq15xaf5
----------------------------- Captured stdout call -----------------------------

12:48:07,488 ccm DEBUG using balanced tokens for non-vnode cluster
12:48:08,48 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pq15xaf5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pq15xaf5/test/node1/conf'}
12:48:08,49 ccm INFO node1: using Java 8 for the current invocation
12:48:08,212 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pq15xaf5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pq15xaf5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:48:08,213 ccm INFO node1: using Java 8 for the current invocation
12:48:08,301 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
12:48:08,48 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pq15xaf5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pq15xaf5/test/node1/conf'}
12:48:08,49 ccm INFO node1: using Java 8 for the current invocation
12:48:08,212 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pq15xaf5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pq15xaf5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:48:08,213 ccm INFO node1: using Java 8 for the current invocation
12:48:08,301 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_type failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/cql_test.py:227>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 19.76 seconds ======================
[msx] rc = 1
v1v2 running time = 41451711480
---> v1v2 test failed.
proj: cassandra
u_test: cql_test.py::TestCQL::test_type
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type PASSED                                   [100%]
===Flaky Test Report===

test_type passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 29.67 seconds ===========================
[msx] rc = 0
v1v1 running time = 51514282096
cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type 
-------------------------------- live log call ---------------------------------
12:49:59,41 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
12:49:59,148 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:49:58,222 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

cql_test.py::TestCQL::test_type ERROR                                    [100%]

==================================== ERRORS ====================================
____________________ ERROR at teardown of TestCQL.test_type ____________________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-02-01 12:49:58,222 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:49:58,224 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:49:58,225 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:49:58,222 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
12:49:40,696 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:49:39,677 conftest INFO Starting execution of test_type at 2022-02-01 12:49:39.677442
12:49:40,580 dtest_setup INFO cluster ccm directory: /tmp/dtest-_dho_hem
----------------------------- Captured stdout call -----------------------------

12:49:40,698 ccm DEBUG using balanced tokens for non-vnode cluster
12:49:41,335 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_dho_hem/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_dho_hem/test/node1/conf'}
12:49:41,336 ccm INFO node1: using Java 8 for the current invocation
12:49:41,529 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_dho_hem/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_dho_hem/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:49:41,530 ccm INFO node1: using Java 8 for the current invocation
12:49:41,624 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:49:58,222 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:49:58,224 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:49:58,225 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
12:49:41,335 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_dho_hem/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_dho_hem/test/node1/conf'}
12:49:41,336 ccm INFO node1: using Java 8 for the current invocation
12:49:41,529 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_dho_hem/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_dho_hem/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:49:41,530 ccm INFO node1: using Java 8 for the current invocation
12:49:41,624 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
12:49:59,148 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:49:58,222 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
______________________________ TestCQL.test_type _______________________________

self = <cql_test.TestCQL object at 0x7fba41daf588>

    def test_type(self):
        """
            Smoke test basic TYPE operations:
    
            - CREATE a type
            - CREATE a table using that type
            - ALTER the type and CREATE another table
            - DROP the tables and type
            - CREATE another table using the DROPped type and assert it fails with an InvalidRequest
            # TODO run SELECTs to make sure each statement works
            # TODO is this even necessary given the existence of the auth_tests?
            """
        session = self.prepare()
        # even though we only ever use the user_types attribute of this object,
        # we have to access it each time, because attribute access is how the
        # value is updated
        ks_meta = UpdatingKeyspaceMetadataWrapper(session.cluster, ks_name='ks')
    
        session.execute("CREATE TYPE address_t (street text, city text, zip_code int)")
        assert 'address_t' in ks_meta.user_types
    
>       session.execute("CREATE TABLE test4 (id int PRIMARY KEY, address frozen<address_t>)")

cql_test.py:230: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
12:49:40,696 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:49:39,677 conftest INFO Starting execution of test_type at 2022-02-01 12:49:39.677442
12:49:40,580 dtest_setup INFO cluster ccm directory: /tmp/dtest-_dho_hem
----------------------------- Captured stdout call -----------------------------

12:49:40,698 ccm DEBUG using balanced tokens for non-vnode cluster
12:49:41,335 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_dho_hem/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_dho_hem/test/node1/conf'}
12:49:41,336 ccm INFO node1: using Java 8 for the current invocation
12:49:41,529 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_dho_hem/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_dho_hem/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:49:41,530 ccm INFO node1: using Java 8 for the current invocation
12:49:41,624 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:49:58,222 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:49:58,224 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:49:58,225 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
12:49:41,335 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_dho_hem/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_dho_hem/test/node1/conf'}
12:49:41,336 ccm INFO node1: using Java 8 for the current invocation
12:49:41,529 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-_dho_hem/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-_dho_hem/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:49:41,530 ccm INFO node1: using Java 8 for the current invocation
12:49:41,624 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_type failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/cql_test.py:230>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 20.96 seconds ======================
[msx] rc = 1
v2v2 running time = 42950309765
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: cql_test.py::TestCQL::test_type
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type 
-------------------------------- live log call ---------------------------------
12:50:42,317 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
12:50:42,472 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:50:41,595 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

cql_test.py::TestCQL::test_type ERROR                                    [100%]

==================================== ERRORS ====================================
____________________ ERROR at teardown of TestCQL.test_type ____________________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-02-01 12:50:41,595 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:50:41,599 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:50:41,599 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:50:41,595 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
12:50:24,430 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:50:22,898 conftest INFO Starting execution of test_type at 2022-02-01 12:50:22.898041
12:50:24,351 dtest_setup INFO cluster ccm directory: /tmp/dtest-exuqqxsb
----------------------------- Captured stdout call -----------------------------

12:50:24,432 ccm DEBUG using balanced tokens for non-vnode cluster
12:50:25,104 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-exuqqxsb/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-exuqqxsb/test/node1/conf'}
12:50:25,105 ccm INFO node1: using Java 8 for the current invocation
12:50:25,265 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-exuqqxsb/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-exuqqxsb/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:50:25,266 ccm INFO node1: using Java 8 for the current invocation
12:50:25,353 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:50:41,595 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:50:41,599 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:50:41,599 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
12:50:25,104 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-exuqqxsb/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-exuqqxsb/test/node1/conf'}
12:50:25,105 ccm INFO node1: using Java 8 for the current invocation
12:50:25,265 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-exuqqxsb/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-exuqqxsb/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:50:25,266 ccm INFO node1: using Java 8 for the current invocation
12:50:25,353 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
12:50:42,472 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:50:41,595 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
______________________________ TestCQL.test_type _______________________________

self = <cql_test.TestCQL object at 0x7f1e43e03a20>

    def test_type(self):
        """
            Smoke test basic TYPE operations:
    
            - CREATE a type
            - CREATE a table using that type
            - ALTER the type and CREATE another table
            - DROP the tables and type
            - CREATE another table using the DROPped type and assert it fails with an InvalidRequest
            # TODO run SELECTs to make sure each statement works
            # TODO is this even necessary given the existence of the auth_tests?
            """
        session = self.prepare()
        # even though we only ever use the user_types attribute of this object,
        # we have to access it each time, because attribute access is how the
        # value is updated
        ks_meta = UpdatingKeyspaceMetadataWrapper(session.cluster, ks_name='ks')
    
>       session.execute("CREATE TYPE address_t (street text, city text, zip_code int)")

cql_test.py:227: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
12:50:24,430 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:50:22,898 conftest INFO Starting execution of test_type at 2022-02-01 12:50:22.898041
12:50:24,351 dtest_setup INFO cluster ccm directory: /tmp/dtest-exuqqxsb
----------------------------- Captured stdout call -----------------------------

12:50:24,432 ccm DEBUG using balanced tokens for non-vnode cluster
12:50:25,104 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-exuqqxsb/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-exuqqxsb/test/node1/conf'}
12:50:25,105 ccm INFO node1: using Java 8 for the current invocation
12:50:25,265 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-exuqqxsb/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-exuqqxsb/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:50:25,266 ccm INFO node1: using Java 8 for the current invocation
12:50:25,353 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:50:41,595 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:50:41,599 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:50:41,599 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
12:50:25,104 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-exuqqxsb/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-exuqqxsb/test/node1/conf'}
12:50:25,105 ccm INFO node1: using Java 8 for the current invocation
12:50:25,265 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-exuqqxsb/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-exuqqxsb/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:50:25,266 ccm INFO node1: using Java 8 for the current invocation
12:50:25,353 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_type failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/cql_test.py:227>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 20.58 seconds ======================
[msx] rc = 1
v1v2 running time = 42461270773
---> v1v2 test failed.
proj: cassandra
u_test: cql_test.py::TestCQL::test_type
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type PASSED                                   [100%]
===Flaky Test Report===

test_type passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 23.97 seconds ===========================
[msx] rc = 0
v1v1 running time = 45582338367
cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type 
-------------------------------- live log call ---------------------------------
12:52:11,43 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
12:52:11,150 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:52:10,414 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

cql_test.py::TestCQL::test_type ERROR                                    [100%]

==================================== ERRORS ====================================
____________________ ERROR at teardown of TestCQL.test_type ____________________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-02-01 12:52:10,414 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:52:10,417 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:52:10,418 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:52:10,414 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
12:51:51,953 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:51:50,701 conftest INFO Starting execution of test_type at 2022-02-01 12:51:50.701682
12:51:51,861 dtest_setup INFO cluster ccm directory: /tmp/dtest-nwkbh5lq
----------------------------- Captured stdout call -----------------------------

12:51:51,955 ccm DEBUG using balanced tokens for non-vnode cluster
12:51:52,534 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nwkbh5lq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nwkbh5lq/test/node1/conf'}
12:51:52,535 ccm INFO node1: using Java 8 for the current invocation
12:51:52,701 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nwkbh5lq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nwkbh5lq/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:51:52,702 ccm INFO node1: using Java 8 for the current invocation
12:51:52,788 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
xception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:52:10,414 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:52:10,417 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:52:10,418 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
12:51:52,534 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nwkbh5lq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nwkbh5lq/test/node1/conf'}
12:51:52,535 ccm INFO node1: using Java 8 for the current invocation
12:51:52,701 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nwkbh5lq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nwkbh5lq/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:51:52,702 ccm INFO node1: using Java 8 for the current invocation
12:51:52,788 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
12:52:11,150 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:52:10,414 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
______________________________ TestCQL.test_type _______________________________

self = <cql_test.TestCQL object at 0x7f289c3ff6d8>

    def test_type(self):
        """
            Smoke test basic TYPE operations:
    
            - CREATE a type
            - CREATE a table using that type
            - ALTER the type and CREATE another table
            - DROP the tables and type
            - CREATE another table using the DROPped type and assert it fails with an InvalidRequest
            # TODO run SELECTs to make sure each statement works
            # TODO is this even necessary given the existence of the auth_tests?
            """
        session = self.prepare()
        # even though we only ever use the user_types attribute of this object,
        # we have to access it each time, because attribute access is how the
        # value is updated
        ks_meta = UpdatingKeyspaceMetadataWrapper(session.cluster, ks_name='ks')
    
        session.execute("CREATE TYPE address_t (street text, city text, zip_code int)")
        assert 'address_t' in ks_meta.user_types
    
>       session.execute("CREATE TABLE test4 (id int PRIMARY KEY, address frozen<address_t>)")

cql_test.py:230: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
12:51:51,953 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:51:50,701 conftest INFO Starting execution of test_type at 2022-02-01 12:51:50.701682
12:51:51,861 dtest_setup INFO cluster ccm directory: /tmp/dtest-nwkbh5lq
----------------------------- Captured stdout call -----------------------------

12:51:51,955 ccm DEBUG using balanced tokens for non-vnode cluster
12:51:52,534 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nwkbh5lq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nwkbh5lq/test/node1/conf'}
12:51:52,535 ccm INFO node1: using Java 8 for the current invocation
12:51:52,701 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nwkbh5lq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nwkbh5lq/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:51:52,702 ccm INFO node1: using Java 8 for the current invocation
12:51:52,788 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
xception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:52:10,414 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:52:10,417 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:52:10,418 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
12:51:52,534 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nwkbh5lq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nwkbh5lq/test/node1/conf'}
12:51:52,535 ccm INFO node1: using Java 8 for the current invocation
12:51:52,701 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-nwkbh5lq/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-nwkbh5lq/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:51:52,702 ccm INFO node1: using Java 8 for the current invocation
12:51:52,788 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_type failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/cql_test.py:230>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 21.41 seconds ======================
[msx] rc = 1
v2v2 running time = 43093756969
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: cql_test.py::TestCQL::test_type
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type PASSED                                   [100%]
===Flaky Test Report===

test_type passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 17.21 seconds ===========================
[msx] rc = 0
v1v2 running time = 38892914228
---> v1v2 test suceeded.
cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type PASSED                                   [100%]
===Flaky Test Report===

test_type passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 25.93 seconds ===========================
[msx] rc = 0
v1v1 running time = 47641442944
cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type FAILED                                   [100%]
------------------------------ live log teardown -------------------------------
12:54:23,379 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:54:22,178 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

cql_test.py::TestCQL::test_type ERROR                                    [100%]

==================================== ERRORS ====================================
____________________ ERROR at teardown of TestCQL.test_type ____________________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-02-01 12:54:22,178 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:54:22,182 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:54:22,182 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:54:22,178 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
12:54:02,848 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:54:00,769 conftest INFO Starting execution of test_type at 2022-02-01 12:54:00.769648
12:54:02,733 dtest_setup INFO cluster ccm directory: /tmp/dtest-n2qy3js3
----------------------------- Captured stdout call -----------------------------

12:54:02,851 ccm DEBUG using balanced tokens for non-vnode cluster
12:54:03,669 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n2qy3js3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n2qy3js3/test/node1/conf'}
12:54:03,670 ccm INFO node1: using Java 8 for the current invocation
12:54:03,883 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n2qy3js3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n2qy3js3/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:54:03,884 ccm INFO node1: using Java 8 for the current invocation
12:54:03,994 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:54:23,155 ccm DEBUG C* process with 12385 is terminated
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:54:22,178 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:54:22,182 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:54:22,182 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
12:54:03,669 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n2qy3js3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n2qy3js3/test/node1/conf'}
12:54:03,670 ccm INFO node1: using Java 8 for the current invocation
12:54:03,883 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n2qy3js3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n2qy3js3/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:54:03,884 ccm INFO node1: using Java 8 for the current invocation
12:54:03,994 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
12:54:23,379 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:54:22,178 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
______________________________ TestCQL.test_type _______________________________

self = <cql_test.TestCQL object at 0x7fbf827646d8>

    def test_type(self):
        """
            Smoke test basic TYPE operations:
    
            - CREATE a type
            - CREATE a table using that type
            - ALTER the type and CREATE another table
            - DROP the tables and type
            - CREATE another table using the DROPped type and assert it fails with an InvalidRequest
            # TODO run SELECTs to make sure each statement works
            # TODO is this even necessary given the existence of the auth_tests?
            """
>       session = self.prepare()

cql_test.py:221: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cql_test.py:57: in prepare
    cluster.populate(nodes).start()
../dtest/lib/python3.6/site-packages/ccmlib/cluster.py:549: in start
    error_on_pid_terminated=True)
../dtest/lib/python3.6/site-packages/ccmlib/node.py:586: in watch_log_for
    self.raise_node_error_if_cassandra_process_is_terminated()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <ccmlib.node.Node object at 0x7fbf82764d68>

    def raise_node_error_if_cassandra_process_is_terminated(self):
        if not self._is_pid_running():
            msg = "C* process with {pid} is terminated".format(pid=self.pid)
            common.debug(msg)
>           raise NodeError(msg)
E           ccmlib.node.NodeError: C* process with 12385 is terminated

../dtest/lib/python3.6/site-packages/ccmlib/node.py:670: NodeError
---------------------------- Captured stdout setup -----------------------------
12:54:02,848 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:54:00,769 conftest INFO Starting execution of test_type at 2022-02-01 12:54:00.769648
12:54:02,733 dtest_setup INFO cluster ccm directory: /tmp/dtest-n2qy3js3
----------------------------- Captured stdout call -----------------------------

12:54:02,851 ccm DEBUG using balanced tokens for non-vnode cluster
12:54:03,669 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n2qy3js3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n2qy3js3/test/node1/conf'}
12:54:03,670 ccm INFO node1: using Java 8 for the current invocation
12:54:03,883 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n2qy3js3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n2qy3js3/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:54:03,884 ccm INFO node1: using Java 8 for the current invocation
12:54:03,994 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:54:23,155 ccm DEBUG C* process with 12385 is terminated
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:54:22,178 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:54:22,182 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 12:54:22,182 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
12:54:03,669 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n2qy3js3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n2qy3js3/test/node1/conf'}
12:54:03,670 ccm INFO node1: using Java 8 for the current invocation
12:54:03,883 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n2qy3js3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n2qy3js3/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:54:03,884 ccm INFO node1: using Java 8 for the current invocation
12:54:03,994 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_type failed and was not selected for rerun.
	<class 'ccmlib.node.NodeError'>
	C* process with 12385 is terminated
	[<TracebackEntry /root/cassandra-dtest/cql_test.py:221>, <TracebackEntry /root/cassandra-dtest/cql_test.py:57>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py:549>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:586>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:670>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 23.61 seconds ======================
[msx] rc = 1
v2v2 running time = 45660815225
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: cql_test.py::TestCQL::test_type
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type 
-------------------------------- live log call ---------------------------------
12:55:05,910 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
12:55:06,17 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:55:05,246 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

cql_test.py::TestCQL::test_type ERROR                                    [100%]

==================================== ERRORS ====================================
____________________ ERROR at teardown of TestCQL.test_type ____________________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-02-01 12:55:05,246 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:55:05,248 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:55:05,249 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:55:05,246 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
12:54:47,799 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:54:46,440 conftest INFO Starting execution of test_type at 2022-02-01 12:54:46.440260
12:54:47,691 dtest_setup INFO cluster ccm directory: /tmp/dtest-hgl86rl5
----------------------------- Captured stdout call -----------------------------
12:54:47,801 ccm DEBUG using balanced tokens for non-vnode cluster
12:54:48,487 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hgl86rl5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hgl86rl5/test/node1/conf'}
12:54:48,488 ccm INFO node1: using Java 8 for the current invocation
12:54:48,668 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hgl86rl5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hgl86rl5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:54:48,669 ccm INFO node1: using Java 8 for the current invocation
12:54:48,759 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra

12:54:47,801 ccm DEBUG using balanced tokens for non-vnode cluster
12:54:48,487 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hgl86rl5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hgl86rl5/test/node1/conf'}
12:54:48,488 ccm INFO node1: using Java 8 for the current invocation
12:54:48,668 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hgl86rl5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hgl86rl5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:54:48,669 ccm INFO node1: using Java 8 for the current invocation
12:54:48,759 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
12:54:48,487 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hgl86rl5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hgl86rl5/test/node1/conf'}
12:54:48,488 ccm INFO node1: using Java 8 for the current invocation
12:54:48,668 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hgl86rl5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hgl86rl5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:54:48,669 ccm INFO node1: using Java 8 for the current invocation
12:54:48,759 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
12:55:06,17 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:55:05,246 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
______________________________ TestCQL.test_type _______________________________

self = <cql_test.TestCQL object at 0x7fb72b30a668>

    def test_type(self):
        """
            Smoke test basic TYPE operations:
    
            - CREATE a type
            - CREATE a table using that type
            - ALTER the type and CREATE another table
            - DROP the tables and type
            - CREATE another table using the DROPped type and assert it fails with an InvalidRequest
            # TODO run SELECTs to make sure each statement works
            # TODO is this even necessary given the existence of the auth_tests?
            """
        session = self.prepare()
        # even though we only ever use the user_types attribute of this object,
        # we have to access it each time, because attribute access is how the
        # value is updated
        ks_meta = UpdatingKeyspaceMetadataWrapper(session.cluster, ks_name='ks')
    
        session.execute("CREATE TYPE address_t (street text, city text, zip_code int)")
        assert 'address_t' in ks_meta.user_types
    
        session.execute("CREATE TABLE test4 (id int PRIMARY KEY, address frozen<address_t>)")
    
        session.execute("ALTER TYPE address_t ADD phones set<text>")
        assert 'phones' in ks_meta.user_types['address_t'].field_names
    
        # drop the table so we can safely drop the type it uses
>       session.execute("DROP TABLE test4")

cql_test.py:236: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
12:54:47,799 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:54:46,440 conftest INFO Starting execution of test_type at 2022-02-01 12:54:46.440260
12:54:47,691 dtest_setup INFO cluster ccm directory: /tmp/dtest-hgl86rl5
----------------------------- Captured stdout call -----------------------------
12:54:47,801 ccm DEBUG using balanced tokens for non-vnode cluster
12:54:48,487 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hgl86rl5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hgl86rl5/test/node1/conf'}
12:54:48,488 ccm INFO node1: using Java 8 for the current invocation
12:54:48,668 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hgl86rl5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hgl86rl5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:54:48,669 ccm INFO node1: using Java 8 for the current invocation
12:54:48,759 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra

12:54:47,801 ccm DEBUG using balanced tokens for non-vnode cluster
12:54:48,487 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hgl86rl5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hgl86rl5/test/node1/conf'}
12:54:48,488 ccm INFO node1: using Java 8 for the current invocation
12:54:48,668 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hgl86rl5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hgl86rl5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:54:48,669 ccm INFO node1: using Java 8 for the current invocation
12:54:48,759 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
12:54:48,487 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hgl86rl5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hgl86rl5/test/node1/conf'}
12:54:48,488 ccm INFO node1: using Java 8 for the current invocation
12:54:48,668 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-hgl86rl5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-hgl86rl5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:54:48,669 ccm INFO node1: using Java 8 for the current invocation
12:54:48,759 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_type failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/cql_test.py:236>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 20.55 seconds ======================
[msx] rc = 1
v1v2 running time = 42573348883
---> v1v2 test failed.
proj: cassandra
u_test: cql_test.py::TestCQL::test_type
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type PASSED                                   [100%]
===Flaky Test Report===

test_type passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 22.38 seconds ===========================
[msx] rc = 0
v1v1 running time = 44248571748
cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type 
-------------------------------- live log call ---------------------------------
12:56:33,393 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
12:56:33,604 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:56:32,383 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

cql_test.py::TestCQL::test_type ERROR                                    [100%]

==================================== ERRORS ====================================
____________________ ERROR at teardown of TestCQL.test_type ____________________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-02-01 12:56:32,383 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:56:32,386 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:56:32,386 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:56:32,383 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
12:56:14,320 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:56:13,210 conftest INFO Starting execution of test_type at 2022-02-01 12:56:13.210816
12:56:14,220 dtest_setup INFO cluster ccm directory: /tmp/dtest-kzt7r09l
----------------------------- Captured stdout call -----------------------------
2:56:14,324 ccm DEBUG using balanced tokens for non-vnode cluster
12:56:15,50 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kzt7r09l/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kzt7r09l/test/node1/conf'}
12:56:15,50 ccm INFO node1: using Java 8 for the current invocation
12:56:15,221 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kzt7r09l/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kzt7r09l/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:56:15,222 ccm INFO node1: using Java 8 for the current invocation
12:56:15,312 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:56:14,324 ccm DEBUG using balanced tokens for non-vnode cluster
12:56:15,50 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kzt7r09l/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kzt7r09l/test/node1/conf'}
12:56:15,50 ccm INFO node1: using Java 8 for the current invocation
12:56:15,221 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kzt7r09l/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kzt7r09l/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:56:15,222 ccm INFO node1: using Java 8 for the current invocation
12:56:15,312 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
12:56:15,50 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kzt7r09l/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kzt7r09l/test/node1/conf'}
12:56:15,50 ccm INFO node1: using Java 8 for the current invocation
12:56:15,221 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kzt7r09l/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kzt7r09l/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:56:15,222 ccm INFO node1: using Java 8 for the current invocation
12:56:15,312 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
12:56:33,604 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:56:32,383 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
______________________________ TestCQL.test_type _______________________________

self = <cql_test.TestCQL object at 0x7fdfcce6fa20>

    def test_type(self):
        """
            Smoke test basic TYPE operations:
    
            - CREATE a type
            - CREATE a table using that type
            - ALTER the type and CREATE another table
            - DROP the tables and type
            - CREATE another table using the DROPped type and assert it fails with an InvalidRequest
            # TODO run SELECTs to make sure each statement works
            # TODO is this even necessary given the existence of the auth_tests?
            """
        session = self.prepare()
        # even though we only ever use the user_types attribute of this object,
        # we have to access it each time, because attribute access is how the
        # value is updated
        ks_meta = UpdatingKeyspaceMetadataWrapper(session.cluster, ks_name='ks')
    
>       session.execute("CREATE TYPE address_t (street text, city text, zip_code int)")

cql_test.py:227: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
12:56:14,320 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:56:13,210 conftest INFO Starting execution of test_type at 2022-02-01 12:56:13.210816
12:56:14,220 dtest_setup INFO cluster ccm directory: /tmp/dtest-kzt7r09l
----------------------------- Captured stdout call -----------------------------
2:56:14,324 ccm DEBUG using balanced tokens for non-vnode cluster
12:56:15,50 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kzt7r09l/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kzt7r09l/test/node1/conf'}
12:56:15,50 ccm INFO node1: using Java 8 for the current invocation
12:56:15,221 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kzt7r09l/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kzt7r09l/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:56:15,222 ccm INFO node1: using Java 8 for the current invocation
12:56:15,312 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:56:14,324 ccm DEBUG using balanced tokens for non-vnode cluster
12:56:15,50 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kzt7r09l/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kzt7r09l/test/node1/conf'}
12:56:15,50 ccm INFO node1: using Java 8 for the current invocation
12:56:15,221 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kzt7r09l/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kzt7r09l/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:56:15,222 ccm INFO node1: using Java 8 for the current invocation
12:56:15,312 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
12:56:15,50 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kzt7r09l/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kzt7r09l/test/node1/conf'}
12:56:15,50 ccm INFO node1: using Java 8 for the current invocation
12:56:15,221 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-kzt7r09l/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-kzt7r09l/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:56:15,222 ccm INFO node1: using Java 8 for the current invocation
12:56:15,312 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_type failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/cql_test.py:227>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 21.50 seconds ======================
[msx] rc = 1
v2v2 running time = 43923760818
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: cql_test.py::TestCQL::test_type
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type 
-------------------------------- live log call ---------------------------------
12:57:19,619 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
12:57:19,747 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:57:18,929 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

cql_test.py::TestCQL::test_type ERROR                                    [100%]

==================================== ERRORS ====================================
____________________ ERROR at teardown of TestCQL.test_type ____________________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-02-01 12:57:18,929 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:57:18,931 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:57:18,932 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:57:18,929 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
12:57:00,799 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:56:57,93 conftest INFO Starting execution of test_type at 2022-02-01 12:56:57.093921
12:57:00,708 dtest_setup INFO cluster ccm directory: /tmp/dtest-tz82atag
------------------------------ Captured log call -------------------------------
12:57:01,458 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tz82atag/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tz82atag/test/node1/conf'}
12:57:01,459 ccm INFO node1: using Java 8 for the current invocation
12:57:01,656 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tz82atag/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tz82atag/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:57:01,657 ccm INFO node1: using Java 8 for the current invocation
12:57:01,740 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
12:57:19,747 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:57:18,929 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
______________________________ TestCQL.test_type _______________________________

self = <cql_test.TestCQL object at 0x7ff1a42c86d8>

    def test_type(self):
        """
            Smoke test basic TYPE operations:
    
            - CREATE a type
            - CREATE a table using that type
            - ALTER the type and CREATE another table
            - DROP the tables and type
            - CREATE another table using the DROPped type and assert it fails with an InvalidRequest
            # TODO run SELECTs to make sure each statement works
            # TODO is this even necessary given the existence of the auth_tests?
            """
        session = self.prepare()
        # even though we only ever use the user_types attribute of this object,
        # we have to access it each time, because attribute access is how the
        # value is updated
        ks_meta = UpdatingKeyspaceMetadataWrapper(session.cluster, ks_name='ks')
    
>       session.execute("CREATE TYPE address_t (street text, city text, zip_code int)")

cql_test.py:227: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
12:57:00,799 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:56:57,93 conftest INFO Starting execution of test_type at 2022-02-01 12:56:57.093921
12:57:00,708 dtest_setup INFO cluster ccm directory: /tmp/dtest-tz82atag
------------------------------ Captured log call -------------------------------
12:57:01,458 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tz82atag/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tz82atag/test/node1/conf'}
12:57:01,459 ccm INFO node1: using Java 8 for the current invocation
12:57:01,656 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-tz82atag/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-tz82atag/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:57:01,657 ccm INFO node1: using Java 8 for the current invocation
12:57:01,740 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_type failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/cql_test.py:227>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 23.64 seconds ======================
[msx] rc = 1
v1v2 running time = 45547740139
---> v1v2 test failed.
proj: cassandra
u_test: cql_test.py::TestCQL::test_type
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type PASSED                                   [100%]
===Flaky Test Report===

test_type passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 22.25 seconds ===========================
[msx] rc = 0
v1v1 running time = 44343258354
cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type 
-------------------------------- live log call ---------------------------------
12:58:45,733 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
12:58:45,839 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:58:45,389 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

cql_test.py::TestCQL::test_type ERROR                                    [100%]

==================================== ERRORS ====================================
____________________ ERROR at teardown of TestCQL.test_type ____________________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-02-01 12:58:45,389 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:58:45,392 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:58:45,393 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:58:45,389 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
12:58:27,903 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:58:27,51 conftest INFO Starting execution of test_type at 2022-02-01 12:58:27.051461
12:58:27,810 dtest_setup INFO cluster ccm directory: /tmp/dtest-z49uc1ft
------------------------------ Captured log call -------------------------------
12:58:28,681 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z49uc1ft/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z49uc1ft/test/node1/conf'}
12:58:28,682 ccm INFO node1: using Java 8 for the current invocation
12:58:28,884 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z49uc1ft/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z49uc1ft/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:58:28,885 ccm INFO node1: using Java 8 for the current invocation
12:58:28,967 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
12:58:45,839 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:58:45,389 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
______________________________ TestCQL.test_type _______________________________

self = <cql_test.TestCQL object at 0x7f6804d32668>

    def test_type(self):
        """
            Smoke test basic TYPE operations:
    
            - CREATE a type
            - CREATE a table using that type
            - ALTER the type and CREATE another table
            - DROP the tables and type
            - CREATE another table using the DROPped type and assert it fails with an InvalidRequest
            # TODO run SELECTs to make sure each statement works
            # TODO is this even necessary given the existence of the auth_tests?
            """
        session = self.prepare()
        # even though we only ever use the user_types attribute of this object,
        # we have to access it each time, because attribute access is how the
        # value is updated
        ks_meta = UpdatingKeyspaceMetadataWrapper(session.cluster, ks_name='ks')
    
>       session.execute("CREATE TYPE address_t (street text, city text, zip_code int)")

cql_test.py:227: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
12:58:27,903 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:58:27,51 conftest INFO Starting execution of test_type at 2022-02-01 12:58:27.051461
12:58:27,810 dtest_setup INFO cluster ccm directory: /tmp/dtest-z49uc1ft
------------------------------ Captured log call -------------------------------
12:58:28,681 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z49uc1ft/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z49uc1ft/test/node1/conf'}
12:58:28,682 ccm INFO node1: using Java 8 for the current invocation
12:58:28,884 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-z49uc1ft/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-z49uc1ft/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:58:28,885 ccm INFO node1: using Java 8 for the current invocation
12:58:28,967 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_type failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/cql_test.py:227>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 19.76 seconds ======================
[msx] rc = 1
v2v2 running time = 41728468120
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: cql_test.py::TestCQL::test_type
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type 
-------------------------------- live log call ---------------------------------
12:59:28,523 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
FAILED                                                                   [100%]
------------------------------ live log teardown -------------------------------
12:59:28,735 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:59:27,602 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

cql_test.py::TestCQL::test_type ERROR                                    [100%]

==================================== ERRORS ====================================
____________________ ERROR at teardown of TestCQL.test_type ____________________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-02-01 12:59:27,602 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:59:27,604 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:59:27,604 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 12:59:27,602 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
12:59:10,391 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:59:08,686 conftest INFO Starting execution of test_type at 2022-02-01 12:59:08.686120
12:59:10,300 dtest_setup INFO cluster ccm directory: /tmp/dtest-u0l1b6m6
------------------------------ Captured log call -------------------------------
12:59:11,45 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u0l1b6m6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u0l1b6m6/test/node1/conf'}
12:59:11,45 ccm INFO node1: using Java 8 for the current invocation
12:59:11,221 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u0l1b6m6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u0l1b6m6/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:59:11,222 ccm INFO node1: using Java 8 for the current invocation
12:59:11,321 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:59:28,523 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
---------------------------- Captured log teardown -----------------------------
12:59:28,735 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 12:59:27,602 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
______________________________ TestCQL.test_type _______________________________

self = <cql_test.TestCQL object at 0x7fcf3c6ea588>

    def test_type(self):
        """
            Smoke test basic TYPE operations:
    
            - CREATE a type
            - CREATE a table using that type
            - ALTER the type and CREATE another table
            - DROP the tables and type
            - CREATE another table using the DROPped type and assert it fails with an InvalidRequest
            # TODO run SELECTs to make sure each statement works
            # TODO is this even necessary given the existence of the auth_tests?
            """
        session = self.prepare()
        # even though we only ever use the user_types attribute of this object,
        # we have to access it each time, because attribute access is how the
        # value is updated
        ks_meta = UpdatingKeyspaceMetadataWrapper(session.cluster, ks_name='ks')
    
>       session.execute("CREATE TYPE address_t (street text, city text, zip_code int)")

cql_test.py:227: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
12:59:10,391 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
12:59:08,686 conftest INFO Starting execution of test_type at 2022-02-01 12:59:08.686120
12:59:10,300 dtest_setup INFO cluster ccm directory: /tmp/dtest-u0l1b6m6
------------------------------ Captured log call -------------------------------
12:59:11,45 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u0l1b6m6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u0l1b6m6/test/node1/conf'}
12:59:11,45 ccm INFO node1: using Java 8 for the current invocation
12:59:11,221 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u0l1b6m6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u0l1b6m6/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
12:59:11,222 ccm INFO node1: using Java 8 for the current invocation
12:59:11,321 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
12:59:28,523 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down
===Flaky Test Report===

test_type failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/cql_test.py:227>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 21.07 seconds ======================
[msx] rc = 1
v1v2 running time = 42863221383
---> v1v2 test failed.
proj: cassandra
u_test: cql_test.py::TestCQL::test_type
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type PASSED                                   [100%]
===Flaky Test Report===

test_type passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 31.58 seconds ===========================
[msx] rc = 0
v1v1 running time = 53379378420
cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type FAILED                                   [100%]
------------------------------ live log teardown -------------------------------
13:01:33,997 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 13:01:03,676 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

cql_test.py::TestCQL::test_type ERROR                                    [100%]

==================================== ERRORS ====================================
____________________ ERROR at teardown of TestCQL.test_type ____________________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-02-01 13:01:03,676 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 13:01:03,678 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 13:01:03,678 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 13:01:03,676 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
13:00:45,705 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:00:44,692 conftest INFO Starting execution of test_type at 2022-02-01 13:00:44.692101
13:00:45,598 dtest_setup INFO cluster ccm directory: /tmp/dtest-q37gc4m4
----------------------------- Captured stdout call -----------------------------

13:00:45,707 ccm DEBUG using balanced tokens for non-vnode cluster
13:00:46,333 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q37gc4m4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q37gc4m4/test/node1/conf'}
13:00:46,334 ccm INFO node1: using Java 8 for the current invocation
13:00:46,515 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q37gc4m4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q37gc4m4/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:00:46,515 ccm INFO node1: using Java 8 for the current invocation
13:00:46,606 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 13:01:03,676 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 13:01:03,678 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 13:01:03,678 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
13:00:46,333 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q37gc4m4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q37gc4m4/test/node1/conf'}
13:00:46,334 ccm INFO node1: using Java 8 for the current invocation
13:00:46,515 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q37gc4m4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q37gc4m4/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:00:46,515 ccm INFO node1: using Java 8 for the current invocation
13:00:46,606 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
13:01:33,997 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 13:01:03,676 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
______________________________ TestCQL.test_type _______________________________

self = <cql_test.TestCQL object at 0x7f368a48d588>

    def test_type(self):
        """
            Smoke test basic TYPE operations:
    
            - CREATE a type
            - CREATE a table using that type
            - ALTER the type and CREATE another table
            - DROP the tables and type
            - CREATE another table using the DROPped type and assert it fails with an InvalidRequest
            # TODO run SELECTs to make sure each statement works
            # TODO is this even necessary given the existence of the auth_tests?
            """
>       session = self.prepare()

cql_test.py:221: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cql_test.py:60: in prepare
    session = self.patient_cql_connection(node1, protocol_version=protocol_version, user=user, password=password)
dtest_setup.py:250: in patient_cql_connection
    **kwargs
dtest_setup.py:39: in retry_till_success
    return fun(*args, **kwargs)
dtest_setup.py:177: in cql_connection
    protocol_version, port=port, ssl_opts=ssl_opts, **kwargs)
dtest_setup.py:216: in _create_session
    session = cluster.connect(wait_for_all_pools=True)
cassandra/cluster.py:1667: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1703: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:1690: in cassandra.cluster.Cluster.connect
    ???
cassandra/cluster.py:3488: in cassandra.cluster.ControlConnection.connect
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to connect to any servers', {'127.0.0.1:9042': ConnectionRefusedError(111, "Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused")})

cassandra/cluster.py:3533: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
13:00:45,705 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:00:44,692 conftest INFO Starting execution of test_type at 2022-02-01 13:00:44.692101
13:00:45,598 dtest_setup INFO cluster ccm directory: /tmp/dtest-q37gc4m4
----------------------------- Captured stdout call -----------------------------

13:00:45,707 ccm DEBUG using balanced tokens for non-vnode cluster
13:00:46,333 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q37gc4m4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q37gc4m4/test/node1/conf'}
13:00:46,334 ccm INFO node1: using Java 8 for the current invocation
13:00:46,515 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q37gc4m4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q37gc4m4/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:00:46,515 ccm INFO node1: using Java 8 for the current invocation
13:00:46,606 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 13:01:03,676 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 13:01:03,678 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 13:01:03,678 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
13:00:46,333 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q37gc4m4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q37gc4m4/test/node1/conf'}
13:00:46,334 ccm INFO node1: using Java 8 for the current invocation
13:00:46,515 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-q37gc4m4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-q37gc4m4/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:00:46,515 ccm INFO node1: using Java 8 for the current invocation
13:00:46,606 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_type failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to connect to any servers', {'127.0.0.1:9042': ConnectionRefusedError(111, "Tried connecting to [('127.0.0.1', 9042)]. Last error: Connection refused")})
	[<TracebackEntry /root/cassandra-dtest/cql_test.py:221>, <TracebackEntry /root/cassandra-dtest/cql_test.py:60>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:250>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:39>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:177>, <TracebackEntry /root/cassandra-dtest/dtest_setup.py:216>, <TracebackEntry cassandra/cluster.py:1667>, <TracebackEntry cassandra/cluster.py:1703>, <TracebackEntry cassandra/cluster.py:1690>, <TracebackEntry cassandra/cluster.py:3488>, <TracebackEntry cassandra/cluster.py:3533>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 50.29 seconds ======================
[msx] rc = 1
v2v2 running time = 72177799089
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: cql_test.py::TestCQL::test_type
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type 
-------------------------------- live log call ---------------------------------
13:02:19,55 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
13:02:19,160 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 13:02:18,265 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

cql_test.py::TestCQL::test_type ERROR                                    [100%]

==================================== ERRORS ====================================
____________________ ERROR at teardown of TestCQL.test_type ____________________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-02-01 13:02:18,265 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 13:02:18,268 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 13:02:18,269 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 13:02:18,265 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
13:02:00,342 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:01:57,68 conftest INFO Starting execution of test_type at 2022-02-01 13:01:57.068766
13:02:00,235 dtest_setup INFO cluster ccm directory: /tmp/dtest-2ggrx88a
----------------------------- Captured stdout call -----------------------------
13:02:00,344 ccm DEBUG using balanced tokens for non-vnode cluster
13:02:01,209 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2ggrx88a/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2ggrx88a/test/node1/conf'}
13:02:01,210 ccm INFO node1: using Java 8 for the current invocation
13:02:01,392 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2ggrx88a/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2ggrx88a/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:02:01,393 ccm INFO node1: using Java 8 for the current invocation
13:02:01,471 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 13:02:18,265 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 13:02:18,268 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 13:02:18,269 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
13:02:01,209 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2ggrx88a/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2ggrx88a/test/node1/conf'}
13:02:01,210 ccm INFO node1: using Java 8 for the current invocation
13:02:01,392 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2ggrx88a/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2ggrx88a/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:02:01,393 ccm INFO node1: using Java 8 for the current invocation
13:02:01,471 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
13:02:19,160 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 13:02:18,265 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
______________________________ TestCQL.test_type _______________________________

self = <cql_test.TestCQL object at 0x7f80d5137a20>

    def test_type(self):
        """
            Smoke test basic TYPE operations:
    
            - CREATE a type
            - CREATE a table using that type
            - ALTER the type and CREATE another table
            - DROP the tables and type
            - CREATE another table using the DROPped type and assert it fails with an InvalidRequest
            # TODO run SELECTs to make sure each statement works
            # TODO is this even necessary given the existence of the auth_tests?
            """
        session = self.prepare()
        # even though we only ever use the user_types attribute of this object,
        # we have to access it each time, because attribute access is how the
        # value is updated
        ks_meta = UpdatingKeyspaceMetadataWrapper(session.cluster, ks_name='ks')
    
>       session.execute("CREATE TYPE address_t (street text, city text, zip_code int)")

cql_test.py:227: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
13:02:00,342 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:01:57,68 conftest INFO Starting execution of test_type at 2022-02-01 13:01:57.068766
13:02:00,235 dtest_setup INFO cluster ccm directory: /tmp/dtest-2ggrx88a
----------------------------- Captured stdout call -----------------------------
13:02:00,344 ccm DEBUG using balanced tokens for non-vnode cluster
13:02:01,209 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2ggrx88a/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2ggrx88a/test/node1/conf'}
13:02:01,210 ccm INFO node1: using Java 8 for the current invocation
13:02:01,392 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2ggrx88a/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2ggrx88a/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:02:01,393 ccm INFO node1: using Java 8 for the current invocation
13:02:01,471 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
----------------------------- Captured stderr call -----------------------------
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/lib/python3.6/threading.py", line 916, in _bootstrap_inner
    self.run()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 193, in run
    self.scan_and_report()
  File "/root/dtest/lib/python3.6/site-packages/ccmlib/cluster.py", line 186, in scan_and_report
    on_error_call(errordata)
  File "/root/cassandra-dtest/dtest_setup.py", line 136, in _log_error_handler
    pytest.fail("Error details: \n{message}".format(message=message))
  File "/root/dtest/lib/python3.6/site-packages/_pytest/outcomes.py", line 97, in fail
    raise Failed(msg=msg, pytrace=pytrace)
Failed: Error details: 
Errors seen in logs for: node1
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 13:02:18,265 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 13:02:18,268 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
node1: ERROR [HintsWriteExecutor:1] 2022-02-01 13:02:18,269 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

------------------------------ Captured log call -------------------------------
13:02:01,209 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2ggrx88a/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2ggrx88a/test/node1/conf'}
13:02:01,210 ccm INFO node1: using Java 8 for the current invocation
13:02:01,392 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-2ggrx88a/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-2ggrx88a/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:02:01,393 ccm INFO node1: using Java 8 for the current invocation
13:02:01,471 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_type failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/cql_test.py:227>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 23.05 seconds ======================
[msx] rc = 1
v1v2 running time = 44954252632
---> v1v2 test failed.
proj: cassandra
u_test: cql_test.py::TestCQL::test_type
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type PASSED                                   [100%]
===Flaky Test Report===

test_type passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 27.99 seconds ===========================
[msx] rc = 0
v1v1 running time = 49596893093
cassandra cql_test.py::TestCQL::test_type false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is cql_test.py::TestCQL::test_type
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

cql_test.py::TestCQL::test_type 
-------------------------------- live log call ---------------------------------
13:03:51,7 cassandra.cluster WARNING Host 127.0.0.1:9042 has been marked down

------------------------------ live log teardown -------------------------------
13:03:51,113 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 13:03:50,257 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

cql_test.py::TestCQL::test_type ERROR                                    [100%]

==================================== ERRORS ====================================
____________________ ERROR at teardown of TestCQL.test_type ____________________
Unexpected error found in node logs (see stdout for full details). Errors: [ERROR [HintsWriteExecutor:1] 2022-02-01 13:03:50,257 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 13:03:50,260 JVMStabilityInspector.java:102 - OutOfMemory error letting the JVM handle the error:
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 13:03:50,261 JVMStabilityInspector.java:151 - Force heap space OutOfMemoryError in the presence of
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748), ERROR [HintsWriteExecutor:1] 2022-02-01 13:03:50,257 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)]
---------------------------- Captured stdout setup -----------------------------
3:03:32,453 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:03:31,490 conftest INFO Starting execution of test_type at 2022-02-01 13:03:31.489998
13:03:32,348 dtest_setup INFO cluster ccm directory: /tmp/dtest-7q_gw9rw
------------------------------ Captured log call -------------------------------
13:03:33,92 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7q_gw9rw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7q_gw9rw/test/node1/conf'}
13:03:33,93 ccm INFO node1: using Java 8 for the current invocation
13:03:33,297 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7q_gw9rw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7q_gw9rw/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:03:33,298 ccm INFO node1: using Java 8 for the current invocation
13:03:33,391 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
---------------------------- Captured log teardown -----------------------------
13:03:51,113 conftest ERROR Unexpected error in node1 log, error: 
ERROR [HintsWriteExecutor:1] 2022-02-01 13:03:50,257 CassandraDaemon.java:581 - Exception in thread Thread[HintsWriteExecutor:1,5,main]
java.lang.OutOfMemoryError: Direct buffer memory
	at java.nio.Bits.reserveMemory(Bits.java:695)
	at java.nio.DirectByteBuffer.<init>(DirectByteBuffer.java:123)
	at java.nio.ByteBuffer.allocateDirect(ByteBuffer.java:311)
	at org.apache.cassandra.hints.HintsBuffer.create(HintsBuffer.java:73)
	at org.apache.cassandra.hints.HintsBufferPool.createBuffer(HintsBufferPool.java:131)
	at org.apache.cassandra.hints.HintsBufferPool.initializeCurrentBuffer(HintsBufferPool.java:102)
	at org.apache.cassandra.hints.HintsBufferPool.currentBuffer(HintsBufferPool.java:94)
	at org.apache.cassandra.hints.HintsWriteExecutor$FlushBufferPoolTask.run(HintsWriteExecutor.java:159)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)
=================================== FAILURES ===================================
______________________________ TestCQL.test_type _______________________________

self = <cql_test.TestCQL object at 0x7f6078229a20>

    def test_type(self):
        """
            Smoke test basic TYPE operations:
    
            - CREATE a type
            - CREATE a table using that type
            - ALTER the type and CREATE another table
            - DROP the tables and type
            - CREATE another table using the DROPped type and assert it fails with an InvalidRequest
            # TODO run SELECTs to make sure each statement works
            # TODO is this even necessary given the existence of the auth_tests?
            """
        session = self.prepare()
        # even though we only ever use the user_types attribute of this object,
        # we have to access it each time, because attribute access is how the
        # value is updated
        ks_meta = UpdatingKeyspaceMetadataWrapper(session.cluster, ks_name='ks')
    
        session.execute("CREATE TYPE address_t (street text, city text, zip_code int)")
        assert 'address_t' in ks_meta.user_types
    
>       session.execute("CREATE TABLE test4 (id int PRIMARY KEY, address frozen<address_t>)")

cql_test.py:230: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
cassandra/cluster.py:2618: in cassandra.cluster.Session.execute
    ???
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

>   ???
E   cassandra.cluster.NoHostAvailable: ('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})

cassandra/cluster.py:4894: NoHostAvailable
---------------------------- Captured stdout setup -----------------------------
3:03:32,453 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
13:03:31,490 conftest INFO Starting execution of test_type at 2022-02-01 13:03:31.489998
13:03:32,348 dtest_setup INFO cluster ccm directory: /tmp/dtest-7q_gw9rw
------------------------------ Captured log call -------------------------------
13:03:33,92 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7q_gw9rw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7q_gw9rw/test/node1/conf'}
13:03:33,93 ccm INFO node1: using Java 8 for the current invocation
13:03:33,297 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '7c08658af1e8', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'cql_test.py::TestCQL::()::test_type (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7q_gw9rw/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7q_gw9rw/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
13:03:33,298 ccm INFO node1: using Java 8 for the current invocation
13:03:33,391 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
===Flaky Test Report===

test_type failed and was not selected for rerun.
	<class 'cassandra.cluster.NoHostAvailable'>
	('Unable to complete the operation against any hosts', {<Host: 127.0.0.1:9042 datacenter1>: ConnectionShutdown('[Errno 104] Connection reset by peer',)})
	[<TracebackEntry /root/cassandra-dtest/cql_test.py:230>, <TracebackEntry cassandra/cluster.py:2618>, <TracebackEntry cassandra/cluster.py:4894>]

===End Flaky Test Report===
====================== 1 failed, 1 error in 20.58 seconds ======================
[msx] rc = 1
v2v2 running time = 42266424526
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: cql_test.py::TestCQL::test_type
h_list: commitlog_segment_size_in_mb@@@CassandraDaemon@@@1@@@32@@@1024
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

early stop after 7 is satisfied
v1v2 failed with probability 6 out of 7
v1v1v2v2 failed with probability 7 out of 7
Total execution time in seconds : 967
0
