my_type=hypothesis
proj=cassandra
u_test=jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list[1]=read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release PASSED               [100%]
===Flaky Test Report===

test_mv_metric_mbeans_release passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 34.64 seconds ===========================
[msx] rc = 0
v1v2 running time = 56067264571
---> v1v2 test suceeded.
cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7fe744ac5048>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7fe7441fa128>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
10:49:44,725 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:49:43,628 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 10:49:43.627943
10:49:44,626 dtest_setup INFO cluster ccm directory: /tmp/dtest-qs7bu4sx
----------------------------- Captured stdout call -----------------------------

10:49:44,732 ccm DEBUG using balanced tokens for non-vnode cluster
10:49:45,378 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-qs7bu4sx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-qs7bu4sx/test/node1/conf'}
10:49:45,379 ccm INFO node1: using Java 8 for the current invocation
10:49:45,544 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-qs7bu4sx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-qs7bu4sx/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:49:45,544 ccm INFO node1: using Java 8 for the current invocation
10:49:45,623 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:50:00,931 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-qs7bu4sx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-qs7bu4sx/test/node1/conf'}
10:50:00,932 ccm INFO node1: using Java 8 for the current invocation
10:50:06,875 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-qs7bu4sx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-qs7bu4sx/test/node1/conf'}
10:50:06,875 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
10:49:45,378 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-qs7bu4sx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-qs7bu4sx/test/node1/conf'}
10:49:45,379 ccm INFO node1: using Java 8 for the current invocation
10:49:45,544 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-qs7bu4sx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-qs7bu4sx/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:49:45,544 ccm INFO node1: using Java 8 for the current invocation
10:49:45,623 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:50:00,931 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-qs7bu4sx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-qs7bu4sx/test/node1/conf'}
10:50:00,932 ccm INFO node1: using Java 8 for the current invocation
10:50:06,875 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-qs7bu4sx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-qs7bu4sx/test/node1/conf'}
10:50:06,875 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
10:50:21,88 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
10:50:25,519 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:50:24,257 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 10:50:24.257721
10:50:25,419 dtest_setup INFO cluster ccm directory: /tmp/dtest-7c8axk76
----------------------------- Captured stdout call -----------------------------
10:50:25,529 ccm DEBUG using balanced tokens for non-vnode cluster
10:50:26,147 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7c8axk76/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7c8axk76/test/node1/conf'}
10:50:26,148 ccm INFO node1: using Java 8 for the current invocation
10:50:26,313 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7c8axk76/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7c8axk76/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:50:26,313 ccm INFO node1: using Java 8 for the current invocation
10:50:26,393 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:50:40,903 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7c8axk76/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7c8axk76/test/node1/conf'}
10:50:40,904 ccm INFO node1: using Java 8 for the current invocation
10:50:47,717 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7c8axk76/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7c8axk76/test/node1/conf'}
10:50:47,718 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
10:50:26,147 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7c8axk76/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7c8axk76/test/node1/conf'}
10:50:26,148 ccm INFO node1: using Java 8 for the current invocation
10:50:26,313 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7c8axk76/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7c8axk76/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:50:26,313 ccm INFO node1: using Java 8 for the current invocation
10:50:26,393 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:50:40,903 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7c8axk76/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7c8axk76/test/node1/conf'}
10:50:40,904 ccm INFO node1: using Java 8 for the current invocation
10:50:47,717 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7c8axk76/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7c8axk76/test/node1/conf'}
10:50:47,718 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
10:50:21,88 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:50:21,88 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:50:58,902 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 77.85 seconds ===========================
[msx] rc = 1
v1v1 running time = 99158669546
cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7f8c37ccabe0>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f8c37219898>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
10:51:24,57 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:51:22,850 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 10:51:22.850009
10:51:23,961 dtest_setup INFO cluster ccm directory: /tmp/dtest-u3sqeni8
----------------------------- Captured stdout call -----------------------------

10:51:24,63 ccm DEBUG using balanced tokens for non-vnode cluster
10:51:24,701 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u3sqeni8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u3sqeni8/test/node1/conf'}
10:51:24,702 ccm INFO node1: using Java 8 for the current invocation
10:51:24,875 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u3sqeni8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u3sqeni8/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:51:24,876 ccm INFO node1: using Java 8 for the current invocation
10:51:24,978 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:51:38,279 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u3sqeni8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u3sqeni8/test/node1/conf'}
10:51:38,280 ccm INFO node1: using Java 8 for the current invocation
10:51:44,393 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u3sqeni8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u3sqeni8/test/node1/conf'}
10:51:44,394 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
10:51:24,701 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u3sqeni8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u3sqeni8/test/node1/conf'}
10:51:24,702 ccm INFO node1: using Java 8 for the current invocation
10:51:24,875 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u3sqeni8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u3sqeni8/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:51:24,876 ccm INFO node1: using Java 8 for the current invocation
10:51:24,978 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:51:38,279 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u3sqeni8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u3sqeni8/test/node1/conf'}
10:51:38,280 ccm INFO node1: using Java 8 for the current invocation
10:51:44,393 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u3sqeni8/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u3sqeni8/test/node1/conf'}
10:51:44,394 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
10:51:58,656 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
10:52:02,678 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:52:01,825 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 10:52:01.825209
10:52:02,585 dtest_setup INFO cluster ccm directory: /tmp/dtest-e04j5ivo
----------------------------- Captured stdout call -----------------------------

10:52:02,684 ccm DEBUG using balanced tokens for non-vnode cluster
10:52:03,275 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e04j5ivo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e04j5ivo/test/node1/conf'}
10:52:03,276 ccm INFO node1: using Java 8 for the current invocation
10:52:03,448 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e04j5ivo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e04j5ivo/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:52:03,448 ccm INFO node1: using Java 8 for the current invocation
10:52:03,523 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:52:18,813 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e04j5ivo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e04j5ivo/test/node1/conf'}
10:52:18,813 ccm INFO node1: using Java 8 for the current invocation
10:52:24,620 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e04j5ivo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e04j5ivo/test/node1/conf'}
10:52:24,621 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
10:52:03,275 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e04j5ivo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e04j5ivo/test/node1/conf'}
10:52:03,276 ccm INFO node1: using Java 8 for the current invocation
10:52:03,448 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e04j5ivo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e04j5ivo/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:52:03,448 ccm INFO node1: using Java 8 for the current invocation
10:52:03,523 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:52:18,813 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e04j5ivo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e04j5ivo/test/node1/conf'}
10:52:18,813 ccm INFO node1: using Java 8 for the current invocation
10:52:24,620 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-e04j5ivo/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-e04j5ivo/test/node1/conf'}
10:52:24,621 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
10:51:58,656 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:51:58,656 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:52:35,544 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 73.27 seconds ===========================
[msx] rc = 1
v2v2 running time = 94656749879
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

v2v2 failed in a hypo test
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7fd9eabb70f0>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7fd9ea0e0748>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
10:52:58,498 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:52:57,550 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 10:52:57.550252
10:52:58,407 dtest_setup INFO cluster ccm directory: /tmp/dtest-3jg_ddjz
----------------------------- Captured stdout call -----------------------------

10:52:58,504 ccm DEBUG using balanced tokens for non-vnode cluster
10:52:59,134 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3jg_ddjz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3jg_ddjz/test/node1/conf'}
10:52:59,135 ccm INFO node1: using Java 8 for the current invocation
10:52:59,290 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3jg_ddjz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3jg_ddjz/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:52:59,291 ccm INFO node1: using Java 8 for the current invocation
10:52:59,369 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:53:13,664 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3jg_ddjz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3jg_ddjz/test/node1/conf'}
10:53:13,665 ccm INFO node1: using Java 8 for the current invocation
10:53:18,416 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3jg_ddjz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3jg_ddjz/test/node1/conf'}
10:53:18,416 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
10:52:59,134 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3jg_ddjz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3jg_ddjz/test/node1/conf'}
10:52:59,135 ccm INFO node1: using Java 8 for the current invocation
10:52:59,290 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3jg_ddjz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3jg_ddjz/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:52:59,291 ccm INFO node1: using Java 8 for the current invocation
10:52:59,369 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:53:13,664 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3jg_ddjz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3jg_ddjz/test/node1/conf'}
10:53:13,665 ccm INFO node1: using Java 8 for the current invocation
10:53:18,416 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-3jg_ddjz/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-3jg_ddjz/test/node1/conf'}
10:53:18,416 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
10:53:32,348 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
10:53:36,649 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:53:35,583 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 10:53:35.583636
10:53:36,545 dtest_setup INFO cluster ccm directory: /tmp/dtest-uonnk7xh
----------------------------- Captured stdout call -----------------------------

10:53:36,665 ccm DEBUG using balanced tokens for non-vnode cluster
10:53:37,319 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-uonnk7xh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-uonnk7xh/test/node1/conf'}
10:53:37,320 ccm INFO node1: using Java 8 for the current invocation
10:53:37,501 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-uonnk7xh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-uonnk7xh/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:53:37,502 ccm INFO node1: using Java 8 for the current invocation
10:53:37,590 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:53:50,881 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-uonnk7xh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-uonnk7xh/test/node1/conf'}
10:53:50,882 ccm INFO node1: using Java 8 for the current invocation
10:53:56,515 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-uonnk7xh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-uonnk7xh/test/node1/conf'}
10:53:56,516 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
10:53:37,319 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-uonnk7xh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-uonnk7xh/test/node1/conf'}
10:53:37,320 ccm INFO node1: using Java 8 for the current invocation
10:53:37,501 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-uonnk7xh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-uonnk7xh/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:53:37,502 ccm INFO node1: using Java 8 for the current invocation
10:53:37,590 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:53:50,881 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-uonnk7xh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-uonnk7xh/test/node1/conf'}
10:53:50,882 ccm INFO node1: using Java 8 for the current invocation
10:53:56,515 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-uonnk7xh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-uonnk7xh/test/node1/conf'}
10:53:56,516 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
10:53:32,348 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:53:32,348 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:54:07,493 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 70.49 seconds ===========================
[msx] rc = 1
v1v2 running time = 91927182788
---> v1v2 test failed.
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7f10d0dfd710>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f10d05357b8>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
0:54:31,183 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:54:29,665 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 10:54:29.665725
10:54:31,75 dtest_setup INFO cluster ccm directory: /tmp/dtest-vfzyxwt2
----------------------------- Captured stdout call -----------------------------
10:54:31,198 ccm DEBUG using balanced tokens for non-vnode cluster
10:54:31,855 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vfzyxwt2/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vfzyxwt2/test/node1/conf'}
10:54:31,856 ccm INFO node1: using Java 8 for the current invocation
10:54:32,49 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vfzyxwt2/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vfzyxwt2/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:54:32,50 ccm INFO node1: using Java 8 for the current invocation
10:54:32,142 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:54:48,419 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vfzyxwt2/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vfzyxwt2/test/node1/conf'}
10:54:48,420 ccm INFO node1: using Java 8 for the current invocation
10:54:55,56 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vfzyxwt2/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vfzyxwt2/test/node1/conf'}
10:54:55,57 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
10:54:31,855 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vfzyxwt2/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vfzyxwt2/test/node1/conf'}
10:54:31,856 ccm INFO node1: using Java 8 for the current invocation
10:54:32,49 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vfzyxwt2/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vfzyxwt2/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:54:32,50 ccm INFO node1: using Java 8 for the current invocation
10:54:32,142 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:54:48,419 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vfzyxwt2/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vfzyxwt2/test/node1/conf'}
10:54:48,420 ccm INFO node1: using Java 8 for the current invocation
10:54:55,56 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-vfzyxwt2/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-vfzyxwt2/test/node1/conf'}
10:54:55,57 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
10:55:09,539 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
0:55:14,137 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:55:13,126 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 10:55:13.126289
10:55:14,35 dtest_setup INFO cluster ccm directory: /tmp/dtest-1vrl1sfx
----------------------------- Captured stdout call -----------------------------
10:55:14,144 ccm DEBUG using balanced tokens for non-vnode cluster
10:55:14,764 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1vrl1sfx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1vrl1sfx/test/node1/conf'}
10:55:14,764 ccm INFO node1: using Java 8 for the current invocation
10:55:14,932 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1vrl1sfx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1vrl1sfx/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:55:14,933 ccm INFO node1: using Java 8 for the current invocation
10:55:15,18 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:55:29,314 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1vrl1sfx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1vrl1sfx/test/node1/conf'}
10:55:29,315 ccm INFO node1: using Java 8 for the current invocation
10:55:35,463 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1vrl1sfx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1vrl1sfx/test/node1/conf'}
10:55:35,463 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
10:55:14,764 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1vrl1sfx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1vrl1sfx/test/node1/conf'}
10:55:14,764 ccm INFO node1: using Java 8 for the current invocation
10:55:14,932 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1vrl1sfx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1vrl1sfx/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:55:14,933 ccm INFO node1: using Java 8 for the current invocation
10:55:15,18 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:55:29,314 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1vrl1sfx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1vrl1sfx/test/node1/conf'}
10:55:29,315 ccm INFO node1: using Java 8 for the current invocation
10:55:35,463 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1vrl1sfx/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1vrl1sfx/test/node1/conf'}
10:55:35,463 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
10:55:09,539 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:55:09,539 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:55:46,557 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 77.44 seconds ===========================
[msx] rc = 1
v1v1 running time = 99058181270
cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7fdb4fd96470>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7fdb4f57c588>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
10:56:09,675 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:56:08,419 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 10:56:08.419325
10:56:09,578 dtest_setup INFO cluster ccm directory: /tmp/dtest-94gpq8rf
----------------------------- Captured stdout call -----------------------------

10:56:09,682 ccm DEBUG using balanced tokens for non-vnode cluster
10:56:10,284 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-94gpq8rf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-94gpq8rf/test/node1/conf'}
10:56:10,285 ccm INFO node1: using Java 8 for the current invocation
10:56:10,455 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-94gpq8rf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-94gpq8rf/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:56:10,455 ccm INFO node1: using Java 8 for the current invocation
10:56:10,540 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:56:24,850 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-94gpq8rf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-94gpq8rf/test/node1/conf'}
10:56:24,851 ccm INFO node1: using Java 8 for the current invocation
10:56:31,170 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-94gpq8rf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-94gpq8rf/test/node1/conf'}
10:56:31,170 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
10:56:10,284 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-94gpq8rf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-94gpq8rf/test/node1/conf'}
10:56:10,285 ccm INFO node1: using Java 8 for the current invocation
10:56:10,455 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-94gpq8rf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-94gpq8rf/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:56:10,455 ccm INFO node1: using Java 8 for the current invocation
10:56:10,540 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:56:24,850 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-94gpq8rf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-94gpq8rf/test/node1/conf'}
10:56:24,851 ccm INFO node1: using Java 8 for the current invocation
10:56:31,170 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-94gpq8rf/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-94gpq8rf/test/node1/conf'}
10:56:31,170 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
10:56:45,296 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
10:56:48,392 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:56:48,45 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 10:56:48.045500
10:56:48,302 dtest_setup INFO cluster ccm directory: /tmp/dtest-im26evjh
----------------------------- Captured stdout call -----------------------------
10:56:48,398 ccm DEBUG using balanced tokens for non-vnode cluster
10:56:48,946 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-im26evjh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-im26evjh/test/node1/conf'}
10:56:48,947 ccm INFO node1: using Java 8 for the current invocation
10:56:49,118 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-im26evjh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-im26evjh/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:56:49,118 ccm INFO node1: using Java 8 for the current invocation
10:56:49,204 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:57:00,477 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-im26evjh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-im26evjh/test/node1/conf'}
10:57:00,478 ccm INFO node1: using Java 8 for the current invocation
10:57:07,531 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-im26evjh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-im26evjh/test/node1/conf'}
10:57:07,531 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
10:56:48,946 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-im26evjh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-im26evjh/test/node1/conf'}
10:56:48,947 ccm INFO node1: using Java 8 for the current invocation
10:56:49,118 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-im26evjh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-im26evjh/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:56:49,118 ccm INFO node1: using Java 8 for the current invocation
10:56:49,204 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:57:00,477 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-im26evjh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-im26evjh/test/node1/conf'}
10:57:00,478 ccm INFO node1: using Java 8 for the current invocation
10:57:07,531 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-im26evjh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-im26evjh/test/node1/conf'}
10:57:07,531 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
10:56:45,296 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:56:45,296 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:57:18,486 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 70.62 seconds ===========================
[msx] rc = 1
v2v2 running time = 91929516743
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

v2v2 failed in a hypo test
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7f3c6e930048>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f3c6e119390>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
10:57:42,35 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:57:40,413 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 10:57:40.413283
10:57:41,921 dtest_setup INFO cluster ccm directory: /tmp/dtest-6o65s7nd
----------------------------- Captured stdout call -----------------------------
10:57:42,42 ccm DEBUG using balanced tokens for non-vnode cluster
10:57:42,693 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6o65s7nd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6o65s7nd/test/node1/conf'}
10:57:42,694 ccm INFO node1: using Java 8 for the current invocation
10:57:42,856 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6o65s7nd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6o65s7nd/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:57:42,857 ccm INFO node1: using Java 8 for the current invocation
10:57:42,943 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:57:58,226 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6o65s7nd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6o65s7nd/test/node1/conf'}
10:57:58,227 ccm INFO node1: using Java 8 for the current invocation
10:58:04,252 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6o65s7nd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6o65s7nd/test/node1/conf'}
10:58:04,253 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
10:57:42,693 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6o65s7nd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6o65s7nd/test/node1/conf'}
10:57:42,694 ccm INFO node1: using Java 8 for the current invocation
10:57:42,856 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6o65s7nd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6o65s7nd/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:57:42,857 ccm INFO node1: using Java 8 for the current invocation
10:57:42,943 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:57:58,226 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6o65s7nd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6o65s7nd/test/node1/conf'}
10:57:58,227 ccm INFO node1: using Java 8 for the current invocation
10:58:04,252 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-6o65s7nd/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-6o65s7nd/test/node1/conf'}
10:58:04,253 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
10:58:18,173 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
10:58:22,123 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:58:21,268 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 10:58:21.268686
10:58:22,28 dtest_setup INFO cluster ccm directory: /tmp/dtest-i3v_n7du
----------------------------- Captured stdout call -----------------------------

10:58:22,129 ccm DEBUG using balanced tokens for non-vnode cluster
10:58:22,743 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i3v_n7du/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i3v_n7du/test/node1/conf'}
10:58:22,744 ccm INFO node1: using Java 8 for the current invocation
10:58:22,918 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i3v_n7du/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i3v_n7du/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:58:22,919 ccm INFO node1: using Java 8 for the current invocation
10:58:23,9 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:58:37,296 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i3v_n7du/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i3v_n7du/test/node1/conf'}
10:58:37,296 ccm INFO node1: using Java 8 for the current invocation
10:58:43,462 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i3v_n7du/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i3v_n7du/test/node1/conf'}
10:58:43,462 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
10:58:22,743 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i3v_n7du/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i3v_n7du/test/node1/conf'}
10:58:22,744 ccm INFO node1: using Java 8 for the current invocation
10:58:22,918 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i3v_n7du/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i3v_n7du/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:58:22,919 ccm INFO node1: using Java 8 for the current invocation
10:58:23,9 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:58:37,296 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i3v_n7du/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i3v_n7du/test/node1/conf'}
10:58:37,296 ccm INFO node1: using Java 8 for the current invocation
10:58:43,462 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-i3v_n7du/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-i3v_n7du/test/node1/conf'}
10:58:43,462 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
10:58:18,173 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:58:18,173 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:58:54,557 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 74.72 seconds ===========================
[msx] rc = 1
v1v2 running time = 96073833431
---> v1v2 test failed.
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7f4b3ebd7128>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f4b3e1249b0>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
10:59:17,467 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:59:16,520 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 10:59:16.520724
10:59:17,379 dtest_setup INFO cluster ccm directory: /tmp/dtest-k0fc1qx1
----------------------------- Captured stdout call -----------------------------

10:59:17,474 ccm DEBUG using balanced tokens for non-vnode cluster
10:59:18,107 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k0fc1qx1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k0fc1qx1/test/node1/conf'}
10:59:18,108 ccm INFO node1: using Java 8 for the current invocation
10:59:18,265 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k0fc1qx1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k0fc1qx1/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:59:18,265 ccm INFO node1: using Java 8 for the current invocation
10:59:18,341 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:59:34,622 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k0fc1qx1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k0fc1qx1/test/node1/conf'}
10:59:34,623 ccm INFO node1: using Java 8 for the current invocation
10:59:42,144 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k0fc1qx1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k0fc1qx1/test/node1/conf'}
10:59:42,144 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
10:59:18,107 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k0fc1qx1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k0fc1qx1/test/node1/conf'}
10:59:18,108 ccm INFO node1: using Java 8 for the current invocation
10:59:18,265 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k0fc1qx1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k0fc1qx1/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
10:59:18,265 ccm INFO node1: using Java 8 for the current invocation
10:59:18,341 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
10:59:34,622 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k0fc1qx1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k0fc1qx1/test/node1/conf'}
10:59:34,623 ccm INFO node1: using Java 8 for the current invocation
10:59:42,144 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k0fc1qx1/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k0fc1qx1/test/node1/conf'}
10:59:42,144 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
10:59:56,329 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:00:01,313 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
10:59:59,869 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 10:59:59.869549
11:00:01,182 dtest_setup INFO cluster ccm directory: /tmp/dtest-p_dnd7mg
----------------------------- Captured stdout call -----------------------------
 11:00:01,326 ccm DEBUG using balanced tokens for non-vnode cluster
11:00:02,2 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p_dnd7mg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p_dnd7mg/test/node1/conf'}
11:00:02,3 ccm INFO node1: using Java 8 for the current invocation
11:00:02,186 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p_dnd7mg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p_dnd7mg/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:00:02,187 ccm INFO node1: using Java 8 for the current invocation
11:00:02,278 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:00:17,565 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p_dnd7mg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p_dnd7mg/test/node1/conf'}
11:00:17,566 ccm INFO node1: using Java 8 for the current invocation
11:00:24,844 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p_dnd7mg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p_dnd7mg/test/node1/conf'}
11:00:24,844 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:00:02,2 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p_dnd7mg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p_dnd7mg/test/node1/conf'}
11:00:02,3 ccm INFO node1: using Java 8 for the current invocation
11:00:02,186 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p_dnd7mg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p_dnd7mg/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:00:02,187 ccm INFO node1: using Java 8 for the current invocation
11:00:02,278 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:00:17,565 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p_dnd7mg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p_dnd7mg/test/node1/conf'}
11:00:17,566 ccm INFO node1: using Java 8 for the current invocation
11:00:24,844 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-p_dnd7mg/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-p_dnd7mg/test/node1/conf'}
11:00:24,844 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
10:59:56,329 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
10:59:56,329 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:00:35,958 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 79.96 seconds ===========================
[msx] rc = 1
v1v1 running time = 101417328700
cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7f6e0070e4a8>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f6dffeec898>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:00:59,52 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:00:57,892 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:00:57.892108
11:00:58,952 dtest_setup INFO cluster ccm directory: /tmp/dtest-0yi5bgyp
----------------------------- Captured stdout call -----------------------------
11:00:59,59 ccm DEBUG using balanced tokens for non-vnode cluster
11:00:59,671 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0yi5bgyp/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0yi5bgyp/test/node1/conf'}
11:00:59,672 ccm INFO node1: using Java 8 for the current invocation
11:00:59,858 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0yi5bgyp/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0yi5bgyp/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:00:59,858 ccm INFO node1: using Java 8 for the current invocation
11:00:59,944 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:01:10,236 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0yi5bgyp/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0yi5bgyp/test/node1/conf'}
11:01:10,236 ccm INFO node1: using Java 8 for the current invocation
11:01:14,776 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0yi5bgyp/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0yi5bgyp/test/node1/conf'}
11:01:14,777 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:00:59,671 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0yi5bgyp/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0yi5bgyp/test/node1/conf'}
11:00:59,672 ccm INFO node1: using Java 8 for the current invocation
11:00:59,858 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0yi5bgyp/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0yi5bgyp/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:00:59,858 ccm INFO node1: using Java 8 for the current invocation
11:00:59,944 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:01:10,236 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0yi5bgyp/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0yi5bgyp/test/node1/conf'}
11:01:10,236 ccm INFO node1: using Java 8 for the current invocation
11:01:14,776 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-0yi5bgyp/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-0yi5bgyp/test/node1/conf'}
11:01:14,777 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:01:28,937 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:01:33,143 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:01:32,139 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:01:32.139015
11:01:33,50 dtest_setup INFO cluster ccm directory: /tmp/dtest-fffqmx89
----------------------------- Captured stdout call -----------------------------

11:01:33,149 ccm DEBUG using balanced tokens for non-vnode cluster
11:01:33,804 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fffqmx89/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fffqmx89/test/node1/conf'}
11:01:33,804 ccm INFO node1: using Java 8 for the current invocation
11:01:33,973 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fffqmx89/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fffqmx89/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:01:33,973 ccm INFO node1: using Java 8 for the current invocation
11:01:34,66 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:01:46,378 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fffqmx89/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fffqmx89/test/node1/conf'}
11:01:46,378 ccm INFO node1: using Java 8 for the current invocation
11:01:51,95 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fffqmx89/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fffqmx89/test/node1/conf'}
11:01:51,96 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:01:33,804 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fffqmx89/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fffqmx89/test/node1/conf'}
11:01:33,804 ccm INFO node1: using Java 8 for the current invocation
11:01:33,973 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fffqmx89/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fffqmx89/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:01:33,973 ccm INFO node1: using Java 8 for the current invocation
11:01:34,66 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:01:46,378 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fffqmx89/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fffqmx89/test/node1/conf'}
11:01:46,378 ccm INFO node1: using Java 8 for the current invocation
11:01:51,95 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-fffqmx89/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-fffqmx89/test/node1/conf'}
11:01:51,96 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:01:28,937 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:01:28,937 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:02:01,974 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 64.63 seconds ===========================
[msx] rc = 1
v2v2 running time = 85974902555
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

v2v2 failed in a hypo test
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release PASSED               [100%]
===Flaky Test Report===

test_mv_metric_mbeans_release passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 35.24 seconds ===========================
[msx] rc = 0
v1v2 running time = 56618635572
---> v1v2 test suceeded.
cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release PASSED               [100%]
===Flaky Test Report===

test_mv_metric_mbeans_release passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 25.73 seconds ===========================
[msx] rc = 0
v1v1 running time = 47087457295
cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7f7d990bb5c0>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f7d988a2da0>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:04:08,920 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:04:07,622 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:04:07.621977
11:04:08,821 dtest_setup INFO cluster ccm directory: /tmp/dtest-k_svqt57
----------------------------- Captured stdout call -----------------------------

11:04:08,926 ccm DEBUG using balanced tokens for non-vnode cluster
11:04:09,572 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k_svqt57/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k_svqt57/test/node1/conf'}
11:04:09,573 ccm INFO node1: using Java 8 for the current invocation
11:04:09,760 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k_svqt57/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k_svqt57/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:04:09,761 ccm INFO node1: using Java 8 for the current invocation
11:04:09,844 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:04:25,166 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k_svqt57/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k_svqt57/test/node1/conf'}
11:04:25,167 ccm INFO node1: using Java 8 for the current invocation
11:04:31,758 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k_svqt57/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k_svqt57/test/node1/conf'}
11:04:31,759 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:04:09,572 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k_svqt57/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k_svqt57/test/node1/conf'}
11:04:09,573 ccm INFO node1: using Java 8 for the current invocation
11:04:09,760 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k_svqt57/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k_svqt57/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:04:09,761 ccm INFO node1: using Java 8 for the current invocation
11:04:09,844 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:04:25,166 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k_svqt57/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k_svqt57/test/node1/conf'}
11:04:25,167 ccm INFO node1: using Java 8 for the current invocation
11:04:31,758 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-k_svqt57/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-k_svqt57/test/node1/conf'}
11:04:31,759 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:04:46,20 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:04:50,374 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:04:49,356 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:04:49.356287
11:04:50,258 dtest_setup INFO cluster ccm directory: /tmp/dtest-n04f9aj5
----------------------------- Captured stdout call -----------------------------

11:04:50,380 ccm DEBUG using balanced tokens for non-vnode cluster
11:04:51,30 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n04f9aj5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n04f9aj5/test/node1/conf'}
11:04:51,31 ccm INFO node1: using Java 8 for the current invocation
11:04:51,207 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n04f9aj5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n04f9aj5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:04:51,207 ccm INFO node1: using Java 8 for the current invocation
11:04:51,289 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:05:06,584 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n04f9aj5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n04f9aj5/test/node1/conf'}
11:05:06,585 ccm INFO node1: using Java 8 for the current invocation
11:05:14,46 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n04f9aj5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n04f9aj5/test/node1/conf'}
11:05:14,47 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:04:51,30 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n04f9aj5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n04f9aj5/test/node1/conf'}
11:04:51,31 ccm INFO node1: using Java 8 for the current invocation
11:04:51,207 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n04f9aj5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n04f9aj5/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:04:51,207 ccm INFO node1: using Java 8 for the current invocation
11:04:51,289 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:05:06,584 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n04f9aj5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n04f9aj5/test/node1/conf'}
11:05:06,585 ccm INFO node1: using Java 8 for the current invocation
11:05:14,46 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-n04f9aj5/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-n04f9aj5/test/node1/conf'}
11:05:14,47 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:04:46,20 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:04:46,20 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:05:24,982 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 79.90 seconds ===========================
[msx] rc = 1
v2v2 running time = 101301948039
---> v1v1 or v2v2 test failed.
v2v2 failed in a hypo test
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release PASSED               [100%]
===Flaky Test Report===

test_mv_metric_mbeans_release passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 32.41 seconds ===========================
[msx] rc = 0
v1v2 running time = 53757111132
---> v1v2 test suceeded.
cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7fee566f35f8>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7fee55e29e10>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:06:43,997 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:06:42,732 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:06:42.732505
11:06:43,891 dtest_setup INFO cluster ccm directory: /tmp/dtest-lbmb5vu3
----------------------------- Captured stdout call -----------------------------
11:06:44,4 ccm DEBUG using balanced tokens for non-vnode cluster
11:06:44,771 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lbmb5vu3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lbmb5vu3/test/node1/conf'}
11:06:44,771 ccm INFO node1: using Java 8 for the current invocation
11:06:44,967 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lbmb5vu3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lbmb5vu3/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:06:44,967 ccm INFO node1: using Java 8 for the current invocation
11:06:45,67 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:07:00,391 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lbmb5vu3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lbmb5vu3/test/node1/conf'}
11:07:00,392 ccm INFO node1: using Java 8 for the current invocation
11:07:05,945 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lbmb5vu3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lbmb5vu3/test/node1/conf'}
11:07:05,945 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:06:44,771 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lbmb5vu3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lbmb5vu3/test/node1/conf'}
11:06:44,771 ccm INFO node1: using Java 8 for the current invocation
11:06:44,967 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lbmb5vu3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lbmb5vu3/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:06:44,967 ccm INFO node1: using Java 8 for the current invocation
11:06:45,67 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:07:00,391 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lbmb5vu3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lbmb5vu3/test/node1/conf'}
11:07:00,392 ccm INFO node1: using Java 8 for the current invocation
11:07:05,945 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-lbmb5vu3/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-lbmb5vu3/test/node1/conf'}
11:07:05,945 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:07:20,361 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:07:25,441 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:07:24,64 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:07:24.064238
11:07:25,326 dtest_setup INFO cluster ccm directory: /tmp/dtest-7ocbmla7
----------------------------- Captured stdout call -----------------------------
11:07:25,448 ccm DEBUG using balanced tokens for non-vnode cluster
11:07:26,124 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7ocbmla7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7ocbmla7/test/node1/conf'}
11:07:26,124 ccm INFO node1: using Java 8 for the current invocation
11:07:26,290 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7ocbmla7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7ocbmla7/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:07:26,290 ccm INFO node1: using Java 8 for the current invocation
11:07:26,377 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:07:42,672 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7ocbmla7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7ocbmla7/test/node1/conf'}
11:07:42,672 ccm INFO node1: using Java 8 for the current invocation
11:07:48,467 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7ocbmla7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7ocbmla7/test/node1/conf'}
11:07:48,468 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:07:26,124 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7ocbmla7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7ocbmla7/test/node1/conf'}
11:07:26,124 ccm INFO node1: using Java 8 for the current invocation
11:07:26,290 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7ocbmla7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7ocbmla7/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:07:26,290 ccm INFO node1: using Java 8 for the current invocation
11:07:26,377 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:07:42,672 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7ocbmla7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7ocbmla7/test/node1/conf'}
11:07:42,672 ccm INFO node1: using Java 8 for the current invocation
11:07:48,467 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7ocbmla7/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7ocbmla7/test/node1/conf'}
11:07:48,468 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:07:20,361 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:07:20,361 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:07:59,578 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 77.41 seconds ===========================
[msx] rc = 1
v1v1 running time = 98810867043
cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release PASSED               [100%]
===Flaky Test Report===

test_mv_metric_mbeans_release passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 31.93 seconds ===========================
[msx] rc = 0
v2v2 running time = 53302139926
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7f961caeb438>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f961c2d4080>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:09:15,785 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:09:14,789 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:09:14.789194
11:09:15,696 dtest_setup INFO cluster ccm directory: /tmp/dtest-pcvl1kr6
----------------------------- Captured stdout call -----------------------------
11:09:15,792 ccm DEBUG using balanced tokens for non-vnode cluster
11:09:16,412 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pcvl1kr6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pcvl1kr6/test/node1/conf'}
11:09:16,413 ccm INFO node1: using Java 8 for the current invocation
11:09:16,571 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pcvl1kr6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pcvl1kr6/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:09:16,572 ccm INFO node1: using Java 8 for the current invocation
11:09:16,658 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:09:31,994 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pcvl1kr6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pcvl1kr6/test/node1/conf'}
11:09:31,995 ccm INFO node1: using Java 8 for the current invocation
11:09:37,797 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pcvl1kr6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pcvl1kr6/test/node1/conf'}
11:09:37,798 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:09:16,412 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pcvl1kr6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pcvl1kr6/test/node1/conf'}
11:09:16,413 ccm INFO node1: using Java 8 for the current invocation
11:09:16,571 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pcvl1kr6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pcvl1kr6/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:09:16,572 ccm INFO node1: using Java 8 for the current invocation
11:09:16,658 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:09:31,994 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pcvl1kr6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pcvl1kr6/test/node1/conf'}
11:09:31,995 ccm INFO node1: using Java 8 for the current invocation
11:09:37,797 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-pcvl1kr6/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-pcvl1kr6/test/node1/conf'}
11:09:37,798 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:09:51,658 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:09:56,420 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:09:55,262 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:09:55.262169
11:09:56,311 dtest_setup INFO cluster ccm directory: /tmp/dtest-v9oltme_
----------------------------- Captured stdout call -----------------------------
11:09:56,426 ccm DEBUG using balanced tokens for non-vnode cluster
11:09:57,127 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v9oltme_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v9oltme_/test/node1/conf'}
11:09:57,127 ccm INFO node1: using Java 8 for the current invocation
11:09:57,297 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v9oltme_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v9oltme_/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:09:57,297 ccm INFO node1: using Java 8 for the current invocation
11:09:57,394 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:10:16,194 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v9oltme_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v9oltme_/test/node1/conf'}
11:10:16,195 ccm INFO node1: using Java 8 for the current invocation
11:10:22,39 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v9oltme_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v9oltme_/test/node1/conf'}
11:10:22,39 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:09:57,127 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v9oltme_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v9oltme_/test/node1/conf'}
11:09:57,127 ccm INFO node1: using Java 8 for the current invocation
11:09:57,297 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v9oltme_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v9oltme_/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:09:57,297 ccm INFO node1: using Java 8 for the current invocation
11:09:57,394 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:10:16,194 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v9oltme_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v9oltme_/test/node1/conf'}
11:10:16,195 ccm INFO node1: using Java 8 for the current invocation
11:10:22,39 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v9oltme_/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v9oltme_/test/node1/conf'}
11:10:22,39 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:09:51,658 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:09:51,658 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:10:33,34 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 78.82 seconds ===========================
[msx] rc = 1
v1v2 running time = 100136178643
---> v1v2 test failed.
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7f403eb12048>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f403e24aac8>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:10:55,905 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:10:54,954 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:10:54.954195
11:10:55,810 dtest_setup INFO cluster ccm directory: /tmp/dtest-a3au3jo4
----------------------------- Captured stdout call -----------------------------

11:10:55,912 ccm DEBUG using balanced tokens for non-vnode cluster
11:10:56,571 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a3au3jo4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a3au3jo4/test/node1/conf'}
11:10:56,572 ccm INFO node1: using Java 8 for the current invocation
11:10:56,729 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a3au3jo4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a3au3jo4/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:10:56,730 ccm INFO node1: using Java 8 for the current invocation
11:10:56,808 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:11:11,108 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a3au3jo4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a3au3jo4/test/node1/conf'}
11:11:11,109 ccm INFO node1: using Java 8 for the current invocation
11:11:16,826 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a3au3jo4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a3au3jo4/test/node1/conf'}
11:11:16,827 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:10:56,571 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a3au3jo4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a3au3jo4/test/node1/conf'}
11:10:56,572 ccm INFO node1: using Java 8 for the current invocation
11:10:56,729 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a3au3jo4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a3au3jo4/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:10:56,730 ccm INFO node1: using Java 8 for the current invocation
11:10:56,808 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:11:11,108 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a3au3jo4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a3au3jo4/test/node1/conf'}
11:11:11,109 ccm INFO node1: using Java 8 for the current invocation
11:11:16,826 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-a3au3jo4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-a3au3jo4/test/node1/conf'}
11:11:16,827 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:11:30,771 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:11:34,609 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:11:33,790 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:11:33.790540
11:11:34,500 dtest_setup INFO cluster ccm directory: /tmp/dtest-mnx8ki66
----------------------------- Captured stdout call -----------------------------
11:11:34,615 ccm DEBUG using balanced tokens for non-vnode cluster
11:11:35,242 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mnx8ki66/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mnx8ki66/test/node1/conf'}
11:11:35,243 ccm INFO node1: using Java 8 for the current invocation
11:11:35,426 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mnx8ki66/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mnx8ki66/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:11:35,427 ccm INFO node1: using Java 8 for the current invocation
11:11:35,513 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:11:47,857 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mnx8ki66/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mnx8ki66/test/node1/conf'}
11:11:47,858 ccm INFO node1: using Java 8 for the current invocation
11:11:54,395 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mnx8ki66/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mnx8ki66/test/node1/conf'}
11:11:54,396 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:11:35,242 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mnx8ki66/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mnx8ki66/test/node1/conf'}
11:11:35,243 ccm INFO node1: using Java 8 for the current invocation
11:11:35,426 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mnx8ki66/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mnx8ki66/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:11:35,427 ccm INFO node1: using Java 8 for the current invocation
11:11:35,513 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:11:47,857 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mnx8ki66/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mnx8ki66/test/node1/conf'}
11:11:47,858 ccm INFO node1: using Java 8 for the current invocation
11:11:54,395 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-mnx8ki66/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-mnx8ki66/test/node1/conf'}
11:11:54,396 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:11:30,771 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:11:30,771 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:12:05,517 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 71.12 seconds ===========================
[msx] rc = 1
v1v1 running time = 92525045087
cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7f8d9f66d550>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f8d9ee565c0>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:12:28,563 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:12:27,446 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:12:27.446582
11:12:28,456 dtest_setup INFO cluster ccm directory: /tmp/dtest-ryjhd_93
----------------------------- Captured stdout call -----------------------------

11:12:28,569 ccm DEBUG using balanced tokens for non-vnode cluster
11:12:29,221 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ryjhd_93/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ryjhd_93/test/node1/conf'}
11:12:29,222 ccm INFO node1: using Java 8 for the current invocation
11:12:29,394 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ryjhd_93/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ryjhd_93/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:12:29,395 ccm INFO node1: using Java 8 for the current invocation
11:12:29,488 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:12:42,769 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ryjhd_93/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ryjhd_93/test/node1/conf'}
11:12:42,770 ccm INFO node1: using Java 8 for the current invocation
11:12:47,157 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ryjhd_93/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ryjhd_93/test/node1/conf'}
11:12:47,158 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:12:29,221 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ryjhd_93/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ryjhd_93/test/node1/conf'}
11:12:29,222 ccm INFO node1: using Java 8 for the current invocation
11:12:29,394 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ryjhd_93/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ryjhd_93/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:12:29,395 ccm INFO node1: using Java 8 for the current invocation
11:12:29,488 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:12:42,769 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ryjhd_93/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ryjhd_93/test/node1/conf'}
11:12:42,770 ccm INFO node1: using Java 8 for the current invocation
11:12:47,157 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ryjhd_93/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ryjhd_93/test/node1/conf'}
11:12:47,158 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:13:01,209 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:13:05,422 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:13:04,462 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:13:04.462232
11:13:05,323 dtest_setup INFO cluster ccm directory: /tmp/dtest-ioan2o1q
----------------------------- Captured stdout call -----------------------------

11:13:05,428 ccm DEBUG using balanced tokens for non-vnode cluster
11:13:06,25 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ioan2o1q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ioan2o1q/test/node1/conf'}
11:13:06,26 ccm INFO node1: using Java 8 for the current invocation
11:13:06,205 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ioan2o1q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ioan2o1q/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:13:06,206 ccm INFO node1: using Java 8 for the current invocation
11:13:06,298 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:13:18,595 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ioan2o1q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ioan2o1q/test/node1/conf'}
11:13:18,596 ccm INFO node1: using Java 8 for the current invocation
11:13:24,199 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ioan2o1q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ioan2o1q/test/node1/conf'}
11:13:24,200 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:13:06,25 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ioan2o1q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ioan2o1q/test/node1/conf'}
11:13:06,26 ccm INFO node1: using Java 8 for the current invocation
11:13:06,205 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ioan2o1q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ioan2o1q/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:13:06,206 ccm INFO node1: using Java 8 for the current invocation
11:13:06,298 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:13:18,595 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ioan2o1q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ioan2o1q/test/node1/conf'}
11:13:18,596 ccm INFO node1: using Java 8 for the current invocation
11:13:24,199 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-ioan2o1q/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-ioan2o1q/test/node1/conf'}
11:13:24,200 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:13:01,209 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:13:01,209 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:13:35,321 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 68.41 seconds ===========================
[msx] rc = 1
v2v2 running time = 89751935787
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

v2v2 failed in a hypo test
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v2v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7f8043a476a0>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f804322ddd8>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:13:58,908 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:13:57,198 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:13:57.198578
11:13:58,809 dtest_setup INFO cluster ccm directory: /tmp/dtest-la76r5_w
----------------------------- Captured stdout call -----------------------------

11:13:58,914 ccm DEBUG using balanced tokens for non-vnode cluster
11:13:59,597 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-la76r5_w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-la76r5_w/test/node1/conf'}
11:13:59,597 ccm INFO node1: using Java 8 for the current invocation
11:13:59,767 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-la76r5_w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-la76r5_w/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:13:59,768 ccm INFO node1: using Java 8 for the current invocation
11:13:59,855 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:14:13,178 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-la76r5_w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-la76r5_w/test/node1/conf'}
11:14:13,179 ccm INFO node1: using Java 8 for the current invocation
11:14:18,901 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-la76r5_w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-la76r5_w/test/node1/conf'}
11:14:18,902 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:13:59,597 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-la76r5_w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-la76r5_w/test/node1/conf'}
11:13:59,597 ccm INFO node1: using Java 8 for the current invocation
11:13:59,767 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-la76r5_w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-la76r5_w/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:13:59,768 ccm INFO node1: using Java 8 for the current invocation
11:13:59,855 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:14:13,178 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-la76r5_w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-la76r5_w/test/node1/conf'}
11:14:13,179 ccm INFO node1: using Java 8 for the current invocation
11:14:18,901 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-la76r5_w/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-la76r5_w/test/node1/conf'}
11:14:18,902 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:14:32,782 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
1:14:36,938 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:14:35,984 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:14:35.984014
11:14:36,833 dtest_setup INFO cluster ccm directory: /tmp/dtest-7jd24ysc
----------------------------- Captured stdout call -----------------------------
11:14:36,946 ccm DEBUG using balanced tokens for non-vnode cluster
11:14:37,800 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7jd24ysc/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7jd24ysc/test/node1/conf'}
11:14:37,801 ccm INFO node1: using Java 8 for the current invocation
11:14:38,160 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7jd24ysc/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7jd24ysc/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:14:38,161 ccm INFO node1: using Java 8 for the current invocation
11:14:38,292 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:14:56,210 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7jd24ysc/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7jd24ysc/test/node1/conf'}
11:14:56,211 ccm INFO node1: using Java 8 for the current invocation
11:15:01,927 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7jd24ysc/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7jd24ysc/test/node1/conf'}
11:15:01,928 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:14:37,800 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7jd24ysc/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7jd24ysc/test/node1/conf'}
11:14:37,801 ccm INFO node1: using Java 8 for the current invocation
11:14:38,160 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7jd24ysc/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7jd24ysc/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:14:38,161 ccm INFO node1: using Java 8 for the current invocation
11:14:38,292 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:14:56,210 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7jd24ysc/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7jd24ysc/test/node1/conf'}
11:14:56,211 ccm INFO node1: using Java 8 for the current invocation
11:15:01,927 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7jd24ysc/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7jd24ysc/test/node1/conf'}
11:15:01,928 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:14:32,782 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:14:32,782 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:15:13,76 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 76.43 seconds ===========================
[msx] rc = 1
v1v2 running time = 97772322867
---> v1v2 test failed.
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release PASSED               [100%]
===Flaky Test Report===

test_mv_metric_mbeans_release passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 33.26 seconds ===========================
[msx] rc = 0
v1v1 running time = 54651588553
cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release PASSED               [100%]
===Flaky Test Report===

test_mv_metric_mbeans_release passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 24.41 seconds ===========================
[msx] rc = 0
v2v2 running time = 45766719769
---> v1v1 and v2v2 test test suceeded.
cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7f4f46478128>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7f4f45c620f0>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:17:17,334 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:17:15,470 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:17:15.470221
11:17:17,233 dtest_setup INFO cluster ccm directory: /tmp/dtest-u70kkuz9
----------------------------- Captured stdout call -----------------------------
11:17:17,342 ccm DEBUG using balanced tokens for non-vnode cluster
11:17:17,964 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u70kkuz9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u70kkuz9/test/node1/conf'}
11:17:17,965 ccm INFO node1: using Java 8 for the current invocation
11:17:18,146 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u70kkuz9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u70kkuz9/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:17:18,146 ccm INFO node1: using Java 8 for the current invocation
11:17:18,237 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:17:32,648 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u70kkuz9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u70kkuz9/test/node1/conf'}
11:17:32,648 ccm INFO node1: using Java 8 for the current invocation
11:17:39,787 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u70kkuz9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u70kkuz9/test/node1/conf'}
11:17:39,787 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:17:17,964 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u70kkuz9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u70kkuz9/test/node1/conf'}
11:17:17,965 ccm INFO node1: using Java 8 for the current invocation
11:17:18,146 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u70kkuz9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u70kkuz9/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:17:18,146 ccm INFO node1: using Java 8 for the current invocation
11:17:18,237 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:17:32,648 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u70kkuz9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u70kkuz9/test/node1/conf'}
11:17:32,648 ccm INFO node1: using Java 8 for the current invocation
11:17:39,787 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-u70kkuz9/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-u70kkuz9/test/node1/conf'}
11:17:39,787 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:17:54,471 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:17:58,451 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:17:57,580 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:17:57.580673
11:17:58,341 dtest_setup INFO cluster ccm directory: /tmp/dtest-7guh5457
----------------------------- Captured stdout call -----------------------------

11:17:58,464 ccm DEBUG using balanced tokens for non-vnode cluster
11:17:59,82 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7guh5457/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7guh5457/test/node1/conf'}
11:17:59,82 ccm INFO node1: using Java 8 for the current invocation
11:17:59,273 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7guh5457/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7guh5457/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:17:59,274 ccm INFO node1: using Java 8 for the current invocation
11:17:59,358 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:18:12,660 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7guh5457/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7guh5457/test/node1/conf'}
11:18:12,661 ccm INFO node1: using Java 8 for the current invocation
11:18:18,334 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7guh5457/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7guh5457/test/node1/conf'}
11:18:18,335 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:17:59,82 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7guh5457/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7guh5457/test/node1/conf'}
11:17:59,82 ccm INFO node1: using Java 8 for the current invocation
11:17:59,273 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7guh5457/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7guh5457/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:17:59,274 ccm INFO node1: using Java 8 for the current invocation
11:17:59,358 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:18:12,660 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7guh5457/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7guh5457/test/node1/conf'}
11:18:12,661 ccm INFO node1: using Java 8 for the current invocation
11:18:18,334 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-7guh5457/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-7guh5457/test/node1/conf'}
11:18:18,335 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:17:54,471 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:17:54,471 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:18:29,300 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 74.40 seconds ===========================
[msx] rc = 1
v1v2 running time = 95824784403
---> v1v2 test failed.
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v1v2
result: FAIL
failureMessage: 
stackTrace: 

cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release FAILED               [100%]

=================================== FAILURES ===================================
____________________ TestJMX.test_mv_metric_mbeans_release _____________________

self = <jmx_test.TestJMX object at 0x7fd13d5a3630>

    @since('3.0')
    def test_mv_metric_mbeans_release(self):
        """
            Test that the right mbeans are created and released when creating mvs
            """
        cluster = self.cluster
        cluster.set_configuration_options({'enable_materialized_views': 'true'})
        cluster.populate(1)
        node = cluster.nodelist()[0]
        cluster.start()
    
        node.run_cqlsh(cmds="""
                CREATE KEYSPACE mvtest WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor': 1 };
                CREATE TABLE mvtest.testtable (
                    foo int,
                    bar text,
                    baz text,
                    PRIMARY KEY (foo, bar)
                );
    
                CREATE MATERIALIZED VIEW mvtest.testmv AS
                    SELECT foo, bar, baz FROM mvtest.testtable WHERE
                    foo IS NOT NULL AND bar IS NOT NULL AND baz IS NOT NULL
                PRIMARY KEY (foo, bar, baz);""")
    
        table_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                         name='AllMemtablesHeapSize')
        table_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewReadTime')
        table_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testtable',
                                          name='ViewLockAcquireTime')
        mv_memtable_size = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                      name='AllMemtablesHeapSize')
        mv_view_read_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewReadTime')
        mv_view_lock_time = make_mbean('metrics', type='Table', keyspace='mvtest', scope='testmv',
                                       name='ViewLockAcquireTime')
    
        missing_metric_message = "Table metric %s should have been registered after creating table %s" \
                                 "but wasn't!"
    
        with JolokiaAgent(node) as jmx:
            assert jmx.read_attribute(table_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testtable")
            assert jmx.read_attribute(table_view_read_time, "Count") is not None, \
                missing_metric_message.format("ViewReadTime", "testtable")
            assert jmx.read_attribute(table_view_lock_time, "Count") is not None, \
                missing_metric_message.format("ViewLockAcquireTime", "testtable")
            assert jmx.read_attribute(mv_memtable_size, "Value") is not None, \
                missing_metric_message.format("AllMemtablesHeapSize", "testmv")
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_read_time, attribute="Count", verbose=False)
            with pytest.raises(Exception, match=".*InstanceNotFoundException.*"):
                jmx.read_attribute(mbean=mv_view_lock_time, attribute="Count", verbose=False)
    
>       node.run_cqlsh(cmds="DROP KEYSPACE mvtest;")

jmx_test.py:162: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
../dtest/lib/python3.6/site-packages/ccmlib/node.py:1095: in run_cqlsh
    return handle_external_tool_process(p, ['cqlsh', cmds, cqlsh_options])
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

process = <subprocess.Popen object at 0x7fd13ccda898>
cmd_args = ['cqlsh', 'DROP KEYSPACE mvtest;', None]

    def handle_external_tool_process(process, cmd_args):
        out, err = process.communicate()
        if (out is not None) and isinstance(out, bytes):
            out = out.decode()
        if (err is not None) and isinstance(err, bytes):
            err = err.decode()
        rc = process.returncode
    
        if rc != 0:
>           raise ToolError(cmd_args, rc, out, err)
E           ccmlib.node.ToolError: Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
E           stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

../dtest/lib/python3.6/site-packages/ccmlib/node.py:2305: ToolError
---------------------------- Captured stdout setup -----------------------------
11:18:52,690 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:18:51,311 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:18:51.311837
11:18:52,571 dtest_setup INFO cluster ccm directory: /tmp/dtest-1w7dg4na
----------------------------- Captured stdout call -----------------------------
11:18:52,697 ccm DEBUG using balanced tokens for non-vnode cluster
11:18:53,320 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1w7dg4na/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1w7dg4na/test/node1/conf'}
11:18:53,321 ccm INFO node1: using Java 8 for the current invocation
11:18:53,494 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1w7dg4na/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1w7dg4na/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:18:53,495 ccm INFO node1: using Java 8 for the current invocation
11:18:53,586 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:19:06,886 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1w7dg4na/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1w7dg4na/test/node1/conf'}
11:19:06,886 ccm INFO node1: using Java 8 for the current invocation
11:19:12,513 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1w7dg4na/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1w7dg4na/test/node1/conf'}
11:19:12,514 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:18:53,320 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1w7dg4na/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1w7dg4na/test/node1/conf'}
11:18:53,321 ccm INFO node1: using Java 8 for the current invocation
11:18:53,494 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1w7dg4na/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1w7dg4na/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:18:53,495 ccm INFO node1: using Java 8 for the current invocation
11:18:53,586 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:19:06,886 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1w7dg4na/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1w7dg4na/test/node1/conf'}
11:19:06,886 ccm INFO node1: using Java 8 for the current invocation
11:19:12,513 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-1w7dg4na/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-1w7dg4na/test/node1/conf'}
11:19:12,514 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:19:26,573 ccm DEBUG Log-watching thread exiting.
---------------------------- Captured stdout setup -----------------------------
11:19:30,615 ccm DEBUG Log-watching thread starting.
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
11:19:29,666 conftest INFO Starting execution of test_mv_metric_mbeans_release at 2022-01-30 11:19:29.666501
11:19:30,524 dtest_setup INFO cluster ccm directory: /tmp/dtest-v4t4dmqh
----------------------------- Captured stdout call -----------------------------

11:19:30,623 ccm DEBUG using balanced tokens for non-vnode cluster
11:19:31,377 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v4t4dmqh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v4t4dmqh/test/node1/conf'}
11:19:31,378 ccm INFO node1: using Java 8 for the current invocation
11:19:31,571 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v4t4dmqh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v4t4dmqh/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:19:31,572 ccm INFO node1: using Java 8 for the current invocation
11:19:31,702 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:19:46,982 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v4t4dmqh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v4t4dmqh/test/node1/conf'}
11:19:46,983 ccm INFO node1: using Java 8 for the current invocation
11:19:53,445 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v4t4dmqh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v4t4dmqh/test/node1/conf'}
11:19:53,446 ccm INFO node1: using Java 8 for the current invocation
------------------------------ Captured log call -------------------------------
11:19:31,377 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v4t4dmqh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v4t4dmqh/test/node1/conf'}
11:19:31,378 ccm INFO node1: using Java 8 for the current invocation
11:19:31,571 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v4t4dmqh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v4t4dmqh/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
11:19:31,572 ccm INFO node1: using Java 8 for the current invocation
11:19:31,702 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
11:19:46,982 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v4t4dmqh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v4t4dmqh/test/node1/conf'}
11:19:46,983 ccm INFO node1: using Java 8 for the current invocation
11:19:53,445 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': 'f1db7bca526f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '4', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'jmx_test.py::TestJMX::()::test_mv_metric_mbeans_release (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-v4t4dmqh/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-v4t4dmqh/test/node1/conf'}
11:19:53,446 ccm INFO node1: using Java 8 for the current invocation
--------------------------- Captured stdout teardown ---------------------------
11:19:26,573 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:19:26,573 ccm DEBUG Log-watching thread exiting.
--------------------------- Captured stdout teardown ---------------------------
11:20:04,494 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_mv_metric_mbeans_release failed (1 runs remaining out of 2).
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]
test_mv_metric_mbeans_release failed; it passed 0 out of the required 1 times.
	<class 'ccmlib.node.ToolError'>
	Subprocess ['cqlsh', 'DROP KEYSPACE mvtest;', None] exited with non-zero status; exit status: 2; 
stderr: <stdin>:2:OperationTimedOut: errors={'127.0.0.1:9042': 'Client request timeout. See Session.execute[_async](timeout)'}, last_host=127.0.0.1:9042

	[<TracebackEntry /root/cassandra-dtest/jmx_test.py:162>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:1095>, <TracebackEntry /root/dtest/lib/python3.6/site-packages/ccmlib/node.py:2305>]

===End Flaky Test Report===
========================== 1 failed in 73.76 seconds ===========================
[msx] rc = 1
v1v1 running time = 95116198264
cassandra jmx_test.py::TestJMX::test_mv_metric_mbeans_release false false
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is jmx_test.py::TestJMX::test_mv_metric_mbeans_release
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

jmx_test.py::TestJMX::test_mv_metric_mbeans_release PASSED               [100%]
===Flaky Test Report===

test_mv_metric_mbeans_release passed 1 out of the required 1 times. Success!

===End Flaky Test Report===

========================== 1 passed in 24.47 seconds ===========================
[msx] rc = 0
v2v2 running time = 45758191767
---> v1v1 or v2v2 test failed.
v1v1 failed in a hypo test
proj: cassandra
u_test: jmx_test.py::TestJMX::test_mv_metric_mbeans_release
h_list: read_request_timeout_in_ms@@@CassandraDaemon@@@1@@@15000@@@5000
vv_mode: v1v1
result: FAIL
failureMessage: 
stackTrace: 

early stop after 7 is satisfied
v1v2 failed with probability 5 out of 8
v1v1v2v2 failed with probability 7 out of 8
Total execution time in seconds : 1944
0
