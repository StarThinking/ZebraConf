mesg: ttyname failed: Inappropriate ioctl for device
cassandra commitlog_test.py::TestCommitLog::test_stop_failure_policy false true
log_dst_dir = /root/vm_images/ZebraConf/app_meta/logs
the_test is commitlog_test.py::TestCommitLog::test_stop_failure_policy
rm: cannot remove '/tmp/my_log.txt': No such file or directory
============================= test session starts ==============================
platform linux -- Python 3.6.9, pytest-3.6.4, py-1.11.0, pluggy-0.7.1 -- /root/dtest/bin/python
cachedir: .pytest_cache
rootdir: /root/cassandra-dtest, inifile: pytest.ini
plugins: flaky-3.7.0, timeout-1.4.2, repeat-0.9.1
timeout: 1200.0s
timeout method: signal
timeout func_only: False
collecting ... collected 1 item

commitlog_test.py::TestCommitLog::test_stop_failure_policy FAILED        [100%]

=================================== FAILURES ===================================
____________________ TestCommitLog.test_stop_failure_policy ____________________

self = <commitlog_test.TestCommitLog object at 0x7f5f2e3ccac8>

    def test_stop_failure_policy(self):
        """
            Test the stop commitlog failure policy (default one)
            """
        self.prepare()
    
        self._provoke_commitlog_failure()
        failure = self.node1.grep_log("Failed .+ commit log segments. Commit disk failure policy is stop; terminating thread")
        logger.debug(failure)
>       assert failure, "Cannot find the commitlog failure message in logs"
E       AssertionError: Cannot find the commitlog failure message in logs
E       assert []

commitlog_test.py:325: AssertionError
---------------------------- Captured stdout setup -----------------------------
09:50:06,43 ccm DEBUG Log-watching thread starting.
09:50:06,48 ccm DEBUG using balanced tokens for non-vnode cluster
---------------------------- Captured stderr setup -----------------------------
swapoff: Not superuser.
------------------------------ Captured log setup ------------------------------
09:50:05,874 conftest INFO Starting execution of test_stop_failure_policy at 2022-02-05 09:50:05.874115
09:50:05,953 dtest_setup INFO cluster ccm directory: /tmp/dtest-89_xmwn4
----------------------------- Captured stdout call -----------------------------
09:50:06,929 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '04a42001b39f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '3', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'commitlog_test.py::TestCommitLog::()::test_stop_failure_policy (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-89_xmwn4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-89_xmwn4/test/node1/conf'}
09:50:06,930 ccm INFO node1: using Java 8 for the current invocation
09:50:07,144 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '04a42001b39f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '3', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'commitlog_test.py::TestCommitLog::()::test_stop_failure_policy (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-89_xmwn4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-89_xmwn4/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
09:50:07,145 ccm INFO node1: using Java 8 for the current invocation
09:50:07,254 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
------------------------------ Captured log call -------------------------------
09:50:06,929 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '04a42001b39f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '3', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'commitlog_test.py::TestCommitLog::()::test_stop_failure_policy (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-89_xmwn4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-89_xmwn4/test/node1/conf'}
09:50:06,930 ccm INFO node1: using Java 8 for the current invocation
09:50:07,144 ccm INFO node1: current_java_version=8, current_java_home_version=8, jvm_version=None, for_build=False, cassandra_version=4.0.2, install_dir=/root/cassandra, env={'HOSTNAME': '04a42001b39f', 'JAVA_HOME': '/usr/lib/jvm/java-1.8.0-openjdk-amd64', 'PWD': '/root/cassandra-dtest', 'HOME': '/root', 'SHLVL': '3', 'ZEBRACONF_HOME': '/root/vm_images/ZebraConf', 'PATH': '/root/dtest/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin', '_': '/root/dtest/bin/pytest', 'OLDPWD': '/', 'PYTEST_CURRENT_TEST': 'commitlog_test.py::TestCommitLog::()::test_stop_failure_policy (call)', 'CASSANDRA_INCLUDE': '/tmp/dtest-89_xmwn4/test/node1/bin/cassandra.in.sh', 'MAX_HEAP_SIZE': '500M', 'HEAP_NEWSIZE': '50M', 'CASSANDRA_HOME': '/root/cassandra', 'CASSANDRA_CONF': '/tmp/dtest-89_xmwn4/test/node1/conf', 'CASSANDRA_LIBJEMALLOC': '-', 'JVM_EXTRA_OPTS': ' -Dcassandra.migration_task_wait_in_seconds=2'}
09:50:07,145 ccm INFO node1: using Java 8 for the current invocation
09:50:07,254 ccm INFO Starting node1 with JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-amd64 java_version=8 cassandra_version=4.0.2, install_dir=/root/cassandra
--------------------------- Captured stdout teardown ---------------------------
09:51:37,754 ccm DEBUG Log-watching thread exiting.
===Flaky Test Report===

test_stop_failure_policy failed and was not selected for rerun.
	<class 'AssertionError'>
	Cannot find the commitlog failure message in logs
assert []
	[<TracebackEntry /root/cassandra-dtest/commitlog_test.py:325>]

===End Flaky Test Report===
========================== 1 failed in 95.78 seconds ===========================
[msx] rc = 1
mv /tmp/my_log.txt /root/vm_images/ZebraConf/app_meta/logs/commitlog_test.py::TestCommitLog::test_stop_failure_policy-output_1644054711578_2549724016.txt
